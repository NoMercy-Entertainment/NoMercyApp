import"./useBaseQuery-CMhLd9-U.js";import"./useInfiniteServerClient-MMR7oD7k.js";import"./useQueryClient-YAttX_Mh.js";import"./useQuery-CmvJ8I_d.js";import{Di as b,Fc as u,Fs as p,Hs as o,Is as c,Mc as y,Oi as _,Rs as k,Ss as C,Vs as v,Ws as w,ac as i,fo as L,g as R,io as E,jc as d,ks as $,lc as q,mi as a,r as I,sc as N,vc as t,wc as g}from"./index-BLQpgzX8.js";import"./_plugin-vue_export-helper-Qq1ciMp2.js";import"./AppLogoSquare-B-kmZabX.js";import{t as V}from"./TMDBImage-CGNzn1sE.js";import"./MoooomIcon-dvFgFFTt.js";import{t as j}from"./useServerClient-BVrDeuWr.js";import"./ScrollContainer-BI_Fnk7v.js";import"./useMounted-J-3GexKa.js";import"./RipperOverlay-dfDTUhK2.js";import"./HubConnection-klX5ssCm.js";import"./ripperSocket-D1Nd2ST_.js";import"./Button-BGwgw4rc.js";import"./FloatingBackButton-CVf20Z6P.js";import{t as A}from"./DashboardLayout-Bm0jsGn3.js";import{t as F}from"./DashboardCard-D-wlDKNJ.js";C();var M={class:"relative flex aspect-video flex-shrink-0 flex-grow-0 flex-col items-center justify-center self-stretch overflow-clip rounded-lg bg-theme-8"},T={key:1,class:"text-xl font-bold"},z=w({__name:"LibraryCard",props:{data:{type:Object,required:!0}},setup(r){return(l,n)=>(i(),c(F,{line1:r.data.title,line2:r.data.folder_library&&r.data.folder_library?.length!==1?`${r.data.folder_library?.length} folders`:`${r.data.folder_library?.length}  folder`,route:`/dashboard/libraries/${r.data.id}`},{image:t(()=>[p("div",M,[n[0]||(n[0]=p("div",{class:"backdropCard-overlay"},null,-1)),r.data.image?(i(),c(V,{key:0,path:r.data.image,aspect:"backdrop",class:"z-0"},null,8,["path"])):(i(),k("span",T,u(r.data.title),1))])]),_:1},8,["line1","line2","route"]))}}),K=z;C();var O=w({__name:"Desktop",setup(r){const l=I(),{data:n,error:x}=j({path:"dashboard/libraries",queryKey:["dashboard","libraries",_.value?.serverBaseUrl]});function B(){b().post("dashboard/libraries").then(({data:e})=>{l.add({severity:e.status==="ok"?"success":"error",summary:a(e.status==="ok"?"Success":"Error"),detail:a(e.message,...e.args),life:5e3}),R.invalidateQueries({queryKey:["dashboard","libraries",_.value?.serverBaseUrl]})})}const s=g(!1);function S(){s.value=!0,b().post("dashboard/libraries/refresh").then(({data:e})=>{s.value=!1,l.add({severity:e.status==="ok"?"success":"error",summary:a(e.status==="ok"?"Success":"Error"),detail:a(e.message,...e.args),life:5e3})}).catch(()=>{s.value=!1,l.add({severity:"error",summary:a("Error"),detail:a("An error occurred while rescanning the libraries"),life:5e3})})}const f=g(!1);function D(){f.value=!0,b().post("dashboard/libraries/rescan").then(({data:e})=>{f.value=!1,l.add({severity:e.status==="ok"?"success":"error",summary:a(e.status==="ok"?"Success":"Error"),detail:a(e.message,...e.args),life:5e3})}).catch(()=>{f.value=!1,l.add({severity:"error",summary:a("Error"),detail:a("An error occurred while rescanning the libraries"),life:5e3})})}return(e,U)=>{const m=q("Button");return i(),c(d(L),null,{default:t(()=>[o(d(E),{fullscreen:!0},{default:t(()=>[o(A,{error:d(x),"grid-style":1,title:"Libraries",description:"Manage your media libraries and their content here."},{cta:t(()=>[o(m,{id:"newLibrary",color:"theme","start-icon":"folderAdd",onClick:B},{default:t(()=>[v(u(e.$t("New library")),1)]),_:1})]),actions:t(()=>[o(m,{id:"refresh",type:"button",variant:"text","start-icon":"folderSwap",disabled:s.value,class:y(s.value?"first:children:animate-spin cursor-not-allowed":""),onClick:S},{default:t(()=>[v(u(e.$t("Refresh all libraries")),1)]),_:1},8,["disabled","class"]),o(m,{id:"rescan",type:"button",variant:"text","start-icon":"folderSwap",disabled:s.value,class:y(s.value?"first:children:animate-spin cursor-not-allowed":""),onClick:D},{default:t(()=>[v(u(e.$t("Rescan all libraries")),1)]),_:1},8,["disabled","class"])]),default:t(()=>[(i(!0),k($,null,N(d(n)??[],h=>(i(),c(K,{key:h.id,data:h},null,8,["data"]))),128))]),_:1},8,["error"])]),_:1})]),_:1})}}}),ue=O;export{ue as default};
