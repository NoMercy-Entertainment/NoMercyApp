import{Un as q}from"./index-CJ3av9Nr.js";import{n as G,r as m,t as T}from"./index5-DoEihQ4z.js";import{f as W,g as C,h as j,i as z,t as I}from"./helpers-WTIhTost.js";import"./index6-3cPFhgM2.js";import{d as J,i as Q,o as V,s as X}from"./index8-_cfIjXvh.js";import{n as Z,r as E,t as ee}from"./keyboard-D6ipGNt8.js";var A,D,R,k,N,te,O,re,F,H,U,$,P,_,M,h,x,Y,p,B,oe,se,ie=q({"node_modules/@nomercy-entertainment/nomercy-music-player/node_modules/@ionic/core/components/input-shims.js":()=>{G(),X(),W(),E(),A=new WeakMap,D=(e,r,t,o=0,i=!1)=>{A.has(e)!==t&&(t?k(e,r,o,i):N(e,r))},R=e=>e===e.getRootNode().activeElement,k=(e,r,t,o=!1)=>{const i=r.parentNode,s=r.cloneNode(!1);s.classList.add("cloned-input"),s.tabIndex=-1,o&&(s.disabled=!0),i.appendChild(s),A.set(e,s);const a=e.ownerDocument.dir==="rtl"?9999:-9999;e.style.pointerEvents="none",r.style.transform=`translate3d(${a}px,${t}px,0) scale(0)`},N=(e,r)=>{const t=A.get(e);t&&(A.delete(e),t.remove()),e.style.pointerEvents="",r.style.transform=""},te=50,O=(e,r,t)=>{if(!t||!r)return()=>{};const o=u=>{R(r)&&D(e,r,u)},i=()=>D(e,r,!1),s=()=>o(!0),a=()=>o(!1);return I(t,"ionScrollStart",s),I(t,"ionScrollEnd",a),r.addEventListener("blur",i),()=>{C(t,"ionScrollStart",s),C(t,"ionScrollEnd",a),r.removeEventListener("blur",i)}},re="input, textarea, [no-blur], [contenteditable]",F=()=>{let e=!0,r=!1;const t=document,o=()=>{r=!0},i=()=>{e=!0},s=a=>{if(r){r=!1;return}const u=t.activeElement;if(!u||u.matches("input, textarea, [no-blur], [contenteditable]"))return;const f=a.target;f!==u&&(f.matches("input, textarea, [no-blur], [contenteditable]")||f.closest("input, textarea, [no-blur], [contenteditable]")||(e=!1,setTimeout(()=>{e||u.blur()},50)))};return I(t,"ionScrollStart",o),t.addEventListener("focusin",i,!0),t.addEventListener("touchend",s,!1),()=>{C(t,"ionScrollStart",o,!0),t.removeEventListener("focusin",i,!0),t.removeEventListener("touchend",s,!1)}},H=.3,U=(e,r,t,o)=>{var i;const s=(i=e.closest("ion-item,[ion-item]"))!==null&&i!==void 0?i:e;return $(s.getBoundingClientRect(),r.getBoundingClientRect(),t,o)},$=(e,r,t,o)=>{const i=e.top,s=e.bottom,a=r.top,u=Math.min(r.bottom,o-t),f=a+15,d=u-50-s,c=f-i,l=Math.round(d<0?-d:c>0?-c:0),v=Math.min(l,i-a),S=Math.abs(v)/H;return{scrollAmount:v,scrollDuration:Math.min(400,Math.max(150,S)),scrollPadding:t,inputSafeY:-(i-f)+4}},P="$ionPaddingTimer",_=(e,r,t)=>{const o=e[P];o&&clearTimeout(o),r>0?e.style.setProperty("--keyboard-offset",`${r}px`):e[P]=setTimeout(()=>{e.style.setProperty("--keyboard-offset","0px"),t&&t()},120)},M=(e,r,t)=>{const o=()=>{r&&_(r,0,t)};e.addEventListener("focusout",o,{once:!0})},h=0,x="data-ionic-skip-scroll-assist",Y=(e,r,t,o,i,s,a,u=!1)=>{const f=s&&(a===void 0||a.mode===Z.None);let d=!1;const c=m!==void 0?m.innerHeight:0,l=b=>{if(d===!1){d=!0;return}B(e,r,t,o,b.detail.keyboardHeight,f,u,c,!1)},v=()=>{d=!1,m===null||m===void 0||m.removeEventListener("ionKeyboardDidShow",l),e.removeEventListener("focusout",v)},S=async()=>{if(r.hasAttribute("data-ionic-skip-scroll-assist")){r.removeAttribute(x);return}B(e,r,t,o,i,f,u,c),m===null||m===void 0||m.addEventListener("ionKeyboardDidShow",l),e.addEventListener("focusout",v)};return e.addEventListener("focusin",S),()=>{e.removeEventListener("focusin",S),m===null||m===void 0||m.removeEventListener("ionKeyboardDidShow",l),e.removeEventListener("focusout",v)}},p=e=>{document.activeElement!==e&&(e.setAttribute(x,"true"),e.focus())},B=async(e,r,t,o,i,s,a=!1,u=0,f=!0)=>{if(!t&&!o)return;const d=U(e,t||o,i,u);if(t&&Math.abs(d.scrollAmount)<4){p(r),s&&t!==null&&(_(t,h),M(r,t,()=>h=0));return}if(D(e,r,!0,d.inputSafeY,a),p(r),j(()=>e.click()),s&&t&&(h=d.scrollPadding,_(t,h)),typeof window<"u"){let c;const l=async()=>{c!==void 0&&clearTimeout(c),window.removeEventListener("ionKeyboardDidShow",v),window.removeEventListener("ionKeyboardDidShow",l),t&&await J(t,0,d.scrollAmount,d.scrollDuration),D(e,r,!1,d.inputSafeY),p(r),s&&M(r,t,()=>h=0)},v=()=>{window.removeEventListener("ionKeyboardDidShow",v),window.addEventListener("ionKeyboardDidShow",l)};if(t){const S=await V(t),b=S.scrollHeight-S.clientHeight;if(f&&d.scrollAmount>b-S.scrollTop){r.type==="password"?(d.scrollAmount+=50,window.addEventListener("ionKeyboardDidShow",v)):window.addEventListener("ionKeyboardDidShow",l),c=setTimeout(l,1e3);return}}l()}},oe=!0,se=async(e,r)=>{if(T===void 0)return;const t=r==="ios",o=r==="android",i=e.getNumber("keyboardHeight",290),s=e.getBoolean("scrollAssist",!0),a=e.getBoolean("hideCaretOnScroll",t),u=e.getBoolean("inputBlurring",!1),f=e.getBoolean("scrollPadding",!0),d=Array.from(T.querySelectorAll("ion-input, ion-textarea")),c=new WeakMap,l=new WeakMap,v=await ee.getResizeMode(),S=async n=>{await new Promise(g=>z(n,g));const y=n.shadowRoot||n,w=y.querySelector("input")||y.querySelector("textarea"),L=Q(n),K=L?null:n.closest("ion-footer");if(w){if(L&&a&&!c.has(n)){const g=O(n,w,L);c.set(n,g)}if(!(w.type==="date"||w.type==="datetime-local")&&(L||K)&&s&&!l.has(n)){const g=Y(n,w,L,K,i,f,v,o);l.set(n,g)}}},b=n=>{if(a){const y=c.get(n);y&&y(),c.delete(n)}if(s){const y=l.get(n);y&&y(),l.delete(n)}};u&&F();for(const n of d)S(n);T.addEventListener("ionInputDidLoad",n=>{S(n.detail)}),T.addEventListener("ionInputDidUnload",n=>{b(n.detail)})}}});ie();export{se as startInputShims};
