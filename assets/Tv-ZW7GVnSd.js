import{I as F,f as z,c as p,o as n,b as S,d as b,a as c,t as D,F as y,h as q,z as P,cg as R,j as A,w as U,l as x,D as H,ch as M,s as V,K as w,bu as O,bh as W}from"./index-C_qNKMWs.js";import{u as G}from"./useServerClient-abD0VdnA.js";import{u as J}from"./useInfiniteServerClient-BbeQXtgw.js";import{_ as Q}from"./TMDBImage.vue_vue_type_script_setup_true_lang-DUzr8L2O.js";import"./useQuery-DTS8T947.js";import"./useBaseQuery-vm7BPSk-.js";import"./useQueryClient-C4PrSAx1.js";import"./AppLogoSquare-C46FQJ-V.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const X={key:0,"data-row":"",class:"grid grid-rows-[auto_1fr] grid-cols-7 relative justify-start flex-1 w-full gap-3 mb-2"},Y={class:"row-start-1 col-span-7 pointer-events-none font-semibold font-3xl"},Z=["src"],L=F({__name:"TvCarousel2",props:{data:{type:Array,required:!0},title:{type:String,required:!0},handleFocus:{type:Function,required:!0},handleDown:{type:Function,required:!0},handleUp:{type:Function,required:!0},suffix:{type:String,required:!1,default:""}},setup(r){return(v,u)=>{var d;const m=z("RouterLink");return n(),p(y,null,[r.data.length?(n(),p("div",X,[c("h3",Y,D(r.title),1),(n(!0),p(y,null,q(r.data.slice(0,7),(a,h)=>(n(),b(m,{key:a.id,to:`${a.link}${r.suffix}`,"data-card":a.id,"data-index":h,class:"row-start-2 w-full h-auto rounded-xl bg-cover aspect-poster focus:scale-105 focus:outline outline-[2.2px] outline-white transition-transform duration-200 scroll-mb-20 scroll-mt-12 snap-center snap-mandatory",style:P(`background-image: url('https://app.nomercy.tv/tmdb-images${a.poster}?width=300&type=avif&aspect_ratio=null')`),onFocus:i=>r.handleFocus(i,a),onKeydown:u[0]||(u[0]=i=>r.handleDown(i)),onKeyup:u[1]||(u[1]=i=>r.handleUp(i))},null,8,["to","data-card","data-index","style","onFocus"]))),128))])):S("",!0),(n(),b(R,{to:".image-preload-container"},[(n(!0),p(y,null,q((d=r.data)==null?void 0:d.slice(0,7),a=>(n(),p("img",{key:a.id,src:`https://app.nomercy.tv/tmdb-images${a.backdrop}`,width:"0",height:"0",loading:"eager",alt:"",class:"absolute"},null,8,Z))),128))]))],64)}}}),ee={class:"w-available h-auto absolute left-[250px] top-0 overflow-hidden bg-black aspect-video"},te={class:"flex flex-col justify-start items-start w-[484px] relative left-[58px] top-20 gap-7"},ae={class:"flex flex-col justify-start items-start self-stretch relative gap-5"},le={class:"flex flex-col justify-start items-start w-full relative gap-0"},oe={class:"self-stretch w-full text-xl text-left mt-2"},se={class:"line-clamp-4 text-sm -mt-4"},re=F({__name:"TvHeader",props:{selected:{type:Object,required:!1}},setup(r){return(v,u)=>{var m,d,a,h,i;return n(),p("div",{key:(m=r.selected)==null?void 0:m.id,class:"w-full h-full absolute left-0 top-0 bg-[#131314]"},[c("div",ee,[A(Q,{class:"w-available h-available absolute left-[-0.39px] top-[-0.39px] object-cover",path:(d=r.selected)==null?void 0:d.backdrop,size:1080,alt:(a=r.selected)==null?void 0:a.title},null,8,["path","alt"]),u[0]||(u[0]=c("div",{class:"w-available h-available absolute left-[-0.39px] top-[-0.39px]"},null,-1)),u[1]||(u[1]=c("div",{class:"w-[150vw] h-[150vw] absolute left-[-30%] bottom-[-50%]",style:{background:`radial-gradient(
            closest-side,
            rgba(19, 19, 20, 0.1) 0%,
            rgba(19, 19, 20, 1) 70.73974609375%
          )`}},null,-1))]),c("div",te,[c("div",ae,[c("div",le,[c("p",oe,D((h=r.selected)==null?void 0:h.title),1)]),c("div",se,D((i=r.selected)==null?void 0:i.overview),1)])])])}}}),ne={class:"w-screen h-screen relative overflow-hidden bg-[#131314]"},ve=F({__name:"Tv",setup(r){const{data:v,fetchNextPage:u,hasNextPage:m}=J({path:"/",queryKey:["home"]});U(v,()=>{m&&u()});const{data:d}=G({path:"userdata/continue",queryKey:["continue"],refetchInterval:1e3*60*5}),a=x();U(d,e=>{var l;e&&(a.value=(l=e==null?void 0:e.filter(t=>t.id))==null?void 0:l.at(0))}),H(()=>{var e,l;a.value=(l=(e=d.value)==null?void 0:e.filter(t=>t.id))==null?void 0:l.at(0),setTimeout(()=>{var o;const t=document.querySelector(`[data-card="${(o=a.value)==null?void 0:o.id}"]`);t&&t.focus()},1e3)}),M(()=>{var e,l;a.value=(l=(e=d.value)==null?void 0:e.filter(t=>t.id))==null?void 0:l.at(0),setTimeout(()=>{var o;const t=document.querySelector(`[data-card="${(o=a.value)==null?void 0:o.id}"]`);t&&t.focus()},1e3)});const h=x(),i=x(!1),C=x(),B=x();function $(e,l){var o;const t=e.target;if((t==null?void 0:t.nodeName)==="DIV"){(o=B.value??t.querySelector("a"))==null||o.focus();return}l&&(a.value=l,B.value=t)}function j(e){var N,K;if(i.value){e.preventDefault();return}clearTimeout(C.value),i.value=!0;const l=e.target,t=l.getAttribute("data-index"),o=l.closest("[data-row]"),s=o==null?void 0:o.previousElementSibling,k=s==null?void 0:s.querySelector(`a[data-index="${t}"]`),f=o==null?void 0:o.nextElementSibling,_=f==null?void 0:f.querySelector(`a[data-index="${t}"]`),T=l.previousElementSibling,E=l.nextElementSibling;if(k&&e.key==="ArrowUp")e.preventDefault(),k.focus();else if(_&&e.key==="ArrowDown")e.preventDefault(),_.focus();else if(T&&e.key==="ArrowLeft")e.preventDefault(),T.focus();else if(E&&e.key==="ArrowRight")e.preventDefault(),E.focus();else if(s&&e.key==="ArrowUp"){const g=(N=Array.from(s==null?void 0:s.querySelectorAll("a")))==null?void 0:N.at(-1);g&&g.focus()}else if(f&&e.key==="ArrowDown"){const g=(K=Array.from(f==null?void 0:f.querySelectorAll("a")))==null?void 0:K.at(-1);g&&g.focus()}}function I(){C.value=setTimeout(()=>{i.value=!1},150)}return(e,l)=>(n(),b(w(W),null,{default:V(()=>[A(w(O),{fullscreen:!0},{default:V(()=>{var t,o;return[c("div",ne,[a.value?(n(),b(re,{key:0,selected:a.value},null,8,["selected"])):S("",!0),c("div",{ref_key:"scrollContainer",ref:h,tabindex:"0",class:"flex flex-col justify-start items-start w-available -mx-3 px-3 absolute left-14 right-14 top-[264px] h-available overflow-auto scroll-smooth gap-4 flex-1 pb-16",onFocus:l[0]||(l[0]=s=>$(s))},[A(L,{title:"Continue watching",data:((t=w(d))==null?void 0:t.filter(s=>!!s.id))??[],"handle-focus":$,"handle-down":j,"handle-up":I},null,8,["data"]),(o=w(v))!=null&&o.pages?(n(!0),p(y,{key:0},q(w(v).pages,(s,k)=>(n(),p(y,{key:k},[s?(n(!0),p(y,{key:0},q((s==null?void 0:s.data)??[],(f,_)=>(n(),b(L,{key:_,title:f.title,data:f.items,"handle-focus":$,"handle-down":j,"handle-up":I,suffix:"/watch"},null,8,["title","data"]))),128)):S("",!0)],64))),128)):S("",!0)],544)])]}),_:1})]),_:1}))}});export{ve as default};
