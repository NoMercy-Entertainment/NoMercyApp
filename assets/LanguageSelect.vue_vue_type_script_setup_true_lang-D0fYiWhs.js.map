{"version":3,"file":"LanguageSelect.vue_vue_type_script_setup_true_lang-D0fYiWhs.js","sources":["../../src/components/Forms/LanguageSelect.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport {onMounted, PropType, ref, watch} from 'vue';\nimport {useTranslation} from 'i18next-vue';\n\nimport {Listbox, ListboxButton, ListboxLabel, ListboxOption, ListboxOptions} from '@headlessui/vue';\n\nimport {availableTranslations} from '@/config/i18next';\nimport useServerClient from '@/lib/clients/useServerClient';\nimport {Language} from '@/types/api/shared';\nimport MoooomIcon from '@/components/Images/icons/MoooomIcon.vue';\n\nconst {t} = useTranslation();\n\nconst props = defineProps({\n  modelValue: {\n    type: Object as PropType<Language[] | Language>,\n    required: true,\n  },\n  name: {\n    type: String,\n    required: true,\n  },\n  id: {\n    type: String,\n    required: true,\n  },\n  multiple: {\n    type: Boolean,\n    required: false,\n    default: false,\n  },\n  items: {\n    type: Array as PropType<Language[]>,\n    required: false,\n  },\n  variant: {\n    type: String as PropType<'tight' | 'dense' | 'normal'>,\n    required: false,\n    default: 'normal',\n  },\n});\n\nconst emit = defineEmits(['update:modelValue']);\n\nconst selected = ref<Language[] | Language>(props.modelValue);\nconst query = ref('');\nconst filteredOptions = ref<Language[]>([]);\n\nconst {data: languages} = useServerClient<Language[]>({\n  path: '/dashboard/configuration/languages',\n});\n\nconst items = ref<Language[]>(props.items ?? languages.value ?? []);\n\nwatch(languages, (value) => {\n  if (!value) return;\n  items.value = value;\n});\n\nwatch(selected, (value) => {\n  if (!value) return;\n  emit('update:modelValue', value);\n});\n\nwatch(items, (value) => {\n  if (!value) return;\n\n  if (props.multiple) {\n    filteredOptions.value = value;\n  } else {\n    filteredOptions.value = query.value === ''\n        ? value.filter(l => availableTranslations.includes(l.iso_639_1)) ?? []\n        : value.filter(l => availableTranslations.includes(l.iso_639_1))?.filter((language) => {\n      return language.english_name.toLowerCase()\n          .includes(query.value.toLowerCase());\n    }) ?? [];\n  }\n\n});\n\nonMounted(() => {\n  if (!items.value) return;\n\n  if (props.multiple) {\n    filteredOptions.value = items.value;\n  } else {\n    filteredOptions.value = query.value === ''\n        ? items.value.filter(l => availableTranslations.includes(l.iso_639_1)) ?? []\n        : items.value.filter(l => availableTranslations.includes(l.iso_639_1))?.filter((language) => {\n      return language.english_name.toLowerCase()\n          .includes(query.value.toLowerCase());\n    }) ?? [];\n  }\n\n});\n\n</script>\n\n<template>\n\n  <div class=\"relative w-full\">\n    <Listbox as=\"div\" :multiple=\"multiple\"\n             v-model=\"selected\" @change=\"$emit('update:modelValue', $event.target?.value)\">\n      <ListboxLabel\n          class='block select-none text-contrast space-nowrap empty:hidden'\n          :class=\"{\n            'mb-1 text-sm font-medium': variant === 'normal',\n            'mb-0.5 text-sm font-medium': variant === 'dense',\n            'mb-px text-xs font-thin': variant === 'tight',\n          }\"\n      >\n        {{ t(name) }}\n      </ListboxLabel>\n      <div\n          class=\"relative\"\n          :class=\"{\n            'h-10 min-h-10 mt-2': variant === 'normal',\n            'h-8 min-h-8 mt-1': variant === 'dense',\n            'h-7 min-h-7 mt-0': variant === 'tight',\n          }\"\n      >\n        <ListboxButton\n            class=\"relative flex items-center w-full cursor-default rounded-md text-contrast shadow-sm sm:text-sm data-[headlessui-state='disabled']:grayscale *:data-[headlessui-state='disabled']:hidden\"\n            :class=\"{\n              '!bg-auto-1 ring-[1.5px] ring-inset ring-auto-3 focus:outline-none focus:ring-2 focus:ring-focus data-[headlessui-state=\\'open\\']:ring-2 data-[headlessui-state=\\'open\\']:ring-focus': variant === 'normal' || variant === 'dense',\n              'h-10 min-h-10 pl-3': variant === 'normal',\n              'h-8 min-h-8 pl-2': variant === 'dense',\n              'h-5 min-h-5 pl-0': variant === 'tight',\n            }\"\n        >\n\t\t\t\t\t<span class=\"flex items-center self-center\" v-if=\"!Array.isArray(selected)\">\n\t\t\t\t\t\t<img :src=\"`/img/flags/${selected?.iso_639_1?.toUpperCase()}.svg`\"\n                 :onerror=\"(event: any) => {\n                     event.target.onerror = null;\n                     event.target.src = '/img/flags/xxx.svg';\n                 }\"\n                 :alt=\"`${selected?.name != '' && selected?.name != null ? selected?.name : selected?.english_name} flag`\"\n                 class=\"h-auto w-6 rounded-sm border border-auto-50 group-hover:border-theme-600\"/>\n\t\t\t\t\t\t<span class=\"ml-3 block truncate text-left text-contrast\">\n\t\t\t\t\t\t\t{{\n                (selected as Language)?.name != '' && (selected as Language)?.name != null ? (selected as Language)?.name : (selected as Language)?.english_name\n              }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</span>\n          <span v-else class=\"flex items-center self-center\">\n\t\t\t\t\t\t<span v-if=\"selected?.length > 4\" class=\"ml-3 block truncate text-left text-contrast\">\n\t\t\t\t\t\t\t{{ selected?.length }} {{ t('selected') }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span v-else class=\"ml-3 block truncate text-left text-contrast\">\n\t\t\t\t\t\t\t{{\n                selected.map(s => s?.name != '' && s?.name != null ? s?.name : s?.english_name)?.join(', ')\n              }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</span>\n          <span\n              class=\"absolute inset-y-0 right-0 flex h-auto items-center rounded-r-md min-h-auto focus-visible:outline-transparent\"\n              :class=\"{\n                'h-10 min-h-10 px-3': variant === 'normal',\n                'h-8 min-h-8 px-2': variant === 'dense',\n                'hidden': variant === 'tight',\n              }\"\n          >\n\t\t\t\t\t\t\t<MoooomIcon v-if=\"multiple\" icon=\"arrowSelect\"\n                          className=\"w-5 ui-open:rotate-180 transition-transform duration-300\"/>\n\t\t\t\t\t\t\t<MoooomIcon v-else icon=\"chevronDown\"\n                          className=\"w-5 ui-open:rotate-180 transition-transform duration-300\"/>\n\t\t\t\t\t</span>\n        </ListboxButton>\n\n        <transition leave-active-class=\"transition duration-100 ease-in\"\n                    leave-from-class=\"opacity-100\"\n                    leave-to-class=\"opacity-0\">\n          <ListboxOptions\n              class=\"absolute z-10 h-auto max-h-56 min-w-fit overflow-auto rounded-md text-base shadow-lg ring-1 ring-black ring-opacity-5 min-h-auto w-available bg-auto-1 focus:outline-none sm:text-sm\"\n              :class=\"{\n                'py-2 px-3': variant === 'normal',\n                'py-1 px-2': variant === 'dense',\n                'py-0.5 px-1.5': variant === 'tight',\n              }\"\n          >\n            <ListboxOption as=\"template\"\n                           v-for=\"language in filteredOptions\"\n                           :key=\"language.iso_639_1\"\n                           :value=\"language\"\n                           v-slot=\"{ active, selected }\">\n              <li class=\"relative flex w-full min-w-fit cursor-default select-none items-center rounded-sm\"\n                  :class=\"{\n                  '!bg-focus text-auto-12 ': active,\n                  'text-contrast' : !active,\n                  'h-8 min-h-8': variant === 'normal',\n                  'h-6 min-h-6': variant === 'dense',\n\t\t\t\t\t\t\t}\"\n              >\n                <div class=\"ml-2 flex items-center self-center\">\n                  <img :src=\"`/img/flags/${language?.iso_639_1?.toUpperCase()}.svg`\"\n                       :onerror=\"(event: any) => {\n                         event.target.onerror = null;\n                         event.target.src = '/img/flags/xxx.svg';\n                       }\"\n                       :alt=\"`${language.name != '' && language.name != null ? language.name : language.english_name} flag`\"\n                       class=\"h-auto w-6 rounded-sm border border-auto-1 group-hover:border-theme-600\"/>\n                  <span\n                      class=\"mx-3 block truncate text-left\"\n                      :class=\"{\n\t\t\t\t\t\t\t\t\t\t\t\t\t'font-semibold': selected,\n\t\t\t\t\t\t\t\t\t\t\t\t\t'font-normal': !selected,\n\t\t\t\t\t\t\t\t}\"\n                  >\n\t\t\t\t\t\t\t\t{{ language.name != '' && language.name != null ? language.name : language.english_name }}\n\t\t\t\t\t\t\t</span>\n                </div>\n\n                <span v-if=\"selected\"\n                      class=\"absolute right-0 flex items-center justify-center pr-4 data-[headlessui-state='disabled']:hidden\"\n                      :class=\"{\n                        'text-auto-50':active,\n                        'text-focus': !active,\n                      }\"\n                >\n\t\t\t\t\t\t\t<MoooomIcon icon=\"check\" class=\"h-5 w-5\"\n                          aria-hidden=\"true\"/>\n\t\t\t\t\t\t</span>\n              </li>\n            </ListboxOption>\n          </ListboxOptions>\n        </transition>\n      </div>\n    </Listbox>\n  </div>\n</template>\n"],"names":["t","useTranslation","props","__props","emit","__emit","selected","ref","query","filteredOptions","languages","useServerClient","items","watch","value","l","availableTranslations","_a","language","onMounted"],"mappings":"k+BAWM,KAAA,CAAC,EAAAA,CAAC,EAAIC,EAAe,EAErBC,EAAQC,EA6BRC,EAAOC,EAEPC,EAAWC,EAA2BL,EAAM,UAAU,EACtDM,EAAQD,EAAI,EAAE,EACdE,EAAkBF,EAAgB,EAAE,EAEpC,CAAC,KAAMG,CAAS,EAAIC,EAA4B,CACpD,KAAM,oCAAA,CACP,EAEKC,EAAQL,EAAgBL,EAAM,OAASQ,EAAU,OAAS,EAAE,EAE5D,OAAAG,EAAAH,EAAYI,GAAU,CACrBA,IACLF,EAAM,MAAQE,EAAA,CACf,EAEKD,EAAAP,EAAWQ,GAAU,CACpBA,GACLV,EAAK,oBAAqBU,CAAK,CAAA,CAChC,EAEKD,EAAAD,EAAQE,GAAU,OACjBA,IAEDZ,EAAM,SACRO,EAAgB,MAAQK,EAERL,EAAA,MAAQD,EAAM,QAAU,GAClCM,EAAM,OAAOC,GAAKC,EAAsB,SAASD,EAAE,SAAS,CAAC,GAAK,CAAA,IAClEE,EAAAH,EAAM,OAAOC,GAAKC,EAAsB,SAASD,EAAE,SAAS,CAAC,IAA7D,YAAAE,EAAgE,OAAQC,GACrEA,EAAS,aAAa,YAAY,EACpC,SAASV,EAAM,MAAM,aAAa,KACnC,CAAC,EACT,CAED,EAEDW,EAAU,IAAM,OACTP,EAAM,QAEPV,EAAM,SACRO,EAAgB,MAAQG,EAAM,MAE9BH,EAAgB,MAAQD,EAAM,QAAU,GAClCI,EAAM,MAAM,OAAO,GAAKI,EAAsB,SAAS,EAAE,SAAS,CAAC,GAAK,CAAA,IACxEC,EAAAL,EAAM,MAAM,OAAO,GAAKI,EAAsB,SAAS,EAAE,SAAS,CAAC,IAAnE,YAAAC,EAAsE,OAAQC,GAC3EA,EAAS,aAAa,YAAY,EACpC,SAASV,EAAM,MAAM,aAAa,KACnC,CAAC,EACT,CAED"}