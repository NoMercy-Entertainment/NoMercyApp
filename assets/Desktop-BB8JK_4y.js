import{$ as S,B as E,h as q,o as p,j as t,x as h,G as J,F as K,q as U,v as Z,z as m,a as se,c as k,b as O,p as v,A as C,a_ as L,k as T,a$ as ee,aU as P,R as M,d as _,w as F,ae as le,ap as te,a0 as z,bl as ae,ab as oe,av as ie,as as ne}from"./vue-ionic-9j_oSDCB.js";import{u as Q}from"./useServerClient-J7l5I3tr.js";import{_ as A}from"./Button.vue_vue_type_script_setup_true_lang-Cw5NIKe3.js";import{A as de}from"./AppLogo-Bnkv7DZt.js";import{a as j,bf as w,cs as ue,cp as ce,cq as fe,cr as pe,r as W}from"./index-CyQIzsKG.js";import{_ as R}from"./Modal.vue_vue_type_script_setup_true_lang-VaOoPbaO.js";import{_ as D}from"./MoooomIcon.vue_vue_type_script_setup_true_lang-CioUFssk.js";import{_ as X}from"./Button.vue_vue_type_script_setup_true_lang-aQAcunBv.js";import{u as I}from"./primevue-BfjCwqou.js";import{_ as me}from"./FolderBrowser.vue_vue_type_script_setup_true_lang-CLt9XiW3.js";import"./vendor-Dgtccx1h.js";import"./icons-BW5E66pf.js";import"./rxjs-BCp2L9Rn.js";import"./media-C2AqgyMX.js";import"./api-BBofn2cc.js";import"./swiper-D00Cnjmx.js";import"./useInfiniteServerClient-W2k7iyTV.js";import"./OptimizedIcon.vue_vue_type_script_setup_true_lang-CHVfvbJh.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./music-player-CxG_wAnH.js";import"./ScrollContainer.vue_vue_type_script_setup_true_lang-B9pPA2_S.js";const he={class:"-mt-12 px-4"},ve={class:"text-xl font-bold text-contrast"},ye={"aria-hidden":"true",class:"mt-4"},xe={class:"overflow-hidden rounded-full bg-gray-200"},be=S({__name:"Stepper",props:{steps:{type:Array,required:!0},currentStep:{type:String,required:!0}},setup(r){const e=r,a=E(()=>{var o;return e.steps?(o=e.steps)==null?void 0:o.indexOf(e.currentStep):0}),n=E(()=>e.steps?(a.value+1)/e.steps.length*100:0);return(o,s)=>(p(),q("div",he,[t("h4",ve,h(o.$t(r.currentStep)),1),t("div",ye,[t("div",xe,[t("div",{style:J(`width: ${n.value}%`),class:"h-1 rounded-full bg-focus transition-all duration-300"},null,4)]),t("div",{style:J(`grid-template-columns: repeat(${r.steps.length}, minmax(0, 1fr))`),class:"mt-6 hidden text-sm font-medium text-auto-600 sm:grid"},[(p(!0),q(K,null,U(r.steps,l=>(p(),q("div",{key:l,class:"text-center"},h(o.$t(l)),1))),128))],4)])]))}}),ge={class:"mx-auto grid h-screen place-content-center px-4 sm:px-6 lg:px-8"},_e={class:"mx-auto -mt-24 w-screen max-w-6xl"},ke={class:"flex h-full w-full flex-col gap-4 overflow-hidden p-8 pb-0 min-h-[80vh] max-h-[80vh] h-available"},we={class:"mx-auto h-44 w-auto p-2"},$e={class:"overflow-hidden p-4 h-available"},qe={class:"mt-auto flex h-16 w-full justify-end gap-4 rounded-b-lg p-4 bg-slate-light-1/70 dark:bg-slate-dark-1/70"},Se=S({__name:"Frame",props:{steps:{type:Array,required:!0},nextButtonLocked:{type:Boolean,default:!1},currentStep:{type:String,required:!0},setCurrentStep:{type:Function,required:!0},finish:{type:Function,required:!0}},setup(r){const e=r,a=E(()=>e.steps.findIndex(l=>l===e.currentStep)===0),n=E(()=>e.steps.findIndex(l=>l===e.currentStep)===e.steps.length-1);function o(){e.steps.findIndex(l=>l===e.currentStep)<e.steps.length-1&&e.setCurrentStep(e.steps[e.steps.findIndex(l=>l===e.currentStep)+1])}function s(){e.steps.findIndex(l=>l===e.currentStep)>0&&e.setCurrentStep(e.steps[e.steps.findIndex(l=>l===e.currentStep)-1])}return Q({path:"/dashboard/configuration/languages"}),Q({path:"/dashboard/libraries"}),Q({path:"/dashboard/encoderProfiles"}),(l,c)=>(p(),q("div",ge,[t("div",_e,[t("div",{class:Z(["animate-loading","w-full h-full gap-2.5 flex flex-col ml-auto overflow-hidden rounded-xl bg-slate-light-1 dark:bg-slate-dark-1 bg-cover border-2 border-transparent text-start [background:padding-box_var(--bg-color),border-box_var(--border-color)] transition-all duration-300"]),style:{"--bg-color":"linear-gradient(rgb(var(--color-auto-50)), rgb(var(--color-auto-50)))","--border-color":`linear-gradient(var(--angle),
						rgb(var(--color-logo-light) / 0.7) 0%,
						rgb(var(--color-logo-light) / 0.3) 33.33%,
						rgb(var(--color-logo-light) / 0.14) 66.67%,
						rgb(var(--color-logo-light) / 0.1) 100%
					)`}},[t("div",ke,[t("div",we,[m(de,{class:"pb-8"})]),m(be,{"current-step":r.currentStep,steps:r.steps},null,8,["current-step","steps"]),t("div",$e,[se(l.$slots,"default")])]),t("div",qe,[a.value?O("",!0):(p(),k(A,{key:0,id:"yes",class:"ml-auto !w-28",color:"white",type:"button",variant:"text",onClick:s},{default:v(()=>[C(h(l.$t("Back")),1)]),_:1})),n.value?(p(),k(A,{key:1,id:"cancel",disabled:r.nextButtonLocked,class:"!w-28",color:"theme",type:"button",variant:"default",onClick:r.finish},{default:v(()=>[C(h(l.$t("Finish")),1)]),_:1},8,["disabled","onClick"])):(p(),k(A,{key:2,id:"save",disabled:r.nextButtonLocked,class:"!w-28",color:"theme",type:"button",variant:"default",onClick:o},{default:v(()=>[C(h(l.$t("Next")),1)]),_:1},8,["disabled"]))])])])]))}}),Ce={class:"flex flex-col justify-start items-center flex-grow gap-4"},je={class:"flex justify-start items-start flex-grow-0 flex-shrink-0 relative gap-2 rounded-lg"},Be={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-0.5"},Fe={class:"flex justify-start items-start self-stretch flex-grow-0 flex-shrink-0 relative gap-1.5"},Ve={class:"flex-grow w-full text-base font-medium text-center text-[#eeecec]"},Le=S({__name:"TypeButton",props:{type:{type:Object,required:!0},selected:{type:Boolean,default:!1},className:{type:String,required:!1,default:""}},setup(r){const e=r,a=E(()=>{var o;let n="nomercy";switch((o=e.type)==null?void 0:o.value){case"music":n="noteDouble";break;case"tv":n="tv";break;case"image":n="camera";break;case"movie":n="film";break;default:n="nomercy"}return n});return(n,o)=>(p(),q("div",{class:Z(["flex justify-start items-start flex-grow gap-1 px-2 py-4 rounded-xl",{"bg-focus/6 outline outline-2 outline-focus hover:bg-focus/[0.15]":r.selected,"hover:bg-focus/[0.15]":!r.selected}])},[t("div",Ce,[t("div",je,[m(D,{icon:a.value,"class-name":r.className},null,8,["icon","class-name"])]),t("div",Be,[t("div",Fe,[t("p",Ve,h(r.type.name),1)])])])],2))}}),Ne={class:"my-6 text-sm text-auto-10"},De=S({__name:"DeleteFolderModal",props:{open:{type:Boolean,required:!0},close:{type:Function,required:!0},id:{type:String,required:!0},libraryId:{type:String,required:!0},name:{type:String,required:!0},noRedirect:{type:Boolean,default:!1}},setup(r){const e=r,a=L(),n=I();function o(){j().delete(`dashboard/libraries/${e.libraryId}/folders/${e.id}`).then(({data:s})=>{a.invalidateQueries({queryKey:["dashboard","libraries"]}),n.add({severity:s.status==="ok"?"success":"error",summary:w(s.status==="ok"?"Success":"Error"),detail:w(s.message,...s.args??[]),life:5e3}),e.close()}).catch(s=>{n.add({severity:"error",summary:w("Error"),detail:s.message,life:5e3}),e.close()})}return(s,l)=>{const c=T("Button");return p(),k(R,{close:r.close,open:r.open,"max-width":"max-w-xl",params:{folder:r.name},title:"Delete folder {{folder}}"},{actions:v(()=>[m(c,{id:"yes",onclick:o,"end-icon":"trash",color:"red",type:"button",variant:"contained"},{default:v(()=>[C(h(s.$t("Delete")),1)]),_:1}),m(c,{id:"no",onclick:r.close,type:"button",color:"text-auto-alpha-11",variant:"text"},{default:v(()=>[C(h(s.$t("Cancel")),1)]),_:1},8,["onclick"])]),default:v(()=>[t("div",Ne,h(s.$t("Are you sure you want to delete this folder?")),1)]),_:1},8,["close","open","params"])}}}),Ee={class:"flex justify-start items-center self-stretch flex-grow-0 flex-shrink-0 gap-2"},Ie={class:"flex flex-col justify-center items-center flex-grow gap-2"},Me={class:"flex justify-start items-center self-stretch flex-grow-0 flex-shrink-0 h-10 relative overflow-hidden gap-2 pl-3 pr-2.5 py-2.5 rounded-[10px] bg-[#d5feff]/[0.03]"},Ke={class:"flex-grow w-available text-base font-semibold text-left text-[#9ba1a6]"},Qe=S({__name:"FolderItem",props:ee({handleDeleteFolder:{type:Function,required:!0},folder:{type:Object,required:!0}},{modelValue:{type:Object,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(r){var N;const e=r,a=I(),n=L(),o=P(r,"modelValue"),{data:s}=Q({path:"dashboard/encoderProfiles",queryKey:["dashboard","encoderProfiles"]}),l=E(()=>{var b,y,g,i;switch(o.value.type){case"anime":return(b=s.value)==null?void 0:b.filter(u=>u.container==="m3u8").map(u=>M(u));case"movie":return(y=s.value)==null?void 0:y.filter(u=>u.container==="m3u8").map(u=>M(u));case"tv":return(g=s.value)==null?void 0:g.filter(u=>u.container==="m3u8").map(u=>M(u));case"music":return(i=s.value)==null?void 0:i.filter(u=>u.container==="mp3"||u.container==="flac").map(u=>M(u));default:return[]}}),c=_(((N=l.value)==null?void 0:N.filter(b=>{var y,g;return(g=(y=e.folder.folder)==null?void 0:y.encoder_profiles)==null?void 0:g.some(i=>i.id===b.id)}))??[]);F([l,e],([b,y])=>{!b||!y||(c.value=b.filter(g=>{var i;return(i=y.folder.folder)==null?void 0:i.encoder_profiles.some(u=>u.id===g.id)}))},{deep:!0});function d(b){const y=b.map(g=>M(g));c.value=y,f(M(e.folder),y)}function f(b,y){if(!o.value)return;const g=o.value.folder_library.map(i=>i.folder_id===b.folder_id?{...i,folder:{...i.folder,encoder_profiles:y.map(u=>u)}}:i);j().patch(`dashboard/libraries/${o.value.id}`,{folder_library:g}).then(()=>{n.invalidateQueries({queryKey:["dashboard","libraries"]})}).catch(i=>{a.add({severity:"error",summary:w("Error"),detail:i.message,life:5e3})})}F(o,()=>{l.value&&(c.value=l.value.filter(b=>{var y;return(y=e.folder.folder)==null?void 0:y.encoder_profiles.some(g=>g.id===b.id)}))});const x=_(!1);function $(){x.value=!0}function B(){x.value=!1}return(b,y)=>{var i;const g=T("MultiSelect");return p(),q(K,null,[t("div",Ee,[m(g,{id:"encoderProfiles","model-value":c.value,placeholder:"Select",class:"w-[160px]",options:l.value,"option-label":"name","onUpdate:modelValue":d},null,8,["model-value","options"]),t("div",Ie,[t("div",Me,[t("p",Ke,h(r.folder.folder.path),1),t("button",{onClick:$},[m(D,{icon:"trash","class-name":"w-6 h-6 text-[#9ba1a6] flex-grow-0 flex-shrink-0 cursor-pointer"})])])])]),m(De,{id:r.folder.folder.id,"library-id":(i=o.value)==null?void 0:i.id,name:r.folder.folder.path,close:B,open:x.value},null,8,["id","library-id","name","open"])],64)}}}),Ae={class:"mx-auto flex w-full flex-col h-[44vh]"},Oe=S({__name:"NewFolderModal",props:{open:{type:Boolean,required:!0},close:{type:Function,required:!0},folder:{type:String,required:!0},setFolder:{type:Function,required:!0},library:{type:Object,required:!1}},setup(r){const e=r,a=le(),n=L(),o=I();function s(){var l;j().post(`dashboard/libraries/${a.params.id??((l=e.library)==null?void 0:l.id)}/folders`,{path:e.folder}).then(({data:c})=>{n.invalidateQueries({queryKey:["dashboard","libraries"]}),o.add({severity:c.status==="ok"?"success":"error",summary:w(c.status==="ok"?"Success":"Error"),detail:w(c.message,...c.args),life:5e3}),e.setFolder("/"),e.close()}).catch(c=>{console.error("Error adding folder:",c),e.close()})}return(l,c)=>{const d=T("Button");return p(),k(R,{close:r.close,open:r.open,"max-width":"max-w-5xl",title:"Add folder"},{actions:v(()=>[m(d,{id:"yes",onclick:s,color:"theme",type:"button",variant:"contained"},{default:v(()=>[C(h(l.$t("Add")),1)]),_:1}),m(d,{id:"no",onclick:r.close,type:"button",color:"text-auto-alpha-11",variant:"text"},{default:v(()=>[C(h(l.$t("Cancel")),1)]),_:1},8,["onclick"])]),default:v(()=>[t("div",Ae,[m(me,{selected:r.folder,"set-selected":r.setFolder},null,8,["selected","set-selected"])])]),_:1},8,["close","open"])}}}),Te={class:"flex flex-col justify-start items-start flex-grow-0 flex-shrink-0 w-full relative gap-8 p-1 px-6"},Ue={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-3"},Re={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-6"},ze={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-4"},Pe={class:"grid grid-cols-4 justify-start items-start self-stretch gap-2"},Ge={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-2"},Ye={class:"flex justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-2"},He={class:"flex flex-col justify-start items-start flex-grow gap-1.5"},Je={class:"flex justify-start items-center flex-grow-0 flex-shrink-0 relative gap-px"},We={class:"flex-grow-0 flex-shrink-0 text-sm font-medium text-left text-[#eeecec]"},Xe={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-3"},Ze={class:"flex justify-start items-center self-stretch flex-grow-0 flex-shrink-0 relative gap-2 rounded"},et={class:"flex-grow w-[501px] text-lg font-medium text-left text-[#eeecec]"},tt={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-6"},rt={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-2"},st={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-2"},lt={class:"flex justify-start items-center self-stretch flex-grow-0 flex-shrink-0 relative gap-1"},at={class:"flex-grow-0 flex-shrink-0 text-sm text-left text-[#9ba1a6]"},ot={class:"flex w-full justify-end items-start self-stretch flex-grow-0 flex-shrink-0 gap-2 rounded-lg bg-white/[0.04] p-2"},it=S({__name:"EditLibraryModal",props:ee({open:{type:Boolean,required:!0},close:{type:Function,required:!0},id:{type:String,required:!0},noRedirect:{type:Boolean,default:!1}},{modelValue:{type:Object,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(r){var y,g;const e=r,a=P(r,"modelValue"),n=L(),o=I(),s=_((y=a.value)==null?void 0:y.title),l=te(s,500),c=_(((g=a.value)==null?void 0:g.type)??"movie");F(a,i=>{i&&(s.value=i.title,c.value=i.type||"movie",a.value.folder_library||(a.value={...a.value,folder_library:[]}))},{deep:!0});const d=_([]),f=_("/");function x(i){f.value=i}const $=_(!1);function B(){$.value=!0}function N(){$.value=!1}function b(){j().patch(`dashboard/libraries/${a.value.id}`,{...a.value,subtitles:d.value.map(i=>i.iso_639_1),specialSeasonName:a.value.specialSeasonName}).then(()=>{n.invalidateQueries({queryKey:["dashboard","libraries"]}),o.add({severity:"success",summary:w("Success"),detail:"Library updated successfully",life:5e3}),e.close()}).catch(i=>{o.add({severity:"error",summary:w("Error"),detail:i.message,life:5e3}),e.close()})}return F(l,i=>{i&&j().patch(`dashboard/libraries/${a.value.id}`,{title:i}).then(()=>{n.invalidateQueries({queryKey:["dashboard","libraries"]})}).catch(u=>{o.add({severity:"error",summary:w("Error"),detail:u.message,life:5e3})})}),F(c,i=>{i&&j().patch(`dashboard/libraries/${a.value.id}`,{type:i}).then(()=>{n.invalidateQueries({queryKey:["dashboard","libraries"]})}).catch(u=>{o.add({severity:"error",summary:w("Error"),detail:u.message,life:5e3})})}),(i,u)=>{const re=T("InputText");return p(),q(K,null,[m(R,{id:"editLibraryModal",close:r.close,open:r.open,"max-width":"max-w-[565px]",title:"Edit Library"},{actions:v(()=>[t("div",ot,[m(X,{id:"done",type:"button",color:"theme",onClick:b},{default:v(()=>[C(h(i.$t("Done")),1)]),_:1})])]),default:v(()=>{var G,Y;return[t("div",Te,[t("div",Ue,[t("div",Re,[t("div",ze,[t("div",Pe,[(p(!0),q(K,null,U(z(ue),V=>(p(),k(Le,{key:V.value,type:V,selected:c.value===V.value,"class-name":"size-10",onClick:H=>c.value=V.value},null,8,["type","selected","onClick"]))),128))]),t("div",Ge,[t("div",Ye,[t("div",He,[t("div",Je,[t("p",We,h(i.$t("Library Title")),1),u[2]||(u[2]=t("p",{class:"flex-grow-0 flex-shrink-0 text-sm font-medium text-left text-[#6e56cf]"}," * ",-1))]),m(re,{id:"title",modelValue:s.value,"onUpdate:modelValue":u[0]||(u[0]=V=>s.value=V),class:"w-full",required:""},null,8,["modelValue"])])])])])])]),u[3]||(u[3]=t("div",{class:"flex-grow-0 flex-shrink-0 w-10 h-0.5 rounded bg-[#e2f0fd]/[0.08]"},null,-1)),t("div",Xe,[t("div",Ze,[t("p",et,h(i.$t("Select one or more folders")),1)]),t("div",tt,[t("div",rt,[t("div",st,[m(X,{id:"save",type:"button",color:"slate",class:"w-full flex justify-between","end-icon":"folderAdd",onClick:B},{default:v(()=>[C(h(i.$t("Add folder")),1)]),_:1})]),(G=a.value)!=null&&G.folder_library?(p(!0),q(K,{key:0},U((Y=a.value)==null?void 0:Y.folder_library,V=>(p(),k(Qe,{key:V.folder_id,modelValue:a.value,"onUpdate:modelValue":u[1]||(u[1]=H=>a.value=H),folder:V},null,8,["modelValue","folder"]))),128)):O("",!0),t("div",lt,[m(D,{icon:"infoCircle","class-name":"w-4 h-4 text-[#9ba1a6] flex-grow-0 flex-shrink-0"}),t("p",at,h(i.$t("You can always add folder and change encoding profiles later")),1)])])])])])]}),_:1},8,["close","open"]),m(Oe,{close:N,folder:f.value,open:$.value,"set-folder":x,library:a.value},null,8,["folder","open","library"])],64)}}}),nt={class:"my-6 text-sm text-auto-10"},dt=S({__name:"DeleteLibraryModal",props:{open:{type:Boolean,required:!0},close:{type:Function,required:!0},id:{type:String,required:!0},name:{type:String,required:!0},noRedirect:{type:Boolean,default:!1}},setup(r){const e=r,a=L(),n=I();function o(){j().delete(`dashboard/libraries/${e.id}`).then(({data:s})=>{n.add({severity:s.status==="ok"?"success":"error",summary:w(s.status==="ok"?"Success":"Error"),detail:w(s.message,...s.args??[]),life:5e3}),a.invalidateQueries({queryKey:["dashboard","libraries"]})}),e.close()}return(s,l)=>(p(),k(R,{close:r.close,open:r.open,"max-width":"max-w-xl",params:{library:e.name},title:"Delete library {{library}}"},{actions:v(()=>[m(A,{id:"yes",onclick:o,"end-icon":"trash",color:"red",type:"button",variant:"contained"},{default:v(()=>[C(h(s.$t("Delete")),1)]),_:1}),m(A,{id:"no",onclick:r.close,type:"button",color:"text-auto-alpha-11",variant:"text"},{default:v(()=>[C(h(s.$t("Cancel")),1)]),_:1},8,["onclick"])]),default:v(()=>[t("div",nt,h(s.$t("Are you sure you want to delete this library?")),1)]),_:1},8,["close","open","params"]))}}),ut={class:"flex h-min children:cursor-default flex-col items-center rounded-lg w-inherit odd:bg-auto-300/20 even:bg-auto-300/0"},ct={class:"flex items-center gap-2 overflow-x-hidden py-2 pr-2 w-inherit overflow-y-show"},ft={class:"ml-2 h-auto w-8 p-2 handle"},pt={class:"w-full line-clamp-1"},mt=S({__name:"LibraryItem",props:{modelValue:{type:Object,required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(r){const e=P(r,"modelValue"),a=_(!1);function n(){a.value=!0}function o(){a.value=!1}const s=_(!1);function l(){s.value=!0}function c(){s.value=!1}const d=E(()=>{let f;switch(e.value.type){case"music":f="noteDouble";break;case"tv":f="tv";break;case"image":f="camera";break;case"movie":f="film";break;default:f="nomercy"}return f});return(f,x)=>{var $,B,N;return p(),q("div",ut,[t("div",ct,[t("button",ft,[m(D,{icon:"menuDotsVertical",class:"h-6 w-6"})]),m(D,{icon:d.value,class:"h-6 w-6"},null,8,["icon"]),t("span",pt,h(($=e.value)==null?void 0:$.title),1),t("button",{class:"ml-auto flex justify-center items-center h-10 px-2.5 py-2 gap-2 rounded-lg text-sm select-none w-auto font-semibold leading-[100%] transition-all duration-150 button-text hover:outline-[rgba(var(--color-500),.1)] hover:outline-1 hover:outline text-[var(--color-500)]",type:"button",onClick:l},[m(D,{icon:"folderEdit",class:"h-6 w-6"})]),t("button",{class:"ml-auto flex justify-center items-center h-10 px-2.5 py-2 gap-2 rounded-lg text-sm select-none w-auto font-semibold leading-[100%] transition-all duration-150 button-text hover:outline-[rgba(var(--color-500),.1)] hover:outline-1 hover:outline text-[var(--color-500)]",type:"button",onClick:n},[m(D,{icon:"folderRemove",class:"h-6 w-6"})])]),e.value?(p(),k(it,{key:0,id:(B=e.value)==null?void 0:B.id,modelValue:e.value,"onUpdate:modelValue":x[0]||(x[0]=b=>e.value=b),close:c,open:s.value},null,8,["id","modelValue","open"])):O("",!0),e.value?(p(),k(dt,{key:1,id:(N=e.value)==null?void 0:N.id,name:e.value.title,close:o,open:a.value},null,8,["id","name","open"])):O("",!0)])}}}),ht={class:"flex flex-col overflow-hidden text-start h-available"},vt={class:"mb-2 text-xl font-semibold"},yt={class:"mb-4 text-sm"},xt={class:"mt-4 flex w-full justify-start"},bt=S({__name:"Libraries",props:{setNextButtonLocked:{type:Function,required:!0}},setup(r){const e=r,a=L(),{data:n}=Q({path:"dashboard/libraries",queryKey:["dashboard","libraries"]}),o=_(null),s=_(n.value??[]);F(n,d=>{console.log("Libraries updated:",d),d&&(s.value=d,e.setNextButtonLocked((d==null?void 0:d.length)===0))});function l(){j().post("dashboard/libraries").then(()=>{a.invalidateQueries({queryKey:["dashboard","libraries"]})})}function c(){j().patch("dashboard/libraries/sort",{libraries:s.value.map((d,f)=>({id:d.id,order:f}))}).then(()=>{a.invalidateQueries({queryKey:["dashboard","libraries"]})})}return F(s,()=>{c()}),ae(o,s,{animation:150,handle:".handle"}),(d,f)=>(p(),q("div",ht,[t("h2",vt,h(d.$t("Organize your media library")),1),t("p",yt,h(d.$t("Add your media libraries to organize your content.")),1),t("div",{ref_key:"el",ref:o,class:"flex h-auto w-full flex-col overflow-y-auto text-start"},[(p(!0),q(K,null,U(s.value,(x,$)=>(p(),k(mt,{key:x.id,modelValue:s.value[$],"onUpdate:modelValue":B=>s.value[$]=B},null,8,["modelValue","onUpdate:modelValue"]))),128))],512),t("div",xt,[m(A,{id:"yes",color:"theme",type:"button",variant:"contained",onClick:l},{default:v(()=>[C(h(d.$t("Add media library")),1)]),_:1})])]))}}),gt=S({__name:"Finish",props:{setNextButtonLocked:{type:Function,required:!0}},setup(r){return oe(),L(),(e,a)=>null}}),_t={class:"flex flex-col gap-2"},kt=S({__name:"Name",props:{setNextButtonLocked:{type:Function,required:!0}},setup(r){var d;const e=r,a=L(),n=I(),{data:o}=Q({path:"dashboard/server/info",queryKey:["serverinfo"]}),s=_(((d=o.value)==null?void 0:d.server)??""),l=te(s,500);F(o,f=>{f&&(s.value=f.server)});function c(){j().patch("dashboard/server/info",{name:l.value}).then(({data:f})=>{n.add({severity:"success",summary:w("Success"),detail:w(f.message,...f.args??[]),life:5e3}),a.invalidateQueries({queryKey:["servers"]})})}return F(l,(f,x)=>{!f||f===x||x===""||c()}),F(s,f=>{e.setNextButtonLocked(!f)}),(f,x)=>{const $=T("InputText");return p(),q("div",_t,[x[1]||(x[1]=t("label",{for:"serverName"},"Server name",-1)),m($,{id:"serverName",modelValue:s.value,"onUpdate:modelValue":x[0]||(x[0]=B=>s.value=B),class:"w-1/3",name:"Give your server a friendly name to help identify it."},null,8,["modelValue"])])}}}),Rt=S({__name:"Desktop",setup(r){const e=I(),a=_(["Base info","Media libraries","Finish"]),n=_("Base info"),o=_(!1);async function s(){console.log("Finish"),await j().post("/dashboard/libraries/refresh").then(()=>{e.add({severity:"success",summary:w("Success"),detail:"Your media libraries are being scanned in the background.",life:16e3})}).catch(d=>{e.add({severity:"error",summary:"Error refreshing libraries",detail:d.message,life:16e3})}),await j().get("libraries").then(({data:d})=>{ce(d.data),fe.value=!0,pe.value=!0,W.replace("/")}).catch(()=>{W.replace({name:"Server offline"})})}function l(d){n.value=d}function c(d){o.value=d}return(d,f)=>(p(),k(z(ne),null,{default:v(()=>[m(z(ie),{fullscreen:!0},{default:v(()=>[m(Se,{"current-step":n.value,finish:s,"next-button-locked":o.value,"set-current-step":l,steps:a.value},{default:v(()=>[n.value==="Base info"?(p(),k(kt,{key:0,"set-next-button-locked":c})):n.value==="Media libraries"?(p(),k(bt,{key:1,"set-next-button-locked":c})):n.value==="Finish"?(p(),k(gt,{key:2,"set-next-button-locked":c})):O("",!0)]),_:1},8,["current-step","next-button-locked","steps"])]),_:1})]),_:1}))}});export{Rt as default};
