import{$,ab as P,B as D,h as S,o as d,j as r,x as m,G as W,F as I,q as T,v as ee,c as _,z as f,a as le,b as O,p as v,A as C,a_ as L,k as E,a$ as te,aU as G,R as M,d as k,w as V,ae,ap as re,a0 as z,bl as oe,av as ne,as as ie}from"./vue-ionic-9j_oSDCB.js";import{u as K}from"./useServerClient-Cus9vSzs.js";import{_ as Q}from"./Button.vue_vue_type_script_setup_true_lang-Cw5NIKe3.js";import{A as de}from"./AppLogo-Bnkv7DZt.js";import{a as j,bf as U,cs as ue,cp as ce,cq as fe,cr as me,r as X}from"./index-CTarIx2-.js";import{_ as R}from"./Modal.vue_vue_type_script_setup_true_lang-VaOoPbaO.js";import{_ as N}from"./MoooomIcon.vue_vue_type_script_setup_true_lang-CioUFssk.js";import{_ as Z}from"./Button.vue_vue_type_script_setup_true_lang-aQAcunBv.js";import{u as A}from"./primevue-BfjCwqou.js";import{_ as pe}from"./FolderBrowser.vue_vue_type_script_setup_true_lang-BvUvXAlY.js";import"./vendor-Dgtccx1h.js";import"./icons-BW5E66pf.js";import"./rxjs-BCp2L9Rn.js";import"./media-C2AqgyMX.js";import"./api-BBofn2cc.js";import"./swiper-D00Cnjmx.js";import"./useInfiniteServerClient-io0xNIN9.js";import"./OptimizedIcon.vue_vue_type_script_setup_true_lang-CHVfvbJh.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./music-player-CxG_wAnH.js";import"./ScrollContainer.vue_vue_type_script_setup_true_lang-Dz1BQw1o.js";const he={class:"-mt-12 px-4"},ve={class:"text-xl font-bold text-contrast"},ye={"aria-hidden":"true",class:"mt-4"},xe={class:"overflow-hidden rounded-full bg-gray-200"},be=$({__name:"Stepper",props:{steps:{type:Array,required:!0},currentStep:{type:String,required:!0}},setup(t){const e=t;P();const l=D(()=>{var n;return e.steps?(n=e.steps)==null?void 0:n.indexOf(e.currentStep):0}),a=D(()=>e.steps?(l.value+1)/e.steps.length*100:0);return(n,s)=>(d(),S("div",he,[r("h4",ve,m(n.$t(t.currentStep)),1),r("div",ye,[r("div",xe,[r("div",{style:W(`width: ${a.value}%`),class:"h-1 rounded-full bg-theme-600"},null,4)]),r("div",{style:W(`grid-template-columns: repeat(${t.steps.length}, minmax(0, 1fr))`),class:"mt-6 hidden text-sm font-medium text-auto-600 sm:grid"},[(d(!0),S(I,null,T(t.steps,o=>(d(),S("div",{key:o,class:"text-center"},m(n.$t(o)),1))),128))],4)])]))}}),ge={class:"mx-auto grid h-screen place-content-center px-4 sm:px-6 lg:px-8"},_e={class:"mx-auto -mt-24 w-screen max-w-6xl"},ke={class:"flex h-full w-full flex-col gap-4 overflow-hidden p-8 pb-0 min-h-[80vh] max-h-[80vh] h-available"},we={class:"mx-auto h-44 w-auto p-2"},$e={class:"overflow-hidden p-4 h-available"},qe={class:"mt-auto flex h-16 w-full justify-end gap-4 rounded-b-lg p-4 bg-slate-light-1/70 dark:bg-slate-dark-1/70"},Se=$({__name:"Frame",props:{steps:{type:Array,required:!0},nextButtonLocked:{type:Boolean,default:!1},currentStep:{type:String,required:!0},setCurrentStep:{type:Function,required:!0},finish:{type:Function,required:!0}},setup(t){const e=t;P();const l=D(()=>e.steps.findIndex(o=>o===e.currentStep)===0),a=D(()=>e.steps.findIndex(o=>o===e.currentStep)===e.steps.length-1);function n(){e.steps.findIndex(o=>o===e.currentStep)<e.steps.length-1&&e.setCurrentStep(e.steps[e.steps.findIndex(o=>o===e.currentStep)+1])}function s(){e.steps.findIndex(o=>o===e.currentStep)>0&&e.setCurrentStep(e.steps[e.steps.findIndex(o=>o===e.currentStep)-1])}return K({path:"/dashboard/configuration/languages"}),K({path:"/dashboard/libraries"}),K({path:"/dashboard/encoderProfiles"}),(o,u)=>(d(),S("div",ge,[r("div",_e,[r("div",{class:ee(["animate-loading","w-full h-full gap-2.5 flex flex-col ml-auto overflow-hidden rounded-xl bg-slate-light-1 dark:bg-slate-dark-1 bg-cover border-2 border-transparent text-start [background:padding-box_var(--bg-color),border-box_var(--border-color)] transition-all duration-300"]),style:{"--bg-color":"linear-gradient(rgb(var(--color-auto-50)), rgb(var(--color-auto-50)))","--border-color":`linear-gradient(var(--angle),
						rgb(var(--color-logo-light) / 0.7) 0%,
						rgb(var(--color-logo-light) / 0.3) 33.33%,
						rgb(var(--color-logo-light) / 0.14) 66.67%,
						rgb(var(--color-logo-light) / 0.1) 100%
					)`}},[r("div",ke,[r("div",we,[f(de,{class:"pb-8"})]),(d(),_(be,{key:t.currentStep,"current-step":t.currentStep,steps:t.steps},null,8,["current-step","steps"])),r("div",$e,[le(o.$slots,"default")])]),r("div",qe,[l.value?O("",!0):(d(),_(Q,{key:0,id:"yes",class:"ml-auto !w-28",color:"white",type:"button",variant:"text",onClick:s},{default:v(()=>[C(m(o.$t("Back")),1)]),_:1})),a.value?(d(),_(Q,{key:1,id:"cancel",disabled:t.nextButtonLocked,class:"!w-28",color:"theme",type:"button",variant:"default",onClick:t.finish},{default:v(()=>[C(m(o.$t("Finish")),1)]),_:1},8,["disabled","onClick"])):(d(),_(Q,{key:2,id:"save",disabled:t.nextButtonLocked,class:"!w-28",color:"theme",type:"button",variant:"default",onClick:n},{default:v(()=>[C(m(o.$t("Next")),1)]),_:1},8,["disabled"]))])])])]))}}),Ce={class:"flex flex-col justify-start items-center flex-grow gap-4"},je={class:"flex justify-start items-start flex-grow-0 flex-shrink-0 relative gap-2 p-2 rounded-lg"},Fe={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-0.5"},Ve={class:"flex justify-start items-start self-stretch flex-grow-0 flex-shrink-0 relative gap-1.5"},Be={class:"flex-grow w-[109.25px] text-base font-medium text-center text-[#eeecec]"},Le=$({__name:"TypeButton",props:{type:{type:Object,required:!0},selected:{type:Boolean,default:!1},className:{type:String,required:!1,default:""}},setup(t){const e=t,l=D(()=>{var n;let a="nomercy";switch((n=e.type)==null?void 0:n.value){case"music":a="noteDouble";break;case"tv":a="tv";break;case"image":a="camera";break;case"movie":a="film";break;default:a="nomercy"}return a});return(a,n)=>(d(),S("div",{class:ee(["flex justify-start items-start flex-grow gap-1 px-2 py-4 rounded-xl",{"bg-[#1c172b] outline outline-2 outline-[#7c66dc] hover:bg-[#7452fe]/[0.15]":t.selected,"hover:bg-[#7452fe]/[0.15]":!t.selected}])},[r("div",Ce,[r("div",je,[f(N,{icon:l.value,"class-name":t.className},null,8,["icon","class-name"])]),r("div",Fe,[r("div",Ve,[r("p",Be,m(t.type.name),1)])])])],2))}}),Ne={class:"my-6 text-sm text-auto-10"},De=$({__name:"DeleteFolderModal",props:{open:{type:Boolean,required:!0},close:{type:Function,required:!0},id:{type:String,required:!0},libraryId:{type:String,required:!0},name:{type:String,required:!0},noRedirect:{type:Boolean,default:!1}},setup(t){const e=t,l=L(),a=A();function n(){j().delete(`dashboard/libraries/${e.libraryId}/folders/${e.id}`).then(({data:s})=>{l.invalidateQueries({queryKey:["dashboard","libraries"]}),a.add({severity:s.status==="ok"?"success":"error",summary:U(s.message,...s.args??[]),life:2e3}),e.close()}).catch(s=>{a.add({severity:"error",summary:s.message,life:2e3}),e.close()})}return(s,o)=>{const u=E("Button");return d(),_(R,{close:t.close,open:t.open,"max-width":"max-w-xl",params:{folder:t.name},title:"Delete folder {{folder}}"},{actions:v(()=>[f(u,{id:"yes",onclick:n,"end-icon":"trash",color:"red",type:"button",variant:"contained"},{default:v(()=>[C(m(s.$t("Delete")),1)]),_:1}),f(u,{id:"no",onclick:t.close,type:"button",color:"text-auto-alpha-11",variant:"text"},{default:v(()=>[C(m(s.$t("Cancel")),1)]),_:1},8,["onclick"])]),default:v(()=>[r("div",Ne,m(s.$t("Are you sure you want to delete this folder?")),1)]),_:1},8,["close","open","params"])}}}),Me={class:"flex justify-start items-center self-stretch flex-grow-0 flex-shrink-0 gap-2"},Ie={class:"flex flex-col justify-center items-center flex-grow gap-2"},Ke={class:"flex justify-start items-center self-stretch flex-grow-0 flex-shrink-0 h-10 relative overflow-hidden gap-2 pl-3 pr-2.5 py-2.5 rounded-[10px] bg-[#d5feff]/[0.03]"},Qe={class:"flex-grow w-available text-base font-semibold text-left text-[#9ba1a6]"},Ae=$({__name:"FolderItem",props:te({handleDeleteFolder:{type:Function,required:!0},folder:{type:Object,required:!0}},{modelValue:{type:Object,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){var w;const e=t,l=G(t,"modelValue"),{data:a}=K({path:"dashboard/encoderProfiles",queryKey:["dashboard","encoderProfiles"]}),n=D(()=>{var p,y,g,b;switch(l.value.type){case"anime":return(p=a.value)==null?void 0:p.filter(h=>h.container==="m3u8").map(h=>M(h));case"movie":return(y=a.value)==null?void 0:y.filter(h=>h.container==="m3u8").map(h=>M(h));case"tv":return(g=a.value)==null?void 0:g.filter(h=>h.container==="m3u8").map(h=>M(h));case"music":return(b=a.value)==null?void 0:b.filter(h=>h.container==="mp3"||h.container==="flac").map(h=>M(h));default:return[]}}),s=k(((w=n.value)==null?void 0:w.filter(p=>{var y,g;return(g=(y=e.folder.folder)==null?void 0:y.encoder_profiles)==null?void 0:g.some(b=>b.id===p.id)}))??[]);V([n,e],([p,y])=>{!p||!y||(s.value=p.filter(g=>{var b;return(b=y.folder.folder)==null?void 0:b.encoder_profiles.some(h=>h.id===g.id)}))},{deep:!0});function o(p){const y=p.map(g=>M(g));s.value=y,u(M(e.folder),y)}function u(p,y){if(!l.value)return;const g=l.value.folder_library.map(b=>b.folder_id===p.folder_id?{...b,folder:{...b.folder,encoder_profiles:y.map(h=>h)}}:b);j().patch(`dashboard/libraries/${l.value.id}`,{folder_library:g}).then(()=>{query.invalidateQueries({queryKey:["dashboard","libraries"]})}).catch(b=>{toast.add({severity:"error",summary:b.message,life:2e3})})}V(l,()=>{n.value&&(s.value=n.value.filter(p=>{var y;return(y=e.folder.folder)==null?void 0:y.encoder_profiles.some(g=>g.id===p.id)}))});const i=k(!1);function c(){i.value=!0}function F(){i.value=!1}return(p,y)=>{var b;const g=E("MultiSelect");return d(),S(I,null,[r("div",Me,[f(g,{id:"encoderProfiles","model-value":s.value,placeholder:"Select",class:"w-[160px]",options:n.value,"option-label":"name","onUpdate:modelValue":o},null,8,["model-value","options"]),r("div",Ie,[r("div",Ke,[r("p",Qe,m(t.folder.folder.path),1),r("button",{onClick:c},[f(N,{icon:"trash","class-name":"w-6 h-6 text-[#9ba1a6] flex-grow-0 flex-shrink-0 cursor-pointer"})])])])]),f(De,{id:t.folder.folder.id,"library-id":(b=l.value)==null?void 0:b.id,name:t.folder.folder.path,close:F,open:i.value},null,8,["id","library-id","name","open"])],64)}}}),Oe={class:"mx-auto flex w-full flex-col h-[44vh]"},Ee=$({__name:"NewFolderModal",props:{open:{type:Boolean,required:!0},close:{type:Function,required:!0},folder:{type:String,required:!0},setFolder:{type:Function,required:!0},library:{type:Object,required:!1}},setup(t){const e=t,l=ae(),a=L(),n=A();function s(){var o;j().post(`dashboard/libraries/${l.params.id??((o=e.library)==null?void 0:o.id)}/folders`,{path:e.folder}).then(({data:u})=>{a.invalidateQueries({queryKey:["dashboard","libraries"]}),n.add({severity:u.status==="ok"?"success":"error",summary:U(u.message,...u.args),life:2e3}),e.setFolder("/"),e.close()}).catch(u=>{console.error("Error adding folder:",u),e.close()})}return(o,u)=>{const i=E("Button");return d(),_(R,{close:t.close,open:t.open,"max-width":"max-w-5xl",title:"Add folder"},{actions:v(()=>[f(i,{id:"yes",onclick:s,color:"theme",type:"button",variant:"contained"},{default:v(()=>[C(m(o.$t("Add")),1)]),_:1}),f(i,{id:"no",onclick:t.close,type:"button",color:"text-auto-alpha-11",variant:"text"},{default:v(()=>[C(m(o.$t("Cancel")),1)]),_:1},8,["onclick"])]),default:v(()=>[r("div",Oe,[f(pe,{selected:t.folder,"set-selected":t.setFolder},null,8,["selected","set-selected"])])]),_:1},8,["close","open"])}}}),Te={class:"flex flex-col justify-start items-start flex-grow-0 flex-shrink-0 w-full relative gap-8 p-1 px-6"},Ue={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-3"},Re={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-6"},ze={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-4"},Pe={class:"flex justify-start items-start self-stretch flex-grow-0 flex-shrink-0"},Ge={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-2"},Ye={class:"flex justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-2"},He={class:"flex flex-col justify-start items-start flex-grow gap-1.5"},Je={class:"flex justify-start items-center flex-grow-0 flex-shrink-0 relative gap-px"},We={class:"flex-grow-0 flex-shrink-0 text-sm font-medium text-left text-[#eeecec]"},Xe={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-3"},Ze={class:"flex justify-start items-center self-stretch flex-grow-0 flex-shrink-0 relative gap-2 rounded"},et={class:"flex-grow w-[501px] text-lg font-medium text-left text-[#eeecec]"},tt={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-6"},rt={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-2"},st={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-2"},lt={class:"flex justify-start items-center self-stretch flex-grow-0 flex-shrink-0 relative gap-1"},at={class:"flex-grow-0 flex-shrink-0 text-sm text-left text-[#9ba1a6]"},ot={class:"flex w-full justify-end items-start self-stretch flex-grow-0 flex-shrink-0 gap-2 rounded-lg bg-white/[0.04] p-2"},nt=$({__name:"EditLibraryModal",props:te({open:{type:Boolean,required:!0},close:{type:Function,required:!0},id:{type:String,required:!0},noRedirect:{type:Boolean,default:!1}},{modelValue:{type:Object,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){var b,h;const e=t,l=G(t,"modelValue"),a=L(),n=A(),s=k((b=l.value)==null?void 0:b.title),o=re(s,500),u=k(((h=l.value)==null?void 0:h.type)??"movie");V(l,x=>{x&&(s.value=x.title,u.value=x.type||"movie",l.value.folder_library||(l.value={...l.value,folder_library:[]}))},{deep:!0});const i=k([]),c=k("/");function F(x){c.value=x}const w=k(!1);function p(){w.value=!0}function y(){w.value=!1}function g(){j().patch(`dashboard/libraries/${l.value.id}`,{...l.value,subtitles:i.value.map(x=>x.iso_639_1),specialSeasonName:l.value.specialSeasonName}).then(()=>{a.invalidateQueries({queryKey:["dashboard","libraries"]}),n.add({severity:"success",summary:"Library updated successfully",life:2e3}),e.close()}).catch(x=>{n.add({severity:"error",summary:x.message,life:2e3}),e.close()})}return V(o,x=>{x&&j().patch(`dashboard/libraries/${l.value.id}`,{title:x}).then(()=>{a.invalidateQueries({queryKey:["dashboard","libraries"]})}).catch(q=>{n.add({severity:"error",summary:q.message,life:2e3})})}),V(u,x=>{x&&j().patch(`dashboard/libraries/${l.value.id}`,{type:x}).then(()=>{a.invalidateQueries({queryKey:["dashboard","libraries"]})}).catch(q=>{n.add({severity:"error",summary:q.message,life:2e3})})}),(x,q)=>{const se=E("InputText");return d(),S(I,null,[f(R,{id:"editLibraryModal",close:t.close,open:t.open,"max-width":"max-w-[565px]",title:"Edit Library"},{actions:v(()=>[r("div",ot,[f(Z,{id:"done",type:"button",color:"theme",onClick:g},{default:v(()=>[C(m(x.$t("Done")),1)]),_:1})])]),default:v(()=>{var Y,H;return[r("div",Te,[r("div",Ue,[r("div",Re,[r("div",ze,[r("div",Pe,[(d(!0),S(I,null,T(z(ue),B=>(d(),_(Le,{key:B.value,type:B,selected:u.value===B.value,"class-name":"size-10",onClick:J=>u.value=B.value},null,8,["type","selected","onClick"]))),128))]),r("div",Ge,[r("div",Ye,[r("div",He,[r("div",Je,[r("p",We,m(x.$t("Library Title")),1),q[2]||(q[2]=r("p",{class:"flex-grow-0 flex-shrink-0 text-sm font-medium text-left text-[#6e56cf]"}," * ",-1))]),f(se,{id:"title",modelValue:s.value,"onUpdate:modelValue":q[0]||(q[0]=B=>s.value=B),class:"w-full",required:""},null,8,["modelValue"])])])])])])]),q[3]||(q[3]=r("div",{class:"flex-grow-0 flex-shrink-0 w-10 h-0.5 rounded bg-[#e2f0fd]/[0.08]"},null,-1)),r("div",Xe,[r("div",Ze,[r("p",et,m(x.$t("Select one or more folders")),1)]),r("div",tt,[r("div",rt,[r("div",st,[f(Z,{id:"save",type:"button",color:"slate",class:"w-full flex justify-between","end-icon":"folderAdd",onClick:p},{default:v(()=>[C(m(x.$t("Add folder")),1)]),_:1})]),(Y=l.value)!=null&&Y.folder_library?(d(!0),S(I,{key:0},T((H=l.value)==null?void 0:H.folder_library,B=>(d(),_(Ae,{key:B.folder_id,modelValue:l.value,"onUpdate:modelValue":q[1]||(q[1]=J=>l.value=J),folder:B},null,8,["modelValue","folder"]))),128)):O("",!0),r("div",lt,[f(N,{icon:"infoCircle","class-name":"w-4 h-4 text-[#9ba1a6] flex-grow-0 flex-shrink-0"}),r("p",at,m(x.$t("You can always add folder and change encoding profiles later")),1)])])])])])]}),_:1},8,["close","open"]),f(Ee,{close:y,folder:c.value,open:w.value,"set-folder":F,library:l.value},null,8,["folder","open","library"])],64)}}}),it={class:"my-6 text-sm text-auto-10"},dt=$({__name:"DeleteLibraryModal",props:{open:{type:Boolean,required:!0},close:{type:Function,required:!0},id:{type:String,required:!0},name:{type:String,required:!0},noRedirect:{type:Boolean,default:!1}},setup(t){const e=t,l=L(),a=A();function n(){j().delete(`dashboard/libraries/${e.id}`).then(({data:s})=>{a.add({severity:s.status==="ok"?"success":"error",summary:U(s.message,...s.args??[]),life:2e3}),l.invalidateQueries({queryKey:["dashboard","libraries"]})}),e.close()}return(s,o)=>(d(),_(R,{close:t.close,open:t.open,"max-width":"max-w-xl",params:{library:e.name},title:"Delete library {{library}}"},{actions:v(()=>[f(Q,{id:"yes",onclick:n,"end-icon":"trash",color:"red",type:"button",variant:"contained"},{default:v(()=>[C(m(s.$t("Delete")),1)]),_:1}),f(Q,{id:"no",onclick:t.close,type:"button",color:"text-auto-alpha-11",variant:"text"},{default:v(()=>[C(m(s.$t("Cancel")),1)]),_:1},8,["onclick"])]),default:v(()=>[r("div",it,m(s.$t("Are you sure you want to delete this library?")),1)]),_:1},8,["close","open","params"]))}}),ut={class:"flex h-min children:cursor-default flex-col items-center rounded-lg w-inherit odd:bg-auto-300/20 even:bg-auto-300/0"},ct={class:"flex items-center gap-2 overflow-x-hidden py-2 pr-2 w-inherit overflow-y-show"},ft={class:"ml-2 h-auto w-8 p-2 handle"},mt={class:"w-full line-clamp-1"},pt=$({__name:"LibraryItem",props:{modelValue:{type:Object,required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(t){const e=G(t,"modelValue"),l=k(!1);function a(){l.value=!0}function n(){l.value=!1}const s=k(!1);function o(){s.value=!0}function u(){s.value=!1}const i=D(()=>{let c;switch(e.value.type){case"music":c="noteDouble";break;case"tv":c="tv";break;case"image":c="camera";break;case"movie":c="film";break;default:c="nomercy"}return c});return(c,F)=>{var w,p,y;return d(),S("div",ut,[r("div",ct,[r("button",ft,[f(N,{icon:"menuDotsVertical",class:"h-6 w-6"})]),f(N,{icon:i.value,class:"h-6 w-6"},null,8,["icon"]),r("span",mt,m((w=e.value)==null?void 0:w.title),1),r("button",{class:"ml-auto flex justify-center items-center h-10 px-2.5 py-2 gap-2 rounded-lg text-sm select-none w-auto font-semibold leading-[100%] transition-all duration-150 button-text hover:outline-[rgba(var(--color-500),.1)] hover:outline-1 hover:outline text-[var(--color-500)]",type:"button",onClick:o},[f(N,{icon:"folderEdit",class:"h-6 w-6"})]),r("button",{class:"ml-auto flex justify-center items-center h-10 px-2.5 py-2 gap-2 rounded-lg text-sm select-none w-auto font-semibold leading-[100%] transition-all duration-150 button-text hover:outline-[rgba(var(--color-500),.1)] hover:outline-1 hover:outline text-[var(--color-500)]",type:"button",onClick:a},[f(N,{icon:"folderRemove",class:"h-6 w-6"})])]),e.value?(d(),_(nt,{key:0,id:(p=e.value)==null?void 0:p.id,modelValue:e.value,"onUpdate:modelValue":F[0]||(F[0]=g=>e.value=g),close:u,open:s.value},null,8,["id","modelValue","open"])):O("",!0),e.value?(d(),_(dt,{key:1,id:(y=e.value)==null?void 0:y.id,name:e.value.title,close:n,open:l.value},null,8,["id","name","open"])):O("",!0)])}}}),ht={class:"flex flex-col overflow-hidden text-start h-available"},vt={class:"mb-2 text-xl font-semibold"},yt={class:"mb-4 text-sm"},xt={class:"mt-4 flex w-full justify-start"},bt=$({__name:"Libraries",props:{setNextButtonLocked:{type:Function,required:!0}},setup(t){const e=t,l=L(),{data:a}=K({path:"dashboard/libraries",queryKey:["dashboard","libraries"]}),n=k(null),s=k(a.value??[]);V(a,i=>{console.log("Libraries updated:",i),i&&(s.value=i,e.setNextButtonLocked((i==null?void 0:i.length)===0))});function o(){j().post("dashboard/libraries").then(()=>{l.invalidateQueries({queryKey:["dashboard","libraries"]})})}function u(){j().patch("dashboard/libraries/sort",{libraries:s.value.map((i,c)=>({id:i.id,order:c}))}).then(()=>{l.invalidateQueries({queryKey:["dashboard","libraries"]})})}return V(s,()=>{u()}),oe(n,s,{animation:150,handle:".handle"}),(i,c)=>(d(),S("div",ht,[r("h2",vt,m(i.$t("Organize your media library")),1),r("p",yt,m(i.$t("Add your media libraries to organize your content.")),1),r("div",{ref_key:"el",ref:n,class:"flex h-auto w-full flex-col overflow-y-auto text-start"},[(d(!0),S(I,null,T(s.value,(F,w)=>(d(),_(pt,{key:F.id,modelValue:s.value[w],"onUpdate:modelValue":p=>s.value[w]=p},null,8,["modelValue","onUpdate:modelValue"]))),128))],512),r("div",xt,[f(Q,{id:"yes",color:"theme",type:"button",variant:"contained",onClick:o},{default:v(()=>[C(m(i.$t("Add media library")),1)]),_:1})])]))}}),gt=$({__name:"Finish",props:{setNextButtonLocked:{type:Function,required:!0}},setup(t){return P(),L(),(e,l)=>null}}),_t=$({__name:"Name",props:{setNextButtonLocked:{type:Function,required:!0}},setup(t){var i;const e=t,l=L(),a=A(),{data:n}=K({path:"dashboard/server/info",queryKey:["serverinfo"]}),s=k(((i=n.value)==null?void 0:i.server)??""),o=re(s,500);V(n,c=>{c&&(s.value=c.server)});function u(){j().patch("dashboard/server/info",{name:o.value}).then(({data:c})=>{a.add({severity:"success",summary:U(c.message,...c.args??[]),life:2e3}),l.invalidateQueries({queryKey:["servers"]})})}return V(o,c=>{c&&u()}),V(s,c=>{e.setNextButtonLocked(!c)}),(c,F)=>{const w=E("Textarea");return d(),_(w,{id:"serverName",modelValue:s.value,"onUpdate:modelValue":F[0]||(F[0]=p=>s.value=p),name:"Give your server a friendly name to help identify it."},null,8,["modelValue"])}}}),Ut=$({__name:"Desktop",setup(t){const e=A();L();const l=k(["Name","Media libraries","Finish"]),a=k("Name"),n=k(!1);async function s(){console.log("Finish"),await j().post("/dashboard/libraries/refresh").then(()=>{e.add({severity:"success",summary:"Scanning libraries",detail:"Your media libraries are being scanned in the background.",life:16e3})}).catch(i=>{e.add({severity:"error",summary:"Error refreshing libraries",detail:i.message,life:16e3})}),await j().get("libraries").then(({data:i})=>{ce(i.data),fe.value=!0,me.value=!0,X.replace("/")}).catch(()=>{X.replace({name:"Server offline"})})}function o(i){a.value=i}function u(i){n.value=i}return(i,c)=>(d(),_(z(ie),null,{default:v(()=>[f(z(ne),{fullscreen:!0},{default:v(()=>[f(Se,{"current-step":a.value,finish:s,"next-button-locked":n.value,"set-current-step":o,steps:l.value},{default:v(()=>[a.value==="Name"?(d(),_(_t,{key:0,"set-next-button-locked":u})):a.value==="Media libraries"?(d(),_(bt,{key:1,"set-next-button-locked":u})):a.value==="Finish"?(d(),_(gt,{key:2,"set-next-button-locked":u})):O("",!0)]),_:1},8,["current-step","next-button-locked","steps"])]),_:1})]),_:1}))}});export{Ut as default};
