import{d}from"./api-BBofn2cc.js";import{$ as V,a7 as S,d as l,f as $,w as A,c as g,o as r,l as x,y as B,a0 as o,au as M,h as p,i as e,v as s,b as y,b8 as j,ar as q}from"./vue-ionic-DerxjBh9.js";import{bt as F,bu as k,H as I,v as i,bv as L,r as Q,x as R}from"./index-Dq_Cm6ym.js";import"./vendor-C28OoIfY.js";import"./media-C2AqgyMX.js";import"./icons-BW5E66pf.js";import"./swiper-D00Cnjmx.js";import"./music-player-B5BcR-ht.js";import"./rxjs-BCp2L9Rn.js";const z={key:0,class:"flex h-screen w-screen flex-nowrap items-center justify-between gap-4 overflow-hidden p-24 text-slate-light-12 dark:text-slate-dark-12 bg-slate-light-3 dark:bg-slate-dark-1"},D={class:"flex w-2/3 flex-col gap-4 font-semibold"},E={class:"text-3xl"},H={class:"flex items-start gap-4"},K={class:"whitespace-nowrap rounded-md px-3 leading-8 text-white bg-theme-600"},P={class:"flex flex-col gap-2 text-lg"},U={class:"text-2xl font-semibold whitespace-break-spaces"},Y={class:"flex items-start gap-4"},G={class:"whitespace-nowrap rounded-md px-3 leading-8 text-white bg-theme-600"},J={class:"flex flex-col gap-2 text-lg"},O={class:"grid w-1/3 place-items-center gap-4 p-4 font-semibold"},W=["src"],X={key:1,class:"grid h-screen w-screen place-items-center"},Z={role:"status"},de=V({__name:"Tv",setup(ee){const{t:n}=S(),b=l(`https://${i?`${i.replace("-","")}.`:""}nomercy.tv/tv`),u=l(""),T=l(!1),h=l(!1),C=l("L"),N=l("canvas"),a=l();$(async()=>{try{await F(),k();const{isAuthenticated:t}=I();t.value=!0}catch{d.post(`https://auth${i}.nomercy.tv/realms/NoMercyTV/protocol/openid-connect/auth/device`,{client_id:"nomercy-ui",scope:"openid profile email",cancelToken:new d.CancelToken(c=>c("Cancel repeated request"))},{headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}}).then(c=>{a.value=c.data,h.value=!0}).catch(c=>{console.log(c)})}}),A(a,t=>{t&&(console.log(t),setTimeout(()=>{v()},t.interval*1e3))});function v(){var t;d.post(`https://auth${i}.nomercy.tv/realms/NoMercyTV/protocol/openid-connect/token`,{grant_type:"urn:ietf:params:oauth:grant-type:device_code",client_id:"nomercy-ui",scope:"openid",device_code:(t=a.value)==null?void 0:t.device_code},{headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}}).then(async c=>{L(c.data),k(),await Q.push(R.value)}).catch(()=>{setTimeout(()=>{v()},a.value.interval*1e3)})}return(t,c)=>(r(),g(o(q),null,{default:x(()=>[B(o(M),{fullscreen:!0},{default:x(()=>{var _,m,f,w;return[h.value&&((_=a.value)!=null&&_.user_code)&&!T.value?(r(),p("div",z,[e("div",D,[e("h1",E,s(o(n)("Follow these steps on your computer or mobile device")),1),e("div",H,[e("span",K,s(o(n)("Step"))+" 1",1),e("div",P,[e("p",null,s(o(n)("Scan the QR with your phone or go to"))+":",1),e("p",U,s(b.value)+"?code="+s((m=a.value)==null?void 0:m.user_code),1)])]),e("div",Y,[e("span",G,s(o(n)("Step"))+" 2",1),e("div",J,[e("p",null,s(o(n)("Sign in to NoMercy"))+".",1),e("p",null,s(o(n)("Your tv will be ready to watch"))+".",1)])])]),e("div",O,[(f=a.value)!=null&&f.verification_uri_complete?(r(),g(j,{key:0,level:C.value,"render-as":N.value,size:250,value:(w=a.value)==null?void 0:w.verification_uri_complete,class:"bg-white p-1"},null,8,["level","render-as","value"])):y("",!0),u.value?(r(),p("img",{key:1,src:u.value,alt:"",class:"bg-white p-1"},null,8,W)):y("",!0)])])):(r(),p("div",X,[e("div",Z,[e("span",null,s(o(n)("Loading"))+"...",1)])]))]}),_:1})]),_:1}))}});export{de as default};
