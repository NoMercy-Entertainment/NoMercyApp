import"./useBaseQuery-B_FYPFZb.js";import"./useInfiniteServerClient-CWcViavg.js";import"./useQueryClient-DgPzfFPv.js";import"./useQuery-Pvalhcdd.js";import{As as c,Ds as P,Fo as l,Jo as _,Os as k,Ta as C,Tr as b,U as w,Us as p,Vs as h,Ys as S,_a as M,hs as U,i as o,nc as d,os as T,ps as x,ri as s,rs as D,ss as v,za as I}from"./index-vyVLvOi8.js";import{s as i}from"./imageModal-D03y4Dpf.js";import{t as N}from"./useServerClient-43vBeAdz.js";import{i as A,n as B,o as F,r as H,s as V}from"./VideoPlayer-BUVst9L5.js";import"./buttons-CaJv4k3N.js";import{t as z}from"./keyHandlerPlugin-W7L2EOo0.js";import{t as J}from"./videoNoMercyConnectPlugin-fg6XxUND.js";_();I();var O=U({__name:"Desktop",setup(Y){const{data:r}=N({enabled:!s.value.features?.nomercyConnect}),e=S();function u(t){const n={controls:!1,playlist:t?.filter(a=>!!a.id)??[],accessToken:s.value?.accessToken,basePath:b.value?.serverBaseUrl,forceTvMode:(l("android")||l("ios"))&&!l("mobile"),disableTouchControls:!1,disableMediaControls:"mediaSession"in navigator||l("capacitor"),renderAhead:100,disableAutoPlayback:s.value.features?.nomercyConnect};if(e.value?.dispose(),e.value=H("player1").setup(n),e.value.once("back",()=>{history.state.back?o.back():o.replace("/")}),s.value.features?.nomercyConnect){const a=new J;e.value.registerPlugin("videoNoMercyConnect",a),e.value.usePlugin("videoNoMercyConnect")}const f=new A;e.value.registerPlugin("desktopUI",f),e.value.usePlugin("desktopUI");const g=new F;e.value.registerPlugin("autoSkip",g),e.value.usePlugin("autoSkip");const y=new z;if(e.value.registerPlugin("keyHandler",y),e.value.usePlugin("keyHandler"),!s.value.features?.nomercyConnect){const a=new V;e.value.registerPlugin("sync",a),e.value.usePlugin("sync")}const m=new B;e.value.registerPlugin("octopus",m),e.value.usePlugin("octopus"),e.value.once("play",()=>{e.value.enterFullscreen()}),e.value.on("playlistComplete",()=>{console.log("Playlist complete"),history.state.back?o.back():o.replace("/")}),e.value.on("play",()=>{i(!0)}),e.value.on("pause",()=>{i(!1)}),e.value.on("fullscreen",a=>{window.external?.sendMessage?.(a?"enterFullscreen":"exitFullscreen")})}return h(r,t=>{t?.length&&u(t)}),P(()=>{w.stop(),s.value.features?.nomercyConnect?u():r.value?.length&&u(r.value)}),k(()=>{e.value?.dispose(),i(!1)}),(t,n)=>(c(),v(d(C),null,{default:p(()=>[x(d(M),{fullscreen:!0},{default:p(()=>[(c(),v(D,{to:"body"},[n[0]||(n[0]=T("div",{id:"player1",class:"group nomercyplayer text-white"},null,-1))]))]),_:1})]),_:1}))}}),$=O;export{$ as default};
