import{_ as A,a as C,c as G,d as B,f as J,g as Z,h as X,i as p,l as Y,m as ee,n as g,o as te,p as U,r as ae,s as le,t as ne,u as re}from"./use-text-value-D7cp-qtb.js";import{$a as se,Bl as ue,C as b,Cl as oe,Dl as P,Fl as x,Gl as L,Hl as T,Ml as ie,S as ce,Ul as de,Wl as ve,b as fe,bl as q,es as $,eu as V,fa as j,g as N,gn as H,gu as E,hl as pe,hu as M,k as K,kl as R,ll as F,nu as me,ql as be,su as S,tu as k,ul as ge,v as z,xl as O,yl as w,yu as Ie,zl as ye}from"./index-DhiB0zJh.js";F();function he({container:a,accept:v,walk:m,enabled:r}){V(()=>{let f=a.value;if(!f||r!==void 0&&!r.value)return;let d=fe(a);if(!d)return;let e=Object.assign(u=>v(u),{acceptNode:v}),s=d.createTreeWalker(f,NodeFilter.SHOW_ELEMENT,e,!1);for(;s.nextNode();)m(s.currentNode)})}F();var Me=(a=>(a[a.Open=0]="Open",a[a.Closed=1]="Closed",a))(Me||{}),Se=(a=>(a[a.Pointer=0]="Pointer",a[a.Other=1]="Other",a))(Se||{});function we(a){requestAnimationFrame(()=>requestAnimationFrame(a))}var W=Symbol("MenuContext");function _(a){let v=ie(W,null);if(v===null){let m=new Error(`<${a} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(m,_),m}return v}var xe=R({name:"Menu",props:{as:{type:[Object,String],default:"template"}},setup(a,{slots:v,attrs:m}){let r=S(1),f=S(null),d=S(null),e=S([]),s=S(""),u=S(null),I=S(1);function h(t=l=>l){let l=u.value!==null?e.value[u.value]:null,n=J(t(e.value.slice()),y=>b(y.dataRef.domRef)),i=l?n.indexOf(l):null;return i===-1&&(i=null),{items:n,activeItemIndex:i}}let o={menuState:r,buttonRef:f,itemsRef:d,items:e,searchQuery:s,activeItemIndex:u,activationTrigger:I,closeMenu:()=>{r.value=1,u.value=null},openMenu:()=>r.value=0,goToItem(t,l,n){let i=h(),y=ae(t===g.Specific?{focus:g.Specific,id:l}:{focus:t},{resolveItems:()=>i.items,resolveActiveIndex:()=>i.activeItemIndex,resolveId:c=>c.id,resolveDisabled:c=>c.dataRef.disabled});s.value="",u.value=y,I.value=n??1,e.value=i.items},search(t){let l=s.value!==""?0:1;s.value+=t.toLowerCase();let n=(u.value!==null?e.value.slice(u.value+l).concat(e.value.slice(0,u.value+l)):e.value).find(y=>y.dataRef.textValue.startsWith(s.value)&&!y.dataRef.disabled),i=n?e.value.indexOf(n):-1;i===-1||i===u.value||(u.value=i,I.value=1)},clearSearch(){s.value=""},registerItem(t,l){let n=h(i=>[...i,{id:t,dataRef:l}]);e.value=n.items,u.value=n.activeItemIndex,I.value=1},unregisterItem(t){let l=h(n=>{let i=n.findIndex(y=>y.id===t);return i!==-1&&n.splice(i,1),n});e.value=l.items,u.value=l.activeItemIndex,I.value=1}};return re([f,d],(t,l)=>{var n;o.closeMenu(),Z(l,ee.Loose)||(t.preventDefault(),(n=b(f))==null||n.focus())},w(()=>r.value===0)),de(W,o),le(w(()=>ce(r.value,{0:C.Open,1:C.Closed}))),()=>N({ourProps:{},theirProps:a,slot:{open:r.value===0,close:o.closeMenu},slots:v,attrs:m,name:"Menu"})}}),ke=R({name:"MenuButton",props:{disabled:{type:Boolean,default:!1},as:{type:[Object,String],default:"button"},id:{type:String,default:null}},setup(a,{attrs:v,slots:m,expose:r}){var f;let d=(f=a.id)!=null?f:`headlessui-menu-button-${A()}`,e=_("MenuButton");r({el:e.buttonRef,$el:e.buttonRef});function s(o){switch(o.key){case p.Space:case p.Enter:case p.ArrowDown:o.preventDefault(),o.stopPropagation(),e.openMenu(),x(()=>{var t;(t=b(e.itemsRef))==null||t.focus({preventScroll:!0}),e.goToItem(g.First)});break;case p.ArrowUp:o.preventDefault(),o.stopPropagation(),e.openMenu(),x(()=>{var t;(t=b(e.itemsRef))==null||t.focus({preventScroll:!0}),e.goToItem(g.Last)});break}}function u(o){switch(o.key){case p.Space:o.preventDefault();break}}function I(o){a.disabled||(e.menuState.value===0?(e.closeMenu(),x(()=>{var t;return(t=b(e.buttonRef))==null?void 0:t.focus({preventScroll:!0})})):(o.preventDefault(),e.openMenu(),we(()=>{var t;return(t=b(e.itemsRef))==null?void 0:t.focus({preventScroll:!0})})))}let h=Y(w(()=>({as:a.as,type:v.type})),e.buttonRef);return()=>{var o;let t={open:e.menuState.value===0},{...l}=a;return N({ourProps:{ref:e.buttonRef,id:d,type:h.value,"aria-haspopup":"menu","aria-controls":(o=b(e.itemsRef))==null?void 0:o.id,"aria-expanded":e.menuState.value===0,onKeydown:s,onKeyup:u,onClick:I},theirProps:l,slot:t,attrs:v,slots:m,name:"MenuButton"})}}}),Re=R({name:"MenuItems",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:null}},setup(a,{attrs:v,slots:m,expose:r}){var f;let d=(f=a.id)!=null?f:`headlessui-menu-items-${A()}`,e=_("MenuItems"),s=S(null);r({el:e.itemsRef,$el:e.itemsRef}),he({container:w(()=>b(e.itemsRef)),enabled:w(()=>e.menuState.value===0),accept(t){return t.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:t.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(t){t.setAttribute("role","none")}});function u(t){var l;switch(s.value&&clearTimeout(s.value),t.key){case p.Space:if(e.searchQuery.value!=="")return t.preventDefault(),t.stopPropagation(),e.search(t.key);case p.Enter:if(t.preventDefault(),t.stopPropagation(),e.activeItemIndex.value!==null){let n=e.items.value[e.activeItemIndex.value];(l=b(n.dataRef.domRef))==null||l.click()}e.closeMenu(),U(b(e.buttonRef));break;case p.ArrowDown:return t.preventDefault(),t.stopPropagation(),e.goToItem(g.Next);case p.ArrowUp:return t.preventDefault(),t.stopPropagation(),e.goToItem(g.Previous);case p.Home:case p.PageUp:return t.preventDefault(),t.stopPropagation(),e.goToItem(g.First);case p.End:case p.PageDown:return t.preventDefault(),t.stopPropagation(),e.goToItem(g.Last);case p.Escape:t.preventDefault(),t.stopPropagation(),e.closeMenu(),x(()=>{var n;return(n=b(e.buttonRef))==null?void 0:n.focus({preventScroll:!0})});break;case p.Tab:t.preventDefault(),t.stopPropagation(),e.closeMenu(),x(()=>X(b(e.buttonRef),t.shiftKey?B.Previous:B.Next));break;default:t.key.length===1&&(e.search(t.key),s.value=setTimeout(()=>e.clearSearch(),350));break}}function I(t){switch(t.key){case p.Space:t.preventDefault();break}}let h=te(),o=w(()=>h!==null?(h.value&C.Open)===C.Open:e.menuState.value===0);return()=>{var t,l;let n={open:e.menuState.value===0},{...i}=a;return N({ourProps:{"aria-activedescendant":e.activeItemIndex.value===null||(t=e.items.value[e.activeItemIndex.value])==null?void 0:t.id,"aria-labelledby":(l=b(e.buttonRef))==null?void 0:l.id,id:d,onKeydown:u,onKeyup:I,role:"menu",tabIndex:0,ref:e.itemsRef},theirProps:i,slot:n,attrs:v,slots:m,features:z.RenderStrategy|z.Static,visible:o.value,name:"MenuItems"})}}}),De=R({name:"MenuItem",inheritAttrs:!1,props:{as:{type:[Object,String],default:"template"},disabled:{type:Boolean,default:!1},id:{type:String,default:null}},setup(a,{slots:v,attrs:m,expose:r}){var f;let d=(f=a.id)!=null?f:`headlessui-menu-item-${A()}`,e=_("MenuItem"),s=S(null);r({el:s,$el:s});let u=w(()=>e.activeItemIndex.value!==null?e.items.value[e.activeItemIndex.value].id===d:!1),I=ne(s),h=w(()=>({disabled:a.disabled,get textValue(){return I()},domRef:s}));ye(()=>e.registerItem(d,h)),ue(()=>e.unregisterItem(d)),V(()=>{e.menuState.value===0&&u.value&&e.activationTrigger.value!==0&&x(()=>{var c,D;return(D=(c=b(s))==null?void 0:c.scrollIntoView)==null?void 0:D.call(c,{block:"nearest"})})});function o(c){if(a.disabled)return c.preventDefault();e.closeMenu(),U(b(e.buttonRef))}function t(){if(a.disabled)return e.goToItem(g.Nothing);e.goToItem(g.Specific,d)}let l=G();function n(c){l.update(c)}function i(c){l.wasMoved(c)&&(a.disabled||u.value||e.goToItem(g.Specific,d,0))}function y(c){l.wasMoved(c)&&(a.disabled||u.value&&e.goToItem(g.Nothing))}return()=>{let{disabled:c,...D}=a,Q={active:u.value,disabled:c,close:e.closeMenu};return N({ourProps:{id:d,ref:s,role:"menuitem",tabIndex:c===!0?void 0:-1,"aria-disabled":c===!0?!0:void 0,onClick:o,onFocus:t,onPointerenter:n,onMouseenter:n,onPointermove:i,onMousemove:i,onPointerleave:y,onMouseleave:y},theirProps:{...m,...D},slot:Q,attrs:m,slots:v,name:"MenuItem"})}}});F();var Pe={class:"relative flex flex-1 items-center justify-start gap-2 text-base font-semibold"},Te={class:"flex flex-1 w-full whitespace-nowrap"},Ce=R({__name:"ListControlHeaderMoreMenu",props:{items:{type:Array,required:!0},className:{type:String,required:!1,default:""},title:{type:String,required:!1,default:"More options"},showDelay:{type:Number,required:!1,default:750},hideDelay:{type:Number,required:!1,default:300},noTip:{type:Boolean,required:!1,default:!1}},setup(a){const v=a,m=w(()=>v.items.filter(r=>!r.privileged||r.privileged&&($.value?.is_owner||$.value?.is_manager)));return(r,f)=>{const d=be("tooltip");return T(),O(M(xe),{as:"div",class:"relative select-none z-[150]"},{default:k(()=>[me((T(),O(M(se),{"aria-label":r.$t(a.title),as:M(ke),class:E([{[M(H)(M(j),"flex flex-nowrap w-fit min-w-fit")]:!0},"data-[headlessui-state='open']:bg-surface-12/6 sm:data-[headlessui-state='open']:bg-surface-12/6"]),unstyled:!0},{default:k(()=>[L(r.$slots,"button",{},()=>[P(K,{icon:"menuDotsHorizontal"})])]),_:3},8,["aria-label","as","class"])),[[d,{showDelay:a.showDelay,hideDelay:a.hideDelay,value:a.noTip?null:r.$t(a.title)},void 0,{top:!0}]]),P(ge,{"enter-active-class":"transition duration-100 ease-out","enter-from-class":"scale-95 transform opacity-0","enter-to-class":"scale-100 transform opacity-100","leave-active-class":"transition duration-75 ease-in","leave-from-class":"scale-100 transform opacity-100","leave-to-class":"scale-95 transform opacity-0"},{default:k(()=>[P(M(Re),{class:E(M(H)(a.className,"absolute z-10 m-2 ml-8 flex origin-top-right -translate-x-full flex-col gap-2 rounded-xl p-1 shadow-lg bg-surface-3 dark:bg-surface-1 border-1 border-surface-8/11 w-max min-w-min"))},{default:k(()=>[L(r.$slots,"default"),(T(!0),oe(pe,null,ve(m.value,(e,s)=>(T(),O(M(De),{key:s,class:E([M(j).replace("sm:bg-surface-12/2",""),"w-available min-w-60 !flex"]),as:"div",onClick:e.onclick},{default:k(()=>[q("span",Pe,[P(K,{icon:e.icon,title:e.title},null,8,["icon","title"]),q("span",Te,Ie(r.$t(e.title)),1)])]),_:2},1032,["class","onClick"]))),128))]),_:3},8,["class"])]),_:3})]),_:3})}}}),Ee=Ce;export{ke as n,De as r,Ee as t};
