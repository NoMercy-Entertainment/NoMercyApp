import{I as S,Z as U,l as _,w as A,E as N,ah as R,bM as j,c as v,o as n,a,y as H,K as i,b2 as K,R as M,ag as E,f as L,d as b,b as $,A as x,n as w,a6 as z,ac as P,s as g,j as p,t as f,h as O,F as Z}from"./index-BlsCkKvU.js";import{A as G}from"./autoSkipPlugin-BrLb25Qa.js";import{n as J}from"./subtitles-octopus-Bdu7PkFC.js";import{D as Q}from"./desktopUIPlugin-6g1P5VRl.js";import{K as W}from"./keyHandlerPlugin-BtaNBKEG.js";import{s as I,c as X,a as Y}from"./sidebar-CmPAIqr0.js";import{g as k}from"./imageModal-zqT0KAAe.js";import{u as ee}from"./useServerClient-6Bqhc4IC.js";import{S as q}from"./swiper-vue-BSkH_9PR.js";import{C as te}from"./Carousel-pQqyupW3.js";import{_ as ae}from"./Select.vue_vue_type_script_setup_true_lang-a0VGVaRY.js";import{u as le}from"./index-BYwqtu8U.js";import{_ as V}from"./TMDBImage.vue_vue_type_script_setup_true_lang-BloXBgAN.js";import{_ as T}from"./OptimizedIcon.vue_vue_type_script_setup_true_lang-CcyaU_rN.js";const oe=["data-music","data-sidebar"],De=S({__name:"Trailer",props:{videos:{type:Array,required:!0},toggle:{type:Function,required:!0},open:{type:Boolean,required:!0},title:{type:String,required:!0},index:{type:Number,required:!0},incrementTrailerIndex:{type:Function,required:!0}},setup(e){const l=e,y=U(),{data:c,isError:u}=ee({queryKey:["base","info",y.params.id,"trailer",l.videos[l.index].src],path:`trailer/${l.videos[l.index].src}`}),m=_(),d=_(),t=_();function s(r){const o={muted:!1,controls:!1,preload:"auto",debug:!1,autoPlay:!0,playlist:[r],controlsTimeout:3e3,doubleClickDelay:300,playbackRates:[.25,.5,.75,1,1.25,1.5,1.75,2],accessToken:E.value?.accessToken,basePath:M.value?.serverBaseUrl};t.value=J("trailer").setup(o),t.value?.once("back",()=>{l.toggle()});const C=new Q;t.value?.registerPlugin("desktopUI",C),t.value?.usePlugin("desktopUI");const D=new G;t.value?.registerPlugin("autoSkip",D),t.value?.usePlugin("autoSkip");const F=new W;t.value?.registerPlugin("keyHandler",F),t.value?.usePlugin("keyHandler"),t.value?.on("playlistComplete",()=>{console.log("Playlist complete"),l.toggle()}),t.value?.on("play",()=>{k(!0)}),t.value?.on("pause",()=>{k(!1)}),t.value?.on("fullscreen",h=>{window.external?.sendMessage?.(h?"enterFullscreen":"exitFullscreen")}),t.value?.on("remove",()=>{l.toggle(),l.incrementTrailerIndex()}),t.value?.on("error",()=>{l.toggle()}),t.value?.on("close",()=>{l.toggle()}),t.value?.on("captionsChanged",h=>{h.track===-1?localStorage.setItem("trailerSubtitles","off"):localStorage.setItem("trailerSubtitles",h.track)}),t.value?.once("ready",()=>{t.value?.seek(0)}),t.value?.on("play",()=>{localStorage.getItem("trailerSubtitles")==="off"?t.value?.setCurrentCaption(-1):t.value?.setCurrentCaption(Number.parseInt(localStorage.getItem("trailerSubtitles")??"-1",10))})}return A(c,r=>{!r||u.value||s(r)}),N(()=>{!c.value||u.value||(R.stop(),d.value=I.value,k(!0),X(),s(c.value))}),j(()=>{if(Y(d.value??"open"),k(!1),t.value)try{t.value?.dispose()}catch{}}),(r,o)=>(n(),v("button",{class:"fixed inset-0 h-available w-available overflow-hidden rounded-lg bg-black/50",onClick:o[1]||(o[1]=C=>e.toggle())},[a("div",{"data-music":i(K),"data-sidebar":i(I),class:"absolute inset-0 w-full h-auto max-w-full max-h-full sm:w-full sm:h-auto sm:overflow-hidden sm:inset-1/2 sm:aspect-video sm:-translate-y-[50%] px-4 py-2 xl:px-[1.8rem] sidebar-closed:xl:py-4 sm:-translate-x-[50%] sidebar-open:px-4 sidebar-open:py-6 sidebar-open:xl:px-[2.8rem] sidebar-open:xl:py-6"},[a("div",{ref_key:"trailerContainer",ref:m,class:"relative rounded-2xl flex overflow-clip mx-auto children:overflow-clip h-auto top-1/4 sm:top-1/2 sm:-translate-y-1/2 w-auto sm:w-fit max-w-available sm:h-full",onClick:o[0]||(o[0]=H(()=>{},["stop"]))},[...o[2]||(o[2]=[a("div",{id:"trailer",class:"group nomercyplayer"},null,-1)])],512)],8,oe)]))}}),se={class:"relative mb-1 h-auto w-full overflow-clip rounded-t-md group-focus-visible/season:rounded-b-none group-hover/season:rounded-b-none aspect-backdrop bg-auto-1"},ie={class:"transitioning hover:scale-110",style:{"--stroke-width":"1"}},re={key:0,class:"absolute bottom-0 left-0 z-40 mb-3 w-full px-3"},ne=["id"],de=["id"],ue={class:"grid w-full items-stretch gap-1 rounded-b-md p-2 transitioning text-left"},ce=["title"],me=["title"],fe={class:"relative mb-1 h-auto w-full overflow-clip rounded-t-md group-focus-visible/season:rounded-b-none group-hover/season:rounded-b-none aspect-backdrop bg-auto-1"},pe={class:"transitioning hover:scale-110",style:{"--stroke-width":"1"}},be={key:0,class:"absolute bottom-0 left-0 z-40 mb-3 w-full px-3"},ge=["id"],ve=["id"],ye={class:"grid w-full items-stretch gap-1 rounded-b-md p-2 transitioning text-left"},he=["title"],xe=["title"],B=S({__name:"SeasonCard",props:{data:{type:Object,required:!0},suffix:{type:String,required:!1,default:""}},setup(e){const l=e;return(y,c)=>{const u=L("RouterLink");return e.data?.id&&e.data?.available?(n(),b(u,{key:0,id:e.data?.id,class:w(`frosting border-0 border-[rgb(var(--color-focus))] flex flex-col h-auto items-center group/season focus-shift focus-outline transition-all duration-200 overflow-clip relative !rounded-lg select-none shadow-[0px_0px_0_1px_rgb(var(--color-focus,var(--color-theme-6))/70%)] w-full z-0 bg-auto-1/12  text-slate-lightA-12/90  dark:text-slate-darkA-12/80 ${e.data?.available?"cursor-pointer":"cursor-not-allowed"}`),onfocus:i(P)(),style:x(`--color-focus: ${i(z)(l.data?.color_palette?.still).replace(/,/gu," ").replace(")","").replace("rgb(","")};`),"data-card":"true",to:e.data?.available?e.data.link:"#"},{default:g(()=>[a("div",se,[p(V,{path:e.data?.still,title:e.data?.title,"color-palette":e.data?.color_palette?.still,class:"h-40",size:660,loading:"lazy",aspect:"backdrop","class-name":"pointer-events-none absolute z-20 flex h-full w-full select-none object-cover transitioning trickle-div",type:"image"},null,8,["path","title","color-palette"]),a("div",{class:w(`absolute inset-0 z-30 grid w-full text-white place-items-center group-focus-visible/season:bg-black opacity-0 group-focus-visible/season:opacity-100 transitioning group-hover/season:opacity-100 [background:radial-gradient(75%_50%_at_50%_50%,_rgba(0,_0,_0,_0.40)_0%,_rgba(0,_0,_0,_0.00)_100%),_rgba(0,_0,_0,_0.09)] ${e.data?.available?"":"hidden"}`)},[a("div",ie,[p(T,{icon:"playCircle","class-name":"w-20",stroke:"1"})])],2),e.data?.progress?(n(),v("div",re,[a("div",{id:`episode-${e.data?.id}-slider-container`,class:"relative z-40 flex h-1 w-full overflow-clip rounded-full pt-2 pr-8 bg-gray-dark-12"},[a("div",{id:`episode-${e.data?.id}-progress-bar`,class:"absolute top-0 left-0 h-full bg-[rgb(var(--color-focus))]",style:x({width:e.data?.progress>=99?"100%":`${e.data?.progress}%`})},null,12,de)],8,ne)])):$("",!0)]),a("div",ue,[a("p",{class:"z-10 w-auto text-2xs sm:text-sm font-bold !leading-5 h-10 line-clamp-2 sm:line-clamp-1",title:`${e.data?.episode_number?`${e.data?.episode_number} - `:""}${e.data?.title}`},f(e.data?.episode_number?`${e.data?.episode_number} - `:"")+f(e.data?.title),9,ce),a("p",{class:"z-10 h-8 w-auto hidden sm:flex text-xs min-h-8 line-clamp-2 leading-[1.2] text-auto-12/80",title:e.data?.overview},f(e.data?.overview),9,me)])]),_:1},8,["id","class","onfocus","style","to"])):e.data?.id?(n(),v("div",{key:1,class:w(`border-0 border-[rgb(var(--color-focus))] flex flex-col h-auto items-center group/season focus-shift focus-outline transition-all duration-200 overflow-clip relative !rounded-lg select-none shadow-[0px_0px_0_1px_rgb(var(--color-focus,var(--color-theme-6))/70%)] w-full z-0 bg-auto-1/12 ${e.data?.available?"cursor-pointer":"cursor-not-allowed"}`),style:x(`--color-focus: ${i(z)(l.data?.color_palette?.still).replace(/,/gu," ").replace(")","").replace("rgb(","")};`),"data-card":"true",onFocus:c[0]||(c[0]=m=>i(P)())},[a("div",fe,[p(V,{path:e.data?.still,title:e.data?.title,"color-palette":e.data?.color_palette?.still,class:"h-40",size:660,aspect:"backdrop","class-name":"pointer-events-none absolute z-20 flex h-full w-full select-none object-cover transitioning trickle-div",type:"image"},null,8,["path","title","color-palette"]),a("div",{class:w(`absolute inset-0 z-30 grid w-full text-white place-items-center group-focus-visible/season:bg-black opacity-0 group-focus-visible/season:opacity-100 transitioning group-hover/season:opacity-100 [background:radial-gradient(75%_50%_at_50%_50%,_rgba(0,_0,_0,_0.40)_0%,_rgba(0,_0,_0,_0.00)_100%),_rgba(0,_0,_0,_0.09)] ${e.data?.available?"":"hidden"}`)},[a("div",pe,[p(T,{icon:"playCircle","class-name":"w-20",stroke:"1"})])],2),e.data?.progress?(n(),v("div",be,[a("div",{id:`episode-${e.data?.id}-slider-container`,class:"relative z-40 flex h-1 w-full overflow-clip rounded-full pt-2 pr-8 bg-gray-dark-12"},[a("div",{id:`episode-${e.data?.id}-progress-bar`,class:"absolute top-0 left-0 h-full bg-[rgb(var(--color-focus))]",style:x({width:e.data?.progress>=99?"100%":`${e.data?.progress}%`})},null,12,ve)],8,ge)])):$("",!0)]),a("div",ye,[a("p",{class:"z-10 w-auto text-sm font-bold !leading-5 h-10 line-clamp-1",title:`${e.data?.episode_number?`${e.data?.episode_number} - `:""}${e.data?.title}`},f(e.data?.episode_number?`${e.data?.episode_number} - `:"")+f(e.data?.title),9,he),a("p",{class:"z-10 h-8 w-auto text-xs min-h-8 line-clamp-2 leading-[1.2] text-auto-12/80",title:e.data?.overview},f(e.data?.overview),9,xe)])],38)):$("",!0)}}}),Fe=S({__name:"SeasonCarousel",props:{data:{type:Array,required:!0},type:{type:String,required:!1,default:"poster"},limitCardCountBy:{type:Number,required:!1}},setup(e){const l=e,{t:y}=le();function c(s){}let u=l.data?.findIndex(s=>s.season_number===1);u===-1&&(u=0);const m=l.data?.map((s,r)=>({index:r,id:s.id,name:`${s.season_number} - ${s.title}`,season_number:s.season_number,episodes:s.episodes}))??[],d=_(m[u]);function t(){document.querySelector(".swiper-undefined")?.swiper?.slideTo(0,300)}return A(d,t),(s,r)=>(n(),b(te,{index:d.value.season_number,"limit-card-count-by":e.limitCardCountBy,type:e.type},{selector:g(()=>[p(ae,{id:"season-selector",modelValue:d.value,"onUpdate:modelValue":r[0]||(r[0]=o=>d.value=o),disabled:i(m).length===1,items:i(m),"option-label":"title",class:"min-w-[21rem] ml-3",label:"",variant:"normal"},null,8,["modelValue","disabled","items"])]),default:g(()=>[d.value.episodes?.length===0?(n(),b(i(q),{key:0,class:"flex sm:p-1 sm:pl-0"},{default:g(()=>[(n(),b(B,{id:"item-0",key:0,data:{id:1,title:i(y)("To be announced"),season_number:null,episode_number:null,available:!1,overview:"",airDate:"",still:"",link:"",color_palette:{still:{darkVibrant:"",lightVibrant:""}},progress:null},onclick:()=>{}},null,8,["data"]))]),_:1})):(n(!0),v(Z,{key:1},O(d.value.episodes,o=>(n(),b(i(q),{key:o.id,class:"flex sm:p-1 sm:pl-0"},{default:g(()=>[p(B,{id:`item-${o.id}`,data:o,onclick:()=>void 0},null,8,["id","data","onclick"])]),_:2},1024))),128))]),_:1},8,["index","limit-card-count-by","type"]))}});export{Fe as _,De as a};
