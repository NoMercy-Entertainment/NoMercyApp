import{I as H,aC as b,J as B,dz as j,dA as q,b1 as D,dB as N,dC as R,dD as G,aw as A,b3 as I,ch as O,o as h,e as C,a7 as V,a6 as U,t as m,cv as K,cw as P,bu as F,az as J,aD as L,c as _,a as l,r as S,v as Q,bx as W,h as X,dE as Y,dF as Z,dG as ee,dH as te,z as se}from"./index-BwHd8GRj.js";import{H as E,u as ae}from"./useMounted-D5pqZhxk.js";import{_ as oe}from"./FloatingBackButton.vue_vue_type_script_setup_true_lang-DXpliVKl.js";import{_ as le}from"./Button.vue_vue_type_script_setup_true_lang-CSo3A7Rk.js";const a=H(),ze=b(()=>{var t;return(t=a.value)==null?void 0:t.connection}),g=H(!1),$=()=>{var t,o,s;g.value=!0,console.log("Connected to Dashboard SignalR"),document.dispatchEvent(new Event("dashboardHub-connected")),(t=a.value)!=null&&t.connection&&(R((o=a.value)==null?void 0:o.connection),G((s=a.value)==null?void 0:s.connection))},w=t=>{g.value=!1,console.log("Disconnected from Dashboard SignalR",t),document.dispatchEvent(new Event("dashboardHub-disconnected"))},M=t=>{g.value=!1,console.error("Dashboard SignalR Error:",t),document.dispatchEvent(new Event("dashboardHub-error"))};B(D,async t=>{var s,n,u,p,x,f,v;const o=(s=j.value)==null?void 0:s.accessToken;t&&g.value&&((u=(n=a.value)==null?void 0:n.connection)==null||u.stop().then(),a.value=new q(D.value.serverBaseUrl,o,"dashboardHub"),(x=(p=a.value)==null?void 0:p.connection)==null||x.on("connected",$),(v=(f=a.value)==null?void 0:f.connection)==null||v.on("disconnected",w),await T().catch(M))});const T=async()=>{var t,o,s,n;if(((o=(t=a.value)==null?void 0:t.connection)==null?void 0:o.state)!==E.Connected)return(n=(s=a.value)==null?void 0:s.connection)==null?void 0:n.start().then($)},ne=async()=>{var t,o,s,n;try{return((o=(t=a.value)==null?void 0:t.connection)==null?void 0:o.state)===E.Disconnected||(n=(s=a.value)==null?void 0:s.connection)==null?void 0:n.stop().then(w).catch(w)}catch(u){console.error("Error stopping Dashboard SignalR:",u),w()}},z=async()=>{var o,s,n,u,p,x,f,v,y,e,r,i,d;const t=(o=j.value)==null?void 0:o.accessToken;D.value&&(!((n=(s=a.value)==null?void 0:s.connection)!=null&&n.state)||((p=(u=a.value)==null?void 0:u.connection)==null?void 0:p.state)===E.Disconnected)&&(a.value=new q(D.value.serverBaseUrl,t,"dashboardHub"),(f=(x=a.value)==null?void 0:x.connection)==null||f.on("connected",$),(y=(v=a.value)==null?void 0:v.connection)==null||y.on("disconnected",w),await T().catch(M),(r=(e=a.value)==null?void 0:e.connection)==null||r.onreconnecting(c=>{var k;console.log("SignalR Disconnected.",c==null?void 0:c.message),N((k=a.value)==null?void 0:k.connection),w()}),(d=(i=a.value)==null?void 0:i.connection)==null||d.onreconnected(()=>{var c;console.log("SignalR Reconnected."),R((c=a.value)==null?void 0:c.connection),$()}))},ce=A({__name:"HelpButton",setup(t){const o=I(),s=b(()=>`https://docs${O}.nomercy.tv${o.path.replace(/\/\w{8}-\w{4}-\w{4}-\w{4}-\w{12}/gu,"")}`);return(n,u)=>(h(),C(le,{id:"help",href:s.value,variant:"text",component:"link",target:"_blank",color:"auto",startIcon:"messageBubbleQuestion",class:"relative flex h-10 flex-shrink-0 flex-grow-0 items-center justify-center gap-2 overflow-hidden rounded-lg px-4 py-2.5"},{default:V(()=>[U(m(n.$t("Help")),1)]),_:1},8,["href"]))}}),re={key:0,class:"grid h-full w-full place-items-center"},ie={class:"relative flex items-center justify-start gap-8 overflow-hidden"},de={class:"relative flex w-full flex-col gap-4"},ue={class:"text-7xl font-bold text-center text-slate-light-12/80 dark:text-slate-dark-12/80"},fe={class:"left-0 text-2xl text-center text-slate-light-12/80 dark:text-slate-dark-12/80 whitespace-pre-line"},ve={key:1,class:"relative z-0 h-available flex flex-shrink-0 flex-grow flex-col overflow-clip items-start justify-start self-stretch w-available min-h-available bg-slate-light-3 dark:bg-slate-dark-2"},he={class:"sticky top-0 z-10 flex flex-shrink-0 flex-grow-0 flex-col items-start justify-start gap-5 self-stretch"},pe={class:"z-10 flex h-20 items-center justify-between gap-4 self-stretch border-b px-4 py-4 border-auto-7/6 xl:px-6 bg-slate-light-3 dark:bg-slate-dark-2"},xe={class:"relative flex h-full flex-col items-start justify-center gap-1 text-slate-light-12/80 dark:text-slate-dark-12/80"},me={class:"w-auto flex-shrink-0 flex-grow-0 self-stretch whitespace-nowrap text-xl font-semibold"},ge={key:1,class:"hidden h-8 w-auto flex-shrink-0 flex-grow-0 items-center self-stretch text-sm empty:hidden lg:flex"},be={class:"flex flex-col flex-nowrap items-end justify-center gap-x-3 gap-y-1 sm:flex-row"},we={key:0,class:"grid h-full w-full place-items-center"},ye={class:"relative flex flex-col items-center justify-start gap-8 overflow-hidden"},ke={class:"relative flex w-full flex-col gap-4"},_e={class:"text-7xl font-bold text-center text-slate-light-12/80 dark:text-slate-dark-12/80"},Se={class:"left-0 text-2xl text-center text-slate-light-12/80 dark:text-slate-dark-12/80 whitespace-pre-line"},Ce={key:2,class:"sticky bottom-0 z-0 flex w-full flex-wrap items-center gap-4 border-t px-4 py-4 border-auto-7/6 empty:hidden sm:h-16 xl:px-6"},He=A({__name:"DashboardLayout",props:K({title:{type:String,required:!0},params:{type:Object,required:!1},description:{type:String,required:!1},gridStyle:{type:Number,required:!1,default:0},back:{type:Boolean,required:!1,default:!1},error:{type:Object,required:!1},allowAnyone:{type:Boolean,required:!1,default:!1}},{modelValue:{required:!1,type:Boolean},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const o=P(t,"modelValue"),s=t,{dataUpdatedAt:n,error:u,isPending:p}=F({path:"dashboard/server",enabled:!s.allowAnyone,refetchInterval:1e4,queryKey:["dashboard","server",g.value]}),x=b(()=>s.gridStyle==1?Z.value:s.gridStyle==2?ee.value:s.gridStyle==3?te.value:"flex flex-wrap"),f=b(()=>{var r,i,d,c,k;if(s.allowAnyone)return null;const e=u.value;if(((r=e==null?void 0:e.response)==null?void 0:r.status)!=200)return{code:((d=(i=e==null?void 0:e.response)==null?void 0:i.data)==null?void 0:d.status)??null,message:((k=(c=e==null?void 0:e.response)==null?void 0:c.data)==null?void 0:k.detail)??""}}),v=b(()=>{var r,i,d,c;const e=s.error;if(console.log(e),!(!(e!=null&&e.response)||((r=e==null?void 0:e.response)==null?void 0:r.status)==200))return{code:(i=e==null?void 0:e.response)==null?void 0:i.status,message:((c=(d=e==null?void 0:e.response)==null?void 0:d.data)==null?void 0:c.detail)??""}});J(()=>{L(null)}),ae(z,ne,1);const y=b(()=>{var e;return(((e=f.value)==null?void 0:e.code)||p.value||!g.value)&&!s.allowAnyone});return B(y,e=>{e&&o.value!=null&&(o.value=!1)}),B(n,e=>{e&&!g.value&&z()}),(e,r)=>{var i,d,c;return h(),C(Y,null,[y.value?(h(),_("div",re,[l("div",ie,[l("div",de,[l("p",ue,m((i=f.value)!=null&&i.code?(d=f.value)==null?void 0:d.code:"Offline"),1),l("p",fe,m((c=f.value)==null?void 0:c.message),1)])])])):(h(),_("div",ve,[l("div",he,[r[0]||(r[0]=l("div",{class:"absolute inset-0 z-0 h-full w-full"},null,-1)),l("div",pe,[l("div",xe,[l("p",me,m(e.$t(t.title,t.params)),1),t.back?(h(),C(oe,{key:0,position:"relative",class:"left-4"})):(h(),_("p",ge,m(e.$t(t.description)),1))]),S(e.$slots,"title"),l("div",be,[Q(ce),S(e.$slots,"cta")])])]),v.value?(h(),_("div",we,[l("div",ye,[l("div",ke,[l("p",_e,m(v.value.code),1),l("p",Se,m(v.value.message),1)])])])):(h(),C(W,{key:1,static:!0,class:"z-0 flex !h-sidebar+ !min-h-[calc(100vh-16rem)] w-full flex-1 overflow-y-auto overflow-x-hidden sm:p-4"},{default:V(()=>[l("div",{class:se(["h-auto w-full flex-wrap content-start gap-4",x.value])},[S(e.$slots,"default")],2)]),_:3})),!v.value&&e.$slots.actions?(h(),_("div",Ce,[r[1]||(r[1]=l("div",{class:"absolute inset-0 -z-10 h-full w-full"},null,-1)),S(e.$slots,"actions")])):X("",!0)]))],1024)}}});export{He as _,ze as c,g as d};
//# sourceMappingURL=DashboardLayout.vue_vue_type_script_setup_true_lang-Db0iqROX.js.map
