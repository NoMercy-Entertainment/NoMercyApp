var T=Object.defineProperty;var C=(d,c,s)=>c in d?T(d,c,{enumerable:!0,configurable:!0,writable:!0,value:s}):d[c]=s;var r=(d,c,s)=>C(d,typeof c!="symbol"?c+"":c,s);import{bi as k,aH as E}from"./vendor-F08gofix.js";import{P as S,h as m,u as B,b as L,d as M,e as P}from"./video-player-0s44mC2a.js";import{b as $}from"./buttons-DDRy-LjE.js";class U extends S{constructor(){super(...arguments);r(this,"player",{});r(this,"overlay",{});r(this,"buttons",{});r(this,"chapterBar",{});r(this,"mainMenu",{});r(this,"menuFrame",{});r(this,"nextUp",{});r(this,"seekContainer",{});r(this,"sliderBar",{});r(this,"sliderPopImage",{});r(this,"chapterText",{});r(this,"episodeScrollContainer",{});r(this,"playbackButton",{});r(this,"loader",{});r(this,"thumbnailClone",{});r(this,"chapters",[]);r(this,"previewTime",[]);r(this,"timer",{});r(this,"timeout",{});r(this,"image","");r(this,"controlsVisible",!1);r(this,"currentScrubTime",0);r(this,"imageBaseUrl","");r(this,"isScrubbing",!1);r(this,"menuOpen",!1);r(this,"mainMenuOpen",!1);r(this,"languageMenuOpen",!1);r(this,"subtitlesMenuOpen",!1);r(this,"subtitleSettingsMenuOpen",!1);r(this,"qualityMenuOpen",!1);r(this,"speedMenuOpen",!1);r(this,"playlistMenuOpen",!1);r(this,"theaterModeEnabled",!1);r(this,"highQuality",!1);r(this,"shouldSlide",!0);r(this,"currentTimeFile","");r(this,"currentMenu",null);r(this,"thumbs",[]);r(this,"languageMenuStyles",["language-button","w-available","mr-auto","h-8","px-1","py-2","flex","items-center","rounded","snap-center","outline-transparent","outline","whitespace-nowrap","hover:bg-neutral-600/50","transition-all","duration-200","outline-1","outline-solid","focus-visible:outline-2","focus-visible:outline-white","active:outline-white"]);r(this,"menuButtonTextStyles",["menu-button-text","text-white","cursor-pointer","font-semibold","pl-2","flex","gap-2","leading-[normal]","line-clamp-1"]);r(this,"menuButtonSubTextStyles",["menu-button-text","text-white/60","cursor-pointer","font-semibold","text-2xs","pl-2","flex","gap-2","leading-[normal]","line-clamp-1"])}initialize(s){this.player=s,this.overlay=s.overlay,this.buttons=$(),this.imageBaseUrl=s.options.basePath?"":"https://image.tmdb.org/t/p/w185",this.player.on("play",()=>{this.player.emit("hide-episode-tip")})}dispose(){clearTimeout(this.timer),clearTimeout(this.timeout),this.player.plugins.desktopUIPlugin=void 0,this.chapters=[],this.previewTime=[],this.overlay&&this.overlay.parentNode&&this.overlay.parentNode.removeChild(this.overlay)}scrollIntoView(s){const e=s.parentElement,i=s.getBoundingClientRect().left+s.offsetWidth/2-e.offsetWidth/2,l=e.scrollLeft,a=performance.now();function n(h){const p=h-a,u=Math.min(p/200,1);e.scrollTo(l+i*u,0),p<200&&requestAnimationFrame(n)}requestAnimationFrame(n)}createSVGElement(s,t,e,i=!1,l=!1){const a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("viewBox","0 0 24 24"),a.id=t,this.player.addClasses(a,k([`${t}-icon`,"svg-size","h-5","w-5","fill-current","pointer-events-none","group-hover/button:scale-110","duration-700",i?"hidden":"flex",...e.classes]).split(" "));const n=document.createElementNS("http://www.w3.org/2000/svg","path");n.setAttribute("d",l?e.normal:e.hover),this.player.addClasses(n,["group-hover/button:hidden","group-hover/volume:hidden"]),a.appendChild(n);const h=document.createElementNS("http://www.w3.org/2000/svg","path");return h.setAttribute("d",l?e.hover:e.normal),this.player.addClasses(h,["hidden","group-hover/button:flex","group-hover/volume:flex"]),a.appendChild(h),!s.classList.contains("menu-button")&&l&&(s.addEventListener("mouseenter",()=>{if(e.title.length==0||["Next","Previous"].includes(e.title)&&this.player.hasNextTip||e.title=="Fullscreen"&&this.player.getFullscreen()||e.title=="Exit fullscreen"&&!this.player.getFullscreen()||e.title=="Play"&&this.player.isPlaying||e.title=="Pause"&&!this.player.isPlaying||e.title=="Mute"&&this.player.isMuted()||e.title=="Unmute"&&!this.player.isMuted())return;const p=`${this.player.localize(e.title)} ${this.getButtonKeyCode(t)}`,u=this.player.getElement().getBoundingClientRect(),o=s.getBoundingClientRect();let y=Math.abs(u.left-(o.left+o.width*.5)-p.length*.5);const f=Math.abs(u.bottom-(o.bottom+o.height*1.2));y<35&&(y=35),y>u.right-u.left-75&&(y=u.right-u.left-75),this.player.emit("show-tooltip",{text:p,currentTime:"bottom",x:`${y}px`,y:`-${f}px`})}),s.addEventListener("mouseleave",()=>{this.player.emit("hide-tooltip")})),s.appendChild(a),a}modifySpinner(s){this.loader=this.player.createElement("h2","loader").addClasses(["loader","pointer-events-none"]).appendTo(s)}createSpinnerContainer(s){const t=this.player.createElement("div","spinner-container").addClasses(["spinner-container","absolute","inset-0","hidden","w-available","h-available","grid","pointer-events-none","place-content-center","bg-transparent","place-items-center","group-[&.nomercyplayer:not(.paused):not(.playing)]:!flex","group-[&.nomercyplayer:not(.paused):not(.playing)]:!bg-gradient-circle-c","group-[&.nomercyplayer.buffering]:bg-gradient-circle-c","group-[&.nomercyplayer.error]:bg-gradient-circle-c","from-15%","from-black/50","via-40%","via-black/30","to-100%","to-black/0"]).appendTo(s),e=this.player.createElement("div","spinner-role").addClasses(["flex","flex-col","items-center","gap-4","mt-11"]).appendTo(t);e.setAttribute("role","status"),this.createSpinner(e);const i=this.player.createElement("span","status-text").addClasses(["status-text","text-white","group-[&.nomercyplayer:not(.paused):not(.playing)]:!hidden","text-lg","font-bold"]).appendTo(e);return i.innerText=this.player.localize("Loading..."),this.player.on("duration",()=>{t.style.display="none"}),this.player.on("waiting",()=>{t.style.display="grid",i.innerText=`${this.player.localize("Buffering")}...`}),this.player.on("error",()=>{t.style.display="none",i.innerText=this.player.localize("Something went wrong trying to play this item")}),this.player.on("ended",()=>{t.style.display="none"}),this.player.on("time",()=>{t.style.display="none"}),this.player.on("bufferedEnd",()=>{t.style.display="none"}),this.player.on("stalled",()=>{t.style.display="grid",i.innerText=`${this.player.localize("Buffering")}...`}),this.player.on("item",()=>{t.style.display="grid"}),t}createSpinner(s){const t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("viewBox","0 0 100 101"),t.id="spinner",t.setAttribute("fill","none"),this.player.addClasses(t,["spinner-icon","group-[&.nomercyplayer:not(.paused):not(.playing)]:!hidden","inline","w-12","h-12","mr-2","animate-spin","text-white/20","fill-white"]),s.appendChild(t);const e=document.createElementNS("http://www.w3.org/2000/svg","path");e.setAttribute("d","M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z"),e.setAttribute("fill","currentColor"),t.appendChild(e);const i=document.createElementNS("http://www.w3.org/2000/svg","path");i.setAttribute("d","M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z"),i.setAttribute("fill","currentFill"),t.appendChild(i)}getButtonKeyCode(s){switch(s){case"play":case"pause":return`(${this.player.localize("SPACE")})`;case"volumeMuted":case"volumeLow":case"volumeMedium":case"volumeHigh":return"(m)";case"seekBack":return"(<)";case"seekForward":return"(>)";case"next":return"(n)";case"theater":return"(t)";case"theater-enabled":return"(t)";case"pip-enter":case"pip-exit":return"(i)";case"playlist":return"";case"previous":return"(p)";case"speed":return"";case"subtitle":case"subtitled":return"(v)";case"audio":return"(b)";case"settings":return"";case"fullscreen-enable":case"fullscreen":return"(f)";default:return""}}fetchPreviewTime(){if(this.previewTime.length===0){const s=this.player.getSpriteFile(),t=new Image;this.player.once("item",()=>{t.remove()}),s&&(this.image=s,this.player.options.accessToken?this.player.getFileContents({url:s,options:{type:"blob"},callback:i=>{const l=URL.createObjectURL(i);t.src=l,this.sliderPopImage.style&&(this.sliderPopImage.style.backgroundImage=`url('${l}')`),this.player.once("item",()=>{URL.revokeObjectURL(l)}),setTimeout(()=>{this.player.emit("preview-time",this.previewTime)},400)}}).then():(this.sliderPopImage.style&&(this.sliderPopImage.style.backgroundImage=`url('${s}')`),t.src=s,setTimeout(()=>{this.player.emit("preview-time",this.previewTime)},400)));const e=this.player.getTimeFile();e&&this.currentTimeFile!==e&&(this.player.currentTimeFile=e,t.onload=()=>{this.player.getFileContents({url:e,options:{type:"text"},callback:i=>{const a=new E.WebVTTParser().parse(i,"metadata"),n=/(?<x>\d*),(?<y>\d*),(?<w>\d*),(?<h>\d*)/u;this.previewTime=[],a.cues.forEach(h=>{const p=n.exec(h.text);if(!(p!=null&&p.groups))return;const{x:u,y:o,w:y,h:f}=p.groups,[g,b,v,x]=[u,o,y,f].map(w=>parseInt(w,10));this.previewTime.push({start:h.startTime,end:h.endTime,x:g,y:b,w:v,h:x})}),setTimeout(()=>{this.player.emit("preview-time",this.previewTime)},400)}}).then(()=>{this.loadSliderPopImage(0)})})}}createUiButton(s,t){var i;const e=this.player.createElement("button",t).addClasses(["cursor-pointer","-outline-offset-2","fill-white","flex","focus-visible:fill-white","focus-visible:outline","focus-visible:outline-2","focus-visible:outline-white/20","group/button","h-10","items-center","justify-center","min-w-[40px]","p-2","pointer-events-auto","relative","rounded-full","tv:fill-white/30","w-10"]).appendTo(s);return e.ariaLabel=(i=this.buttons[t])==null?void 0:i.title,e.addEventListener("keypress",l=>{l.key==="Backspace"&&(e.blur(),this.player.emit("show-menu",!1)),l.key==="Escape"&&(e.blur(),this.player.emit("show-menu",!1))}),e}createBackButton(s,t=!1){if(!this.player.hasBackEventHandler)return;const e=this.createUiButton(s,"back");return s.appendChild(e),this.createSVGElement(e,"back",this.buttons.back,!1,t),e.addEventListener("click",()=>{this.player.emit("hide-tooltip"),this.player.emit("back")}),this.player.on("pip-internal",i=>{i?e.style.display="none":e.style.display="flex"}),e}createRestartButton(s,t=!1){const e=this.createUiButton(s,"restart");return s.appendChild(e),this.createSVGElement(e,"restart",this.buttons.restart,!1,t),e.addEventListener("click",i=>{i.stopPropagation(),this.player.restart()}),e}createSettingsButton(s,t=!1){if(!this.player.hasSpeeds()&&!this.player.hasAudioTracks()&&!this.player.hasCaptions())return;const e=this.createUiButton(s,"settings");return this.createSVGElement(e,"settings",this.buttons.settings,!1,t),e.addEventListener("click",()=>{this.player.emit("hide-tooltip"),this.menuOpen&&this.mainMenuOpen?this.player.emit("show-menu",!1):!this.menuOpen&&this.mainMenuOpen?this.player.emit("show-menu",!0):this.menuOpen&&!this.mainMenuOpen?(this.player.emit("show-main-menu",!0),this.player.emit("show-menu",!0)):(this.player.emit("show-main-menu",!0),this.player.emit("show-menu",!0))}),this.player.on("pip-internal",i=>{i?e.style.display="none":e.style.display="flex"}),s.append(e),e}createCloseButton(s,t=!1){if(!this.player.hasCloseEventHandler)return;const e=this.createUiButton(s,"close");return s.appendChild(e),this.createSVGElement(e,"close",this.buttons.close,!1,t),e.addEventListener("click",()=>{this.player.emit("hide-tooltip"),this.player.emit("close")}),this.player.on("pip-internal",i=>{i?e.style.display="none":e.style.display="flex"}),e}createPlaybackButton(s,t=!1){var l;this.playbackButton=this.createUiButton(s,"playback"),s.appendChild(this.playbackButton),this.playbackButton.ariaLabel=(l=this.buttons.play)==null?void 0:l.title;const e=this.createSVGElement(this.playbackButton,"paused",this.buttons.play,!1,t),i=this.createSVGElement(this.playbackButton,"playing",this.buttons.pause,!0,t);this.playbackButton.addEventListener("click",a=>{a.stopPropagation(),this.player.togglePlayback(),this.player.emit("hide-tooltip")}),this.playbackButton.addEventListener("keydown",()=>this.player.emit.bind(this)("dynamicControls")),this.player.getVideoElement().addEventListener("focus",()=>{this.player.emit("dynamicControls"),this.player.getVideoElement().scrollIntoView()}),this.player.on("pause",()=>{i.style.display="none",e.style.display="flex"}),this.player.on("play",()=>{e.style.display="none",i.style.display="flex"}),this.player.on("item",()=>{})}createSeekBackButton(s,t=!1){if(this.player.isMobile())return;const e=this.createUiButton(s,"seekBack");return this.createSVGElement(e,"seekBack",this.buttons.seekBack,!1,t),e.addEventListener("click",()=>{this.player.emit("hide-tooltip"),this.player.rewindVideo()}),this.player.on("pip-internal",i=>{i?e.style.display="none":e.style.display="flex"}),s.append(e),e}createSeekForwardButton(s,t=!1){if(this.player.isMobile())return;const e=this.createUiButton(s,"seekForward");return this.createSVGElement(e,"seekForward",this.buttons.seekForward,!1,t),e.addEventListener("click",()=>{this.player.emit("hide-tooltip"),this.player.forwardVideo()}),this.player.on("pip-internal",i=>{i?e.style.display="none":e.style.display="flex"}),s.append(e),e}createChapterBackButton(s,t=!1){const e=this.createUiButton(s,"chapterBack");return this.player.addClasses(e,["portrait:!hidden"]),this.player.on("item",()=>{e.style.display="none"}),this.player.on("chapters",i=>{i.cues.length>0?e.style.display="flex":e.style.display="none"}),this.createSVGElement(e,"chapterBack",this.buttons.chapterBack,!1,t),e.addEventListener("click",()=>{this.player.emit("hide-tooltip"),this.player.previousChapter()}),this.player.on("pip-internal",i=>{i?e.style.display="none":e.style.display="flex"}),s.append(e),e}createChapterForwardButton(s,t=!1){const e=this.createUiButton(s,"chapterForward");return this.player.addClasses(e,["portrait:!hidden"]),this.player.on("item",()=>{e.style.display="none"}),this.player.on("chapters",i=>{i.cues.length>0?e.style.display="flex":e.style.display="none"}),this.createSVGElement(e,"chapterForward",this.buttons.chapterForward,!1,t),e.addEventListener("click",()=>{this.player.emit("hide-tooltip"),this.player.nextChapter()}),this.player.on("pip-internal",i=>{i?e.style.display="none":e.style.display="flex"}),s.append(e),e}createTime(s,t,e){const i=this.player.createElement("div",`${t}-time`).addClasses([...e,"time","flex","font-mono","items-center","pointer-events-none","select-none","text-sm","justify-center",`${t}-time`]).appendTo(s);switch(i.innerText=m(this.player.getDuration()),t){case"current":this.player.on("time",l=>{this.player.container.classList.contains("active")&&(i.innerText=m(l.currentTime))}),this.player.on("currentScrubTime",l=>{i.innerText=m(l.currentTime)});break;case"remaining":this.player.on("duration",l=>{l.remaining===1/0?i.innerText="Live":i.innerText=m(l.remaining)}),this.player.on("time",l=>{l.remaining===1/0?i.innerText="Live":this.player.container.classList.contains("active")&&(i.innerText=m(l.remaining))});break;case"duration":this.player.on("duration",l=>{l.duration===1/0?i.innerText="Live":i.innerText=m(l.duration)});break}return this.player.on("pip-internal",l=>{l?i.style.display="none":i.style.display=""}),i}createVolumeButton(s,t=!1){var u;if(this.player.isMobile())return;const e=this.player.createElement("div","volume-container").addClasses(["volume-container","group/volume","flex","overflow-clip","pointer-events-auto"]).appendTo(s),i=this.createUiButton(e,"volume");i.ariaLabel=(u=this.buttons.volumeHigh)==null?void 0:u.title;const l=this.player.createElement("input","volume-slider").addClasses(["volume-slider","w-0","rounded-full","opacity-0","duration-200","group-hover/volume:w-20","group-hover/volume:mx-2","group-hover/volume:opacity-100","group-focus-within/volume:w-20","group-focus-within/volume:mx-2","group-focus-within/volume:opacity-100","appearance-none","volume-slider","bg-white/70","bg-gradient-to-r","from-white","to-white","self-center","h-1","bg-no-repeat","rounded-full","shadow-sm","transition-all","range-track:appearance-none","range-track:border-none","range-track:bg-transparent","range-track:shadow-none","range-thumb:h-3","range-thumb:w-3","range-thumb:appearance-none","range-thumb:rounded-full","range-thumb:bg-white","range-thumb:shadow-sm","range-thumb:border-none"]).appendTo(e);l.type="range",l.min="0",l.max="100",l.step="1",l.value=this.player.getVolume().toString(),l.style.backgroundSize=`${this.player.getVolume()}% 100%`;const a=this.createSVGElement(i,"volumeMuted",this.buttons.volumeMuted,!0,t),n=this.createSVGElement(i,"volumeLow",this.buttons.volumeLow,!0,t),h=this.createSVGElement(i,"volumeMedium",this.buttons.volumeMedium,!0,t),p=this.createSVGElement(i,"volumeHigh",this.buttons.volumeHigh,!1,t);return i.addEventListener("click",o=>{o.stopPropagation(),this.player.toggleMute(),this.player.emit("hide-tooltip")}),l.addEventListener("input",o=>{o.stopPropagation();const y=Math.floor(parseInt(l.value,10));l.style.backgroundSize=`${y}% 100%`,this.player.setVolume(y)}),e.addEventListener("wheel",o=>{o.preventDefault();const y=o.deltaY===0?-o.deltaX:-o.deltaY;y!==0&&(l.style.backgroundSize=`${l.value}% 100%`,l.value=(parseFloat(l.value)+y*.5).toString(),this.player.setVolume(parseFloat(l.value)))},{passive:!0}),this.player.on("volume",o=>{this.volumeHandle(o,a,n,h,p),l.style.backgroundSize=`${o.volume}% 100%`,l.value=o.volume.toString()}),this.player.on("mute",o=>{this.volumeHandle(o,a,n,h,p),o.muted?(l.style.backgroundSize="0% 100%",l.value="0"):(l.style.backgroundSize=`${this.player.getVolume()}% 100%`,l.value=this.player.getVolume().toString())}),e}volumeHandle(s,t,e,i,l){this.player.getMute()||s.volume==0?(e.style.display="none",i.style.display="none",l.style.display="none",t.style.display="flex"):s.volume<=30?(i.style.display="none",l.style.display="none",t.style.display="none",e.style.display="flex"):s.volume<=60?(e.style.display="none",l.style.display="none",t.style.display="none",i.style.display="flex"):(e.style.display="none",i.style.display="none",t.style.display="none",l.style.display="flex")}getClosestSeekableInterval(){const s=this.player.getCurrentTime(),t=this.previewTime.find(e=>s>=e.start&&s<e.end);return t==null?void 0:t.start}createPreviousButton(s,t=!1){const e=this.createUiButton(s,"previous");return this.player.addClasses(e,["portrait:!hidden"]),e.style.display="none",this.createSVGElement(e,"previous",this.buttons.previous,!1,t),e.addEventListener("click",i=>{i.stopPropagation(),this.player.previous(),this.player.emit("hide-tooltip")}),this.player.getPlaylistIndex()>0?e.style.display="flex":e.style.display="none",this.player.on("item",()=>{this.player.getPlaylistIndex()>0?e.style.display="flex":e.style.display="none"}),this.player.on("pip-internal",i=>{i?e.style.display="none":(this.player.playlistItem().episode??!1)&&(e.style.display="flex")}),e.addEventListener("mouseenter",()=>{const i=e.getBoundingClientRect(),l=s.getBoundingClientRect();let a=Math.abs(l.left-i.left+50);const n=Math.abs(l.bottom-i.bottom-60);a<30&&(a=30),a>i.right-i.left-10&&(a=i.right-i.left-10),this.player.emit("show-episode-tip",{direction:"previous",currentTime:"bottom",x:`${a}px`,y:`-${n}px`})}),e.addEventListener("mouseleave",()=>{this.player.emit("hide-episode-tip")}),s.appendChild(e),e}createNextButton(s,t=!1){const e=this.createUiButton(s,"next");return this.player.addClasses(e,["portrait:!hidden"]),e.style.display="none",this.player.hasNextTip=!0,this.createSVGElement(e,"next",this.buttons.next,!1,t),e.addEventListener("click",i=>{i.stopPropagation(),this.player.next(),this.player.emit("hide-tooltip")}),this.player.isLastPlaylistItem()?e.style.display="none":e.style.display="flex",this.player.on("item",()=>{this.player.isLastPlaylistItem()?e.style.display="none":e.style.display="flex"}),this.player.on("pip-internal",i=>{i?e.style.display="none":this.player.isLastPlaylistItem()&&(e.style.display="flex")}),e.addEventListener("mouseenter",()=>{const i=e.getBoundingClientRect(),l=s.getBoundingClientRect();let a=Math.abs(l.left-i.left+50);const n=Math.abs(l.bottom-i.bottom-60);a<30&&(a=30),a>i.right-i.left-10&&(a=i.right-i.left-10),this.player.emit("show-episode-tip",{direction:"next",currentTime:"bottom",x:`${a}px`,y:`-${n}px`})}),e.addEventListener("mouseleave",()=>{this.player.emit("hide-episode-tip")}),s.appendChild(e),e}createCaptionsButton(s,t=!1){var a;const e=this.createUiButton(s,"subtitles");this.player.addClasses(e,["portrait:!hidden"]),e.style.display="none",e.ariaLabel=(a=this.buttons.subtitles)==null?void 0:a.title;const i=this.createSVGElement(e,"subtitle",this.buttons.subtitlesOff,!1,t),l=this.createSVGElement(e,"subtitled",this.buttons.subtitles,!0,t);return e.addEventListener("click",n=>{n.stopPropagation(),this.player.emit("hide-tooltip"),this.subtitlesMenuOpen?(this.player.emit("show-menu",!1),this.menuFrame.close()):(this.player.emit("show-subtitles-menu",!0),this.menuFrame.showModal())}),this.player.hasCaptions()?e.style.display="flex":e.style.display="none",this.player.on("captionsList",n=>{n.length>1?e.style.display="flex":e.style.display="none"}),this.player.on("captionsChanging",n=>{n.id==-1?(l.style.display="none",i.style.display="flex"):(l.style.display="flex",i.style.display="none")}),this.player.on("pip-internal",n=>{n?e.style.display="none":this.player.hasCaptions()&&(e.style.display="flex")}),s.appendChild(e),e}createAudioButton(s,t=!1){var i;const e=this.createUiButton(s,"audio");return this.player.addClasses(e,["portrait:!hidden"]),e.style.display="none",e.ariaLabel=(i=this.buttons.language)==null?void 0:i.title,this.createSVGElement(e,"audio",this.buttons.languageOff,!1,t),e.addEventListener("click",l=>{l.stopPropagation(),this.player.emit("hide-tooltip"),this.languageMenuOpen?(this.player.emit("show-menu",!1),this.menuFrame.close()):(this.player.emit("show-language-menu",!0),this.menuFrame.showModal())}),this.player.on("item",()=>{e.style.display="none"}),this.player.hasAudioTracks()?e.style.display="flex":e.style.display="none",this.player.on("audioTracks",l=>{l.length>1?e.style.display="flex":e.style.display="none"}),this.player.on("pip-internal",l=>{l?e.style.display="none":this.player.hasAudioTracks()&&(e.style.display="flex")}),s.appendChild(e),e}createQualityButton(s,t=!1){const e=this.createUiButton(s,"quality");this.player.addClasses(e,["portrait:!hidden"]),e.style.display="none";const i=this.createSVGElement(e,"low",this.buttons.quality,!1,t),l=this.createSVGElement(e,"high",this.buttons.quality,!0,t);return e.addEventListener("click",a=>{a.stopPropagation(),this.player.emit("hide-tooltip"),this.qualityMenuOpen?(this.player.emit("show-menu",!1),this.menuFrame.close()):(this.player.emit("show-quality-menu",!0),this.menuFrame.showModal()),this.highQuality?(this.highQuality=!1,l.style.display="none",i.style.display="flex"):(this.highQuality=!0,i.style.display="none",l.style.display="flex")}),this.player.on("item",()=>{e.style.display="none"}),this.player.hasQualities()?e.style.display="flex":e.style.display="none",this.player.on("levels",()=>{this.player.hasQualities()?e.style.display="flex":e.style.display="none"}),this.player.on("pip-internal",a=>{a?e.style.display="none":this.player.hasQualities()&&(e.style.display="flex")}),s.appendChild(e),e}createTheaterButton(s,t=!1){if(this.player.isMobile()||!this.player.hasTheaterEventHandler)return;const e=this.createUiButton(s,"theater");return this.createSVGElement(e,"theater",this.buttons.theater,t),this.createSVGElement(e,"theater-enabled",this.buttons.theaterExit,!0,t),e.addEventListener("click",i=>{i.stopPropagation(),this.player.emit("hide-tooltip"),this.theaterModeEnabled?(this.theaterModeEnabled=!1,e.querySelector(".theater-enabled-icon").style.display="none",e.querySelector(".theater-icon").style.display="flex",this.player.emit("theaterMode",!1),this.player.emit("resize")):(this.theaterModeEnabled=!0,e.querySelector(".theater-icon").style.display="none",e.querySelector(".theater-enabled-icon").style.display="flex",this.player.emit("theaterMode",!0),this.player.emit("resize"))}),this.player.on("fullscreen",()=>{this.player.getFullscreen()?e.style.display="none":e.style.display="flex"}),this.player.on("pip-internal",i=>{i?e.style.display="none":e.style.display="flex"}),s.appendChild(e),e}createFullscreenButton(s,t=!1){const e=this.createUiButton(s,"fullscreen");return this.createSVGElement(e,"fullscreen",this.buttons.fullscreen,!1,t),this.createSVGElement(e,"fullscreen-enabled",this.buttons.exitFullscreen,!0,t),e.addEventListener("click",i=>{i.stopPropagation(),this.player.toggleFullscreen(),this.player.emit("hide-tooltip")}),this.player.on("fullscreen",i=>{i?(e.querySelector(".fullscreen-icon").style.display="none",e.querySelector(".fullscreen-enabled-icon").style.display="flex"):(e.querySelector(".fullscreen-enabled-icon").style.display="none",e.querySelector(".fullscreen-icon").style.display="flex")}),this.player.on("pip-internal",i=>{i?e.style.display="none":e.style.display="flex"}),s.appendChild(e),e}createPlaylistsButton(s,t=!1){const e=this.createUiButton(s,"playlist");return this.player.addClasses(e,["portrait:!hidden"]),e.style.display="none",this.createSVGElement(e,"playlist",this.buttons.playlist,!1,t),e.addEventListener("click",i=>{i.stopPropagation(),this.player.emit("hide-tooltip"),this.playlistMenuOpen?(this.player.emit("show-menu",!1),this.menuFrame.close()):(this.player.emit("show-playlist-menu",!0),this.menuFrame.showModal(),setTimeout(()=>{var l;(l=document.querySelector(`playlist-${this.player.playlistItem().id}`))==null||l.scrollIntoView({block:"center"})},100))}),this.player.hasPlaylists()?e.style.display="flex":e.style.display="none",this.player.on("item",()=>{this.player.hasPlaylists()?e.style.display="flex":e.style.display="none"}),this.player.on("pip-internal",i=>{i?e.style.display="none":this.player.hasPlaylists()&&(e.style.display="flex")}),s.appendChild(e),e}createBottomBar(s){const t=this.player.createElement("div","bottom-bar").addClasses(["bottom-bar","absolute","bottom-0","duration-200","flex","flex-col","gap-2","group-[&.nomercyplayer.paused]:translate-y-0","group-[&.nomercyplayer:has(.open)]:translate-y-0","group-[&.nomercyplayer.active]:translate-y-0","group-[&.nomercyplayer:has(.volume-container:hover)]:!translate-y-0","items-center","mt-auto","text-center","transition-all","translate-y-[100vh]","w-available","z-10","pointer-events-none"]).appendTo(s);return this.player.createElement("div","bottom-bar-shadow").addClasses(["absolute","pointer-events-none","pt-[10%]","w-available","bottom-0","bg-gradient-to-t","from-black/85","via-black/40","to-black/0"]).appendTo(t),t}createDivider(s,t){const e=["divider","flex","flex-1","min-w-4"],i=this.player.createElement("div","divider").addClasses(e).appendTo(s);return t?i.innerHTML=t:this.player.addClasses(i,e),i}createOverlayCenterMessage(s){const t=this.player.createElement("button","player-message").addClasses(["player-message","hidden","absolute","rounded-md","bg-neutral-900/95","left-1/2","px-4","py-2","pointer-events-none","text-center","top-12","-translate-x-1/2","z-50"]).appendTo(s);return this.player.on("display-message",e=>{t.style.display="flex",t.innerText=e??""}),this.player.on("remove-message",()=>{t.style.display="none",t.innerText=""}),t}createSeekContainer(s){const t=this.player.createElement("div","seek-container").addClasses(["relative","h-auto","mb-28","w-available","translate-y-[80vh]","z-40","w-available"]).appendTo(s),e=this.player.createElement("div","seek-scroll-clone-container").addClasses(["[--gap:1.5rem]","absolute","flex","h-available","w-available","gap-[var(--gap)]","z-10","pointer-events-none"]).appendTo(t);this.thumbnailClone=this.player.createElement("div","thumbnail-clone-1").addClasses(["h-auto","object-cover","border-4","mx-auto"]).appendTo(e);const i=this.player.createElement("div","seek-scroll-container").addClasses(["relative","flex","h-available","w-available","overflow-auto","px-[calc(100%/2.14)]","gap-1.5","scrollbar-none"]).appendTo(t);return this.player.once("item",()=>{this.player.on("preview-time",()=>{this.thumbs=[];for(const l of this.previewTime)this.thumbs.push({time:l,el:this.createThumbnail(l)});i.innerHTML="",B(this.thumbs.map(l=>l.el),"id").forEach(l=>{i.appendChild(l)}),this.player.once("time",()=>{this.currentScrubTime=this.getClosestSeekableInterval(),this.player.emit("currentScrubTime",{...this.player.getTimeData(),currentTime:this.getClosestSeekableInterval()})})})}),this.player.on("lastTimeTrigger",()=>{this.currentScrubTime=this.getClosestSeekableInterval(),this.player.emit("currentScrubTime",{...this.player.getTimeData(),currentTime:this.getClosestSeekableInterval()})}),this.player.on("currentScrubTime",l=>{l.currentTime<=0?l.currentTime=0:l.currentTime>=this.player.getDuration()&&(l.currentTime=this.player.getDuration());const a=this.thumbs.find(n=>l.currentTime>=n.time.start&&l.currentTime<=n.time.end);this.currentScrubTime=l.currentTime,a&&this.scrollIntoView(a.el)}),this.player.on("show-seek-container",l=>{l?(t.style.transform="none",this.player.pause()):this.seekContainer.style.transform=""}),t}createTopBar(s){return this.player.createElement("div","top-bar").addClasses(["top-bar","-translate-y-[100vh]","absolute","flex","gap-2","items-start","justify-between","mb-auto","pb-[10%]","px-6","py-4","top-0","w-available","z-10","pointer-events-none","group-[&.nomercyplayer.active]:translate-y-0","group-[&.nomercyplayer.paused]:translate-y-0","group-[&.nomercyplayer:has(.open)]:translate-y-0","group-[&.nomercyplayer:has(.volume-container:hover)]:!translate-y-0","transition-all","duration-200","bg-gradient-to-b","from-black/85","via-black/40","to-black/0"]).appendTo(s)}createTvCurrentItem(s){const t=this.player.createElement("div","current-item-container").addClasses(["flex","flex-col","justify-end","items-end","gap-2"]).appendTo(s),e=this.player.createElement("div","current-item-show").addClasses(["text-white","text-sm","whitespace-pre","font-bold"]).appendTo(t),i=this.player.createElement("div","current-item-title-container").addClasses(["flex","flex-row","gap-2"]).appendTo(t),l=this.player.createElement("div","current-item-episode").addClasses([]).appendTo(i),a=this.player.createElement("div","current-item-title").addClasses(["whitespace-pre","text-sm"]).appendTo(i);return this.player.on("item",()=>{var h,p;const n=this.player.playlistItem();e.innerHTML=L(n.show??""),l.innerHTML="",n.season&&(l.innerHTML+=`${this.player.localize("S")}${n.season}`),n.season&&n.episode&&(l.innerHTML+=`: ${this.player.localize("E")}${n.episode}`),a.innerHTML=M(((h=n.title)==null?void 0:h.replace(n.show??"","").length)>0?`"${(p=n.title)==null?void 0:p.replace(n.show??"","").replace("%S",this.player.localize("S")).replace("%E",this.player.localize("E"))}"`:"")}),t}createLanguageMenuButton(s,t,e=!1){const i=this.player.createElement("button",`${t.type}-button-${t.language}`).addClasses(this.languageMenuStyles).appendTo(s),l=this.player.createElement("span","menu-button-text").addClasses(this.menuButtonTextStyles).appendTo(i);t.buttonType=="subtitle"?t.styled?l.innerText=`${this.player.localize(t.language??"")} ${this.player.localize(t.label)} ${this.player.localize("styled")}`:t.language==""?l.innerText=this.player.localize(t.label):l.innerText=`${this.player.localize(t.language??"")} (${this.player.localize(t.type)})`:l.innerText=this.player.localize(t.language);const a=this.createSVGElement(i,"checkmark",this.buttons.checkmark,!1,e);return this.player.addClasses(a,["ml-auto"]),t.id>0&&a.classList.add("hidden"),t.buttonType=="audio"?(this.player.on("audioTrackChanging",n=>{t.id===n.id?a.classList.remove("hidden"):a.classList.add("hidden")}),i.addEventListener("click",n=>{n.stopPropagation(),this.player.setCurrentAudioTrack(t.id),this.player.emit("show-menu",!1)})):t.buttonType=="subtitle"&&(t.id===this.player.getCaptionIndex()?a.classList.remove("hidden"):a.classList.add("hidden"),this.player.on("captionsChanged",n=>{t.id===n.id?a.classList.remove("hidden"):a.classList.add("hidden")}),i.addEventListener("click",n=>{n.stopPropagation(),this.player.setCurrentCaption(t.id),this.player.emit("show-menu",!1)})),this.addKeyEventsToLanguageButton(i,s),i}snakeToCamel(s){return s.replace(/_([a-z])/g,(t,e)=>e.toUpperCase())}spaceToCamel(s){return s.replace(/\s([a-z])/g,(t,e)=>e.toUpperCase())}getClosestElement(s,t){const e=Array.from(document.querySelectorAll(t)).filter(l=>getComputedStyle(l).display=="flex"),i=s.getBoundingClientRect();return e.find(l=>l.getBoundingClientRect().top+l.getBoundingClientRect().height/2==P(e.map(a=>a.getBoundingClientRect().top+a.getBoundingClientRect().height/2),i.top+i.height/2))}addKeyEventsToLanguageButton(s,t){s.addEventListener("keypress",e=>{var i,l,a,n;e.key=="ArrowLeft"?(i=this.getClosestElement(s,'[id^="audio-button-"]'))==null||i.focus():e.key=="ArrowRight"?(l=this.getClosestElement(s,'[id^="subtitle-button-"]'))==null||l.focus():e.key=="ArrowUp"&&!this.player.options.disableTouchControls?(a=s.previousElementSibling)==null||a.focus():e.key=="ArrowDown"&&!this.player.options.disableTouchControls&&((n=s.nextElementSibling)==null||n.focus())}),s.addEventListener("focus",()=>{setTimeout(()=>{this.scrollCenter(s,t.parentElement,{margin:1,duration:100})},50)})}createThumbnail(s){const t=this.player.createElement("div",`thumbnail-${s.start}`).addClasses(["w-1/5","h-auto","object-cover","aspect-video","snap-center"]).get();return t.style.backgroundImage=`url('${(this.player.options.basePath?this.player.options.basePath:"")+this.image}${this.player.options.accessToken?`?token=${this.player.options.accessToken}`:""}')`,t.style.backgroundPosition=`-${s.x}px -${s.y}px`,t.style.width=`max(232px, ${s.w}px)`,t.style.minWidth=`max(232px, ${s.w}px)`,t.style.aspectRatio=`${s.w} / ${s.h}`,this.thumbnailClone.style.aspectRatio=`${s.w} / ${s.h}`,this.thumbnailClone.style.width=`max(232px, ${s.w}px)`,this.thumbnailClone.style.minWidth=`max(232px, ${s.w}px)`,t}getSliderPopImage(s){const t=this.loadSliderPopImage(s);t&&(this.sliderPopImage.style.backgroundPosition=`-${t.x}px -${t.y}px`,this.sliderPopImage.style.width=`${t.w}px`,this.sliderPopImage.style.height=`${t.h}px`,this.chapterText.style.width=`${t.w}px`)}adjustScaling(s,t){const e=s%t;return e%1!==0&&(s/=e/Math.round(e)),e>1&&(s*=e),s}loadSliderPopImage(s){this.fetchPreviewTime();let t=this.previewTime.find(e=>s.scrubTimePlayer>=e.start&&s.scrubTimePlayer<e.end);return t||(t=this.previewTime.at(-1)),t}getScrubTime(s,t=this.sliderBar){var a,n,h,p;const e=t.getBoundingClientRect();let l=(s.clientX??((n=(a=s.touches)==null?void 0:a[0])==null?void 0:n.clientX)??((p=(h=s.changedTouches)==null?void 0:h[0])==null?void 0:p.clientX)??0)-e.left;return l<=0&&(l=0),l>=e.width&&(l=e.width),{scrubTime:l/t.offsetWidth*100,scrubTimePlayer:l/t.offsetWidth*this.player.getDuration()}}setEpisode(s,t){const e=this.player.getPlaylist().findIndex(i=>i.season==s&&i.episode==t);e==-1?this.player.playlistItem(0):this.player.playlistItem(e),this.player.play().then()}scrollCenter(s,t,e){if(!s)return;const i=(e==null?void 0:e.duration)||60,l=(e==null?void 0:e.margin)||1.5,a=s.getBoundingClientRect().top+s.getBoundingClientRect().height/2-t.getBoundingClientRect().height/l,n=t.scrollTop,h=performance.now();function p(u){const o=u-h,y=Math.min(o/i,1);t.scrollTo(0,Math.floor(n+a*y)),o<i&&requestAnimationFrame(p)}requestAnimationFrame(p)}}export{U as B};
