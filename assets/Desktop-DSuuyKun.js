import{Bt as fe,D as me,Dn as Q,Ht as w,In as he,Rn as d,Sn as z,Tn as i,Vt as ge,Wn as x,Yt as k,Zn as y,_n as T,cn as f,en as c,er as j,in as h,nn as m,rn as $,tn as l,tr as C,u as ye,un as P,x as xe}from"./index-04Sh3wNb.js";import"./dist-CVoPesok.js";import"./esm-BuFVrMo0.js";import"./esm-9iWgK55i.js";import"./esm-cDzTb79E.js";import"./esm-BfF1RlcU.js";import"./dist-B3n7-doU.js";import"./focus-visible-CHAJCf_J.js";import"./index5-B30D6T27.js";import"./client-rtF7IPPI.js";import"./ionic-global--aoJHCDL.js";import"./hardware-back-button-h528z6zo.js";import"./index3-CSo3jo06.js";import"./helpers-CXS86XKs.js";import"./index6-CZ6rqL_0.js";import"./index8-BpkFXja0.js";import"./keyboard-cU79cwdW.js";import"./index2-op38TIl9.js";import"./ios.transition-C8T7q-Bo.js";import"./keyboard2-DETZ41vp.js";import"./md.transition-BqH5iNQr.js";import"./dir-BUtgAzbR.js";import{n as _e,t as be}from"./basecomponent-Dw-Pzf3B.js";import{M as ee,O as te,P as _,j as K}from"./ui-BT6EUdI0.js";import{m as re}from"./client-DMa-uSBE.js";import{t as ae}from"./currentServer-B7-kbkE-.js";import"./config-BOA2pGQM.js";import"./esm-CcKFjObu.js";import{g as we,h as oe,l as F}from"./global-gyhCjh_P.js";import"./esm-BuRgllmc.js";import"./user-C1ciKa7-.js";import"./serverClient-FHPKIHPu.js";import"./router-C_xBvmya.js";import"./utils-D5DD-7jP.js";import"./useBaseQuery-CNJp2kAB.js";import"./useInfiniteServerClient-By5CuBlL.js";import{o as Ce}from"./SocketClient-DPmgFkP-.js";import"./useQueryClient-s6ZLwuD6.js";import"./useQuery-C7DDAmeN.js";import"./apiClient-Cw7f36ko.js";import"./notifications-Bi_dU6lP.js";import"./utils-CdenF_Jv.js";import"./bundle-mjs-Xm_uQvzT.js";import"./deviceInfo-Bcw3-ht5.js";import"./helpers-fSCF1qXj.js";import"./auth-DfyD43WY.js";import"./_plugin-vue_export-helper-B_iOTHZb.js";import"./MoooomIcon-DNWQYuYD.js";import"./dist-iWIfSzlj.js";import"./KeepCounting-YCks9kYD.js";import"./card-D438fss_.js";import{t as A}from"./useServerClient-CroZbKWw.js";import"./ScrollContainer-3_hZWeKa.js";import{t as ke}from"./useMounted-CBZpV1fi.js";import{s as Se}from"./RipperOverlay-BWEr7uxe.js";import"./HubConnection-BtQMN1V5.js";import"./ripperSocket-C9kIp3Ty.js";import"./Button-BOqv4y1r.js";import"./FloatingBackButton-D3UgtlFi.js";import{n as b,r as E,t as Pe}from"./DashboardLayout-CXf1x5EO.js";import{t as Oe}from"./ActivityCard-DDchTKUS.js";import{n as H,r as R,t as W}from"./ServerSystemInfoCard-CzYJuWvu.js";w();var $e=_e.extend({name:"chart",classes:{root:"p-chart"},inlineStyles:{root:{position:"relative"}}});ge();var je={name:"BaseChart",extends:be,props:{type:String,data:null,options:null,plugins:null,width:{type:Number,default:300},height:{type:Number,default:150},canvasProps:{type:null,default:null}},style:$e,provide:function(){return{$pcChart:this,$parentInstance:this}}},se={name:"Chart",extends:je,inheritAttrs:!1,emits:["select","loaded"],chart:null,watch:{data:{handler:function(){this.reinit()},deep:!0},type:function(){this.reinit()},options:function(){this.reinit()}},mounted:function(){this.initChart()},beforeUnmount:function(){this.chart&&(this.chart.destroy(),this.chart=null)},methods:{initChart:function(){var e=this;fe(()=>import("./auto-CKvpBuCa.js"),[]).then(function(r){e.chart&&(e.chart.destroy(),e.chart=null),r&&r.default&&(e.chart=new r.default(e.$refs.canvas,{type:e.type,data:e.data,options:e.options,plugins:e.plugins})),e.$emit("loaded",e.chart)})},getCanvas:function(){return this.$canvas},getChart:function(){return this.chart},getBase64Image:function(){return this.chart.toBase64Image()},refresh:function(){this.chart&&this.chart.update()},reinit:function(){this.initChart()},onCanvasClick:function(e){if(this.chart){var r=this.chart.getElementsAtEventForMode(e,"nearest",{intersect:!0},!1),a=this.chart.getElementsAtEventForMode(e,"dataset",{intersect:!0},!1);r&&r[0]&&a&&this.$emit("select",{originalEvent:e,element:r[0],dataset:a})}},generateLegend:function(){if(this.chart)return this.chart.generateLegend()}}};function S(t){"@babel/helpers - typeof";return S=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(t)}function Y(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(u){return Object.getOwnPropertyDescriptor(t,u).enumerable})),r.push.apply(r,a)}return r}function Z(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Y(Object(r),!0).forEach(function(a){Ae(t,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Y(Object(r)).forEach(function(a){Object.defineProperty(t,a,Object.getOwnPropertyDescriptor(r,a))})}return t}function Ae(t,e,r){return(e=Re(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Re(t){var e=De(t,"string");return S(e)=="symbol"?e:e+""}function De(t,e){if(S(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var a=r.call(t,e);if(S(a)!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Ie=["width","height"];function Me(t,e,r,a,u,p){return i(),h("div",T({class:t.cx("root"),style:t.sx("root")},t.ptmi("root")),[l("canvas",T({ref:"canvas",width:t.width,height:t.height,onClick:e[0]||(e[0]=function(n){return p.onCanvasClick(n)})},Z(Z({},t.canvasProps),t.ptm("canvas"))),null,16,Ie)],16)}se.render=Me;w();var Ne={class:"flex flex-shrink-0 flex-grow-0 items-start justify-start gap-4 self-stretch text-slate-11/80 dark:text-slate-11/80"},Be={class:"flex flex-grow flex-col items-start justify-start gap-1 text-left"},Ue={class:"relative flex flex-shrink-0 flex-grow-0 items-center justify-start self-stretch"},ze={class:"w-8 flex-shrink-0 flex-grow-0 text-sm"},Ee={class:"relative h-2 flex-grow rounded-lg"},Ve={class:"w-10 flex-shrink-0 flex-grow-0 text-right text-sm"},qe=P({__name:"ResourceBar",props:{cpu:{type:Number,required:!0,default:0},value:{type:Number,required:!0,default:0}},setup(t){const e=t,r=c(()=>re.value?te(e.value,ee):"var(--color-theme-8)");return(a,u)=>(i(),h("div",Ne,[l("div",Be,[l("div",Ue,[l("p",ze,C(t.cpu),1),l("div",Ee,[u[0]||(u[0]=l("div",{class:"absolute h-2 w-full rounded left-[-1px] top-[-1px] bg-surface-2 dark:bg-surface-1"},null,-1)),l("div",{style:j({width:`${t.value}%`,backgroundImage:`linear-gradient(90deg, ${r.value} 0%, ${r.value} 100%)`}),class:"absolute h-2 rounded transition-all duration-500 left-[-1px] top-[-1px]"},null,4)]),l("p",Ve,C(Math.floor(t.value))+"% ",1)])])]))}}),Ge=qe;w();var Le={class:"relative flex aspect-video h-auto w-full flex-1 flex-shrink-0 flex-col items-start justify-center gap-1 flex-grow-1 text-surface-12/11"},Te={class:"relative h-full flex-1 flex-shrink-0 w-available"},Ke={class:"absolute top-2/3 left-1/2 -translate-x-1/2 text-center font-semibold text-[2.5vw] monospace sm:text-[1.5vw] md:text-[2vw] lg:text-[1.2vw] 2xl:text-[1vw] 5xl:text-[0.6vw]"},Fe={class:"flex-shrink-0 flex-grow-0 scale-75 self-stretch text-center text-sm font-semibold w-available text-[2.5vw] sm:text-[1.5vw] md:text-[2vw] lg:text-[1.2vw] 2xl:text-[1vw] 5xl:text-[0.7vw]"},He=P({__name:"ResourceCircle",props:{name:{type:String,required:!0},value:{type:Number,required:!0},size:{type:Number,required:!0}},setup(t){const e=t,r=c(()=>{if(re.value)return te(e.value,ee);switch(e.name){case"CPU":return _(we,50);case"Memory":return _(oe,50);case"GPU":return _(F,50);default:return _(F,50)}}),a=c(()=>Math.PI*72),u=c(()=>(1-(e.value===-1?0:e.value)/100)*a.value);return(p,n)=>(i(),h("div",Le,[l("div",Te,[(i(),h("svg",{style:j({width:t.size*2,height:t.size*2}),class:"absolute inset-2 mx-auto rounded",fill:"none",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 152 148",xmlns:"http://www.w3.org/2000/svg"},[n[0]||(n[0]=l("path",{class:"stroke-black/50",d:"M148 76C148 66.5448 146.138 57.1822 142.519 48.4468C138.901 39.7114 133.598 31.7741 126.912 25.0883C120.226 18.4025 112.289 13.099 103.553 9.48068C94.8178 5.86234 85.4552 4 76 4C66.5448 3.99999 57.1823 5.86232 48.4468 9.48066C39.7114 13.099 31.7742 18.4025 25.0883 25.0883C18.4025 31.7741 13.099 39.7113 9.48069 48.4468C5.86234 57.1822 4 66.5448 4 76","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"8"},null,-1)),l("path",{style:j({stroke:r.value,strokeDasharray:a.value,strokeDashoffset:u.value}),class:"absolute -top-1 -left-1 h-2 rounded transition-all duration-500",d:"M4 76C4 56.9044 11.5857 38.5909 25.0883 25.0883C38.5909 11.5857 56.9044 4 76 4C95.0956 4 113.409 11.5857 126.912 25.0883C140.414 38.5909 148 56.9044 148 76","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"8"},null,4)],4)),l("p",Ke,C(t.value===-1?p.$t(""):Math.floor(t.value))+C(t.value===-1?"":"%"),1)]),l("p",Fe,C(t.name),1)]))}}),U=He;w();var We={class:"flex items-start justify-between gap-2 overflow-clip w-available text-surface-12/80"},Ye={class:"flex flex-shrink-0 flex-grow-0 flex-col items-start justify-start self-stretch"};var Ze=P({__name:"ServerResourceCard",setup(t){const{data:e}=A({path:"dashboard/server/info",queryKey:["serverInfo",ae.value?.serverBaseUrl]}),r=x(),a=x("graph"),u=x(Array.from({length:40}).fill("")),p=x(Array.from({length:40}).fill(null)),n=x(Array.from({length:40}).fill(null)),D=x(Array.from({length:40}).fill([null]));ke(()=>b.value?.invoke("StartResources"),()=>b.value?.invoke("StopResources").catch(),10);function le(){b.value?.invoke("StartResources")}z(()=>{Ce()?.onreconnected(le)});const V=c(()=>r.value?.cpu?.core?.toSorted((o,s)=>o.index-s.index)??[]),I=c(()=>r.value?.gpu?.toSorted((o,s)=>o.index-s.index).map(o=>(o.power+o.core)/2)??[]),q=c(()=>r.value?.cpu?.core?.length?Math.floor(V.value?.reduce((o,s)=>o+s.utilization,0)/V.value.length):-1),G=c(()=>r.value?.memory?.percentage==="NaN"?-1:r.value?.memory?.percentage??-1),ne=c(()=>{if(r.value?.gpu?.length===0)return-1;const o=Math.floor(I.value?.reduce((s,v)=>s+v,0)/I.value.length);return Number.isNaN(o)?-1:o}),M=c(()=>(window.innerWidth-5e3)/3);function ie(o){if(o.length===1)return[{color:K(o[0]),opacity:50}];const B=(75-25)/(3-1),L=[];for(let O=0;O<o.length;O++){const de=25+O%3*B;L.push({color:K(o[O]),opacity:de})}return L}function ue(o){o&&(r.value=o,p.value=[...p.value.slice(-40),q.value],n.value=[...n.value.slice(-40),G.value],D.value=[...D.value.slice(-40),I.value])}Se(b,"ResourceUpdate",ue);const ce=c(()=>({labels:u.value,datasets:[...e.value?.cpu?.map((o,s)=>{const v="#94f";return{label:`CPU ${e.value?.cpu.length>1?s:""}`,data:p.value,yAxisID:"y",borderColor:_(v,50)}})??[],{label:"Memory",data:n.value,yAxisID:"y",borderColor:_(oe,50)},...e.value?.gpu?.map((o,s)=>{const v=ie(e.value?.gpu)[s],g=_(v.color,v.opacity);return{label:`GPU ${e.value?.gpu.length>1?s:""}`,data:D.value.map(B=>B[s]),yAxisID:"y",borderColor:g}})??[]]})),N=ye("legendPosition","bottom"),pe=c(()=>{const o=getComputedStyle(document.documentElement),s=o.getPropertyValue("--surface-12"),v=o.getPropertyValue("--p-content-border-color"),g=["left","top","right","bottom"];return{indexAxis:"x",maintainAspectRatio:!1,animation:!1,plugins:{legend:{labels:{color:s},value:N.value,onClick(){N.value=g[(g.indexOf(N.value)+1)%g.length]}}},elements:{line:{tension:.2},point:{pointStyle:!1}},scales:{x:{ticks:{color:"transparent"},grid:{color:"transparent"}},y:{min:0,max:100,beginAtZero:!0,clip:!0,ticks:{color:s},grid:{color:v}}}}}),ve=c(()=>`${(e.value?.gpu?.length??0)*40+120}px`);return(o,s)=>(i(),m(R,{title:"Resources monitor"},{cta:d(()=>[...s[0]||(s[0]=[])]),default:d(()=>[l("div",We,[f(U,{size:M.value,value:q.value,name:"CPU"},null,8,["size","value"]),s[1]||(s[1]=l("div",{class:"w-px flex-shrink-0 flex-grow-0 self-stretch bg-white/10"},null,-1)),f(U,{size:M.value,value:G.value,name:"Memory"},null,8,["size","value"]),s[2]||(s[2]=l("div",{class:"w-px flex-shrink-0 flex-grow-0 self-stretch bg-white/10"},null,-1)),f(U,{size:M.value,value:ne.value,name:"GPU"},null,8,["size","value"])]),l("div",Ye,[a.value==="bar"?(i(!0),h(k,{key:0},Q(r.value?.cpu?.core??[],(v,g)=>(i(),h(k,{key:v.index},[Number.isNaN(v.utilization)?$("",!0):(i(),m(Ge,{key:0,cpu:g,value:v.utilization},null,8,["cpu","value"]))],64))),128)):$("",!0),a.value==="graph"?(i(),m(y(se),{key:1,data:ce.value,options:pe.value,style:j(`height: ${ve.value}`),class:"w-available",type:"line"},null,8,["data","options","style"])):$("",!0)])]),_:1}))}}),X=Ze;w();var Xe=P({__name:"ServerActivityCard",setup(t){const{data:e}=A({path:"dashboard/activity",refetchInterval:1e4,data:{take:999},queryKey:["server","activity"]}),{data:r}=A({path:"dashboard/devices",refetchInterval:1e4,queryKey:["devices"]});return(a,u)=>y(E)?(i(),m(R,{key:0,title:"Activity",background:!1},{cta:d(()=>[...u[0]||(u[0]=[])]),default:d(()=>[(i(!0),h(k,null,Q(y(e)?.slice(0,5)??[],p=>(i(),m(Oe,{key:p?.id,devices:y(r)??[],activity:p},null,8,["devices","activity"]))),128))]),_:1})):$("",!0)}}),J=Xe;w();var Je={class:"col-span-3 col-start-1 flex flex-col gap-4 lg:col-span-2 xl:col-span-2 xl:col-start-1 xl:row-start-1"},Qe={class:"col-span-3 col-start-1 flex flex-col gap-4 lg:col-span-2 xl:col-span-2 xl:col-start-3 xl:row-start-1"},et={class:"col-span-3 col-start-1 flex flex-col gap-4 lg:col-span-2 lg:col-start-1 lg:row-start-2 2xl:col-span-2 2xl:col-start-5 2xl:row-start-1 2xl:flex"},tt=P({__name:"Desktop",setup(t){const e=x(!0);he(b,p=>{e.value=!!p}),z(()=>{setTimeout(()=>{e.value=!!b.value},1e3)});const{data:r,error:a}=A({path:"dashboard/server/storage",queryKey:["dashboard","storage",ae.value?.serverBaseUrl]});z(()=>{console.raw(r.value)});const u=c(()=>window.CSS.supports("grid-template-rows: masonry"));return(p,n)=>(i(),m(y(me),null,{default:d(()=>[f(y(xe),{fullscreen:!0},{default:d(()=>[f(Pe,{"grid-style":u.value?3:2,styles:"grid-template-rows: masonry; masonry-surface-flow: next;",title:"Dashboard overview"},{cta:d(()=>[...n[0]||(n[0]=[])]),default:d(()=>[u.value?(i(),h(k,{key:0},[f(W),f(H),f(J),y(E)?(i(),m(X,{key:0})):(i(),m(R,{key:1,class:"animate-pulse",title:"Resources monitor"},{cta:d(()=>[...n[1]||(n[1]=[])]),default:d(()=>[n[2]||(n[2]=l("div",{class:"min-h-80"},null,-1))]),_:1}))],64)):(i(),h(k,{key:1},[l("div",Je,[f(W),y(E)?(i(),m(X,{key:0})):(i(),m(R,{key:1,class:"animate-pulse",title:"Resources monitor"},{cta:d(()=>[...n[3]||(n[3]=[])]),default:d(()=>[n[4]||(n[4]=l("div",{class:"min-h-80"},null,-1))]),_:1}))]),l("div",Qe,[f(H)]),l("div",et,[f(J)])],64))]),_:1},8,["grid-style"])]),_:1})]),_:1}))}}),pr=tt;export{pr as default};
