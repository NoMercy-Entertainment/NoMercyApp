{"version":3,"file":"Mobile-CAbVbR5q.js","sources":["../../src/views/Setup/ServerOffline/Mobile.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport {onMounted, watch} from \"vue\";\nimport {IonPage, IonContent} from '@ionic/vue';\nimport router from '@/router';\n\nimport type {LibrariesResponse} from \"@/types/api/base/library\";\nimport type {Playlist} from \"@/types/api/music/playlists\";\nimport type {LogoResponse} from \"@/types/server\";\n\nimport useServerClient from \"@/lib/clients/useServerClient\";\nimport {setLibraries} from \"@/store/Libraries\";\nimport {setMusicPlaylists} from \"@/store/musicPlaylists\";\n\nimport ExploreContainer from '@/components/ExploreContainer.vue';\n\nconst {data: libraries, refetch} = useServerClient<LibrariesResponse[]>({\n  path: '/libraries',\n  refetchInterval: 10000,\n  queryKey: ['libraries'],\n});\n\nconst {data: playlists, refetch: refetchPlaylists} = useServerClient<Playlist[]>({\n  enabled: !!libraries.value,\n  path: '/music/playlists',\n  queryKey: ['playlists'],\n});\n\nconst { refetch: refetchScreensaver } = useServerClient<LogoResponse[]>({\n  enabled: !!libraries.value,\n  path: '/screensaver',\n});\n\nwatch(libraries, async (value) => {\n  if (!value) return;\n  await refetchPlaylists();\n  await refetchScreensaver();\n\n  setLibraries(value);\n\n  if (value.length > 0) {\n    await router.replace({name: 'Home'})\n        .catch(() => {})\n        .then(() => {\n      console.log('Replaced to Home');\n    });\n  }\n});\n\nwatch(playlists, (value) => {\n  if (!value) return;\n  setMusicPlaylists(value);\n});\n\nonMounted(() => {\n  if (!libraries.value) return;\n  if (libraries.value.length > 0) {\n    router.replace({name: 'Home'})\n        .catch(() => {})\n        .then(() => {\n          console.log('Replaced to Home');\n        });\n  }\n});\n\n</script>\n\n<template>\n  <ion-page>\n    <ion-content :fullscreen=\"true\">\n      <ExploreContainer name=\"Server offline\" />\n    </ion-content>\n  </ion-page>\n</template>\n"],"names":["libraries","refetch","useServerClient","playlists","refetchPlaylists","refetchScreensaver","watch","value","setLibraries","router","setMusicPlaylists","onMounted"],"mappings":"yLAeA,KAAM,CAAC,KAAMA,EAAW,QAAAC,CAAA,EAAWC,EAAqC,CACtE,KAAM,aACN,gBAAiB,IACjB,SAAU,CAAC,WAAW,CAAA,CACvB,EAEK,CAAC,KAAMC,EAAW,QAASC,CAAA,EAAoBF,EAA4B,CAC/E,QAAS,CAAC,CAACF,EAAU,MACrB,KAAM,mBACN,SAAU,CAAC,WAAW,CAAA,CACvB,EAEK,CAAE,QAASK,CAAmB,EAAIH,EAAgC,CACtE,QAAS,CAAC,CAACF,EAAU,MACrB,KAAM,cAAA,CACP,EAEK,OAAAM,EAAAN,EAAW,MAAOO,GAAU,CAC3BA,IACL,MAAMH,EAAiB,EACvB,MAAMC,EAAmB,EAEzBG,EAAaD,CAAK,EAEdA,EAAM,OAAS,GACX,MAAAE,EAAO,QAAQ,CAAC,KAAM,MAAO,CAAA,EAC9B,MAAM,IAAM,CAAA,CAAE,EACd,KAAK,IAAM,CACd,QAAQ,IAAI,kBAAkB,CAAA,CAC/B,EACH,CACD,EAEKH,EAAAH,EAAYI,GAAU,CACrBA,GACLG,EAAkBH,CAAK,CAAA,CACxB,EAEDI,EAAU,IAAM,CACTX,EAAU,OACXA,EAAU,MAAM,OAAS,GAC3BS,EAAO,QAAQ,CAAC,KAAM,MAAO,CAAA,EACxB,MAAM,IAAM,CAAA,CAAE,EACd,KAAK,IAAM,CACV,QAAQ,IAAI,kBAAkB,CAAA,CAC/B,CACP,CACD"}