{"version":3,"file":"Mobile-DqyzKRp1.js","sources":["../../src/views/Base/Person/Mobile.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { computed, ref, watch } from 'vue';\nimport { IonPage, IonContent, IonSkeletonText, onIonViewWillEnter, onIonViewWillLeave } from '@ionic/vue';\nimport { useRoute } from \"vue-router\";\nimport { Swiper as SwiperComponent } from 'swiper/vue';\n\nimport type { PersonResponseItem } from \"@/types/api/base/person\";\n\nimport { tmdbImageBaseUrl } from \"@/config/config\";\nimport i18next from \"@/config/i18next\";\nimport { background, setBackground, setColorPalette } from '@/store/ui';\n\nimport useServerClient from \"@/lib/clients/useServerClient\";\nimport { breakTitle2, setTitle, unique } from \"@/lib/stringArray\";\n\nimport CreditGroup from \"@/components/MusicPlayer/components/CreditGroup.vue\";\nimport MediaCarousel from \"@/components/Carousel/MediaCarousel.vue\";\nimport TMDBImage from \"@/components/Images/TMDBImage.vue\";\nimport { isNative } from \"@/config/global\";\nimport SocialLinkItems from \"@/views/Base/Person/components/SocialLinkItems.vue\";\nimport HeaderItem from \"@/views/Base/Person/components/HeaderItem.vue\";\nimport Collapsible from \"@/views/Base/Person/components/Collapsible.vue\";\n\nconst route = useRoute();\nconst { data, isError } = useServerClient<PersonResponseItem>({\n  queryKey: ['base', 'person', route.params.id],\n});\n\nconst backgroundUrl = computed(() => {\n  if(!data.value?.known_for?.at(0)?.backdrop) return null;\n  return `${tmdbImageBaseUrl}/original${data?.value?.known_for?.at(0)?.backdrop ?? background}`;\n  // return `${currentServer.value?.serverBaseUrl}/images/original${background.value}`;\n});\n\nconst age = computed(() => {\n  if (data.value?.deathday) {\n    const birthDate = new Date(data.value?.birthday);\n    const deathDay = new Date(data.value?.deathday);\n    const a = deathDay.getFullYear() - birthDate.getFullYear();\n    const m = deathDay.getMonth() - birthDate.getMonth();\n    if (m < 0 || (m === 0 && deathDay.getDate() < birthDate.getDate())) {\n      return a - 1;\n    }\n    return a;\n  }\n  if (data.value?.birthday) {\n    const birthDate = new Date(data.value?.birthday);\n    const currentDate = new Date();\n    const a = currentDate.getFullYear() - birthDate.getFullYear();\n    const m = currentDate.getMonth() - birthDate.getMonth();\n    if (m < 0 || (m === 0 && currentDate.getDate() < birthDate.getDate())) {\n      return a - 1;\n    }\n    return a;\n  }\n  return null;\n});\n\nconst gender = computed(() => {\n  if (typeof data.value?.gender !== 'number') return data.value?.gender;\n\n  switch (data.value?.gender) {\n    case 0:\n      return 'Not specified';\n    case 1:\n      return 'Female';\n    case 2:\n      return 'Male';\n    case 3:\n      return 'Non-binary';\n    default:\n      return null;\n  }\n});\n\nwatch(data, (value) => {\n  setTitle(data?.value?.name);\n  setBackground(value?.known_for?.at(0)?.backdrop ?? null);\n  setColorPalette(value?.color_palette?.profile);\n});\n\nonIonViewWillEnter(() => {\n  setTitle(data?.value?.name);\n  setBackground(data?.value?.known_for?.at(0)?.backdrop ?? null);\n  setColorPalette(data?.value?.color_palette?.profile);\n});\n\nonIonViewWillLeave(() => {\n  setBackground(null);\n  setColorPalette(null);\n});\n\nconst filter = 'combined';\n\nconst currentImage = ref(data.value?.images?.profiles?.[0]);\n\nwatch(data, (value) => {\n  currentImage.value = value?.images?.profiles?.[0];\n});\n\n</script>\n\n<template>\n  <ion-page>\n    <ion-content ref=\"content\" :fullscreen=\"true\"\n      :style=\"`--background-image: ${backgroundUrl && !backgroundUrl.includes('null') ? `url(${backgroundUrl})` : ''};`\">\n\n      <div\n          class=\"flex flex-col justify-start items-center self-stretch flex-grow h-auto gap-4 will-change-auto text-slate-lightA-12/70 dark:text-slate-darkA-12/80 z-10 absolute left-0 w-full\"\n          style=\"box-shadow: 0 2px 2px 0 rgba(0,0,0,0.16);\">\n        <div class=\"flex justify-start items-end flex-grow-0 flex-shrink-0 -mx-4 w-available h-[410px] relative gap-2\">\n\n      <SwiperComponent ref=\"swiper\" :slides-per-view=\"1\" :loop=\"true\" class=\"w-available swiper h-[420px] !absolute\"\n        :class=\"{\n          'top-safe-offset-4': isNative,\n          'top-12': !isNative,\n        }\">\n        <template v-for=\"(item, index) in data?.images?.profiles ?? []\" :key=\"item.id\">\n          <swiper-slide class=\"h-full\" :data-index=\"index\" :data-id=\"item.src\">\n            <div class=\"frosting w-[280px] h-[420px] z-10 absolute left-1/2 -translate-x-1/2 overflow-clip rounded-2xl\">\n\n              <TMDBImage v-if=\"item\" :key=\"item.src ?? 'poster'\" :autoShadow=\"true\" :path=\"item.src\" :size=\"760\"\n                priority=\"high\" :title=\"data?.name\" aspect=\"poster\" loading=\"eager\"\n                className=\"pointer-events-none absolute -inset-1 z-20 flex h-auto scale-100 select-none items-center overflow-hidden w-available h-available max-h-available\"\n                class=\"m-auto children:w-full scale-100 max-h-available 5xl:w-inherit\" type=\"image\" />\n\n            </div>\n          </swiper-slide>\n        </template>\n      </SwiperComponent>\n        </div>\n      </div>\n\n      <div\n        class=\"flex flex-col justify-start items-center self-stretch flex-grow gap-4 will-change-auto text-slate-lightA-12/70 dark:text-slate-darkA-12/80 z-0\"\n        style=\"box-shadow: 0 2px 2px 0 rgba(0,0,0,0.16);\">\n        <div class=\"flex justify-start items-end -mx-4 w-available h-[410px] relative gap-2\">\n          <div\n            class=\"absolute flex flex-col justify-start items-end flex-grow w-available -mx-20 h-[410px] bg-cover bg-top\"\n            style=\"background: linear-gradient(0deg, rgba(0, 0, 0, 0.50) 0%, rgba(0, 0, 0, 0.50) 100%), var(--background-image) lightgray 50% / cover no-repeat;\">\n          </div>\n          <div\n            class=\"absolute flex flex-col justify-start items-end flex-grow w-available -mx-20 h-[410px] bg-cover dark:bg-black/50\">\n          </div>\n        </div>\n\n        <div\n          class=\"flex bg-slate-light-3 dark:bg-slate-dark-1 flex-col justify-start items-start self-stretch gap-3 mt-16 pb-5 will-change-auto w-inherit px-6\">\n          <p v-if=\"data?.name\" class=\"self-stretch w-[351px] text-3xl font-bold text-left z-10\"\n            v-html=\"breakTitle2(data?.name ?? ' ', 'text-lg line-clamp-2')\">\n          </p>\n          <ion-skeleton-text v-else :animated=\"true\" class=\"h-7 will-change-auto\"></ion-skeleton-text>\n\n          <Collapsible v-if=\"data?.biography\" :text=\"data?.biography\" :maxLines=\"3\" />\n\n          <div class=\"flex flex-col gap-3 items-start flex-nowrap w-full\">\n\n            <div class=\"flex justify-between items-start flex-nowrap w-full\">\n\n              <HeaderItem v-if=\"data?.known_for_department\" title=\"Known for\" :data=\"data?.known_for_department\" />\n\n              <HeaderItem v-if=\"data?.combined_credits?.cast\" title=\"Credits\"\n                :data=\"data?.combined_credits?.cast.length.toString()\" />\n\n\n              <HeaderItem v-if=\"age\" title=\"Birthday\">\n                <template v-slot:head>\n                  <span v-if=\"data?.deathday\"\n                    class=\"ml-auto flex gap-1 text-xs font-bold uppercase text-auto-alpha-10 whitespace-nowrap\">\n                    <span v-if=\"data.deathday\" class=\"-mr-1 text-base -mt-[3px]\">&#8224;</span>\n                    {{\n                      new Date(data?.deathday!).toLocaleDateString(i18next.language ?? 'en-US', {\n                        year: 'numeric',\n                        month: 'short',\n                        day: '2-digit',\n                      })\n                    }}\n                  </span>\n                </template>\n\n                <p v-if=\"age\" class=\"text-left text-base font-medium self-center whitespace-nowrap\">{{\n                  new Date(data?.birthday!).toLocaleDateString(i18next.language ?? 'en-US', {\n                    year: 'numeric',\n                    month: 'short',\n                    day: '2-digit',\n                  })\n                }} ({{ age }} {{ $t('years old') }})\n                </p>\n\n              </HeaderItem>\n            </div>\n\n            <div class=\"flex gap-3 items-start justify-between flex-nowrap w-full\">\n\n              <HeaderItem v-if=\"gender\" title=\"Gender\" :data=\"gender\" />\n\n              <HeaderItem v-if=\"data?.place_of_birth\" title=\"Place of birth\" :data=\"data?.place_of_birth\" />\n\n            </div>\n\n          </div>\n\n          <div class=\"self-stretch h-px bg-slate-dark-7/[0.1] dark:bg-slate-dark-11/[0.1]\"></div>\n\n          <SocialLinkItems v-if=\"data\" :data=\"data\" />\n\n          <div class=\"mb-8 -ml-1 w-[101.5%]\">\n            <div class=\"ml-2 w-[100.6%]\">\n              <MediaCarousel v-if=\"data?.known_for && data?.known_for?.length > 0\" :color-palette=\"data?.color_palette\"\n                :data=\"unique(data.known_for, 'id')\" class=\"-mx-6\" title=\"Known for\" type=\"poster\" />\n            </div>\n          </div>\n\n          <div class=\"self-stretch h-px bg-slate-dark-7/[0.1] dark:bg-slate-dark-11/[0.1]\"></div>\n\n          <CreditGroup :items=\"data?.[`${filter}_credits`]?.cast\" title=\"Acting\" />\n          <CreditGroup :items=\"data?.[`${filter}_credits`]?.crew.filter((c: any) => c.job.includes('Produc'))\"\n            title=\"Production\" />\n          <CreditGroup :items=\"data?.[`${filter}_credits`]?.crew.filter((c: any) => c.job.includes('Writ'))\"\n            title=\"Writing\" />\n          <CreditGroup :items=\"data?.[`${filter}_credits`]?.crew.filter((c: any) => c.job.includes('Direct'))\"\n            title=\"Directing\" />\n          <CreditGroup\n            :items=\"data?.[`${filter}_credits`]?.crew.filter((c: any) => !c.job.includes('Produc') && !c.job.includes('Writ') && !c.job.includes('Direct') && !c.job.includes('Creator'))\"\n            title=\"Crew\" />\n          <CreditGroup :items=\"data?.[`${filter}_credits`]?.crew.filter((c: any) => c.job.includes('Creator'))\"\n            title=\"Creator\" />\n        </div>\n      </div>\n    </ion-content>\n  </ion-page>\n</template>\n\n<style scoped>\n:root {\n  --background-image: none;\n}\n</style>"],"names":["filter","route","useRoute","data","useServerClient","backgroundUrl","computed","_c","_b","_a","tmdbImageBaseUrl","_f","_e","_d","background","age","birthDate","deathDay","a","m","currentDate","gender","watch","value","setTitle","setBackground","setColorPalette","onIonViewWillEnter","onIonViewWillLeave","currentImage","ref"],"mappings":"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"}