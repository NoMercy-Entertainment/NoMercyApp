import{Bn as x,Bt as S,Gt as f,I as F,Ln as o,M as N,Mt as R,Rn as w,Rt as t,Tt as C,Vn as v,Vt as g,an as L,cn as n,fn as j,jt as H,kn as k,on as A,qt as $,un as E,xn as p,yn as D,zt as b}from"./index-BvWvvCYJ.js";import{L as G}from"./ui-Dy-CmVFO.js";import{t as K}from"./currentServer-WcAeFY_n.js";import{s as O}from"./user-UVXKBmDM.js";import{P as J,l as Q}from"./SocketClient-C4CiAzV3.js";import{m as P}from"./utils-TI96o6zm.js";import{t as W}from"./Select-DIUdVQ_d.js";import{s as _}from"./imageModal-CaU6FSL3.js";import{t as I}from"./TMDBImage-B3CKBjNq.js";import{t as q}from"./MoooomIcon-BaTKWN1R.js";import{n as X}from"./dist-BA3H0wD6.js";import{t as Y}from"./useServerClient-DLV471Yh.js";import{a as T,i as Z,t as ee}from"./sidebar-BSLRJAl-.js";import{n as V}from"./swiper-vue-CiFC3e_8.js";import{t as ae}from"./Carousel-CV0WquSE.js";import{a as te,i as le,r as re,t as oe}from"./VideoPlayer-Cvk_XBH8.js";C();var ie={class:"relative mb-1 h-auto w-full overflow-clip rounded-t-md group-focus-visible/season:rounded-b-none group-hover/season:rounded-b-none aspect-backdrop bg-surface-12/12"},se={class:"transitioning hover:scale-110 text-white/12",style:{"--stroke-width":"1"}},ne={key:0,class:"absolute bottom-0 left-0 z-40 mb-3 w-full px-3"},de=["id"],ue=["id"],ce={class:"grid w-full items-stretch gap-1 rounded-b-md p-2 transitioning text-left"},me=["title"],ve=["title"],fe={class:"relative mb-1 h-auto w-full overflow-clip rounded-t-md group-focus-visible/season:rounded-b-none group-hover/season:rounded-b-none aspect-backdrop bg-surface-1"},pe={class:"transitioning hover:scale-110",style:{"--stroke-width":"1"}},be={key:0,class:"absolute bottom-0 left-0 z-40 mb-3 w-full px-3"},ge=["id"],ye=["id"],he={class:"grid w-full items-stretch gap-1 rounded-b-md p-2 transitioning text-left"},xe=["title"],we=["title"],_e=$({__name:"SeasonCard",props:{data:{type:Object,required:!0},suffix:{type:String,required:!1,default:""}},setup(e){const l=G(e.data?.color_palette?.still);return(y,c)=>{const u=j("RouterLink");return e.data?.id&&e.data?.available?(n(),b(u,{key:0,id:e.data?.id,class:w([{"cursor-pointer":e.data?.available,"cursor-not-allowed":!e.data?.available},"frosting border-0 border-[var(--color-theme-8)] flex flex-col h-auto items-center group/season focus-shift focus-outline transition-all duration-200 overflow-clip relative !rounded-lg select-none shadow-[0px_0px_0_1px_rgb(from_var(--color-theme-8,var(--color-theme-6))_r_g_b/70%)] w-full z-0 bg-surface-2 text-surface-12/90"]),onfocus:o(P)(),style:x(o(l)?`
       --color-theme-8: ${o(l)};
    `:""),to:e.data?.available?e.data.link:"#","data-card":"true"},{default:p(()=>[t("div",ie,[f(I,{"color-palette":e.data?.color_palette?.still,path:e.data?.still,size:660,title:e.data?.title,aspect:"backdrop",class:"h-40","class-name":"pointer-events-none absolute z-20 flex h-full w-full select-none object-cover transitioning trickle-div",loading:"lazy",type:"image"},null,8,["color-palette","path","title"]),t("div",{class:w([{hidden:!e.data?.available},"absolute inset-0 z-30 grid w-full place-items-center group-focus-visible/season:bg-black opacity-0 group-focus-visible/season:opacity-100 transitioning group-hover/season:opacity-100 [background:radial-gradient(75%_50%_at_50%_50%,_rgba(0,_0,_0,_0.40)_0%,_rgba(0,_0,_0,_0.00)_100%),_rgba(0,_0,_0,_0.09)]"])},[t("div",se,[f(q,{"class-name":"w-20",icon:"playCircle",stroke:"1"})])],2),e.data?.progress?(n(),g("div",ne,[t("div",{id:`episode-${e.data?.id}-slider-container`,class:"relative z-40 flex h-1 w-full overflow-clip rounded-full pt-2 pr-8 bg-gray-dark-12"},[t("div",{id:`episode-${e.data?.id}-progress-bar`,style:x({width:e.data?.progress>=99?"100%":`${e.data?.progress}%`}),class:"absolute top-0 left-0 h-full bg-[var(--color-theme-8)]"},null,12,ue)],8,de)])):S("",!0)]),t("div",ce,[t("p",{title:`${e.data?.episode_number?`${e.data?.episode_number} - `:""}${e.data?.title}`,class:"z-10 w-auto text-2xs sm:text-sm font-bold !leading-5 h-10 line-clamp-2 sm:line-clamp-1"},v(e.data?.episode_number?`${e.data?.episode_number} - `:"")+v(e.data?.title),9,me),t("p",{title:e.data?.overview,class:"z-10 h-8 w-auto hidden sm:flex text-xs min-h-8 line-clamp-2 leading-[1.2]"},v(e.data?.overview),9,ve)])]),_:1},8,["id","class","onfocus","style","to"])):e.data?.id?(n(),g("div",{key:1,class:w(`border-0 border-[var(--color-theme-8)] flex flex-col h-auto items-center group/season focus-shift focus-outline transition-all duration-200 overflow-clip relative !rounded-lg select-none shadow-[0px_0px_0_1px_rgb(from_var(--color-theme-8,var(--color-theme-6))_r_g_b/70%)] w-full z-0 bg-surface-1/12 ${e.data?.available?"cursor-pointer":"cursor-not-allowed"}`),style:x(o(l)?`--color-theme-8: ${o(l)};`:""),"data-card":"true",onFocus:c[0]||(c[0]=m=>o(P)())},[t("div",fe,[f(I,{"color-palette":e.data?.color_palette?.still,path:e.data?.still,size:660,title:e.data?.title,aspect:"backdrop",class:"h-40","class-name":"pointer-events-none absolute z-20 flex h-full w-full select-none object-cover transitioning trickle-div",type:"image"},null,8,["color-palette","path","title"]),t("div",{class:w([{hidden:!e.data?.available},"absolute inset-0 z-30 grid w-full place-items-center group-focus-visible/season:bg-black opacity-0 group-focus-visible/season:opacity-100 transitioning group-hover/season:opacity-100 [background:radial-gradient(75%_50%_at_50%_50%,_rgba(0,_0,_0,_0.40)_0%,_rgba(0,_0,_0,_0.00)_100%),_rgba(0,_0,_0,_0.09)]"])},[t("div",pe,[f(q,{"class-name":"w-20",icon:"playCircle",stroke:"1"})])],2),e.data?.progress?(n(),g("div",be,[t("div",{id:`episode-${e.data?.id}-slider-container`,class:"relative z-40 flex h-1 w-full overflow-clip rounded-full pt-2 pr-8 bg-gray-dark-12"},[t("div",{id:`episode-${e.data?.id}-progress-bar`,style:x({width:e.data?.progress>=99?"100%":`${e.data?.progress}%`}),class:"absolute top-0 left-0 h-full bg-[var(--color-theme-8)]"},null,12,ye)],8,ge)])):S("",!0)]),t("div",he,[t("p",{title:`${e.data?.episode_number?`${e.data?.episode_number} - `:""}${e.data?.title}`,class:"z-10 w-auto text-sm font-bold !leading-5 h-10 line-clamp-1"},v(e.data?.episode_number?`${e.data?.episode_number} - `:"")+v(e.data?.title),9,xe),t("p",{title:e.data?.overview,class:"z-10 h-8 w-auto text-xs min-h-8 line-clamp-2 leading-[1.2]"},v(e.data?.overview),9,we)])],38)):S("",!0)}}}),B=_e;C();var ke=$({__name:"SeasonCarousel",props:{data:{type:Array,required:!0},type:{type:String,required:!1,default:"poster"},limitCardCountBy:{type:Number,required:!1}},setup(e){const l=e,{t:y}=X();function c(i){}let u=l.data?.findIndex(i=>i.season_number===1);u===-1&&(u=0);const m=l.data?.map((i,s)=>({index:s,id:i.id,name:`${i.season_number} - ${i.title}`,season_number:i.season_number,episodes:i.episodes}))??[],d=k(m[u]);function a(){document.querySelector(".swiper-undefined")?.swiper?.slideTo(0,300)}return D(d,a),(i,s)=>(n(),b(ae,{index:d.value.season_number,"limit-card-count-by":e.limitCardCountBy,type:e.type},{selector:p(()=>[f(W,{id:"season-selector",modelValue:d.value,"onUpdate:modelValue":s[0]||(s[0]=r=>d.value=r),disabled:o(m).length===1,items:o(m),"option-label":"title",class:"min-w-[21rem] ml-3",label:"",variant:"normal"},null,8,["modelValue","disabled","items"])]),default:p(()=>[d.value.episodes?.length===0?(n(),b(o(V),{key:0,class:"flex sm:p-1 sm:pl-0"},{default:p(()=>[(n(),b(B,{id:"item-0",key:0,data:{id:1,title:o(y)("To be announced"),season_number:null,episode_number:null,available:!1,overview:"",airDate:"",still:"",link:"",color_palette:{still:{darkVibrant:"",lightVibrant:""}},progress:null},onclick:()=>{}},null,8,["data"]))]),_:1})):(n(!0),g(R,{key:1},E(d.value.episodes,r=>(n(),b(o(V),{key:r.id,class:"flex sm:p-1 sm:pl-0"},{default:p(()=>[f(B,{id:`item-${r.id}`,data:r,onclick:()=>void 0},null,8,["id","data","onclick"])]),_:2},1024))),128))]),_:1},8,["index","limit-card-count-by","type"]))}}),He=ke;C();N();var Se=["data-music","data-sidebar"],Ce=$({__name:"Trailer",props:{videos:{type:Array,required:!0},toggle:{type:Function,required:!0},open:{type:Boolean,required:!0},title:{type:String,required:!0},index:{type:Number,required:!0},incrementTrailerIndex:{type:Function,required:!0}},setup(e){const l=e,y=F(),{data:c,isError:u}=Y({queryKey:["base","info",y.params.id,"trailer",l.videos[l.index].src],path:`trailer/${l.videos[l.index].src}`}),m=k(),d=k(),a=k();function i(s){const r={muted:!1,controls:!1,preload:"auto",debug:!1,autoPlay:!0,playlist:[s],controlsTimeout:3e3,doubleClickDelay:300,playbackRates:[.25,.5,.75,1,1.25,1.5,1.75,2],accessToken:O.value?.accessToken,basePath:K.value?.serverBaseUrl};a.value=re("trailer").setup(r),a.value?.once("back",()=>{l.toggle()});const z=new le;a.value?.registerPlugin("desktopUI",z),a.value?.usePlugin("desktopUI");const M=new te;a.value?.registerPlugin("autoSkip",M),a.value?.usePlugin("autoSkip");const U=new oe;a.value?.registerPlugin("keyHandler",U),a.value?.usePlugin("keyHandler"),a.value?.on("playlistComplete",()=>{console.log("Playlist complete"),l.toggle()}),a.value?.on("play",()=>{_(!0)}),a.value?.on("pause",()=>{_(!1)}),a.value?.on("fullscreen",h=>{window.external?.sendMessage?.(h?"enterFullscreen":"exitFullscreen")}),a.value?.on("remove",()=>{l.toggle(),l.incrementTrailerIndex()}),a.value?.on("error",()=>{l.toggle()}),a.value?.on("close",()=>{l.toggle()}),a.value?.on("captionsChanged",h=>{h.track===-1?localStorage.setItem("trailerSubtitles","off"):localStorage.setItem("trailerSubtitles",h.track)}),a.value?.once("playing",()=>{a.value?.seek(0)}),a.value?.on("play",()=>{localStorage.getItem("trailerSubtitles")==="off"?a.value?.setCurrentCaption(-1):a.value?.setCurrentCaption(Number.parseInt(localStorage.getItem("trailerSubtitles")??"-1",10))})}return D(c,s=>{!s||u.value||i(s)}),L(()=>{!c.value||u.value||(Q.stop(),d.value=T.value,_(!0),ee(),i(c.value))}),A(()=>{if(Z(d.value??"open"),_(!1),a.value)try{a.value?.dispose()}catch{}}),(s,r)=>(n(),g("button",{class:"fixed inset-0 h-available w-available overflow-hidden rounded-lg bg-black/50",onClick:r[1]||(r[1]=z=>e.toggle())},[t("div",{"data-music":o(J),"data-sidebar":o(T),class:"absolute inset-0 w-full h-auto max-w-full max-h-full sm:w-full sm:h-auto sm:overflow-hidden sm:inset-1/2 sm:aspect-video sm:-translate-y-[50%] px-4 py-2 xl:px-[1.8rem] sidebar-closed:xl:py-4 sm:-translate-x-[50%] sidebar-open:px-4 sidebar-open:py-6 sidebar-open:xl:px-[2.8rem] sidebar-open:xl:py-6"},[t("div",{ref_key:"trailerContainer",ref:m,class:"relative rounded-2xl flex overflow-clip mx-auto children:overflow-clip h-auto top-1/4 sm:top-1/2 sm:-translate-y-1/2 w-auto sm:w-fit max-w-available sm:h-full",onClick:r[0]||(r[0]=H(()=>{},["stop"]))},[...r[2]||(r[2]=[t("div",{id:"trailer",class:"group nomercyplayer"},null,-1)])],512)],8,Se)]))}}),Ae=Ce;export{He as n,Ae as t};
