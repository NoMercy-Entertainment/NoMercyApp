import{$ as k,a7 as q,w as g,d as b,f as M,j as N,h as w,o as _,i as r,y as l,v as d,a0 as f,l as s,t as Q,F as B,p as E,aa as I,aZ as V,c as D,B as x,R as K}from"./vue-ionic-DerxjBh9.js";import{t as F}from"./index-H0ECF5wf.js";import{_ as L}from"./ScrollContainer.vue_vue_type_script_setup_true_lang-DWrczxyz.js";import{_ as $}from"./OptimizedIcon.vue_vue_type_script_setup_true_lang--O4NX453.js";import{_ as R}from"./Modal.vue_vue_type_script_setup_true_lang-BGuRZarG.js";import{_ as S}from"./Button.vue_vue_type_script_setup_true_lang-DHL8wjTc.js";const U={class:"relative mt-1 w-full"},z={class:"relative flex w-full flex-col overflow-clip h-[88%] even:text-lg"},G={class:"flex p-2 pt-4 border-b !bg-transparent text-sm select-none"},O={class:""},P={class:"mr-auto ml-4"},Z={class:"relative flex w-full flex-col h-[85%]"},H={class:"relative w-full h-auto"},J=["onClick"],W={class:"mr-auto !ml-7 text-sm select-none"},X=k({__name:"FolderBrowser",props:{selected:{type:String,required:!0},setSelected:{type:Function,required:!0}},setup(o){const e=o,{t:n}=q();g(e,a=>{t.value=a.selected});const t=b(e.selected??"/"),m=b(!1),h=b("/");g(t,a=>{e.setSelected(a),m.value=!1});const u=b([]),i=b(!1);function y(a){F().post("/dashboard/server/directorytree",{folder:a}).then(({data:p})=>{var v,c,C;u.value=p.data.filter(A=>A.type==="folder"),h.value=((C=(c=(v=p.data.at(0))==null?void 0:v.full_path)==null?void 0:c.match(/[\\/]/gu))==null?void 0:C.at(-1))??"/"}).then(()=>i.value=!1)}g(t,a=>{a&&y(a??"")});function T(){var a;m.value=!0,t.value=t.value.split(/[/\\]/gu).slice(0,-1).join(h.value),(a=t.value.match(/[/\\]/gu))!=null&&a.length||(t.value="/")}function j(a){t.value=a.full_path}return M(()=>{y(t.value??"")}),(a,p)=>{const v=N("InputText");return _(),w(B,null,[r("div",U,[l(v,{id:"folderName",modelValue:t.value,"onUpdate:modelValue":p[0]||(p[0]=c=>t.value=c),name:"",variant:"filled",class:"w-full"},null,8,["modelValue"])]),r("div",z,[r("div",G,[r("span",O,d(f(n)("Type")),1),r("span",P,d(f(n)("Name")),1)]),r("div",Z,[l(L,{static:!1,"auto-hide":!1,"class-name":"ml-2"},{default:s(()=>[r("div",{class:Q(["bg-auto-6/4 hover:bg-auto-200 border-t-0 border-b border-solid border-[rgba(34,34,34,0.9)] contain flex items-center text-current cursor-pointer overflow-hidden py-1 px-2 align-middle h-10 min-h-10 leading-6 select-none",t.value==="/"?"opacity-50":""]),onClick:T},[l($,{icon:"returnPackage",class:"mt-1 h-5 w-5"}),p[1]||(p[1]=r("span",{class:"mr-auto !ml-7"},"...",-1))],2),r("div",H,[(_(!0),w(B,null,E(u.value,c=>(_(),w("div",{key:c.full_path,class:"even:bg-auto-6/2 odd:bg-auto-100 hover:bg-auto-200 border-t-0 border-b border-solid border-[rgba(34,34,34,0.9)] contain flex items-center bg-transparent text-current cursor-pointer overflow-hidden py-1 px-2 align-middle h-10 leading-6",onClick:()=>j(c)},[l($,{icon:"folder",class:"h-5 w-5"}),r("span",W,d(c.path.replace(/[\\\/]/u,"")),1)],8,J))),128))])]),_:1})])])],64)}}}),Y={class:"mx-auto flex w-full flex-col h-[44vh]"},ne=k({__name:"NewFolderModal",props:{open:{type:Boolean,required:!0},close:{type:Function,required:!0},folder:{type:String,required:!0},setFolder:{type:Function,required:!0},library:{type:Object,required:!1}},setup(o){const e=o,n=I(),{t}=q(),m=V();function h(){var u;F().post(`dashboard/libraries/${n.params.id??((u=e.library)==null?void 0:u.id)}/folders`,{path:e.folder}).then(({data:i})=>{i.status==="ok"&&i.data&&e.library&&(e.library.folder_library=[...K(e.library.folder_library||[]),i.data]),m.invalidateQueries({queryKey:["dashboard","libraries"]}),e.setFolder("/"),e.close()}).catch(i=>{console.error("Error adding folder:",i),e.close()})}return(u,i)=>{const y=N("Button");return _(),D(R,{close:o.close,open:o.open,"max-width":"max-w-5xl",title:"Add folder"},{actions:s(()=>[l(y,{id:"yes","on-click":h,color:"theme",type:"button",variant:"contained"},{default:s(()=>[x(d(f(t)("Add")),1)]),_:1}),l(y,{id:"no","on-click":o.close,type:"button",color:"text-auto-alpha-11",variant:"text"},{default:s(()=>[x(d(f(t)("Cancel")),1)]),_:1},8,["on-click"])]),default:s(()=>[r("div",Y,[l(X,{selected:o.folder,"set-selected":o.setFolder},null,8,["selected","set-selected"])])]),_:1},8,["close","open"])}}}),ee={class:"my-6 text-sm text-auto-10"},ie=k({__name:"DeleteLibraryModal",props:{open:{type:Boolean,required:!0},close:{type:Function,required:!0},id:{type:String,required:!0},name:{type:String,required:!0},noRedirect:{type:Boolean,default:!1}},setup(o){const e=o,{t:n}=q(),t=V();function m(){F().delete(`dashboard/libraries/${e.id}`).then(({data:h})=>{t.invalidateQueries({queryKey:["dashboard","libraries"]}),!e.noRedirect&&window.history.back()}),e.close()}return(h,u)=>(_(),D(R,{close:o.close,open:o.open,"max-width":"max-w-xl",params:{library:e.name},title:"Delete library {{library}}"},{actions:s(()=>[l(S,{id:"yes",onclick:m,"end-icon":"trash",color:"red",type:"button",variant:"contained"},{default:s(()=>[x(d(f(n)("Delete")),1)]),_:1}),l(S,{id:"no","on-click":o.close,type:"button",color:"text-auto-alpha-11",variant:"text"},{default:s(()=>[x(d(f(n)("Cancel")),1)]),_:1},8,["on-click"])]),default:s(()=>[r("div",ee,d(f(n)("Are you sure you want to delete this library?")),1)]),_:1},8,["close","open","params"]))}});export{X as _,ne as a,ie as b};
