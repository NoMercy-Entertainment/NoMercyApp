import{aG as ee,bQ as re,K as l,L as n,az as oe,aP as t,fa as I,fb as O,fc as N,ax as ae,bO as se,v as te,j as le,o as S,a7 as v,x as i,aI as d,b$ as ne,c as y,h as C,a as s,t as Z,a$ as ue,bR as ie,a6 as de,bZ as me,bU as pe,aO as fe}from"./index-DBTFZRC0.js";import{_ as ve}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-CvxdyOIH.js";import{a as _e}from"./index-CxLs7PSx.js";import{s as q}from"./index-C4kIgcDK.js";import"./FloatingBackButton.vue_vue_type_script_setup_true_lang-CvQnfeiN.js";import"./Button.vue_vue_type_script_setup_true_lang-BAO5YSq4.js";const we={key:0,class:"col-span-2 col-start-1 2xl:col-start-1"},ge={class:"flex flex-col gap-2"},ce={class:"flex flex-col gap-2"},ke={class:"flex flex-col gap-2"},xe={key:1,class:"col-span-2 col-start-1 2xl:col-start-3"},be={class:"flex flex-col gap-2"},Ve={class:"flex flex-col gap-2"},Se={class:"flex flex-col gap-2"},qe={key:2,class:"col-span-2 col-start-1 2xl:col-start-5"},Be={class:"flex flex-col gap-2"},ye={class:"flex gap-4"},Ce=["aria-label","href"],Pe=ee({__name:"Desktop",setup(Ue){var h,P,Q,j,z,A,D,E,K,R;const{data:o,refetch:H,error:J}=re({path:"/dashboard/configuration"}),_=l(!1),u=l(o.value??{}),m=(e,r)=>{if(o.value){if(pe(o.value[e])==r){delete u.value[e],u.value={...u.value};return}u.value={...u.value,[e]:r??void 0}}};n(o,e=>{e&&(u.value={},w.value=e==null?void 0:e.name,g.value=e==null?void 0:e.external_port,c.value=e==null?void 0:e.internal_port,k.value=e==null?void 0:e.queue_workers,U.value=e==null?void 0:e.cron_workers,$.value=e==null?void 0:e.data_workers,G.value=e==null?void 0:e.request_workers,b.value=e==null?void 0:e.encoder_workers,x.value=e==null?void 0:e.image_workers,p.value=e==null?void 0:e.swagger,_.value=!0)}),oe(()=>{var e,r,B,f,V,a,T,F,L,M;o.value&&(u.value={},w.value=(e=o.value)==null?void 0:e.name,g.value=(r=o.value)==null?void 0:r.external_port,c.value=(B=o.value)==null?void 0:B.internal_port,k.value=(f=o.value)==null?void 0:f.queue_workers,U.value=(V=o.value)==null?void 0:V.cron_workers,$.value=(a=o.value)==null?void 0:a.data_workers,G.value=(T=o.value)==null?void 0:T.request_workers,b.value=(F=o.value)==null?void 0:F.encoder_workers,x.value=(L=o.value)==null?void 0:L.image_workers,p.value=(M=o.value)==null?void 0:M.swagger,_.value=!0)});const w=l(((h=o.value)==null?void 0:h.name)??"");n(w,e=>{m("name",e),t.value&&(I([...O.value.filter(r=>r.id!==t.value.id),{...t.value,name:e.toString()}]),N({...t.value,name:e.toString()}))});const g=l(((P=o.value)==null?void 0:P.external_port)??0);n(g,e=>{m("external_port",e),t.value&&(I([...O.value.filter(r=>r.id!==t.value.id),{...t.value,external_port:e.toString()}]),N({...t.value,external_port:e.toString()}))});const c=l(((Q=o.value)==null?void 0:Q.internal_port)??0);n(c,e=>{m("internal_port",e),t.value&&(I([...O.value.filter(r=>r.id!==t.value.id),{...t.value,internal_port:e.toString()}]),N({...t.value,internal_port:e.toString()}))});const k=l(((j=o.value)==null?void 0:j.queue_workers)??0);n(k,e=>{m("queue_workers",e)});const U=l(((z=o.value)==null?void 0:z.cron_workers)??0);n(U,e=>{m("cron_workers",e)});const $=l(((A=o.value)==null?void 0:A.data_workers)??0);n($,e=>{m("data_workers",e)});const G=l(((D=o.value)==null?void 0:D.request_workers)??0);n(G,e=>{m("request_workers",e)});const x=l(((E=o.value)==null?void 0:E.image_workers)??0);n(x,e=>{m("image_workers",e)});const b=l(((K=o.value)==null?void 0:K.encoder_workers)??0);n(b,e=>{m("encoder_workers",e)});const p=l(((R=o.value)==null?void 0:R.swagger)??!1);n(p,e=>{m("swagger",e)});const W=ae(()=>Object.keys(u.value).length>0);n(u,e=>{console.log(e)});const X=se(),Y=()=>{console.raw(u.value),fe().patch("/dashboard/configuration",u.value).then(()=>{H(),X.invalidateQueries({queryKey:["serverInfo"]})})};return(e,r)=>{const B=te("Button");return S(),le(d(me),null,{default:v(()=>[i(d(ne),{fullscreen:!0},{default:v(()=>[i(ve,{error:d(J),gridStyle:2,title:"General",description:""},{cta:v(()=>r[8]||(r[8]=[])),actions:v(()=>[i(B,{type:"submit",id:"save",disabled:!W.value,color:"theme",class:"ml-auto",form:"myForm",onClick:r[7]||(r[7]=f=>Y())},{default:v(()=>[de(Z(e.$t("Save")),1)]),_:1},8,["disabled"])]),default:v(()=>{var f,V;return[_.value?(S(),y("div",we,[s("div",ge,[r[9]||(r[9]=s("label",{for:"name"},"Server name",-1)),i(d(_e),{id:"name",modelValue:w.value,"onUpdate:modelValue":r[0]||(r[0]=a=>w.value=a),class:"mb-4"},null,8,["modelValue"])]),s("div",ce,[r[10]||(r[10]=s("label",{for:"internal_port"},"Secure internal port",-1)),i(d(q),{id:"internal_port",modelValue:c.value,"onUpdate:modelValue":r[1]||(r[1]=a=>c.value=a),class:"mb-4",useGrouping:!1,showButtons:"",min:2e3},null,8,["modelValue"])]),s("div",ke,[r[11]||(r[11]=s("label",{for:"external_port"},"Secure external port",-1)),i(d(q),{id:"external_port",modelValue:g.value,"onUpdate:modelValue":r[2]||(r[2]=a=>g.value=a),class:"mb-4",useGrouping:!1,showButtons:"",min:2e3},null,8,["modelValue"])])])):C("",!0),_.value?(S(),y("div",xe,[s("div",be,[r[12]||(r[12]=s("label",{for:"encoder_workers"},"Encoder workers",-1)),i(d(q),{id:"encoder_workers",modelValue:b.value,"onUpdate:modelValue":r[3]||(r[3]=a=>b.value=a),class:"mb-4",useGrouping:!1,showButtons:"",min:0},null,8,["modelValue"])]),s("div",Ve,[r[13]||(r[13]=s("label",{for:"image_workers"},"Image workers",-1)),i(d(q),{id:"image_workers",modelValue:x.value,"onUpdate:modelValue":r[4]||(r[4]=a=>x.value=a),class:"mb-4",useGrouping:!1,showButtons:"",min:0},null,8,["modelValue"])]),s("div",Se,[r[14]||(r[14]=s("label",{for:"queue_workers"},"Queue workers",-1)),i(d(q),{id:"queue_workers",modelValue:k.value,"onUpdate:modelValue":r[5]||(r[5]=a=>k.value=a),class:"mb-4",useGrouping:!1,showButtons:"",min:0},null,8,["modelValue"])])])):C("",!0),_.value?(S(),y("div",qe,[s("div",Be,[s("span",ye,[r[15]||(r[15]=s("label",{for:"swagger"},"Open API / Swagger Ui",-1)),p.value&&((f=d(t))!=null&&f.serverBaseUrl)?(S(),y("a",{key:0,target:"_blank","aria-label":e.$t("Open API / Swagger Ui in a new tab"),href:(V=d(t))==null?void 0:V.serverBaseUrl,class:"flex gap-1 items-center underline underline-offset-4 h-4 text-sm"},[s("span",null,Z(e.$t("Open")),1),i(ue,{icon:"shareSquare",className:"size-4",color:"theme"})],8,Ce)):C("",!0)]),i(ie,{"model-value":p.value,"onUpdate:modelValue":r[6]||(r[6]=a=>p.value=a)},null,8,["model-value"])])])):C("",!0)]}),_:1},8,["error"])]),_:1})]),_:1})}}});export{Pe as default};
