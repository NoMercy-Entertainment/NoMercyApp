var w=Object.defineProperty;var T=(d,h,s)=>h in d?w(d,h,{enumerable:!0,configurable:!0,writable:!0,value:s}):d[h]=s;var n=(d,h,s)=>T(d,typeof h!="symbol"?h+"":h,s);import{aH as k}from"./vendor-DtQjLf9G.js";import{P as E,h as u,u as S,b as M,d as B}from"./video-player--Ll1gdP3.js";import{b as L}from"./buttons-DnucOQvv.js";class V extends E{constructor(){super();n(this,"player",{});n(this,"overlay",{});n(this,"buttons",{});n(this,"chapterBar",{});n(this,"mainMenu",{});n(this,"menuFrame",{});n(this,"nextUp",{});n(this,"seekContainer",{});n(this,"sliderBar",{});n(this,"sliderPopImage",{});n(this,"chapterText",{});n(this,"episodeScrollContainer",{});n(this,"playbackButton",{});n(this,"loader",{});n(this,"thumbnailClone",{});n(this,"chapters",[]);n(this,"previewTime",[]);n(this,"timer",{});n(this,"timeout",{});n(this,"image","");n(this,"controlsVisible",!1);n(this,"currentScrubTime",0);n(this,"imageBaseUrl","");n(this,"isScrubbing",!1);n(this,"menuOpen",!1);n(this,"mainMenuOpen",!1);n(this,"languageMenuOpen",!1);n(this,"subtitlesMenuOpen",!1);n(this,"subtitleSettingsMenuOpen",!1);n(this,"subtitleSettingMenuOpen",!1);n(this,"qualityMenuOpen",!1);n(this,"speedMenuOpen",!1);n(this,"playlistMenuOpen",!1);n(this,"theaterModeEnabled",!1);n(this,"highQuality",!1);n(this,"shouldSlide",!0);n(this,"currentTimeFile","");n(this,"currentMenu",null);n(this,"thumbs",[]);n(this,"languageMenuStyles",["language-button","w-available","mr-auto","h-8","px-1","py-2","flex","items-center","rounded","snap-center","outline-transparent","outline","whitespace-nowrap","hover:bg-neutral-600/50","transition-all","duration-200","outline-1","outline-solid","focus-visible:outline-2","focus-visible:outline-white","active:outline-white"]);n(this,"menuButtonTextStyles",["menu-button-text","text-white","cursor-pointer","font-semibold","pl-2","flex","gap-2","leading-[normal]","line-clamp-1"]);n(this,"menuButtonSubTextStyles",["menu-button-text","text-white/60","cursor-pointer","font-semibold","text-2xs","pl-2","flex","gap-2","leading-[normal]","line-clamp-1"])}initialize(s){this.player=s,this.overlay=s.overlay,this.buttons=L(),this.imageBaseUrl=s.options.basePath?"":"https://image.tmdb.org/t/p/w185",this.player.on("play",()=>{this.player.emit("hide-episode-tip")})}dispose(){clearTimeout(this.timer),clearTimeout(this.timeout),this.player.plugins.desktopUIPlugin=void 0,this.chapters=[],this.previewTime=[],this.overlay&&this.overlay.parentNode&&this.overlay.parentNode.removeChild(this.overlay)}modifySpinner(s){this.loader=this.player.createElement("h2","loader").addClasses(["loader","pointer-events-none"]).appendTo(s).get()}createSpinnerContainer(s){const t=this.player.createElement("div","spinner-container").addClasses(["spinner-container","absolute","inset-0","hidden","w-available","h-available","grid","pointer-events-none","place-content-center","bg-transparent","place-items-center","group-[&.nomercyplayer:not(.paused):not(.playing)]:!flex","group-[&.nomercyplayer:not(.paused):not(.playing)]:!bg-gradient-circle-c","group-[&.nomercyplayer.buffering]:bg-gradient-circle-c","group-[&.nomercyplayer.error]:bg-gradient-circle-c","from-15%","from-black/50","via-40%","via-black/30","to-100%","to-black/0"]).appendTo(s).get(),e=this.player.createElement("div","spinner-role").addClasses(["flex","flex-col","items-center","gap-4","mt-11"]).appendTo(t).get();e.setAttribute("role","status"),this.createSpinner(e);const i=this.player.createElement("span","status-text").addClasses(["status-text","text-white","group-[&.nomercyplayer:not(.paused):not(.playing)]:!hidden","text-lg","font-bold"]).appendTo(e).get();return i.innerText=this.player.localize("Loading..."),this.player.on("duration",()=>{t.style.display="none"}),this.player.on("waiting",()=>{t.style.display="grid",i.innerText=`${this.player.localize("Buffering")}...`}),this.player.on("error",()=>{t.style.display="none",i.innerText=this.player.localize("Something went wrong trying to play this item")}),this.player.on("ended",()=>{t.style.display="none"}),this.player.on("time",()=>{t.style.display="none"}),this.player.on("bufferedEnd",()=>{t.style.display="none"}),this.player.on("stalled",()=>{t.style.display="grid",i.innerText=`${this.player.localize("Buffering")}...`}),this.player.on("item",()=>{t.style.display="grid"}),t}createSpinner(s){const t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("viewBox","0 0 100 101"),t.id="spinner",t.setAttribute("fill","none"),this.player.addClasses(t,["spinner-icon","group-[&.nomercyplayer:not(.paused):not(.playing)]:!hidden","inline","w-12","h-12","mr-2","animate-spin","text-white/20","fill-white"]),s.appendChild(t);const e=document.createElementNS("http://www.w3.org/2000/svg","path");e.setAttribute("d","M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z"),e.setAttribute("fill","currentColor"),t.appendChild(e);const i=document.createElementNS("http://www.w3.org/2000/svg","path");i.setAttribute("d","M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z"),i.setAttribute("fill","currentFill"),t.appendChild(i)}fetchPreviewTime(){if(this.previewTime.length===0){const s=this.player.getSpriteFile(),t=new Image;this.player.once("item",()=>{t.remove()}),s&&(this.image=s,this.player.options.accessToken?this.player.getFileContents({url:s,options:{type:"blob"},callback:i=>{const l=URL.createObjectURL(i);t.src=l,this.sliderPopImage.style&&(this.sliderPopImage.style.backgroundImage=`url('${l}')`),this.player.once("item",()=>{URL.revokeObjectURL(l)}),setTimeout(()=>{this.player.emit("preview-time",this.previewTime)},400)}}).then():(this.sliderPopImage.style&&(this.sliderPopImage.style.backgroundImage=`url('${s}')`),t.src=s,setTimeout(()=>{this.player.emit("preview-time",this.previewTime)},400)));const e=this.player.getTimeFile();e&&this.currentTimeFile!==e&&(this.player.currentTimeFile=e,t.onload=()=>{this.player.getFileContents({url:e,options:{type:"text"},callback:i=>{const a=new k.WebVTTParser().parse(i,"metadata"),r=/(?<x>\d*),(?<y>\d*),(?<w>\d*),(?<h>\d*)/u;this.previewTime=[],a.cues.forEach(o=>{const y=r.exec(o.text);if(!(y!=null&&y.groups))return;const{x:m,y:p,w:c,h:f}=y.groups,[g,b,v,C]=[m,p,c,f].map(x=>parseInt(x,10));this.previewTime.push({start:o.startTime,end:o.endTime,x:g,y:b,w:v,h:C})}),setTimeout(()=>{this.player.emit("preview-time",this.previewTime)},400)}}).then(()=>{this.loadSliderPopImage(0)})})}}createBackButton(s,t=!1){if(!this.player.hasBackEventHandler)return;const e=this.player.createUiButton(s,"back").get();return s.appendChild(e),this.player.createSVGElement(e,"back",this.buttons.back,!1,t),e.addEventListener("click",()=>{this.player.emit("hide-tooltip"),this.player.emit("back")}),this.player.on("pip-internal",i=>{i?e.style.display="none":e.style.display="flex"}),e}createRestartButton(s,t=!1){const e=this.player.createUiButton(s,"restart").get();return s.appendChild(e),this.player.createSVGElement(e,"restart",this.buttons.restart,!1,t),e.addEventListener("click",i=>{i.stopPropagation(),this.hasNoMercyConnect()?this.sendNoMercyConnectCommand("restart"):this.player.restart()}),e}createSettingsButton(s,t=!1){if(!this.player.hasSpeeds()&&!this.player.hasAudioTracks()&&!this.player.hasCaptions())return;const e=this.player.createUiButton(s,"settings").get();return this.player.createSVGElement(e,"settings",this.buttons.settings,!1,t),e.addEventListener("click",i=>{i.stopPropagation(),this.player.emit("hide-tooltip"),this.menuOpen&&this.mainMenuOpen?this.player.emit("show-menu",!1):!this.menuOpen&&this.mainMenuOpen?this.player.emit("show-menu",!0):this.menuOpen&&!this.mainMenuOpen?(this.player.emit("show-main-menu",!0),this.player.emit("show-menu",!0)):(this.player.emit("show-main-menu",!0),this.player.emit("show-menu",!0))}),this.player.on("pip-internal",i=>{i?e.style.display="none":e.style.display="flex"}),s.append(e),e}createCloseButton(s,t=!1){if(!this.player.hasCloseEventHandler)return;const e=this.player.createUiButton(s,"close").get();return s.appendChild(e),this.player.createSVGElement(e,"close",this.buttons.close,!1,t),e.addEventListener("click",()=>{this.player.emit("hide-tooltip"),this.player.emit("close")}),this.player.on("pip-internal",i=>{i?e.style.display="none":e.style.display="flex"}),e}hasNoMercyConnect(){return this.player.plugins.has("videoNoMercyConnect")}getNoMercyConnect(){return this.hasNoMercyConnect()?this.player.plugins.get("videoNoMercyConnect"):null}getNoMercyConnectSocket(){var s;return this.hasNoMercyConnect()?(s=this.player.plugins.get("videoNoMercyConnect"))==null?void 0:s.socket:null}sendNoMercyConnectCommand(s,t){if(this.hasNoMercyConnect())try{const e=this.getNoMercyConnectSocket();e?e.invoke("PlaybackCommand",s,t!==null?t:null):console.error("No NoMercyConnect socket available")}catch(e){console.error("Error invoking PlaybackCommand:",e)}else console.warn("No NoMercyConnect plugin available")}createPlaybackButton(s,t=!1){var l;this.playbackButton=this.player.createUiButton(s,"playback").get(),s.appendChild(this.playbackButton),this.playbackButton.ariaLabel=(l=this.buttons.play)==null?void 0:l.title;const e=this.player.createSVGElement(this.playbackButton,"paused",this.buttons.play,!1,t),i=this.player.createSVGElement(this.playbackButton,"playing",this.buttons.pause,!0,t);this.playbackButton.addEventListener("click",a=>{this.hasNoMercyConnect()?this.sendNoMercyConnectCommand(this.player.isPlaying?"pause":"play"):(a.stopPropagation(),this.player.togglePlayback(),this.player.emit("hide-tooltip"))}),this.playbackButton.addEventListener("keydown",()=>this.player.emit.bind(this)("dynamicControls")),this.player.getVideoElement().addEventListener("focus",()=>{this.player.emit("dynamicControls"),this.player.getVideoElement().scrollIntoView()}),this.player.on("pause",()=>{i.style.display="none",e.style.display="flex"}),this.player.on("play",()=>{e.style.display="none",i.style.display="flex"}),this.player.on("item",()=>{})}createSeekBackButton(s,t=!1){if(this.player.isMobile())return;const e=this.player.createUiButton(s,"seekBack").get();return this.player.createSVGElement(e,"seekBack",this.buttons.seekBack,!1,t),e.addEventListener("click",()=>{this.player.emit("hide-tooltip"),this.hasNoMercyConnect()?this.sendNoMercyConnectCommand("rewind"):this.player.rewindVideo()}),this.player.on("pip-internal",i=>{i?e.style.display="none":e.style.display="flex"}),s.append(e),e}createSeekForwardButton(s,t=!1){if(this.player.isMobile())return;const e=this.player.createUiButton(s,"seekForward").get();return this.player.createSVGElement(e,"seekForward",this.buttons.seekForward,!1,t),e.addEventListener("click",()=>{this.player.emit("hide-tooltip"),this.hasNoMercyConnect()?this.sendNoMercyConnectCommand("forward"):this.player.forwardVideo()}),this.player.on("pip-internal",i=>{i?e.style.display="none":e.style.display="flex"}),s.append(e),e}createChapterBackButton(s,t=!1){const e=this.player.createUiButton(s,"chapterBack").get();return this.player.addClasses(e,["portrait:!hidden"]),this.player.on("item",()=>{e.style.display="none"}),this.player.on("chapters",i=>{i.cues.length>0?e.style.display="flex":e.style.display="none"}),this.player.createSVGElement(e,"chapterBack",this.buttons.chapterBack,!1,t),e.addEventListener("click",()=>{this.player.emit("hide-tooltip"),this.hasNoMercyConnect()?this.sendNoMercyConnectCommand("previousChapter"):this.player.previousChapter()}),this.player.on("pip-internal",i=>{i?e.style.display="none":e.style.display="flex"}),s.append(e),e}createChapterForwardButton(s,t=!1){const e=this.player.createUiButton(s,"chapterForward").get();return this.player.addClasses(e,["portrait:!hidden"]),this.player.on("item",()=>{e.style.display="none"}),this.player.on("chapters",i=>{i.cues.length>0?e.style.display="flex":e.style.display="none"}),this.player.createSVGElement(e,"chapterForward",this.buttons.chapterForward,!1,t),e.addEventListener("click",()=>{this.player.emit("hide-tooltip"),this.hasNoMercyConnect()?this.sendNoMercyConnectCommand("nextChapter"):this.player.nextChapter()}),this.player.on("pip-internal",i=>{i?e.style.display="none":e.style.display="flex"}),s.append(e),e}createTime(s,t,e){const i=this.player.createElement("div",`${t}-time`).addClasses([...e,"time","flex","font-mono","items-center","pointer-events-none","select-none","text-sm","justify-center",`${t}-time`]).appendTo(s).get();switch(i.innerText=u(this.player.getDuration()),t){case"current":this.player.on("time",l=>{this.player.container.classList.contains("active")&&(i.innerText=u(l.currentTime))}),this.player.on("currentScrubTime",l=>{i.innerText=u(l.currentTime)});break;case"remaining":this.player.on("duration",l=>{l.remaining===1/0?i.innerText="Live":i.innerText=u(l.remaining)}),this.player.on("time",l=>{l.remaining===1/0?i.innerText="Live":this.player.container.classList.contains("active")&&(i.innerText=u(l.remaining))});break;case"duration":this.player.on("duration",l=>{l.duration===1/0?i.innerText="Live":i.innerText=u(l.duration)});break}return this.player.on("pip-internal",l=>{l?i.style.display="none":i.style.display=""}),i}createVolumeButton(s,t=!1){var m;if(this.player.isMobile())return;const e=this.player.createElement("div","volume-container").addClasses(["volume-container","group/volume","flex","overflow-clip","pointer-events-auto"]).appendTo(s).get(),i=this.player.createUiButton(e,"volume").get();i.ariaLabel=(m=this.buttons.volumeHigh)==null?void 0:m.title;const l=this.player.createElement("input","volume-slider").addClasses(["volume-slider","w-0","rounded-full","opacity-0","duration-200","group-hover/volume:w-20","group-hover/volume:mx-2","group-hover/volume:opacity-100","group-focus-within/volume:w-20","group-focus-within/volume:mx-2","group-focus-within/volume:opacity-100","appearance-none","volume-slider","bg-white/70","bg-gradient-to-r","from-white","to-white","self-center","h-1","bg-no-repeat","rounded-full","shadow-sm","transition-all","range-track:appearance-none","range-track:border-none","range-track:bg-transparent","range-track:shadow-none","range-thumb:h-3","range-thumb:w-3","range-thumb:appearance-none","range-thumb:rounded-full","range-thumb:bg-white","range-thumb:shadow-sm","range-thumb:border-none"]).appendTo(e).get();l.type="range",l.min="0",l.max="100",l.step="1",l.value=this.player.getVolume().toString(),l.style.backgroundSize=`${this.player.getVolume()}% 100%`;const a=this.player.createSVGElement(i,"volumeMuted",this.buttons.volumeMuted,!0,t),r=this.player.createSVGElement(i,"volumeLow",this.buttons.volumeLow,!0,t),o=this.player.createSVGElement(i,"volumeMedium",this.buttons.volumeMedium,!0,t),y=this.player.createSVGElement(i,"volumeHigh",this.buttons.volumeHigh,!1,t);return i.addEventListener("click",p=>{p.stopPropagation(),this.hasNoMercyConnect()?this.sendNoMercyConnectCommand("mute",!this.player.getMute()):this.player.toggleMute(),this.player.emit("hide-tooltip")}),l.addEventListener("input",p=>{p.stopPropagation();const c=Math.floor(parseInt(l.value,10));l.style.backgroundSize=`${c}% 100%`,this.hasNoMercyConnect()?this.sendNoMercyConnectCommand("volume",c):this.player.setVolume(c)}),e.addEventListener("wheel",p=>{p.preventDefault();const c=p.deltaY===0?-p.deltaX:-p.deltaY;c!==0&&(l.style.backgroundSize=`${l.value}% 100%`,l.value=(parseFloat(l.value)+c*.5).toString(),this.hasNoMercyConnect()?this.sendNoMercyConnectCommand("volume",parseFloat(l.value)):this.player.setVolume(parseFloat(l.value)))},{passive:!0}),this.player.on("volume",p=>{this.volumeHandle(p,a,r,o,y),l.style.backgroundSize=`${p.volume}% 100%`,l.value=p.volume.toString()}),this.player.on("mute",p=>{this.volumeHandle(p,a,r,o,y),p.muted?(l.style.backgroundSize="0% 100%",l.value="0"):(l.style.backgroundSize=`${this.player.getVolume()}% 100%`,l.value=this.player.getVolume().toString())}),e}volumeHandle(s,t,e,i,l){this.player.getMute()||s.volume===0?(e.style.display="none",i.style.display="none",l.style.display="none",t.style.display="flex"):s.volume<=30?(i.style.display="none",l.style.display="none",t.style.display="none",e.style.display="flex"):s.volume<=60?(e.style.display="none",l.style.display="none",t.style.display="none",i.style.display="flex"):(e.style.display="none",i.style.display="none",t.style.display="none",l.style.display="flex")}createPreviousButton(s,t=!1){const e=this.player.createUiButton(s,"previous").get();return this.player.addClasses(e,["portrait:!hidden"]),e.style.display="none",this.player.createSVGElement(e,"previous",this.buttons.previous,!1,t),e.addEventListener("click",i=>{i.stopPropagation(),this.hasNoMercyConnect()?this.sendNoMercyConnectCommand("previous"):this.player.previous(),this.player.emit("hide-tooltip")}),this.player.getPlaylistIndex()>0?e.style.display="flex":e.style.display="none",this.player.on("item",()=>{this.player.getPlaylistIndex()>0?e.style.display="flex":e.style.display="none"}),this.player.on("pip-internal",i=>{i?e.style.display="none":(this.player.playlistItem().episode??!1)&&(e.style.display="flex")}),e.addEventListener("mouseenter",()=>{const i=e.getBoundingClientRect(),l=s.getBoundingClientRect();let a=Math.abs(l.left-i.left+50);const r=Math.abs(l.bottom-i.bottom-60);a<30&&(a=30),a>i.right-i.left-10&&(a=i.right-i.left-10),this.player.emit("show-episode-tip",{direction:"previous",currentTime:"bottom",x:`${a}px`,y:`-${r}px`})}),e.addEventListener("mouseleave",()=>{this.player.emit("hide-episode-tip")}),s.appendChild(e),e}createNextButton(s,t=!1){const e=this.player.createUiButton(s,"next").get();return this.player.addClasses(e,["portrait:!hidden"]),e.style.display="none",this.player.hasNextTip=!0,this.player.createSVGElement(e,"next",this.buttons.next,!1,t),e.addEventListener("click",i=>{i.stopPropagation(),this.hasNoMercyConnect()?this.sendNoMercyConnectCommand("next"):this.player.next(),this.player.emit("hide-tooltip")}),this.player.isLastPlaylistItem()?e.style.display="none":e.style.display="flex",this.player.on("item",()=>{this.player.isLastPlaylistItem()?e.style.display="none":e.style.display="flex"}),this.player.on("pip-internal",i=>{i?e.style.display="none":this.player.isLastPlaylistItem()&&(e.style.display="flex")}),e.addEventListener("mouseenter",()=>{const i=e.getBoundingClientRect(),l=s.getBoundingClientRect();let a=Math.abs(l.left-i.left+50);const r=Math.abs(l.bottom-i.bottom-60);a<30&&(a=30),a>i.right-i.left-10&&(a=i.right-i.left-10),this.player.emit("show-episode-tip",{direction:"next",currentTime:"bottom",x:`${a}px`,y:`-${r}px`})}),e.addEventListener("mouseleave",()=>{this.player.emit("hide-episode-tip")}),s.appendChild(e),e}createCaptionsButton(s,t=!1){var a;const e=this.player.createUiButton(s,"subtitles").get();this.player.addClasses(e,["portrait:!hidden"]),e.style.display="none",e.ariaLabel=(a=this.buttons.subtitles)==null?void 0:a.title;const i=this.player.createSVGElement(e,"subtitle",this.buttons.subtitlesOff,!1,t),l=this.player.createSVGElement(e,"subtitled",this.buttons.subtitles,!0,t);return e.addEventListener("click",r=>{r.stopPropagation(),this.player.emit("hide-tooltip"),this.subtitlesMenuOpen?(this.player.emit("show-menu",!1),this.menuFrame.close()):(this.player.emit("show-subtitles-menu",!0),this.player.emit("show-subtitleSettings-menu",!1),this.menuFrame.showModal())}),this.player.hasCaptions()?e.style.display="flex":e.style.display="none",this.player.on("captionsList",r=>{r.length>1?e.style.display="flex":e.style.display="none"}),this.player.on("captionsChanging",r=>{r.id===-1?(l.style.display="none",i.style.display="flex"):(l.style.display="flex",i.style.display="none")}),this.player.on("pip-internal",r=>{r?e.style.display="none":this.player.hasCaptions()&&(e.style.display="flex")}),s.appendChild(e),e}createAudioButton(s,t=!1){var i;const e=this.player.createUiButton(s,"audio").get();return this.player.addClasses(e,["portrait:!hidden"]),e.style.display="none",e.ariaLabel=(i=this.buttons.language)==null?void 0:i.title,this.player.createSVGElement(e,"audio",this.buttons.languageOff,!1,t),e.addEventListener("click",l=>{l.stopPropagation(),this.player.emit("hide-tooltip"),this.languageMenuOpen?(this.player.emit("show-menu",!1),this.menuFrame.close()):(this.player.emit("show-language-menu",!0),this.menuFrame.showModal())}),this.player.on("item",()=>{e.style.display="none"}),this.player.hasAudioTracks()?e.style.display="flex":e.style.display="none",this.player.on("audioTracks",l=>{l.length>1?e.style.display="flex":e.style.display="none"}),this.player.on("pip-internal",l=>{l?e.style.display="none":this.player.hasAudioTracks()&&(e.style.display="flex")}),s.appendChild(e),e}createQualityButton(s,t=!1){const e=this.player.createUiButton(s,"quality").get();this.player.addClasses(e,["portrait:!hidden"]),e.style.display="none";const i=this.player.createSVGElement(e,"low",this.buttons.quality,!1,t),l=this.player.createSVGElement(e,"high",this.buttons.quality,!0,t);return e.addEventListener("click",a=>{a.stopPropagation(),this.player.emit("hide-tooltip"),this.qualityMenuOpen?(this.player.emit("show-menu",!1),this.menuFrame.close()):(this.player.emit("show-quality-menu",!0),this.menuFrame.showModal()),this.highQuality?(this.highQuality=!1,l.style.display="none",i.style.display="flex"):(this.highQuality=!0,i.style.display="none",l.style.display="flex")}),this.player.on("item",()=>{e.style.display="none"}),this.player.hasQualities()?e.style.display="flex":e.style.display="none",this.player.on("levels",()=>{this.player.hasQualities()?e.style.display="flex":e.style.display="none"}),this.player.on("pip-internal",a=>{a?e.style.display="none":this.player.hasQualities()&&(e.style.display="flex")}),s.appendChild(e),e}createTheaterButton(s,t=!1){if(this.player.isMobile()||!this.player.hasTheaterEventHandler)return;const e=this.player.createUiButton(s,"theater").get();return this.player.createSVGElement(e,"theater",this.buttons.theater,t),this.player.createSVGElement(e,"theater-enabled",this.buttons.theaterExit,!0,t),e.addEventListener("click",i=>{i.stopPropagation(),this.player.emit("hide-tooltip"),this.theaterModeEnabled?(this.theaterModeEnabled=!1,e.querySelector(".theater-enabled-icon").style.display="none",e.querySelector(".theater-icon").style.display="flex",this.player.emit("theaterMode",!1),this.player.emit("resize")):(this.theaterModeEnabled=!0,e.querySelector(".theater-icon").style.display="none",e.querySelector(".theater-enabled-icon").style.display="flex",this.player.emit("theaterMode",!0),this.player.emit("resize"))}),this.player.on("fullscreen",()=>{this.player.getFullscreen()?e.style.display="none":e.style.display="flex"}),this.player.on("pip-internal",i=>{i?e.style.display="none":e.style.display="flex"}),s.appendChild(e),e}createFullscreenButton(s,t=!1){const e=this.player.createUiButton(s,"fullscreen").get();return this.player.createSVGElement(e,"fullscreen",this.buttons.fullscreen,!1,t),this.player.createSVGElement(e,"fullscreen-enabled",this.buttons.exitFullscreen,!0,t),e.addEventListener("click",i=>{i.stopPropagation(),this.player.toggleFullscreen(),this.player.emit("hide-tooltip")}),this.player.on("fullscreen",i=>{i?(e.querySelector(".fullscreen-icon").style.display="none",e.querySelector(".fullscreen-enabled-icon").style.display="flex"):(e.querySelector(".fullscreen-enabled-icon").style.display="none",e.querySelector(".fullscreen-icon").style.display="flex")}),this.player.on("pip-internal",i=>{i?e.style.display="none":e.style.display="flex"}),s.appendChild(e),e}createPlaylistsButton(s,t=!1){const e=this.player.createUiButton(s,"playlist").get();return this.player.addClasses(e,["portrait:!hidden"]),e.style.display="none",this.player.createSVGElement(e,"playlist",this.buttons.playlist,!1,t),e.addEventListener("click",i=>{i.stopPropagation(),this.player.emit("hide-tooltip"),this.playlistMenuOpen?(this.player.emit("show-menu",!1),this.menuFrame.close()):(this.player.emit("show-playlist-menu",!0),this.menuFrame.showModal(),setTimeout(()=>{var l;(l=document.querySelector(`playlist-${this.player.playlistItem().id}`))==null||l.scrollIntoView({block:"center"})},100))}),this.player.hasPlaylists()?e.style.display="flex":e.style.display="none",this.player.on("item",()=>{this.player.hasPlaylists()?e.style.display="flex":e.style.display="none"}),this.player.on("pip-internal",i=>{i?e.style.display="none":this.player.hasPlaylists()&&(e.style.display="flex")}),s.appendChild(e),e}createBottomBar(s){const t=this.player.createElement("div","bottom-bar").addClasses(["bottom-bar","absolute","bottom-0","duration-200","flex","flex-col","gap-2","group-[&.nomercyplayer.paused]:translate-y-0","group-[&.nomercyplayer:has(.open)]:translate-y-0","group-[&.nomercyplayer.active]:translate-y-0","group-[&.nomercyplayer:has(.volume-container:hover)]:!translate-y-0","items-center","mt-auto","text-center","transition-all","translate-y-[100vh]","w-available","z-10","pointer-events-none"]).appendTo(s).get();return this.player.createElement("div","bottom-bar-shadow").addClasses(["absolute","pointer-events-none","pt-[10%]","w-available","bottom-0","bg-gradient-to-t","from-black/85","via-black/40","to-black/0"]).appendTo(t).get(),t}createDivider(s,t){const e=["divider","flex","flex-1","min-w-4"],i=this.player.createElement("div","divider").addClasses(e).appendTo(s).get();return t?i.innerHTML=t:this.player.addClasses(i,e),i}createOverlayCenterMessage(s){const t=this.player.createElement("button","player-message").addClasses(["player-message","hidden","absolute","rounded-md","bg-neutral-900/95","left-1/2","px-4","py-2","pointer-events-none","text-center","top-12","-translate-x-1/2","z-50"]).appendTo(s).get();return this.player.on("display-message",e=>{t.style.display="flex",t.innerText=e??""}),this.player.on("remove-message",()=>{t.style.display="none",t.innerText=""}),t}createSeekContainer(s){const t=this.player.createElement("div","seek-container").addClasses(["relative","h-auto","mb-28","w-available","translate-y-[80vh]","z-40","w-available"]).appendTo(s).get(),e=this.player.createElement("div","seek-scroll-clone-container").addClasses(["[--gap:1.5rem]","absolute","flex","h-available","w-available","gap-[var(--gap)]","z-10","pointer-events-none"]).appendTo(t).get();this.thumbnailClone=this.player.createElement("div","thumbnail-clone-1").addClasses(["h-auto","object-cover","border-4","mx-auto"]).appendTo(e).get();const i=this.player.createElement("div","seek-scroll-container").addClasses(["relative","flex","h-available","w-available","overflow-auto","px-[calc(100%/2.14)]","gap-1.5","scrollbar-none"]).appendTo(t).get();return this.player.once("item",()=>{this.player.on("preview-time",()=>{this.thumbs=[];for(const l of this.previewTime)this.thumbs.push({time:l,el:this.createThumbnail(l)});i.innerHTML="",S(this.thumbs.map(l=>l.el),"id").forEach(l=>{i.appendChild(l)}),this.player.once("time",()=>{this.currentScrubTime=this.player.getClosestSeekableInterval(),this.player.emit("currentScrubTime",{...this.player.getTimeData(),currentTime:this.player.getClosestSeekableInterval()})})})}),this.player.on("lastTimeTrigger",()=>{this.currentScrubTime=this.player.getClosestSeekableInterval(),this.player.emit("currentScrubTime",{...this.player.getTimeData(),currentTime:this.player.getClosestSeekableInterval()})}),this.player.on("currentScrubTime",l=>{l.currentTime<=0?l.currentTime=0:l.currentTime>=this.player.getDuration()&&(l.currentTime=this.player.getDuration());const a=this.thumbs.find(r=>l.currentTime>=r.time.start&&l.currentTime<=r.time.end);this.currentScrubTime=l.currentTime,a&&this.player.scrollIntoView(a.el)}),this.player.on("show-seek-container",l=>{l?(t.style.transform="none",this.player.pause()):this.seekContainer.style.transform=""}),t}createTopBar(s){return this.player.createElement("div","top-bar").addClasses(["top-bar","-translate-y-[100vh]","absolute","flex","gap-2","items-start","justify-between","mb-auto","pb-[10%]","px-6","py-4","top-0","w-available","z-10","pointer-events-none","group-[&.nomercyplayer.active]:translate-y-0","group-[&.nomercyplayer.paused]:translate-y-0","group-[&.nomercyplayer:has(.open)]:translate-y-0","group-[&.nomercyplayer:has(.volume-container:hover)]:!translate-y-0","transition-all","duration-200","bg-gradient-to-b","from-black/85","via-black/40","to-black/0"]).appendTo(s).get()}createTvCurrentItem(s){const t=this.player.createElement("div","current-item-container").addClasses(["flex","flex-col","justify-end","items-end","gap-2"]).appendTo(s).get(),e=this.player.createElement("div","current-item-show").addClasses(["text-white","text-sm","font-bold"]).appendTo(t).get(),i=this.player.createElement("div","current-item-title-container").addClasses(["flex","flex-row","gap-2"]).appendTo(t).get(),l=this.player.createElement("div","current-item-episode").addClasses([]).appendTo(i).get(),a=this.player.createElement("div","current-item-title").addClasses(["whitespace-pre","text-sm"]).appendTo(i).get();return this.player.on("item",()=>{var o,y;const r=this.player.playlistItem();e.innerHTML=M(r.show??""),l.innerHTML="",r.season&&(l.innerHTML+=`${this.player.localize("S")}${r.season}`),r.season&&r.episode&&(l.innerHTML+=`: ${this.player.localize("E")}${r.episode}`),a.innerHTML=B(((o=r.title)==null?void 0:o.replace(r.show??"","").length)>0?`"${(y=r.title)==null?void 0:y.replace(r.show??"","").replace("%S",this.player.localize("S")).replace("%E",this.player.localize("E"))}"`:"")}),t}createLanguageMenuButton(s,t,e=!1){var r;const i=this.player.createElement("button",`${t.type}-button-${t.language}`).addClasses(this.languageMenuStyles).appendTo(s).get(),l=this.player.createElement("span","menu-button-text").addClasses(this.menuButtonTextStyles).appendTo(i).get();t.buttonType==="subtitle"?t.styled?l.innerText=`${this.player.localize(t.language??"")} ${this.player.localize(t.label)} ${this.player.localize("styled")}`:t.language===""?l.innerText=this.player.localize(t.label):l.innerText=`${this.player.localize(t.language??"")} (${this.player.localize(t.type)})`:l.innerText=this.player.localize(t.language)+" "+(((r=this.player.getPlaylistItem().audio.at(t.id))==null?void 0:r.channel_layout)||"");const a=this.player.createSVGElement(i,"checkmark",this.buttons.checkmark,!1,e);return this.player.addClasses(a,["ml-auto","hidden"]),t.buttonType==="audio"?(t.id===this.player.getAudioTrackIndex()?a.classList.remove("hidden"):a.classList.add("hidden"),this.player.on("audioTrackChanging",o=>{t.id===o.id?a.classList.remove("hidden"):a.classList.add("hidden")}),i.addEventListener("click",o=>{o.stopPropagation(),this.hasNoMercyConnect()?this.sendNoMercyConnectCommand("audio",t.id):this.player.setCurrentAudioTrack(t.id),this.player.emit("show-menu",!1)})):t.buttonType==="subtitle"&&(t.id===this.player.getCaptionIndex()?a.classList.remove("hidden"):a.classList.add("hidden"),this.player.on("captionsChanged",o=>{t.id===o.id?a.classList.remove("hidden"):a.classList.add("hidden")}),i.addEventListener("click",o=>{o.stopPropagation(),this.hasNoMercyConnect()?this.sendNoMercyConnectCommand("caption",t.id):this.player.setCurrentCaption(t.id),this.player.emit("show-menu",!1)})),this.addKeyEventsToLanguageButton(i,s),i}addKeyEventsToLanguageButton(s,t){s.addEventListener("keypress",e=>{var i,l,a,r;e.key==="ArrowLeft"?(i=this.player.getClosestElement(s,'[id^="audio-button-"]'))==null||i.focus():e.key==="ArrowRight"?(l=this.player.getClosestElement(s,'[id^="subtitle-button-"]'))==null||l.focus():e.key==="ArrowUp"&&!this.player.options.disableTouchControls?(a=s.previousElementSibling)==null||a.focus():e.key==="ArrowDown"&&!this.player.options.disableTouchControls&&((r=s.nextElementSibling)==null||r.focus())}),s.addEventListener("focus",()=>{setTimeout(()=>{this.player.scrollCenter(s,t.parentElement,{margin:1,duration:100})},50)})}createThumbnail(s){const t=this.player.createElement("div",`thumbnail-${s.start}`).addClasses(["w-1/5","h-auto","object-cover","aspect-video","snap-center"]).get();return t.style.backgroundImage=`url('${(this.player.options.basePath?this.player.options.basePath:"")+this.image}${this.player.options.accessToken?`?token=${this.player.options.accessToken}`:""}')`,t.style.backgroundPosition=`-${s.x}px -${s.y}px`,t.style.width=`max(232px, ${s.w}px)`,t.style.minWidth=`max(232px, ${s.w}px)`,t.style.aspectRatio=`${s.w} / ${s.h}`,this.thumbnailClone.style.aspectRatio=`${s.w} / ${s.h}`,this.thumbnailClone.style.width=`max(232px, ${s.w}px)`,this.thumbnailClone.style.minWidth=`max(232px, ${s.w}px)`,t}getSliderPopImage(s){const t=this.loadSliderPopImage(s);t&&(this.sliderPopImage.style.backgroundPosition=`-${t.x}px -${t.y}px`,this.sliderPopImage.style.width=`${t.w}px`,this.sliderPopImage.style.height=`${t.h}px`,this.chapterText.style.width=`${t.w}px`)}adjustScaling(s,t){const e=s%t;return e%1!==0&&(s/=e/Math.round(e)),e>1&&(s*=e),s}loadSliderPopImage(s){this.fetchPreviewTime();let t=this.previewTime.find(e=>s.scrubTimePlayer>=e.start&&s.scrubTimePlayer<e.end);return t||(t=this.previewTime.at(-1)),t}}export{V as B};
