import"./useBaseQuery-CMhLd9-U.js";import{n as V}from"./useInfiniteServerClient-MMR7oD7k.js";import"./useQueryClient-YAttX_Mh.js";import"./useQuery-CmvJ8I_d.js";import{$r as K,Eo as M,Fc as U,Fs as s,Hs as T,Is as g,Ls as x,Pc as P,Rs as f,Ss as D,Ws as C,ac as u,fo as R,gc as L,io as z,jc as c,ks as w,lc as W,nc as O,sc as q,vc as H,wc as m}from"./index-BLQpgzX8.js";import"./_plugin-vue_export-helper-Qq1ciMp2.js";import"./AppLogoSquare-B-kmZabX.js";import{t as G}from"./TMDBImage-CGNzn1sE.js";import{t as J}from"./useServerClient-BVrDeuWr.js";D();var Q={key:0,class:"grid grid-rows-[auto_1fr] grid-cols-7 relative justify-start flex-1 w-full gap-3 mb-2","data-row":""},X={class:"row-start-1 col-span-7 pointer-events-none font-semibold font-3xl"},Y=C({__name:"TvCarousel2",props:{data:{type:Array,required:!0},title:{type:String,required:!0},handleFocus:{type:Function,required:!0},handleDown:{type:Function,required:!0},handleUp:{type:Function,required:!0},suffix:{type:String,required:!1,default:""}},setup(t){return(v,r)=>{const _=W("RouterLink");return t.data.length?(u(),f("div",Q,[s("h3",X,U(t.title),1),(u(!0),f(w,null,q(t.data.slice(0,7),(o,n)=>(u(),g(_,{key:o.id,"data-card":o.id,"data-index":n,style:P(`background-image: url('https://app.nomercy.tv/tmdb-images${o.poster}?width=300')`),to:`${o.link}${t.suffix}`,class:"row-start-2 w-full h-auto rounded-xl bg-cover aspect-poster focus:scale-105 focus:outline outline-[2.2px] outline-white transition-transform duration-200 scroll-mb-20 scroll-mt-12 snap-center snap-mandatory",onFocus:i=>t.handleFocus(i,o),onKeydown:r[0]||(r[0]=i=>t.handleDown(i)),onKeyup:r[1]||(r[1]=i=>t.handleUp(i))},null,8,["data-card","data-index","style","to","onFocus"]))),128))])):x("",!0)}}}),N=Y;D();var Z={class:"w-available h-auto absolute left-[250px] top-0 overflow-hidden bg-black aspect-video"},ee={class:"flex flex-col justify-start items-start w-[484px] relative left-[58px] top-20 gap-7"},te={class:"flex flex-col justify-start items-start self-stretch relative gap-5"},ae={class:"flex flex-col justify-start items-start w-full relative gap-0"},le=["innerHTML"],re={class:"line-clamp-4 text-sm -mt-4"},se=C({__name:"TvHeader",props:{selected:{type:Object,required:!1}},setup(t){return(v,r)=>(u(),f("div",{key:t.selected?.id,class:"w-full h-full absolute left-0 top-0 bg-[#131314]"},[s("div",Z,[T(G,{alt:t.selected?.title,path:t.selected?.backdrop,size:540,class:"w-available h-available absolute left-[-0.39px] top-[-0.39px] object-cover"},null,8,["alt","path"]),r[0]||(r[0]=s("div",{class:"w-available h-available absolute left-[-0.39px] top-[-0.39px]"},null,-1)),r[1]||(r[1]=s("div",{class:"w-[150vw] h-[150vw] absolute left-[-30%] bottom-[-50%]",style:{background:`radial-gradient(
            closest-side,
            rgba(19, 19, 20, 0.1) 0%,
            rgba(19, 19, 20, 1) 70.73974609375%
          )`}},null,-1))]),s("div",ee,[s("div",te,[s("div",ae,[s("div",{class:"self-stretch w-full text-xl text-left mt-2 flex flex-col",innerHTML:c(K)(t.selected?.title||"","text-lg")},null,8,le)]),s("div",re,U(t.selected?.overview),1)])])]))}}),oe=se;D();var ne={class:"w-screen h-screen relative overflow-hidden bg-[#131314]"},ue=C({__name:"Tv",setup(t){const{data:v,fetchNextPage:r,hasNextPage:_}=V({path:"/",queryKey:["home"]});L(v,()=>{_&&r()});const{data:o}=J({path:"userdata/continue",queryKey:["continue"],refetchInterval:1e3*60*5}),n=m();L(o,e=>{e&&(n.value=e?.filter(l=>l.id)?.at(0))}),O(()=>{n.value=o.value?.filter(e=>e.id)?.at(0),setTimeout(()=>{const e=document.querySelector(`[data-card="${n.value?.id}"]`);e&&e.focus()},1e3)}),M(()=>{n.value=o.value?.filter(e=>e.id)?.at(0),setTimeout(()=>{const e=document.querySelector(`[data-card="${n.value?.id}"]`);e&&e.focus()},1e3)});const i=m(),b=m(!1),F=m(),$=m();function k(e,l){const a=e.target;if(a?.nodeName==="DIV"){($.value??a.querySelector("a"))?.focus();return}l&&(n.value=l,$.value=a)}function A(e){if(b.value){e.preventDefault();return}clearTimeout(F.value),b.value=!0;const l=e.target,a=l.getAttribute("data-index"),y=l.closest("[data-row]"),d=y?.previousElementSibling,h=d?.querySelector(`a[data-index="${a}"]`),S=y?.nextElementSibling,I=S?.querySelector(`a[data-index="${a}"]`),j=l.previousElementSibling,E=l.nextElementSibling;if(h&&e.key==="ArrowUp")e.preventDefault(),h.focus();else if(I&&e.key==="ArrowDown")e.preventDefault(),I.focus();else if(j&&e.key==="ArrowLeft")e.preventDefault(),j.focus();else if(E&&e.key==="ArrowRight")e.preventDefault(),E.focus();else if(d&&e.key==="ArrowUp"){const p=Array.from(d?.querySelectorAll("a"))?.at(-1);p&&p.focus()}else if(S&&e.key==="ArrowDown"){const p=Array.from(S?.querySelectorAll("a"))?.at(-1);p&&p.focus()}}function B(){F.value=setTimeout(()=>{b.value=!1},150)}return(e,l)=>(u(),g(c(R),null,{default:H(()=>[T(c(z),{fullscreen:!0},{default:H(()=>[s("div",ne,[n.value?(u(),g(oe,{key:0,selected:n.value},null,8,["selected"])):x("",!0),s("div",{ref_key:"scrollContainer",ref:i,class:"flex flex-col justify-start items-start w-available -mx-3 px-3 absolute left-14 right-14 top-[264px] h-available overflow-auto scroll-smooth gap-4 flex-1 pb-16",tabindex:"0",onFocus:l[0]||(l[0]=a=>k(a))},[T(N,{data:c(o)?.filter(a=>!!a.id)??[],"handle-down":A,"handle-focus":k,"handle-up":B,title:"Continue watching"},null,8,["data"]),c(v)?.pages?(u(!0),f(w,{key:0},q(c(v).pages,(a,y)=>(u(),f(w,{key:y},[a?(u(!0),f(w,{key:0},q(a?.data??[],(d,h)=>(u(),g(N,{key:h,data:d.items,"handle-down":A,"handle-focus":k,"handle-up":B,title:d.title,suffix:"/watch"},null,8,["data","title"]))),128)):x("",!0)],64))),128)):x("",!0)],544)])]),_:1})]),_:1}))}}),ge=ue;export{ge as default};
