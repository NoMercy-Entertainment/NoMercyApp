import{B as b,h as m,u as w,c as v,l as x,a as C}from"./subtitles-octopus-WbQsAcJL.js";import{s as S,d as T,f,e as E}from"./buttons-IwPh3z7u.js";class L extends b{topBar={};bottomRow={};frame={};center={};isMouseDown=!1;pipEnabled=!1;lockActive=!1;bottomBar={};topRow={};tooltip={};episodeTip={};scrollContainerStyles=["scroll-container","flex","flex-col","gap-1","language-scroll-container","overflow-x-hidden","overflow-y-auto","p-2","transition-all","duration-200","w-available","scroll-p-4","scroll-snap-align-center","scroll-smooth","scroll-p-4"];subMenuContentStyles=["sub-menu-content","flex","flex-col","max-h-available","w-available","overflow-auto","min-w-52"];subtitleSettingActions=[];use(){this.isInitialized||(this.isInitialized=!0,this.subtitleSettingActions=S(this.player),this.topBar=this.createTopBar(this.overlay),this.createBackButton(this.topBar),this.createCloseButton(this.topBar),this.createDivider(this.topBar),this.createTvCurrentItem(this.topBar),this.player.options.disableTouchControls||(this.center=this.createCenter(this.overlay)),this.bottomBar=this.createBottomBar(this.overlay),this.bottomBar.onmouseleave=a=>{const e=this.player.getVideoElement()?.getBoundingClientRect();!e||a.x>e.left&&a.x<e.right&&a.y>e.top&&a.y<e.bottom||this.player.emit("hide-tooltip")},this.topRow=this.createTopRow(this.bottomBar),this.player.addClasses(this.topRow,["mt-4"]),this.bottomRow=this.createBottomRow(this.bottomBar),this.createProgressBar(this.topRow),this.createPlaybackButton(this.bottomRow,!0),this.createPreviousButton(this.bottomRow,!0),this.player.options.seekButtons&&(this.createSeekBackButton(this.bottomRow,!0),this.createSeekForwardButton(this.bottomRow,!0)),this.createChapterBackButton(this.bottomRow,!0),this.createChapterForwardButton(this.bottomRow,!0),this.createNextButton(this.bottomRow,!0),this.createVolumeButton(this.bottomRow,!0),this.createTime(this.bottomRow,"current",["ml-2"]),this.createDivider(this.bottomRow),this.createTime(this.bottomRow,"remaining",["mr-2"]),this.createTheaterButton(this.bottomRow,!0),this.createPIPButton(this.bottomRow,!0),this.createPlaylistsButton(this.bottomRow,!0),this.createCaptionsButton(this.bottomRow,!0),this.createAudioButton(this.bottomRow,!0),this.createQualityButton(this.bottomRow,!0),this.createSettingsButton(this.bottomRow,!0),this.createFullscreenButton(this.bottomRow,!0),this.frame=this.createMenuFrame(this.bottomRow),this.createMainMenu(this.frame),this.createToolTip(this.overlay),this.episodeTip=this.createEpisodeTip(this.overlay),this.modifySpinner(this.overlay),this.eventHandlers())}dispose(){this.topBar.remove(),this.bottomBar.remove(),this.bottomRow.remove(),this.frame.remove(),this.center?.remove(),this.tooltip.remove(),this.episodeTip.remove(),this.loader.remove(),this.menuFrame.remove(),this.sliderBar.remove()}createTopRow(a){return this.player.createElement("div","top-row").addClasses(["top-row","flex","gap-1","h-2","items-center","pl-2","pr-2","relative","w-available"]).appendTo(a).get()}createBottomRow(a){return this.player.createElement("div","bottom-row").addClasses(["bottom-row","flex","h-10","lg:mb-2","p-1","lg:px-4","items-center","relative","w-available"]).appendTo(a).get()}eventHandlers(){this.player.on("chapters",()=>{this.createChapterMarkers()}),this.player.on("back-button",()=>{switch(this.currentMenu){case"episode":case"language":case"quality":this.player.emit("showPauseScreen");break;case"seek":case"pause":this.seekContainer.style.transform="",this.player.play().then();break}}),window.addEventListener("resize",()=>{this.sizeMenuFrame()})}createCenter(a){const e=this.player.createElement("div","center").addClasses(["center","absolute","grid","grid-cols-3","grid-rows-6","h-full","w-full","z-0","transition-all","duration-200","bg-transparent","group-[&.nomercyplayer:not(.buffering).paused]:bg-gradient-circle-c","from-15%","from-black/60","via-35%","via-black/10","to-100%","to-black/0"]).appendTo(a).get();return this.createSpinnerContainer(e),this.player.isMobile()?(this.createTouchSeekBack(e,{x:{start:1,end:1},y:{start:2,end:6}}),this.createTouchPlayback(e,{x:{start:2,end:2},y:{start:3,end:5}}),this.createTouchSeekForward(e,{x:{start:3,end:3},y:{start:2,end:6}}),this.createTouchVolUp(e,{x:{start:2,end:2},y:{start:1,end:3}}),this.createTouchVolDown(e,{x:{start:2,end:2},y:{start:5,end:7}})):(this.createTouchSeekBack(e,{x:{start:1,end:2},y:{start:2,end:6}}),this.createTouchPlayback(e,{x:{start:2,end:3},y:{start:2,end:6}}),this.createTouchSeekForward(e,{x:{start:3,end:4},y:{start:2,end:6}})),e}createTouchSeekBack(a,e){const t=this.createTouchBox(a,"touchSeekBack",e);return["click"].forEach(s=>{t.addEventListener(s,this.player.doubleTap(()=>{this.hasNoMercyConnect()?(this.player.rewindVideo(),this.sendNoMercyConnectCommand("backward")):this.player.rewindVideo()},()=>{this.controlsVisible&&this.player.emit("hideControls")}))}),this.createSeekRipple(t,"left"),t}createTouchSeekForward(a,e){const t=this.createTouchBox(a,"touchSeekForward",e);return["mouseup","touchend"].forEach(s=>{t.addEventListener(s,this.player.doubleTap(()=>{this.hasNoMercyConnect()?(this.player.forwardVideo(),this.sendNoMercyConnectCommand("forward")):this.player.forwardVideo()},()=>{this.controlsVisible&&this.player.emit("hideControls")}))}),this.createSeekRipple(t,"right"),t}createTouchPlayback(a,e,t=!1){const s=this.createTouchBox(a,"touchPlayback",e);this.player.addClasses(s,["touch-playback","flex","-ml-2","items-center","justify-center"]),["click"].forEach(l=>{s.addEventListener(l,this.player.doubleTap(()=>{this.player.toggleFullscreen()},()=>{this.controlsVisible&&(this.hasNoMercyConnect()?this.sendNoMercyConnectCommand(this.player.isPlaying?"pause":"play"):this.player.togglePlayback())}))});const i=this.player.createSVGElement(s,"bigPlay",this.buttons.bigPlay,!1,t);return this.player.addClasses(i,["touch-playback-button","pointer-events-none","fill-white"]),this.player.on("ready",()=>{i.style.display="flex"}),this.player.on("pause",()=>{i.style.display="flex"}),this.player.on("play",()=>{i.style.display="none"}),this.player.on("time",()=>{i.style.display="none"}),this.player.on("firstFrame",()=>{i.style.display="none"}),s}createTouchVolUp(a,e){if(!this.player.isMobile())return;const t=this.createTouchBox(a,"touchVolUp",e);return["click"].forEach(s=>{t.addEventListener(s,this.player.doubleTap(()=>{this.player.volumeUp()},()=>{this.controlsVisible&&this.player.emit("hideControls")}))}),t}createTouchVolDown(a,e){if(!this.player.isMobile())return;const t=this.createTouchBox(a,"touchVolDown",e);return["click"].forEach(s=>{t.addEventListener(s,this.player.doubleTap(()=>{this.player.volumeDown()},()=>{this.controlsVisible&&this.player.emit("hideControls")}))}),t}createTouchBox(a,e,t){const s=this.player.createElement("div",`touch-box-${e}`).addClasses([`touch-box-${e}`,"z-40"]).appendTo(a).get();return s.style.gridColumnStart=t.x.start.toString(),s.style.gridColumnEnd=t.x.end.toString(),s.style.gridRowStart=t.y.start.toString(),s.style.gridRowEnd=t.y.end.toString(),a.appendChild(s),s}createSpeedButton(a,e=!1){if(this.player.isMobile())return;const t=this.player.createUiButton(a,"speed").get();return this.player.hasSpeeds()?t.style.display="flex":t.style.display="none",this.player.createSVGElement(t,"speed",this.buttons.speed,!1,e),t.addEventListener("click",s=>{s.stopPropagation(),this.player.emit("hide-tooltip"),this.speedMenuOpen?this.player.emit("show-menu",!1):(this.player.emit("show-speed-menu",!0),this.menuFrame.showModal())}),this.player.on("pip-internal",s=>{s?t.style.display="none":this.player.hasSpeeds()&&(t.style.display="flex")}),a.appendChild(t),t}createPIPButton(a,e=!1){if(this.player.isMobile()||!this.player.hasPipEventHandler)return;const t=this.player.createUiButton(a,"pip").get();return this.player.hasPIP()?t.style.display="flex":t.style.display="none",t.ariaLabel=this.buttons.pipEnter?.title,this.player.createSVGElement(t,"pip-enter",this.buttons.pipEnter,!1,e),this.player.createSVGElement(t,"pip-exit",this.buttons.pipExit,!0,e),document.addEventListener("visibilitychange",()=>{this.pipEnabled&&(document.hidden?document.pictureInPictureEnabled&&this.player.getVideoElement().requestPictureInPicture().then():document.pictureInPictureElement&&document.exitPictureInPicture().then())}),t.addEventListener("click",s=>{s.stopPropagation(),this.player.emit("hide-tooltip"),this.player.emit("controls",!1),this.pipEnabled?(this.pipEnabled=!1,t.querySelector(".pip-exit-icon").style.display="none",t.querySelector(".pip-enter-icon").style.display="flex",t.ariaLabel=this.buttons.pipEnter?.title,this.player.emit("pip-internal",!1),this.player.emit("pip",!1)):(this.pipEnabled=!0,t.querySelector(".pip-enter-icon").style.display="none",t.querySelector(".pip-exit-icon").style.display="flex",t.ariaLabel=this.buttons.pipExit?.title,this.player.emit("pip-internal",!0),this.player.emit("pip",!0),this.player.emit("show-menu",!1))}),this.player.on("fullscreen",()=>{this.player.getFullscreen()?t.style.display="none":t.style.display="flex"}),a.appendChild(t),t}createMenuFrame(a){this.menuFrame=this.player.createElement("dialog","menu-frame-dialog").addClasses(["group-[&.nomercyplayer:has(.open)]:backdrop:bg-black/60","group-[&.nomercyplayer:has(.open)]:backdrop:pointer-events-none"]).appendTo(a).get(),this.menuFrame.setAttribute("popover","manual"),this.menuFrame.setAttribute("role","modal");const e=this.player.createElement("div","menu-wrapper").addClasses(["menu-wrapper","text-white"]).appendTo(this.menuFrame).get();document.body.parentElement.addEventListener("click",()=>{this.player.emit("show-menu",!1),this.player.emit("show-main-menu",!1),this.player.emit("show-language-menu",!1),this.player.emit("show-subtitles-menu",!1),this.player.emit("show-subtitleSettings-menu",!1),this.player.emit("show-subtitleSetting-menu",!1),this.player.emit("show-quality-menu",!1),this.player.emit("show-speed-menu",!1),this.player.emit("show-playlist-menu",!1)});const t=this.player.createElement("div","menu-frame").addClasses(["menu-frame","absolute","flex-col","h-available","hidden","inset-4","justify-self-end","max-h-[calc(100%-2rem)]","max-w-[min(70rem,calc(100%-2rem))]","overflow-clip","rounded-lg","w-fit","z-50"]).appendTo(e).get();this.sizeMenuFrame();const s=this.player.createElement("div","menu-content").addClasses(["menu-content","flex","flex-row","h-available","justify-end","mt-auto","overflow-clip","w-full"]).appendTo(t).get();return this.player.on("ready",()=>{this.sizeMenuFrame()}),this.player.on("play",()=>{this.sizeMenuFrame()}),this.player.on("resize",()=>{this.sizeMenuFrame()}),this.player.on("fullscreen",()=>{this.sizeMenuFrame()}),this.player.on("show-menu",i=>{this.menuOpen=i,this.lockActive=i,i?(this.sizeMenuFrame(),t.style.display="flex",t.classList.add("open"),this.menuFrame.showModal()):(t.style.display="none",t.classList.remove("open"),this.menuFrame.classList.remove("group-[&.nomercyplayer:has(.open)]:backdrop:!hidden"),this.center.classList.remove("!bg-none"),this.menuFrame.close()),s.classList.add("translate-x-0"),s.classList.remove("sub-menu-open"),setTimeout(()=>{Array.from(this.mainMenu.children).find(l=>l.style.display!=="none"&&l.id!=="menu-header")?.focus()},200),this.player.emit("show-language-menu",!1),this.player.emit("show-subtitles-menu",!1),this.player.emit("hide-subtitleSettings-menu"),this.player.emit("show-subtitleSettings-menu",!1),this.player.emit("show-subtitleSetting-menu",!1),this.player.emit("show-quality-menu",!1),this.player.emit("show-speed-menu",!1),this.player.emit("show-playlist-menu",!1)}),this.player.on("show-main-menu",i=>{this.mainMenuOpen=i,this.lockActive=i,i&&(t.classList.add("open"),this.player.emit("show-language-menu",!1),this.player.emit("show-subtitles-menu",!1),this.player.emit("show-subtitleSettings-menu",!1),this.player.emit("show-subtitleSetting-menu",!1),this.player.emit("show-quality-menu",!1),this.player.emit("show-speed-menu",!1),this.player.emit("show-playlist-menu",!1),s.classList.add("translate-x-0"),s.classList.remove("sub-menu-open"),t.style.display="flex",this.menuFrame.classList.remove("group-[&.nomercyplayer:has(.open)]:backdrop:!hidden"),this.center.classList.remove("!bg-none"),setTimeout(()=>{Array.from(this.mainMenu.children).find(l=>l.style.display!=="none"&&l.id!=="menu-header")?.focus()},200))}),this.player.on("show-language-menu",i=>{this.languageMenuOpen=i,this.lockActive=i,i&&(t.classList.add("open"),this.player.emit("show-main-menu",!1),this.player.emit("show-subtitles-menu",!1),this.player.emit("show-subtitleSettings-menu",!1),this.player.emit("show-subtitleSetting-menu",!1),this.player.emit("show-quality-menu",!1),this.player.emit("show-speed-menu",!1),this.player.emit("show-playlist-menu",!1),s.classList.remove("translate-x-0"),s.classList.add("sub-menu-open"),t.style.display="flex")}),this.player.on("show-subtitles-menu",i=>{this.subtitlesMenuOpen=i,this.lockActive=i,i&&(t.classList.add("open"),this.player.emit("show-main-menu",!1),this.player.emit("show-language-menu",!1),this.player.emit("show-quality-menu",!1),this.player.emit("show-subtitleSetting-menu",!1),this.player.emit("show-speed-menu",!1),this.player.emit("show-playlist-menu",!1),s.classList.remove("translate-x-0"),s.classList.add("sub-menu-open"),t.style.display="flex")}),this.player.on("show-subtitleSettings-menu",i=>{this.subtitleSettingsMenuOpen=i,this.lockActive=i,i&&(t.classList.add("open"),this.player.emit("show-main-menu",!1),this.player.emit("show-language-menu",!1),this.player.emit("show-subtitles-menu",!1),this.player.emit("show-quality-menu",!1),this.player.emit("show-subtitleSetting-menu",!1),this.player.emit("show-speed-menu",!1),this.player.emit("show-playlist-menu",!1),s.classList.remove("translate-x-0"),s.classList.add("sub-menu-open"),t.style.display="flex")}),this.player.on("show-subtitleSetting-menu",i=>{this.subtitleSettingMenuOpen=i,this.lockActive=i,i&&(t.classList.add("open"),this.player.emit("show-main-menu",!1),this.player.emit("show-language-menu",!1),this.player.emit("show-subtitles-menu",!1),this.player.emit("show-subtitleSettings-menu",!1),this.player.emit("show-quality-menu",!1),this.player.emit("show-speed-menu",!1),this.player.emit("show-playlist-menu",!1),s.classList.remove("translate-x-0"),s.classList.add("sub-menu-open"),t.style.display="flex")}),this.player.on("show-quality-menu",i=>{this.qualityMenuOpen=i,this.lockActive=i,i&&(t.classList.add("open"),this.player.emit("show-main-menu",!1),this.player.emit("show-language-menu",!1),this.player.emit("show-subtitles-menu",!1),this.player.emit("show-subtitleSettings-menu",!1),this.player.emit("show-subtitleSetting-menu",!1),this.player.emit("show-speed-menu",!1),this.player.emit("show-playlist-menu",!1),s.classList.remove("translate-x-0"),s.classList.add("sub-menu-open"),t.style.display="flex")}),this.player.on("show-speed-menu",i=>{this.speedMenuOpen=i,this.lockActive=i,i&&(t.classList.add("open"),this.player.emit("show-main-menu",!1),this.player.emit("show-language-menu",!1),this.player.emit("show-subtitles-menu",!1),this.player.emit("show-subtitleSettings-menu",!1),this.player.emit("show-subtitleSetting-menu",!1),this.player.emit("show-quality-menu",!1),this.player.emit("show-playlist-menu",!1),s.classList.remove("translate-x-0"),s.classList.add("sub-menu-open"),t.style.display="flex")}),this.player.on("show-playlist-menu",i=>{this.playlistMenuOpen=i,this.lockActive=i,i?(t.classList.add("open"),this.player.emit("show-main-menu",!1),this.player.emit("show-language-menu",!1),this.player.emit("show-subtitles-menu",!1),this.player.emit("show-subtitleSettings-menu",!1),this.player.emit("show-subtitleSetting-menu",!1),this.player.emit("show-quality-menu",!1),this.player.emit("show-speed-menu",!1),s.classList.remove("translate-x-0"),s.classList.add("sub-menu-open"),t.style.display="flex",this.player.emit("switch-season",this.player.playlistItem().season)):t.style.width=""}),this.player.on("controls",i=>{this.lockActive=i,i||(this.player.emit("show-menu",!1),this.player.emit("show-main-menu",!1),this.player.emit("show-language-menu",!1),this.player.emit("show-subtitles-menu",!1),this.player.emit("show-subtitleSettings-menu",!1),this.player.emit("show-subtitleSetting-menu",!1),this.player.emit("show-quality-menu",!1),this.player.emit("show-speed-menu",!1),this.player.emit("show-playlist-menu",!1))}),s}sizeMenuFrame(){const a=this.player?.getElement()?.getBoundingClientRect();if(!a)return;const{width:e,height:t,top:s,bottom:i,left:l}=a;this.menuFrame.firstChild.style.width=`${e}px`,this.menuFrame.firstChild.style.height=`${t}px`,this.menuFrame.firstChild.style.top=`${s}px`,this.menuFrame.firstChild.style.bottom=`${i}px`,this.menuFrame.firstChild.style.left=`${l}px`,this.menuFrame.firstChild.style.padding="2rem",this.menuFrame.firstChild.style.position="fixed"}createMainMenu(a){return this.mainMenu=this.player.createElement("div","main-menu").addClasses(["main-menu","bg-neutral-900/95","flex","flex-col","gap-1","group-[&.nomercyplayer:has(.sub-menu-open)]:!hidden","h-auto","max-h-full","min-w-64","mt-auto","overflow-clip","p-2","pt-0","rounded-lg","pointer-events-auto"]).appendTo(a).get(),this.mainMenu.style.transform="translateX(0)",this.createMainMenuHeader(this.mainMenu).classList.add("!min-h-[2rem]","-mr-1"),this.player.addClasses(this.mainMenu,["main-menu","bg-neutral-900/95","flex","flex-col","gap-1","group-[&.nomercyplayer:has(.sub-menu-open)]:!hidden","h-auto","max-h-full","min-w-64","mt-auto","overflow-clip","p-2","pt-0","rounded-lg"]),this.player.once("translationsLoaded",()=>{this.createMenuButton(this.mainMenu,"language"),this.createMenuButton(this.mainMenu,"subtitles"),this.createMenuButton(this.mainMenu,"subtitle settings"),this.createMenuButton(this.mainMenu,"quality"),this.createMenuButton(this.mainMenu,"speed"),this.createMenuButton(this.mainMenu,"playlist"),this.player.plugins.has("autoSkip")&&this.createMenuButton(this.mainMenu,"auto skip")}),this.createSubMenu(a),this.mainMenu}createSubMenu(a){const e=this.player.createElement("div","sub-menu").addClasses(["sub-menu","bg-neutral-900/95","flex-col","gap-1","group-[&.nomercyplayer:has(.sub-menu-open)]:flex","h-auto","hidden","max-h-full","min-w-64","mt-auto","overflow-clip","rounded-lg","pointer-events-auto","w-full"]).appendTo(a).get();return e.style.transform="translateX(0)",this.createLanguageMenu(e),this.createSubtitleMenu(e),this.createSubtitleSettingsMenu(e),this.createQualityMenu(e),this.createSpeedMenu(e),this.player.options.playlist&&Array.isArray(this.player.options.playlist)?this.createEpisodeMenu(e):this.player.once("playlist",()=>{this.createEpisodeMenu(e)}),e}createMainMenuHeader(a,e=!1){const t=this.player.createElement("div","main-menu-header").addClasses(["menu-header","flex","h-9","items-center","min-h-[2.5rem]","py-2","text-white","w-available"]).addClasses(["border-b","border-gray-300/20","!p-0"]).appendTo(a).get(),s=this.player.createUiButton(t,"close").get();return this.player.createSVGElement(s,"menu",this.buttons.close,e),this.player.addClasses(s,["ml-auto","w-8"]),s.classList.remove("w-5"),s.addEventListener("click",i=>{i.stopPropagation(),this.player.emit("show-menu",!1),this.lockActive=!1,this.player.emit("controls",!1),this.menuFrame.close(),this.player.emit("dynamicControls")}),t}createMenuHeader(a,e,t=!1){const s=this.player.createElement("div","menu-header").addClasses(["menu-header","flex","h-9","items-center","min-h-[2.5rem]","py-2","text-white","w-available"]).addClasses(["border-b","border-gray-300/20"]).appendTo(a).get();if(e!=="Episodes"){const l=this.player.createUiButton(s,"back").get();this.player.createSVGElement(l,"menu",this.buttons.chevronL,t),this.player.addClasses(l,["w-8"]),l.classList.remove("w-5"),l.addEventListener("click",r=>{r.stopPropagation(),this.player.emit("show-main-menu",!0),this.player.emit("show-language-menu",!1),this.player.emit("show-subtitles-menu",!1),this.player.emit("show-quality-menu",!1),this.player.emit("show-speed-menu",!1),this.player.emit("show-playlist-menu",!1)})}const i=this.player.createElement("span","menu-button-text").addClasses(this.menuButtonTextStyles).appendTo(s).get();if(i.textContent=this.player.localize(e).toTitleCase(),e!=="Seasons"){const l=this.player.createUiButton(s,"close").get();this.player.createSVGElement(l,"menu",this.buttons.close,t),this.player.addClasses(l,["ml-auto","w-8"]),l.classList.remove("w-5"),l.addEventListener("click",r=>{r.stopPropagation(),this.player.emit("show-menu",!1),this.lockActive=!1,this.player.emit("controls",!1),this.menuFrame.close(),this.player.emit("dynamicControls")})}return s}createSubtitleSettingMenuHeader(a,e){const t=this.player.createElement("div","menu-header").addClasses(["menu-header","flex","h-9","items-center","min-h-[2.5rem]","py-2","text-white","w-available"]).addClasses(["border-b","border-gray-300/20"]).appendTo(a).get(),s=this.player.createUiButton(t,"back").get();this.player.createSVGElement(s,"menu",this.buttons.chevronL,!1),this.player.addClasses(s,["w-8"]),s.classList.remove("w-5"),s.addEventListener("click",r=>{r.stopPropagation(),this.player.emit("show-subtitleSettings-menu",!0),this.player.emit("show-subtitleSetting-menu",!1)});const i=this.player.createElement("span","menu-button-text").addClasses(this.menuButtonTextStyles).appendTo(t).get();i.textContent=this.player.localize(e).toTitleCase();const l=this.player.createUiButton(t,"close").get();return this.player.createSVGElement(l,"menu",this.buttons.close,!1),this.player.addClasses(l,["ml-auto","w-8"]),l.classList.remove("w-5"),l.addEventListener("click",r=>{r.stopPropagation(),this.player.emit("show-menu",!1),this.lockActive=!1,this.player.emit("controls",!1),this.menuFrame.close(),this.player.emit("dynamicControls")}),t}createMenuButton(a,e,t=!1){const s=this.player.spaceToCamel(e);if(s==="autoSkip"){const n=this.player.createElement("button",`menu-button-${s}`).addClasses(this.languageMenuStyles).appendTo(a).get(),o=this.player.createSVGElement(n,"skipForwardTab",this.buttons.skipForwardTab,!1,!1);this.player.addClasses(o,["w-5","h-5","transition-opacity","duration-200"]);const p=this.player.createElement("span",`menu-button-${s}-text`).addClasses(this.menuButtonTextStyles).appendTo(n).get();p.textContent=this.player.localize(e.toTitleCase());const h=this.player.createSVGElement(n,"checkmark",this.buttons.checkmark,!1,!1);this.player.addClasses(h,["ml-auto"]);const c=()=>{this.player.plugins.get("autoSkip")?.autoSkip?h.classList.remove("hidden"):h.classList.add("hidden")};return c(),n.addEventListener("click",y=>{y.stopPropagation();const u=this.player.plugins.get("autoSkip");u&&(u.autoSkip=!u.autoSkip,this.player.storage.set("auto-skip",u.autoSkip?"true":"false").then(),c())}),n}const i=this.player.createElement("button",`menu-button-${s}`).addClasses(this.languageMenuStyles).appendTo(a).get();s!=="speed"?i.style.display="none":this.player.hasSpeeds()?i.style.display="flex":i.style.display="none",this.player.createSVGElement(i,"menu",this.buttons[s],t);const l=this.player.createElement("span",`menu-button-${s}`).addClasses(this.menuButtonTextStyles).appendTo(i).get();l.textContent=this.player.localize(e.toTitleCase());const r=this.player.createSVGElement(i,"menu",this.buttons.chevronR,!1,t);this.player.addClasses(r,["ml-auto"]),i.addEventListener("click",n=>{n.stopPropagation(),this.player.emit(`show-${s}-menu`,!0),s==="playlist"&&window.nmplayer().emit("switch-season",window.nmplayer().playlistItem().season)}),s==="language"?(this.player.on("id",()=>{i.style.display="none"}),this.player.hasAudioTracks()&&(i.style.display="flex"),this.player.on("audioTracks",n=>{n.length>1?i.style.display="flex":i.style.display="none"})):s==="subtitles"?(this.player.on("id",()=>{i.style.display="none"}),this.player.hasCaptions()&&(i.style.display="flex"),this.player.on("captionsList",n=>{n.length>1?i.style.display="flex":i.style.display="none"})):s==="subtitleSettings"?i.style.display="flex":s==="quality"?(this.player.on("item",()=>{i.style.display="none"}),this.player.hasQualities()&&(i.style.display="flex"),this.player.on("levels",n=>{n.length>1?i.style.display="flex":i.style.display="none"})):s==="playlist"&&(this.player.options.playlist&&Array.isArray(this.player.options.playlist)&&(i.style.display="flex"),this.player.on("playlist",n=>{n?.length>1?i.style.display="flex":i.style.display="none"}))}createLanguageMenu(a){const e=this.player.createElement("div","language-menu").addClasses(this.subMenuContentStyles).appendTo(a).get();this.createMenuHeader(e,"Language");const t=this.player.createElement("div","language-scroll-container").addClasses(this.scrollContainerStyles).appendTo(e).get();return t.style.transform="translateX(0)",this.player.on("item",()=>{t.innerHTML=""}),this.player.hasAudioTracks()&&Object.values(this.player.getAudioTracks()).forEach(s=>{this.createLanguageMenuButton(t,{language:s.language,label:s.label,type:"audio",id:s.id,buttonType:"audio"})}),this.player.on("audioTracks",s=>{t.innerHTML="",Object.values(s).forEach(i=>{this.createLanguageMenuButton(t,{language:i.language,label:i.label,type:"audio",id:i.id,buttonType:"audio"})})}),this.player.on("show-language-menu",s=>{s?(e.style.display="flex",setTimeout(()=>{t.firstChild?.focus()},200)):e.style.display="none"}),e}createSubtitleMenu(a){const e=this.player.createElement("div","subtitle-menu").addClasses(this.subMenuContentStyles).appendTo(a).get();this.createMenuHeader(e,"subtitles");const t=this.player.createElement("div","subtitle-scroll-container").addClasses(this.scrollContainerStyles).appendTo(e).get();return t.style.transform="translateX(0)",this.player.on("item",()=>{t.innerHTML=""}),this.player.hasCaptions()&&Object.values(this.player.getCaptionsList()).forEach(s=>{this.createLanguageMenuButton(t,{language:s.language,label:s.label,type:s.type,id:s.id,buttonType:"subtitle"})}),this.player.on("captionsList",s=>{t.innerHTML="",Object.values(s).forEach(i=>{this.createLanguageMenuButton(t,{language:i.language,label:i.label,type:i.type,id:i.id,buttonType:"subtitle"})})}),this.player.on("show-subtitles-menu",s=>{s?(e.style.display="flex",setTimeout(()=>{t.firstChild?.focus()},200)):e.style.display="none"}),e}createSubtitleSettingMenuButton(a,e){const t=this.player.createElement("button",`subtitleSetting-button-${this.player.spaceToCamel(e.label)}`).addClasses(this.languageMenuStyles).appendTo(a).get(),s=this.player.createElement("span",`menu-button-text-${this.player.spaceToCamel(e.label)}`).addClasses(this.menuButtonTextStyles).appendTo(t).get();s.textContent=this.player.localize(e.label);const i=this.player.createElement("span",`menu-button-text-${this.player.spaceToCamel(e.label)}`).addClasses(this.menuButtonSubTextStyles).appendTo(t).get();if(this.player.addClasses(i,["ml-auto"]),e.property){const l=this.player.subtitleStyle[e.property].toString();this.makeSubtitleMenuText(e,l,i);const r=this.player.createSVGElement(t,"menu",this.buttons.chevronR,!1,!1);this.player.addClasses(r,["ml-2"]),this.createSubtitleSettingMenu(a,e),this.player.on("set-subtitle-style",n=>{if(e.property!==n.property)return;const o=this.player.subtitleStyle[n.property].toString();this.makeSubtitleMenuText(e,o,i)})}return t.addEventListener("click",l=>{l.stopPropagation(),e.property?this.player.emit("show-subtitleSetting-menu",e.property):this.player.setSubtitleStyle(T)}),this.addKeyEventsToLanguageButton(t,a),t}createSubtitleSettingsMenu(a){const e=this.player.createElement("div","subtitleSettings-menu").addClasses(this.subMenuContentStyles).appendTo(a).get();this.createMenuHeader(e,"subtitle settings");const t=this.player.createElement("div","subtitleSettings-scroll-container").addClasses([...this.scrollContainerStyles,"!w-80"]).appendTo(e).get();return t.style.transform="translateX(0)",this.createSubtitleSettingMenuButton(t,{label:"Font",property:"fontFamily",buttonType:"subtitleSetting"}),this.createSubtitleSettingMenuButton(t,{label:"Text size",property:"fontSize",buttonType:"subtitleSetting"}),this.createSubtitleSettingMenuButton(t,{label:"Text color",property:"textColor",buttonType:"subtitleSetting"}),this.createSubtitleSettingMenuButton(t,{label:"Text opacity",property:"textOpacity",buttonType:"subtitleSetting"}),this.createSubtitleSettingMenuButton(t,{label:"Edge style",property:"edgeStyle",buttonType:"subtitleSetting"}),this.createSubtitleSettingMenuButton(t,{label:"Area color",property:"backgroundColor",buttonType:"subtitleSetting"}),this.createSubtitleSettingMenuButton(t,{label:"Area opacity",property:"backgroundOpacity",buttonType:"subtitleSetting"}),this.createSubtitleSettingMenuButton(t,{label:"Background color",property:"areaColor",buttonType:"subtitleSetting"}),this.createSubtitleSettingMenuButton(t,{label:"Background opacity",property:"windowOpacity",buttonType:"subtitleSetting"}),this.createSubtitleSettingMenuButton(t,{label:"Reset",property:"",buttonType:"subtitleSetting"}),this.player.on("show-subtitleSettings-menu",s=>{s?(e.style.display="flex",this.menuFrame.classList.add("group-[&.nomercyplayer:has(.open)]:backdrop:!hidden"),this.center.classList.add("!bg-none"),setTimeout(()=>{t.firstChild?.focus()},200)):e.style.display="none"}),e}createSubtitleSettingMenu(a,e){const t=this.player.createElement("div",`subtitleSetting-menu-${e.property}`).addClasses(this.subMenuContentStyles).appendTo(a.parentElement.parentElement).get();t.style.display="none",this.createSubtitleSettingMenuHeader(t,e.label);const s=this.player.createElement("div",`subtitleSetting-scroll-container-${e.property}`).addClasses([...this.scrollContainerStyles,"!w-80"]).appendTo(t).get();return s.style.transform="translateX(0)",this.subtitleSettingActions.filter(i=>i.property===e.property).forEach(i=>{this.createSubtitleSettingActionButton(s,i)}),this.player.on("show-subtitleSetting-menu",i=>{e.property===i?(t.style.display="flex",this.menuFrame.classList.add("group-[&.nomercyplayer:has(.open)]:backdrop:!hidden"),this.center.classList.add("!bg-none"),setTimeout(()=>{s.firstChild?.focus()},200)):t.style.display="none"}),this.player.on("hide-subtitleSetting-menu",()=>{t.style.display="none"}),s}createSubtitleSettingActionButton(a,e){const t=this.player.createElement("button",`subtitleSetting-action-button-${e.property}`).addClasses(this.languageMenuStyles).appendTo(a).get(),s=this.player.createElement("span","menu-button-text").addClasses(this.menuButtonTextStyles).appendTo(t).get();s.textContent=this.player.localize(e.label).toTitleCase();const i=this.player.createSVGElement(t,"checkmark",this.buttons.checkmark,!1,!1);return this.player.addClasses(i,["ml-auto"]),e.value!=this.player.getSubtitleStyle()[e.property]&&i.classList.add("hidden"),this.player.on("set-subtitle-style",l=>{e.property===l.property&&(e.value===l.value?i.classList.remove("hidden"):i.classList.add("hidden"))}),t.addEventListener("click",l=>{l.stopPropagation(),e.action(l),this.player.emit("set-subtitle-style",e)}),this.addKeyEventsToLanguageButton(t,a),t}createSpeedMenu(a,e=!1){const t=this.player.createElement("div","speed-menu").addClasses(this.subMenuContentStyles).appendTo(a).get();this.createMenuHeader(t,"speed");const s=this.player.createElement("div","speed-scroll-container").addClasses(this.scrollContainerStyles).appendTo(t).get();s.style.transform="translateX(0)";for(const i of this.player.getSpeeds()??[]){const l=this.player.createElement("button",`speed-button-${i}`).addClasses(this.languageMenuStyles).appendTo(s).get(),r=this.player.createElement("span",`menu-button-text-${i}`).appendTo(l).get(),n=this.player.createElement("span",`menu-button-text-${i}`).addClasses(this.menuButtonTextStyles).appendTo(r).get();n.innerText=i===1?this.player.localize("Normal"):i.toString();const o=this.player.createSVGElement(l,"menu",this.buttons.checkmark,!1,e);this.player.addClasses(o,["ml-auto","hidden"]),this.player.on("speed",p=>{p===i?o.classList.remove("hidden"):o.classList.add("hidden")}),l.addEventListener("click",()=>{this.player.emit("show-menu",!1),this.player.setSpeed(i)}),i===this.player.getSpeed()&&o.classList.remove("hidden")}return this.player.on("show-speed-menu",i=>{i?(t.style.display="flex",setTimeout(()=>{s.firstChild?.focus()},200)):t.style.display="none"}),t}createQualityMenu(a){const e=this.player.createElement("div","quality-menu").addClasses(this.subMenuContentStyles).appendTo(a).get();this.createMenuHeader(e,"quality");const t=this.player.createElement("div","quality-scroll-container").addClasses(this.scrollContainerStyles).appendTo(e).get();return t.style.transform="translateX(0)",this.player.on("item",()=>{t.innerHTML=""}),this.player.hasQualities()&&Object.values(this.player.getQualityLevels()).forEach(s=>{this.createQualityMenuButton(t,{id:s.id,width:s.width??0,height:s.height??0,label:s.label,bitrate:s.bitrate??0})}),this.player.on("levels",s=>{t.innerHTML="",Object.values(s).forEach(i=>{this.createQualityMenuButton(t,{id:i.id,width:i.width??0,height:i.height??0,label:i.label,bitrate:i.bitrate??0})})}),this.player.on("show-quality-menu",s=>{s?(e.style.display="flex",setTimeout(()=>{t.firstChild?.focus()},200)):e.style.display="none"}),e}createQualityMenuButton(a,e,t=!1){const s=this.player.createElement("button",`quality-button-${e.height}-${e.bitrate}`).addClasses(this.languageMenuStyles).appendTo(a).get(),i=this.player.createElement("span","menu-button-text").addClasses(this.menuButtonTextStyles).appendTo(s).get();i.textContent=`${this.player.localize(e.label?.replace("segment-metadata","Off"))}`;const l=this.player.createSVGElement(s,"checkmark",this.buttons.checkmark,!1,t);return this.player.addClasses(l,["ml-auto"]),e.id>0&&l.classList.add("hidden"),this.player.on("levelsChanging",r=>{r.id===e.id?l.classList.remove("hidden"):l.classList.add("hidden")}),s.addEventListener("click",r=>{r.stopPropagation(),this.hasNoMercyConnect()?this.sendNoMercyConnectCommand("quality",e.id):this.player.setCurrentQuality(e.id),this.player.emit("show-menu",!1)}),s}createSeekRipple(a,e){const t=this.player.createElement("div","seek-ripple").addClasses(["seek-ripple",e]).appendTo(a).get(),s=this.player.createElement("div","seek-ripple-arrow").addClasses(["seek-ripple-arrow"]).appendTo(t).get(),i=this.player.createElement("p","seek-ripple-text").addClasses(["seek-ripple-text"]).appendTo(t).get();return e==="left"?(t.style.borderRadius="0 50% 50% 0",t.style.left="0px",s.innerHTML=`
				<div class="arrow arrow2 arrow-left"></div>
				<div class="arrow arrow1 arrow-left"></div>
				<div class="arrow arrow3 arrow-left"></div>
			`,this.player.on("rewind",l=>{i.textContent=`${Math.abs(l)} ${this.player.localize("seconds")}`,t.style.display="flex"}),this.player.on("remove-rewind",()=>{t.style.display="none"})):e==="right"&&(t.style.borderRadius="50% 0 0 50%",t.style.right="0px",s.innerHTML=`
				<div class="arrow arrow3 arrow-right"></div>
				<div class="arrow arrow1 arrow-right"></div>
				<div class="arrow arrow2 arrow-right"></div>
			`,this.player.on("forward",l=>{i.textContent=`${Math.abs(l)} ${this.player.localize("seconds")}`,t.style.display="flex"}),this.player.on("remove-forward",()=>{t.style.display="none"})),t}createProgressBar(a){this.sliderBar=this.player.createElement("div","slider-bar").addClasses(["slider-bar","bg-white","bg-opacity-20","flex","group/slider","h-2","mx-4","pointer-events-auto","relative","rounded-full","w-available"]).appendTo(a).get();const e=this.player.createElement("div","slider-buffer").addClasses(["slider-buffer","absolute","bg-white","bg-opacity-20","flex","h-full","overflow-clip","overflow-hidden","pointer-events-none","rounded-full","z-0"]).appendTo(this.sliderBar).get(),t=this.player.createElement("div","slider-hover").addClasses(["slider-hover","absolute","bg-white/30","flex","h-full","opacity-1","overflow-clip","overflow-hidden","pointer-events-none","rounded-full","z-0"]).appendTo(this.sliderBar).get(),s=this.player.createElement("div","slider-progress").addClasses(["slider-progress","absolute","bg-white","flex","h-full","overflow-clip","overflow-hidden","pointer-events-none","rounded-full","z-10"]).appendTo(this.sliderBar).get();this.chapterBar=this.player.createElement("div","chapter-progress").addClasses(["chapter-bar","bg-transparent","flex","h-2","overflow-clip","relative","rounded-full","w-available"]).appendTo(this.sliderBar).get();const i=document.createElement("div");this.player.addClasses(i,["slider-nipple","!-translate-x-1/2","!-translate-y-1/4","absolute","bg-white","group-hover/slider:flex","h-4","hidden","left-0","rounded-full","top-0","w-4","z-20"]),i.id="slider-nipple",this.player.options.nipple!==!1&&this.sliderBar.append(i);const l=this.player.createElement("div","slider-pop").addClasses(["slider-pop","-translate-x-1/2","absolute","bg-neutral-900/95","bottom-4","flex","flex-col","font-semibold","gap-1","hover:scale-110","overflow-clip","pb-1","pointer-events-none","rounded-md","text-center","z-20"]).appendTo(this.sliderBar).get();l.style.setProperty("--visibility","0"),l.style.opacity="var(--visibility)",this.sliderPopImage=this.player.createElement("div","slider-pop-image").addClasses(["slider-pop-image"]).appendTo(l).get();const r=this.player.createElement("div","slider-text").addClasses(["slider-pop-text","font-mono","mx-4"]).appendTo(l).get();return this.chapterText=this.player.createElement("div","chapter-text").addClasses(["chapter-text"]).appendTo(l).get(),this.player.options.chapters&&!this.player.isTv()&&this.player.getChapters()?.length>0&&(this.sliderBar.style.background=""),["mousedown","touchstart"].forEach(n=>{this.sliderBar.addEventListener(n,()=>{this.isMouseDown||(this.isMouseDown=!0,this.isScrubbing=!0)},{passive:!0})}),this.bottomBar.addEventListener("click",n=>{if(this.player.emit("hide-tooltip"),!this.isMouseDown)return;this.isMouseDown=!1,this.isScrubbing=!1,l.style.setProperty("--visibility","0");const o=this.getScrubTime(n);i.style.left=`${o.scrubTime}%`,this.hasNoMercyConnect()?this.sendNoMercyConnectCommand("seek",Number.parseInt(o.scrubTimePlayer.toString(),10)):this.player.seek(o.scrubTimePlayer)},{passive:!0}),["mousemove","touchmove"].forEach(n=>{this.sliderBar.addEventListener(n,async o=>{const p=this.getScrubTime(o);await this.getSliderPopImage(p),r.textContent=m(p.scrubTimePlayer);const h=this.getSliderPopOffsetX(l,p);l.style.left=`${h}%`,(!this.player.options.chapters||this.player.getChapters()?.length===0)&&(t.style.width=`${p.scrubTime}%`),this.isMouseDown&&(this.chapterText.innerText=this.player.getChapterText(p.scrubTimePlayer)??"",i.style.left=`${p.scrubTime}%`,this.previewTime.length>0&&l.style.setProperty("--visibility","1"))},{passive:!0})}),this.sliderBar.addEventListener("mouseover",async n=>{const o=this.getScrubTime(n);if(await this.getSliderPopImage(o),r.textContent=m(o.scrubTimePlayer),this.chapterText.innerText=this.player.getChapterText(o.scrubTimePlayer)??"",this.previewTime.length>0){l.style.setProperty("--visibility","1");const p=this.getSliderPopOffsetX(l,o);l.style.left=`${p}%`}},{passive:!0}),this.player.on("active",n=>{setTimeout(()=>{this.controlsVisible=n},(this.player.options.doubleClickDelay??300)+10),!n&&l.style.setProperty("--visibility","0")}),this.sliderBar.addEventListener("mouseleave",()=>{l.style.setProperty("--visibility","0"),t.style.width="0"},{passive:!0}),this.player.on("seeked",()=>{l.style.setProperty("--visibility","0")}),this.player.on("item",async()=>{this.sliderBar.classList.add("bg-white/20"),this.chapters=[],e.style.width="0",s.style.width="0",await this.fetchPreviewTime()}),this.player.on("chapters",()=>{this.player.getChapters()?.length>0&&!this.player.isTv()?this.sliderBar.classList.remove("bg-white/20"):this.sliderBar.classList.add("bg-white/20")}),this.player.on("time",n=>{this.player.getChapters()?.length===0&&(s.style.width=`${n.percentage}%`),this.isScrubbing||(i.style.left=`${n.percentage}%`)}),this.player.on("controls",n=>{n||(l.style.setProperty("--visibility","0"),this.menuFrame.close())}),this.player.on("pip-internal",n=>{n?this.sliderBar.style.display="none":this.sliderBar.style.display="flex"}),this.sliderBar}createChapterMarker(a){const e=this.player.createElement("div",`chapter-marker-${a.id.replace(/\s/gu,"-")}`).addClasses(["chapter-marker","[&:last-child(2):.5px]","absolute","h-available","last:translate-x-[1.5px]","min-w-[2px]","overflow-hidden","rounded-sm"]).appendTo(this.chapterBar).get();e.style.left=`${a.left}%`,e.style.width=`calc(${a.width}% - 2px)`,this.player.createElement("div",`chapter-marker-bg-${a.id.replace(/\s/gu,"-")}`).addClasses(["chapter-marker-bg","absolute","bg-white","bg-opacity-20","h-available","left-0","rounded-sm","w-available","z-0"]).appendTo(e).get();const t=this.player.createElement("div",`chapter-marker-hover-${a.id.replace(/\s/gu,"-")}`).addClasses(["chapter-marker-hover","absolute","bg-gray-200","h-available","left-0","origin-left","rounded-sm","scale-x-0","w-available","z-10"]).appendTo(e).get(),s=this.player.createElement("div",`chapter-marker-progress-${a.id.replace(/\s/gu,"-")}`).addClasses(["chapter-marker-progress","absolute","bg-white","h-available","left-0","origin-left","rounded-sm","scale-x-0","w-available","z-20"]).appendTo(e).get(),i=a.left,l=a.left+a.width;return this.player.on("time",r=>{r.percentage<i?s.style.transform="scaleX(0)":r.percentage>l?s.style.transform="scaleX(1)":s.style.transform=`scaleX(${(r.percentage-i)/(l-i)})`}),["mousemove","touchmove"].forEach(r=>{this.chapterBar.addEventListener(r,n=>{const{scrubTime:o}=this.getScrubTime(n);o<i?t.style.transform="scaleX(0)":o>l?t.style.transform="scaleX(1)":t.style.transform=`scaleX(${(o-i)/(l-i)})`})}),this.chapterBar.addEventListener("mouseleave",()=>{t.style.transform="scaleX(0)"}),e}createChapterMarkers(){this.player.isTv()||(this.chapterBar.style.background="",this.player.on("item",()=>{this.chapterBar.style.background=""}),this.chapterBar.querySelectorAll(".chapter-marker").forEach(a=>{this.chapterBar.classList.add("bg-white/20"),a.remove()}),this.player.getChapters()?.forEach(a=>{this.createChapterMarker(a)}))}getSliderPopOffsetX(a,e){const t=this.sliderBar.getBoundingClientRect(),i=a.getBoundingClientRect().width*.5/t.width*100;let l=e.scrubTime;return l<=i&&(l=i),l>=100-i&&(l=100-i),l}createEpisodeMenu(a){if(!this.player.getVideoElement())return;const e=this.player.createElement("div","playlist-menu").addClasses([...this.subMenuContentStyles,"!flex-row","!gap-0"]).appendTo(a).get(),t=this.player.createElement("div","sub-menu-content").addClasses([...this.subMenuContentStyles,"!w-1/3","border-r-2","border-gray-500/20"]).appendTo(e).get();this.createMenuHeader(t,"Seasons");const s=this.player.createElement("div","playlist-scroll-container").addClasses(this.scrollContainerStyles).appendTo(t).get();s.style.transform="translateX(0)",this.player.on("playlist",r=>{s.innerHTML="";for(const[,n]of w(this.player.getPlaylist(),"season").entries()??[])this.createSeasonMenuButton(s,n)});const i=this.player.createElement("div","episode-menu").addClasses([...this.subMenuContentStyles,"!w-[63rem]"]).appendTo(e).get();this.createMainMenuHeader(i);const l=this.player.createElement("div","playlist-scroll-container").addClasses(this.scrollContainerStyles).appendTo(i).get();return l.innerHTML="",l.tabIndex=1,l.addEventListener("focus",()=>{l.firstChild?.focus()}),this.player.on("playlist",r=>{l.innerHTML="";for(const[n,o]of Object.values(r).entries()??[])this.createEpisodeMenuButton(l,o,n)}),this.player.on("show-playlist-menu",r=>{r?(e.style.display="flex",setTimeout(()=>{l.firstChild?.focus()},200)):e.style.display="none"}),e}createSeasonMenuButton(a,e,t=!1){if(e?.season===null||e?.season===void 0)return;const s=this.player.createElement("button",`season-${e.id}`).addClasses(this.languageMenuStyles).appendTo(a).get(),i=this.player.createElement("span",`season-${e.id}-span`).addClasses(this.menuButtonTextStyles).appendTo(s).get();i.textContent=e?.seasonName?e?.seasonName:e?.season?`${this.player.localize("Season")} ${e?.season}`:"";const l=this.player.createSVGElement(s,"menu",this.buttons.chevronR,!1,t);return this.player.addClasses(l,["ml-auto"]),s.addEventListener("click",r=>{r.stopPropagation(),this.player.emit("switch-season",e?.season)}),s.addEventListener("focus",()=>{setTimeout(()=>{this.player.scrollCenter(s,a,{duration:100,margin:1})},50)}),s}createEpisodeMenuButton(a,e,t){const s=this.player.createElement("button",`playlist-${e.id}`).addClasses(["playlist-menu-button","duration-200","flex","focus-visible:outline-2","focus-visible:outline-white","gap-2","hover:bg-neutral-600/20","outline","outline-1","outline-solid","outline-transparent","p-2","relative","rounded-lg","snap-center","text-white","transition-all","w-available"]).appendTo(a).get();this.player.playlistItem()?.season!==1&&(s.style.display="none");const i=this.player.createElement("div",`playlist-${e.id}-left`).addClasses(["episode-menu-button-left","h-available","overflow-clip","pointer-events-none","relative","rounded-md","self-center","w-[30%]"]).appendTo(s).get();this.player.createElement("div",`episode-${e.id}-shadow`).addClasses(["episode-menu-button-shadow","!h-available","absolute","bg-[linear-gradient(0deg,rgba(0,0,0,0.87)_0%,rgba(0,0,0,0.7)_25%,rgba(0,0,0,0)_50%,rgba(0,0,0,0)_100%)]","bottom-0","left-0","shadow-[inset_0px_1px_0px_rgba(255,255,255,0.24),inset_0px_-1px_0px_rgba(0,0,0,0.24),inset_0px_-2px_0px_rgba(0,0,0,0.24)]","w-available"]).appendTo(i).get();const l=this.player.createElement("img",`episode-${e.id}-image`).addClasses(["episode-menu-button-image","aspect-video","h-auto","object-cover","w-available"]).appendTo(i).get();l.setAttribute("loading","lazy"),l.src=e.image&&e.image!==""?`${this.imageBaseUrl.includes("https")?"":this.imageBaseUrl}${e.image}`:"";const r=this.player.createElement("div",`episode-${e.id}-progress-container`).addClasses(["episode-menu-progress-container","absolute","bottom-0","flex","flex-col","px-3","w-available"]).appendTo(i).get(),n=this.player.createElement("div",`episode-${e.id}-progress-box`).addClasses(["episode-menu-progress-box","flex","h-available","justify-between","mb-1","px-1","sm:mx-2"]).appendTo(r).get(),o=this.player.createElement("div",`episode-${e.id}-progress-item`).addClasses(["progress-item-text","text-[0.7rem]"]).appendTo(n).get();e.episode&&(o.textContent=`${this.player.localize("E")}${e.episode}`);const p=this.player.createElement("div",`episode-${e.id}-progress-duration`).addClasses(["progress-duration","text-[0.7rem]"]).appendTo(n).get();p.innerText=e.duration?.replace(/^00:/u,"")??"";const h=this.player.createElement("div",`episode-${e.id}-slider-container`).addClasses(["slider-container","bg-gray-500/80","h-1","hidden","mb-2","mx-1","overflow-clip","rounded-md","sm:mx-2"]).appendTo(r).get(),c=this.player.createElement("div",`episode-${e.id}-progress-bar`).addClasses(["progress-bar","bg-white"]).appendTo(h).get();e.progress?.time&&(c.style.width=`${e.progress.time/v(e.duration)*100}%`,h.style.display="flex");const y=this.player.createElement("div",`episode-${e.id}-right-side`).addClasses(["playlist-card-right","flex","flex-col","gap-1","pointer-events-none","text-left","w-3/4"]).appendTo(s).get(),u=this.player.createElement("span",`episode-${e.id}-title`).addClasses(["playlist-menu-button-title","font-bold","line-clamp-2","text-white"]).appendTo(y).get();e.episode&&(u.textContent=x(e.title?.replace(e.show??"","").replace("%S",this.player.localize("S")).replace("%E",this.player.localize("E"))));const g=this.player.createElement("span",`episode-${e.id}-overview`).addClasses(["playlist-menu-button-overview","leading-[1rem]","line-clamp-4","overflow-hidden","text-[0.7rem]","text-white"]).appendTo(y).get();return g.textContent=C(e.description,600),this.player.on("item",d=>{d.season===e.season?s.style.display="flex":s.style.display="none",this.player.playlistItem().season===e.season&&this.player.playlistItem().episode===e.episode?s.style.background="rgba(255,255,255,.1)":s.style.background=""}),this.player.on("switch-season",d=>{d===e.season?s.style.display="flex":s.style.display="none"}),this.player.on("time",d=>{this.player.playlistItem()?.id===e.id&&(c.style.width=`${d.percentage}%`,d.percentage>0&&(h.style.display="flex"))}),e.episode&&e.show&&(o.innerText=e.season===void 0?`${e.episode}`:`${this.player.localize("S")}${e.season}: ${this.player.localize("E")}${e.episode}`),s.addEventListener("click",()=>{this.player.emit("show-menu",!1),e.episode&&e.season?this.hasNoMercyConnect()?this.sendNoMercyConnectCommand("episode",JSON.stringify({season:e.season,episode:e.episode})):this.player.setEpisode(e.season,e.episode):this.hasNoMercyConnect()?this.sendNoMercyConnectCommand("item",t):this.player.playlistItem(t),this.player.emit("playlist-menu-button-clicked",e)}),s.addEventListener("focus",()=>{setTimeout(()=>{this.player.scrollCenter(s,a,{duration:100,margin:1})},50)}),s}createToolTip(a){return this.tooltip=this.player.createElement("div","tooltip").addClasses(["tooltip","absolute","bg-neutral-900/95","bottom-0","font-medium","hidden","left-0","pointer-events-none","px-3","py-2","rounded-lg","text-white","text-xs","z-50"]).appendTo(a).get(),this.tooltip.style.transform="translateX(10px)",this.tooltip.textContent="Play (space)",this.player.on("show-tooltip",e=>{this.tooltip.textContent=e.text,this.tooltip.style.display="block",this.tooltip.style.transform=`translate(calc(${e.x} - 50%), calc(${e.y} - 100%))`,e.currentTime==="top"?(this.tooltip.classList.add("top-0"),this.tooltip.classList.remove("bottom-0")):(this.tooltip.classList.remove("top-0"),this.tooltip.classList.add("bottom-0"))}),this.player.on("hide-tooltip",()=>{this.tooltip.style.display="none"}),this.tooltip}createEpisodeTip(a){const e=this.player.createElement("div","episode-tip").addClasses(["episode-tip","!w-96","-bottom-8","absolute","bg-neutral-900/95","font-medium","gap-2","h-24","hidden","left-0","px-2","py-2","rounded-lg","text-white","text-xs","z-50","group-[&.nomercyplayer:not(.active)]:!hidden"]).appendTo(a).get(),t=this.player.createElement("div","next-tip-left").addClasses(["next-tip-left","overflow-clip","relative","rounded-sm","self-center","w-[40%]"]).appendTo(e).get(),s=this.player.createElement("img","next-tip-image").addClasses(["playlist-card-image","aspect-video","h-auto","object-cover","rounded-sm","w-available"]).appendTo(t).get();s.setAttribute("loading","eager");const i=this.player.createElement("div","next-tip-right-side").addClasses(["next-tip-right","flex","flex-col","gap-1","text-left","w-[60%]"]).appendTo(e).get(),l=this.player.createElement("span","next-tip-header").addClasses(["next-tip-header","font-bold"]).appendTo(i).get(),r=this.player.createElement("span","next-tip-title").addClasses(["next-tip-header","font-bold","font-sm","line-clamp-3"]).appendTo(i).get();return this.player.on("show-episode-tip",n=>{this.getTipData({direction:n.direction,header:l,title:r,image:s}),e.style.display="flex",e.style.transform=`translate(${n.x}, calc(${n.y} - 50%))`}),this.player.on("hide-episode-tip",()=>{e.style.display="none"}),e}getTipDataIndex(a){let e=this.player.getPlaylistIndex();return a==="previous"?e-=1:e+=1,this.player.getPlaylist().at(e)}getTipData({direction:a,header:e,title:t,image:s}){const i=this.getTipDataIndex(a);i&&(s.src=i.image&&i.image!==""?`${this.imageBaseUrl}${i.image}`:"",e.textContent=`${this.player.localize(`${a.toTitleCase()} Episode`)} ${this.player.getButtonKeyCode(a)}`,t.textContent=i.title?.replace(i.show??"","").replace("%S",this.player.localize("S")).replace("%E",this.player.localize("E")),this.player.once("item",()=>{this.getTipData({direction:a,header:e,title:t,image:s})}))}getScrubTime(a,e=this.sliderBar){const t=e.getBoundingClientRect();let i=(a.clientX??a.touches?.[0]?.clientX??a.changedTouches?.[0]?.clientX??0)-t.left;return i<=0&&(i=0),i>=t.width&&(i=t.width),{scrubTime:i/e.offsetWidth*100,scrubTimePlayer:i/e.offsetWidth*this.player.getDuration()}}makeSubtitleMenuText(a,e,t){a.property==="fontFamily"?(this.player.options.debug&&console.log(f.find(s=>s.value===e)),t.textContent=f.find(s=>s.value===e).name):a.property==="edgeStyle"?t.textContent=E.find(s=>s.value===e).name:t.textContent=(e+(this.player.isNumber(e)?"%":"")).toTitleCase()}}export{L as D};
