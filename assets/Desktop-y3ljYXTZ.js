import{D as $,Dn as D,Ht as k,Rn as a,Tn as d,Wn as p,Yt as A,Zn as b,cn as n,en as B,in as I,kn as w,nn as f,sn as c,tn as s,tr as v,un as x,x as E}from"./index-04Sh3wNb.js";import"./dist-CVoPesok.js";import"./esm-BuFVrMo0.js";import"./esm-9iWgK55i.js";import"./esm-cDzTb79E.js";import"./esm-BfF1RlcU.js";import"./dist-B3n7-doU.js";import"./focus-visible-CHAJCf_J.js";import"./index5-B30D6T27.js";import"./client-rtF7IPPI.js";import"./ionic-global--aoJHCDL.js";import"./hardware-back-button-h528z6zo.js";import"./index3-CSo3jo06.js";import"./helpers-CXS86XKs.js";import"./index6-CZ6rqL_0.js";import"./index8-BpkFXja0.js";import"./keyboard-cU79cwdW.js";import"./index2-op38TIl9.js";import"./ios.transition-C8T7q-Bo.js";import"./keyboard2-DETZ41vp.js";import"./md.transition-BqH5iNQr.js";import"./dir-BUtgAzbR.js";import"./ui-BT6EUdI0.js";import"./client-DMa-uSBE.js";import{t as M}from"./currentServer-B7-kbkE-.js";import"./config-BOA2pGQM.js";import"./esm-CcKFjObu.js";import"./global-gyhCjh_P.js";import"./esm-BuRgllmc.js";import"./user-C1ciKa7-.js";import"./serverClient-FHPKIHPu.js";import"./router-C_xBvmya.js";import"./utils-D5DD-7jP.js";import"./useBaseQuery-CNJp2kAB.js";import"./useInfiniteServerClient-By5CuBlL.js";import{tt as j}from"./SocketClient-DPmgFkP-.js";import"./useQueryClient-s6ZLwuD6.js";import"./useQuery-C7DDAmeN.js";import{t as T}from"./apiClient-Cw7f36ko.js";import"./notifications-Bi_dU6lP.js";import"./utils-CdenF_Jv.js";import"./bundle-mjs-Xm_uQvzT.js";import"./deviceInfo-Bcw3-ht5.js";import"./helpers-fSCF1qXj.js";import"./auth-DfyD43WY.js";import"./_plugin-vue_export-helper-B_iOTHZb.js";import"./AppLogoSquare-DJq6h5gt.js";import"./MoooomIcon-DNWQYuYD.js";import{n as L}from"./dist-iWIfSzlj.js";import"./md5-DV93ZS5Z.js";import{t as N}from"./useServerClient-CroZbKWw.js";import"./ScrollContainer-3_hZWeKa.js";import"./useMounted-CBZpV1fi.js";import"./RipperOverlay-BWEr7uxe.js";import"./HubConnection-BtQMN1V5.js";import"./ripperSocket-C9kIp3Ty.js";import{t as C}from"./Button-BOqv4y1r.js";import{t as Z}from"./Modal-B2WRzJvm.js";import"./FloatingBackButton-D3UgtlFi.js";import{t as z}from"./DashboardLayout-CXf1x5EO.js";import{t as F}from"./DashboardCard-1p8adrLL.js";import{t as K}from"./useApiClient-CCMNDw1L.js";import{t as O}from"./Avatar-DevcIi_5.js";k();var W={class:"backdropCard relative flex aspect-square h-auto w-full flex-col items-center justify-center overflow-clip rounded-lg bg-black"},H=["src"],P=x({__name:"UserCard",props:{data:{type:Object,required:!0}},setup(l){const o=p(!1);function m(e){console.error(e),e.target.onerror=null,o.value=!0}return(e,i)=>(d(),f(F,{line1:l.data.name,route:`/dashboard/users/${l.data.user_id}`,line2:""},{image:a(()=>[s("div",W,[i[0]||(i[0]=s("div",{class:"backdropCard-overlay"},null,-1)),l.data.avatar&&!o.value?(d(),I("img",{key:0,onerror:m,src:l.data.avatar,alt:"",class:"w-full h-full object-cover rounded-lg backdropCard-image"},null,8,H)):(d(),f(O,{key:1,email:l.data.email,class:"w-full backdropCard-image"},null,8,["email"]))])]),_:1},8,["line1","route"]))}}),Q=P;k();var R={class:"flex w-full flex-col justify-start text-left"},Y={class:"py-4 text-sm text-surface-10"},G={class:"flex flex-col gap-2 w-full"},J={class:"pointer-events-auto mt-2 w-full flex-col gap-1 card flex justify-center"},X=x({__name:"InviteUserModal",props:{open:{type:Boolean,required:!0},close:{type:Function,required:!0}},setup(l){const o=l,{t:m}=L();p(null);const e=p(""),i=p([]),{data:h}=N({path:"/dashboard/libraries"}),_=p();function u(){i.value=[],o.close()}function y(t){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/u.test(String(t).toLowerCase())}const S=B(()=>e.value?y(e.value):!1);function V(){if(!e.value){i.value.push({type:"error",place:"email",message:m("Email is required")});return}if(!y(e.value)){i.value.push({type:"error",place:"email",message:m("Invalid email address")});return}T().post("server/server-users",{id:M.value?.id,email:e.value,libraries:_.value?.map(t=>t.id)}).then(()=>{j.invalidateQueries({queryKey:["server_users"]}),e.value="",o.close()}).catch(({response:t})=>{t?.status!==200&&t?.data&&i.value.push({message:t.data.message??"An error occurred",place:"email",type:t.data.status??t.data.exception})})}return(t,r)=>{const q=w("InputText"),U=w("MultiSelect");return d(),f(Z,{close:u,open:l.open,title:"Invite user"},{actions:a(()=>[n(C,{id:"yes",disabled:!S.value,color:"theme","end-icon":"emailSend",type:"button",variant:"contained",onClick:V},{default:a(()=>[c(v(t.$t("Send")),1)]),_:1},8,["disabled"]),n(C,{id:"no",type:"button",variant:"text",onClick:u},{default:a(()=>[c(v(t.$t("Cancel")),1)]),_:1})]),default:a(()=>[s("div",R,[s("p",Y,[c(v(t.$t("Enter the email of the friend you want to invite to your server.")),1),r[2]||(r[2]=s("br",null,null,-1)),c(" "+v(t.$t("We will send this person an email with a link to join the server, if they accept the invitation they will be automatically shown here.")),1)]),s("div",G,[r[3]||(r[3]=s("label",{for:"email"},"Email",-1)),n(q,{id:"email",modelValue:e.value,"onUpdate:modelValue":r[0]||(r[0]=g=>e.value=g),class:"mb-4"},null,8,["modelValue"])]),s("div",J,[r[4]||(r[4]=s("label",{for:"libraries"},"Allowed libraries",-1)),n(U,{id:"libraries",modelValue:_.value,"onUpdate:modelValue":r[1]||(r[1]=g=>_.value=g),options:b(h),display:"chip",label:"libraries",multiple:"","option-label":"title",placeholder:"Select libraries"},null,8,["modelValue","options"])])])]),_:1},8,["open"])}}}),ee=X;k();var te=x({__name:"Desktop",setup(l){const o=p(!1),{data:m}=K({path:"server/server-users",params:{id:M.value?.id},queryKey:["server_users"]});function e(){o.value=!0,setTimeout(()=>{document.querySelector("#email")?.focus()},300)}function i(){o.value=!1}return(h,_)=>(d(),f(b($),null,{default:a(()=>[n(b(E),{fullscreen:!0},{default:a(()=>[n(z,{"grid-style":1,title:"Server members",description:"Manage your server members and their account permissions here."},{cta:a(()=>[n(C,{id:"invite",color:"theme","start-icon":"userAdd",onClick:e},{default:a(()=>[c(v(h.$t("Invite user")),1)]),_:1})]),default:a(()=>[(d(!0),I(A,null,D([...b(m)??[]].sort((u,y)=>u.name.localeCompare(y.name)),u=>(d(),f(Q,{key:u.user_id,data:u},null,8,["data"]))),128)),n(ee,{open:o.value,close:i},null,8,["open"])]),_:1})]),_:1})]),_:1}))}}),mt=te;export{mt as default};
