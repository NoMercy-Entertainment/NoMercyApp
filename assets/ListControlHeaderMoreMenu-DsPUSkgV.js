import{Et as Z,Gt as D,Ln as M,Lt as w,Mt as G,Rn as E,Rt as F,Sn as J,Tt as A,Vn as X,Vt as Y,Zt as ee,an as te,bn as z,cn as P,dn as B,kn as S,ln as ae,on as le,pn as ne,qt as k,tn as x,un as re,xn as R,zt as O}from"./index-BVMfOxho.js";import{t as se}from"./button-DrEO03-q.js";import{t as q}from"./currentServer-wKQllb71.js";import{r as $}from"./global-DPeGmG9M.js";import{t as j}from"./bundle-mjs-DqJ8Zzkh.js";import{_ as L,a as C,c as oe,d as V,f as ue,g as ie,h as ce,i as p,l as de,m as ve,n as I,o as fe,p as U,r as pe,s as me,t as be,u as ge}from"./use-text-value-DhD6xazs.js";import{a as Ie,c as b,r as H,s as ye,t as N}from"./render-pzL1lImx.js";import{t as K}from"./MoooomIcon-x_D_dAky.js";A();function he({container:a,accept:v,walk:m,enabled:r}){z(()=>{let f=a.value;if(!f||r!==void 0&&!r.value)return;let d=Ie(a);if(!d)return;let e=Object.assign(o=>v(o),{acceptNode:v}),s=d.createTreeWalker(f,NodeFilter.SHOW_ELEMENT,e,!1);for(;s.nextNode();)m(s.currentNode)})}A();var Me=(a=>(a[a.Open=0]="Open",a[a.Closed=1]="Closed",a))(Me||{}),Se=(a=>(a[a.Pointer=0]="Pointer",a[a.Other=1]="Other",a))(Se||{});function we(a){requestAnimationFrame(()=>requestAnimationFrame(a))}var W=Symbol("MenuContext");function _(a){let v=ee(W,null);if(v===null){let m=new Error(`<${a} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(m,_),m}return v}var xe=k({name:"Menu",props:{as:{type:[Object,String],default:"template"}},setup(a,{slots:v,attrs:m}){let r=S(1),f=S(null),d=S(null),e=S([]),s=S(""),o=S(null),y=S(1);function h(t=n=>n){let n=o.value!==null?e.value[o.value]:null,l=ue(t(e.value.slice()),g=>b(g.dataRef.domRef)),i=n?l.indexOf(n):null;return i===-1&&(i=null),{items:l,activeItemIndex:i}}let u={menuState:r,buttonRef:f,itemsRef:d,items:e,searchQuery:s,activeItemIndex:o,activationTrigger:y,closeMenu:()=>{r.value=1,o.value=null},openMenu:()=>r.value=0,goToItem(t,n,l){let i=h(),g=pe(t===I.Specific?{focus:I.Specific,id:n}:{focus:t},{resolveItems:()=>i.items,resolveActiveIndex:()=>i.activeItemIndex,resolveId:c=>c.id,resolveDisabled:c=>c.dataRef.disabled});s.value="",o.value=g,y.value=l??1,e.value=i.items},search(t){let n=s.value!==""?0:1;s.value+=t.toLowerCase();let l=(o.value!==null?e.value.slice(o.value+n).concat(e.value.slice(0,o.value+n)):e.value).find(g=>g.dataRef.textValue.startsWith(s.value)&&!g.dataRef.disabled),i=l?e.value.indexOf(l):-1;i===-1||i===o.value||(o.value=i,y.value=1)},clearSearch(){s.value=""},registerItem(t,n){let l=h(i=>[...i,{id:t,dataRef:n}]);e.value=l.items,o.value=l.activeItemIndex,y.value=1},unregisterItem(t){let n=h(l=>{let i=l.findIndex(g=>g.id===t);return i!==-1&&l.splice(i,1),l});e.value=n.items,o.value=n.activeItemIndex,y.value=1}};return ge([f,d],(t,n)=>{var l;u.closeMenu(),ie(n,ve.Loose)||(t.preventDefault(),(l=b(f))==null||l.focus())},w(()=>r.value===0)),ae(W,u),me(w(()=>ye(r.value,{0:C.Open,1:C.Closed}))),()=>{let t={open:r.value===0,close:u.closeMenu};return N({ourProps:{},theirProps:a,slot:t,slots:v,attrs:m,name:"Menu"})}}}),Re=k({name:"MenuButton",props:{disabled:{type:Boolean,default:!1},as:{type:[Object,String],default:"button"},id:{type:String,default:null}},setup(a,{attrs:v,slots:m,expose:r}){var f;let d=(f=a.id)!=null?f:`headlessui-menu-button-${L()}`,e=_("MenuButton");r({el:e.buttonRef,$el:e.buttonRef});function s(u){switch(u.key){case p.Space:case p.Enter:case p.ArrowDown:u.preventDefault(),u.stopPropagation(),e.openMenu(),x(()=>{var t;(t=b(e.itemsRef))==null||t.focus({preventScroll:!0}),e.goToItem(I.First)});break;case p.ArrowUp:u.preventDefault(),u.stopPropagation(),e.openMenu(),x(()=>{var t;(t=b(e.itemsRef))==null||t.focus({preventScroll:!0}),e.goToItem(I.Last)});break}}function o(u){switch(u.key){case p.Space:u.preventDefault();break}}function y(u){a.disabled||(e.menuState.value===0?(e.closeMenu(),x(()=>{var t;return(t=b(e.buttonRef))==null?void 0:t.focus({preventScroll:!0})})):(u.preventDefault(),e.openMenu(),we(()=>{var t;return(t=b(e.itemsRef))==null?void 0:t.focus({preventScroll:!0})})))}let h=de(w(()=>({as:a.as,type:v.type})),e.buttonRef);return()=>{var u;let t={open:e.menuState.value===0},{...n}=a,l={ref:e.buttonRef,id:d,type:h.value,"aria-haspopup":"menu","aria-controls":(u=b(e.itemsRef))==null?void 0:u.id,"aria-expanded":e.menuState.value===0,onKeydown:s,onKeyup:o,onClick:y};return N({ourProps:l,theirProps:n,slot:t,attrs:v,slots:m,name:"MenuButton"})}}}),ke=k({name:"MenuItems",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:null}},setup(a,{attrs:v,slots:m,expose:r}){var f;let d=(f=a.id)!=null?f:`headlessui-menu-items-${L()}`,e=_("MenuItems"),s=S(null);r({el:e.itemsRef,$el:e.itemsRef}),he({container:w(()=>b(e.itemsRef)),enabled:w(()=>e.menuState.value===0),accept(t){return t.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:t.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(t){t.setAttribute("role","none")}});function o(t){var n;switch(s.value&&clearTimeout(s.value),t.key){case p.Space:if(e.searchQuery.value!=="")return t.preventDefault(),t.stopPropagation(),e.search(t.key);case p.Enter:if(t.preventDefault(),t.stopPropagation(),e.activeItemIndex.value!==null){let l=e.items.value[e.activeItemIndex.value];(n=b(l.dataRef.domRef))==null||n.click()}e.closeMenu(),U(b(e.buttonRef));break;case p.ArrowDown:return t.preventDefault(),t.stopPropagation(),e.goToItem(I.Next);case p.ArrowUp:return t.preventDefault(),t.stopPropagation(),e.goToItem(I.Previous);case p.Home:case p.PageUp:return t.preventDefault(),t.stopPropagation(),e.goToItem(I.First);case p.End:case p.PageDown:return t.preventDefault(),t.stopPropagation(),e.goToItem(I.Last);case p.Escape:t.preventDefault(),t.stopPropagation(),e.closeMenu(),x(()=>{var l;return(l=b(e.buttonRef))==null?void 0:l.focus({preventScroll:!0})});break;case p.Tab:t.preventDefault(),t.stopPropagation(),e.closeMenu(),x(()=>ce(b(e.buttonRef),t.shiftKey?V.Previous:V.Next));break;default:t.key.length===1&&(e.search(t.key),s.value=setTimeout(()=>e.clearSearch(),350));break}}function y(t){switch(t.key){case p.Space:t.preventDefault();break}}let h=fe(),u=w(()=>h!==null?(h.value&C.Open)===C.Open:e.menuState.value===0);return()=>{var t,n;let l={open:e.menuState.value===0},{...i}=a,g={"aria-activedescendant":e.activeItemIndex.value===null||(t=e.items.value[e.activeItemIndex.value])==null?void 0:t.id,"aria-labelledby":(n=b(e.buttonRef))==null?void 0:n.id,id:d,onKeydown:o,onKeyup:y,role:"menu",tabIndex:0,ref:e.itemsRef};return N({ourProps:g,theirProps:i,slot:l,attrs:v,slots:m,features:H.RenderStrategy|H.Static,visible:u.value,name:"MenuItems"})}}}),Te=k({name:"MenuItem",inheritAttrs:!1,props:{as:{type:[Object,String],default:"template"},disabled:{type:Boolean,default:!1},id:{type:String,default:null}},setup(a,{slots:v,attrs:m,expose:r}){var f;let d=(f=a.id)!=null?f:`headlessui-menu-item-${L()}`,e=_("MenuItem"),s=S(null);r({el:s,$el:s});let o=w(()=>e.activeItemIndex.value!==null?e.items.value[e.activeItemIndex.value].id===d:!1),y=be(s),h=w(()=>({disabled:a.disabled,get textValue(){return y()},domRef:s}));te(()=>e.registerItem(d,h)),le(()=>e.unregisterItem(d)),z(()=>{e.menuState.value===0&&o.value&&e.activationTrigger.value!==0&&x(()=>{var c,T;return(T=(c=b(s))==null?void 0:c.scrollIntoView)==null?void 0:T.call(c,{block:"nearest"})})});function u(c){if(a.disabled)return c.preventDefault();e.closeMenu(),U(b(e.buttonRef))}function t(){if(a.disabled)return e.goToItem(I.Nothing);e.goToItem(I.Specific,d)}let n=oe();function l(c){n.update(c)}function i(c){n.wasMoved(c)&&(a.disabled||o.value||e.goToItem(I.Specific,d,0))}function g(c){n.wasMoved(c)&&(a.disabled||o.value&&e.goToItem(I.Nothing))}return()=>{let{disabled:c,...T}=a,Q={active:o.value,disabled:c,close:e.closeMenu};return N({ourProps:{id:d,ref:s,role:"menuitem",tabIndex:c===!0?void 0:-1,"aria-disabled":c===!0?!0:void 0,onClick:u,onFocus:t,onPointerenter:l,onMouseenter:l,onPointermove:i,onMousemove:i,onPointerleave:g,onMouseleave:g},theirProps:{...m,...T},slot:Q,attrs:m,slots:v,name:"MenuItem"})}}});A();var De={class:"relative flex flex-1 items-center justify-start gap-2 text-base font-semibold"},Pe={class:"flex flex-1 w-full whitespace-nowrap"},Ce=k({__name:"ListControlHeaderMoreMenu",props:{items:{type:Array,required:!0},className:{type:String,required:!1,default:""},title:{type:String,required:!1,default:"More options"},showDelay:{type:Number,required:!1,default:750},hideDelay:{type:Number,required:!1,default:300},noTip:{type:Boolean,required:!1,default:!1}},setup(a){const v=a,m=w(()=>v.items.filter(r=>!r.privileged||r.privileged&&(q.value?.is_owner||q.value?.is_manager)));return(r,f)=>{const d=ne("tooltip");return P(),O(M(xe),{as:"div",class:"relative select-none z-[150]"},{default:R(()=>[J((P(),O(M(se),{"aria-label":r.$t(a.title),as:M(Re),class:E([{[M(j)(M($),"flex flex-nowrap w-fit min-w-fit")]:!0},"data-[headlessui-state='open']:bg-surface-12/6 sm:data-[headlessui-state='open']:bg-surface-12/6"]),unstyled:!0},{default:R(()=>[B(r.$slots,"button",{},()=>[D(K,{icon:"menuDotsHorizontal"})])]),_:3},8,["aria-label","as","class"])),[[d,{showDelay:a.showDelay,hideDelay:a.hideDelay,value:a.noTip?null:r.$t(a.title)},void 0,{top:!0}]]),D(Z,{"enter-active-class":"transition duration-100 ease-out","enter-from-class":"scale-95 transform opacity-0","enter-to-class":"scale-100 transform opacity-100","leave-active-class":"transition duration-75 ease-in","leave-from-class":"scale-100 transform opacity-100","leave-to-class":"scale-95 transform opacity-0"},{default:R(()=>[D(M(ke),{class:E(M(j)(a.className,"absolute z-10 m-2 ml-8 flex origin-top-right -translate-x-full flex-col gap-2 rounded-xl p-1 shadow-lg bg-surface-3 dark:bg-surface-1 border-1 border-surface-8/11 w-max min-w-min"))},{default:R(()=>[B(r.$slots,"default"),(P(!0),Y(G,null,re(m.value,(e,s)=>(P(),O(M(Te),{key:s,class:E([M($).replace("sm:bg-surface-12/2",""),"w-available min-w-60 !flex"]),as:"div",onClick:e.onclick},{default:R(()=>[F("span",De,[D(K,{icon:e.icon,title:e.title},null,8,["icon","title"]),F("span",Pe,X(r.$t(e.title)),1)])]),_:2},1032,["class","onClick"]))),128))]),_:3},8,["class"])]),_:3})]),_:3})}}}),qe=Ce;export{Re as n,Te as r,qe as t};
