import{An as b,Bn as m,Ft as R,Hn as V,Rt as E,Tt as I,Vt as z,an as O,cn as w,dn as U,on as P,qt as Y,zn as S,zt as j}from"./index-CymNhKD_.js";import{i as g}from"./ui-CVk4xI0v.js";import{t as G}from"./router-Ch9jBD0u.js";import{P as M}from"./SocketClient-DIjrmZvk.js";import{t as J}from"./_plugin-vue_export-helper-pDp7unP0.js";I();var K=["data-music"],Q=Y({__name:"ScrollContainer",props:{autoHide:{type:Boolean,default:!1},className:{type:String,required:!1,default:""},static:{type:Boolean,default:!0},frame:{type:Boolean,default:!1}},emits:["scroll"],setup(o){const u=b(),f=b(),r=b(!1),v=b(!1);let n=null,s=null,i=null,x={clientHeight:0,scrollHeight:0},c=null;function B(){_();const t=u.value,l=f.value,e=g.value;if(!t||!e||!l)return;e.scrollTop=0;const a=()=>{e&&(x.clientHeight=e.clientHeight,x.scrollHeight=e.scrollHeight,n&&n())},d=()=>{if(!e||!t||!l)return;const h=e.clientHeight,C=e.scrollHeight,A=e.scrollTop;if(C<=h){r.value=v.value,s=null;return}r.value=!0;const L=Math.ceil(h/C*h),D=l.clientHeight-L,k=C-h,N=(k>0?A/k:0)*D;t.style.height=`${L}px`,t.style.translate=`0 ${N}px`,s=null};n=()=>{s===null&&(s=requestAnimationFrame(d),v.value=!0,i!==null&&clearTimeout(i),i=window.setTimeout(()=>{v.value=!1,d()},1e3))},a(),requestAnimationFrame(()=>{a(),d()}),c=new ResizeObserver(()=>{a()}),c.observe(e),e.firstElementChild&&c.observe(e.firstElementChild),e.addEventListener("scroll",n,{passive:!0}),t.addEventListener("mousedown",T)}function p(){document.removeEventListener("mouseup",p),document.removeEventListener("mousemove",y)}function T(t){t.preventDefault(),document.addEventListener("mouseup",p),document.addEventListener("mousemove",y)}function F(t,l,e){return Math.min(Math.max(t,l),e)}function y(t){t.preventDefault();const l=u.value,e=f.value,a=g.value;if(!l||!a||!e||t.target?.dataset?.scrollbar)return;const d=F(0,t.clientY-e.getBoundingClientRect().top,e.clientHeight)-l.clientHeight/2;a.scrollTop=(a.scrollHeight-a.clientHeight)*(d/(e.clientHeight-l.clientHeight))}function _(){const t=u.value,l=g.value;s!==null&&(cancelAnimationFrame(s),s=null),i!==null&&(clearTimeout(i),i=null),v.value=!1,c&&(c.disconnect(),c=null),l&&n&&l.removeEventListener("scroll",n),n=null,t&&t.removeEventListener("mousedown",T),document.removeEventListener("mouseup",p),document.removeEventListener("mousemove",y)}O(()=>{B()}),P(()=>{_()}),G.afterEach(B);function H(){r.value=!0}function $(){r.value=!1}function q(){}return(t,l)=>(w(),z("div",{ref_key:"scrollContainerElement",ref:g,class:m([{"group/scrollContainer":!o.frame,"group/scrollContainer-frame":o.frame},"flex flex-1 h-available music-showing:h-[calc(100vh-7rem)] sm:music-showing:h-[calc(100vh-11rem)] z-0 isolate overflow-auto will-change-scroll w-full flex-col scrollbar-none scroll-container text-surface-12"]),"data-music":S(M),tabindex:"1",onFocus:q,onMouseleave:$,onMousemove:H,onScroll:l[0]||(l[0]=e=>t.$emit("scroll",e))},[U(t.$slots,"default",{},void 0,!0),o.static?(w(),j(R,{key:0,to:"body"},[E("div",{ref_key:"refBar",ref:f,onMousemove:H,class:m([{"opacity-100":r.value,"opacity-0":!r.value,"top-16 bottom-6 mr-1":o.static,"top-0 bottom-0 mr-1":!o.static,"bottom-20":S(M)==="showing",className:o.className},"right-0 mt-2 mb-2 hidden rounded-full border-r-2 border-l-4 border-transparent w-3.5 group-active/scrollContainer-frame:bg-surface-12/6 hover:bg-surface-12/6 sm:flex"]),style:V(`position: ${o.static?"fixed":"absolute"}`),"data-scrollbar":""},[E("span",{ref_key:"refHandle",ref:u,class:m([{"opacity-0 group-hover/scrollContainer-frame:opacity-100":o.autoHide&&!r.value,"!transition-none":!r.value},"scrollbar-handle absolute top-0 z-10 h-available right-0 bottom-0 hidden rounded-full border-r-2 border-l-4 border-transparent w-2.5 bg-surface-12/11 sm:flex scale-y-[105%]"]),"data-scrollbar":"",draggable:"true"},null,2)],38)])):(w(),z("div",{key:1,ref_key:"refBar",ref:f,onMousemove:H,class:m([{"opacity-100":r.value,"opacity-0":!r.value},"group/bar absolute top-0 mr-1 z-10 h-available right-0 bottom-0 hidden rounded-full border-r-2 border-l-4 border-transparent w-3.5 group-active/scrollContainer-frame:bg-surface-12/6 hover:bg-surface-12/6 sm:flex scale-[100%_96%]"]),"data-scrollbar":""},[E("span",{ref_key:"refHandle",ref:u,class:m([{"opacity-0 group-hover/scrollContainer:opacity-100 group-active/scrollContainer:bg-surface-2/9":!o.static&&o.autoHide,"!transition-none":!r.value},"scrollbar-handle absolute top-0 z-10 h-available right-0 bottom-0 hidden rounded-full border-r-2 border-l-4 border-transparent w-2.5 bg-surface-12/11 sm:flex scale-y-[105%]"]),"data-scrollbar":"",draggable:"true"},null,2)],34))],42,K))}}),le=J(Q,[["__scopeId","data-v-8918dcc7"]]);export{le as t};
