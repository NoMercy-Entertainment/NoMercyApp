var F=Object.defineProperty;var K=(T,g,l)=>g in T?F(T,g,{enumerable:!0,configurable:!0,writable:!0,value:l}):T[g]=l;var S=(T,g,l)=>(K(T,typeof g!="symbol"?g+"":g,l),l);import{aw as W,bu as G,I as J,J as Q,cS as Y,e8 as V,c9 as Z,cz as L,e as ee,a7 as H,aB as E,dz as te,b1 as se,bo as B,bd as q,e9 as ae,b7 as le,ea as ie,bn as ne,o as re,v as oe,a as O,z as pe,cl as X,bF as ce,bG as de}from"./index-ClmkhrOb.js";import{A as ue,S as he,O as ye}from"./octopusPlugin-JQ0Rq2Hc.js";import{B as fe,c as ge,l as be,a as me,b as ve,n as we}from"./subtitles-octopus-DoCTKBKw.js";import{K as xe}from"./keyHandlerPlugin-CvJBUgLb.js";class Te extends fe{constructor(){super(...arguments);S(this,"preScreen",{});S(this,"episodeScreen",{});S(this,"languageScreen",{});S(this,"selectedSeason");S(this,"hasPlayed",!1);S(this,"tvDialogStyles",["w-available","h-available","max-w-available","max-h-available",""])}use(){this.player.container.style.display="contents",this.createTvOverlay(this.player.overlay),this.createPreScreen(this.player.overlay),this.createEpisodeScreen(this.player.overlay),this.createLanguageScreen(this.player.overlay),this.player.options.autoPlay||this.showPreScreen(),this.player.once("firstFrame",()=>{this.hasPlayed=!0}),this.player.on("play",()=>{this.player.emit("show-seek-container",!1),this.player.getVideoElement().scrollIntoView(),this.closePreScreen(),this.closeEpisodeScreen(),this.closeLanguageScreen()}),this.player.on("back-button",this.backMenu.bind(this)),document.addEventListener("keydown",l=>{l.key=="Backspace"&&this.backMenu(),l.key=="ArrowUp"&&this.player.ui_resetInactivityTimer(),l.key=="ArrowDown"&&this.player.ui_resetInactivityTimer(),l.key=="ArrowLeft"&&this.player.ui_resetInactivityTimer(),l.key=="ArrowRight"&&this.player.ui_resetInactivityTimer()}),this.player.on("pause",()=>{}),this.player.once("ready",()=>{this.showPreScreen(),this.player.pause()})}backMenu(){this.player.isTv()&&this.currentMenu!=="seek"&&(this.player.container.classList.contains("episode-screen")?this.closeEpisodeScreen():this.player.container.classList.contains("language-screen")?this.closeLanguageScreen():this.player.container.classList.contains("pre-screen")?this.player.emit("back"):(this.player.pause(),this.showPreScreen()))}createTvOverlay(l){const e=this.player.createElement("div","tv-overlay").addClasses(["absolute","flex","flex-col","justify-end","gap-4","w-available","h-available","z-0"]).addClasses(["group-[&.nomercyplayer.paused.pre-screen]:hidden"]).appendTo(l),i=this.createTopBar(e);this.player.addClasses(i,["px-10","pt-10","z-0"]);const a=this.createBackButton(i,!0);a&&this.player.addClasses(a,["children:stroke-2"]);const r=this.createRestartButton(i,!0);this.player.addClasses(r,["children:stroke-2"]);const t=this.createNextButton(i,!0);this.player.addClasses(t,["children:stroke-2"]),this.createDivider(i),this.createTvCurrentItem(i),this.createOverlayCenterMessage(e),this.createSpinnerContainer(e),this.seekContainer=this.createSeekContainer(e);const h=this.createBottomBar(e),p=this.player.createElement("div","bottom-row").addClasses(["tv-bottom-row","relative","flex","flex-row","items-center","gap-4","mt-auto","w-available","px-20","pb-10","z-0"]).appendTo(h);this.createPlaybackButton(p,!0),this.createTime(p,"current",[]),this.createTvProgressBar(p),this.createTime(p,"remaining",["mr-14"]),this.player.on("playing",()=>{this.currentMenu!=="seek"&&!this.controlsVisible&&this.playbackButton.focus()});let o=a??r??t;[a,r,t].forEach(n=>{n==null||n.addEventListener("keydown",s=>{var d,u;s.key=="ArrowDown"?this.nextUp.style.display=="none"?(d=this.playbackButton)==null||d.focus():(u=this.nextUp.lastChild)==null||u.focus():s.key=="ArrowLeft"?(o=s.target.previousElementSibling,o==null||o.focus()):s.key=="ArrowRight"&&(s.preventDefault(),o=s.target.nextElementSibling,o==null||o.focus())})}),[this.nextUp.firstChild,this.nextUp.lastChild].forEach(n=>{n==null||n.addEventListener("keydown",s=>{var d,u,y;s.key=="ArrowUp"?(d=o||r)==null||d.focus():s.key=="ArrowDown"?this.playbackButton.focus():s.key=="ArrowLeft"?(u=this.nextUp.firstChild)==null||u.focus():s.key=="ArrowRight"&&((y=this.nextUp.lastChild)==null||y.focus())})}),[this.playbackButton].forEach(n=>{n==null||n.addEventListener("keydown",s=>{var d;s.key=="ArrowUp"&&(s.preventDefault(),this.nextUp.style.display=="none"?o==null||o.focus():(d=this.nextUp.lastChild)==null||d.focus())})});let c=!1;return[document.body].forEach(n=>{n==null||n.addEventListener("keyup",s=>{if(s.key=="ArrowLeft"){if([a,r,t,this.nextUp.firstChild,this.nextUp.lastChild].includes(s.target))return;if(s.preventDefault(),this.player.pause(),this.player.emit("show-seek-container",!0),this.shouldSlide)this.currentScrubTime=this.getClosestSeekableInterval(),this.shouldSlide=!1;else{const d=this.currentScrubTime-10;console.log("newScrubTime",d),c=!0,this.player.emit("currentScrubTime",{...this.player.getTimeData(),currentTime:d})}}else if(s.key=="ArrowRight"){if([a,r,t,this.nextUp.firstChild,this.nextUp.lastChild].includes(s.target))return;if(s.preventDefault(),this.player.pause(),this.player.emit("show-seek-container",!0),this.shouldSlide)this.currentScrubTime=this.getClosestSeekableInterval(),this.shouldSlide=!1;else{const d=this.currentScrubTime+10;c=!0,console.log("newScrubTime",d),this.player.emit("currentScrubTime",{...this.player.getTimeData(),currentTime:d})}}else s.key=="Enter"&&(Math.abs(this.currentScrubTime-this.player.getCurrentTime())>5&&c?(console.log("seeking to",this.currentScrubTime),this.player.seek(this.currentScrubTime),c=!1,this.playbackButton.focus()):this.player.togglePlayback())})}),this.playbackButton.focus(),h}showPreScreen(){var l;this.preScreen.showModal(),(l=this.preScreen.querySelector(".button-container>button"))==null||l.focus(),setTimeout(()=>{this.player.container.classList.add("pre-screen")},5)}closePreScreen(){this.preScreen.close(),this.player.emit("hideControls"),this.player.container.classList.remove("pre-screen")}createPreScreen(l){this.preScreen=this.player.createElement("dialog","pre-screen-dialog").addClasses(this.tvDialogStyles).addClasses(["group-[&.nomercyplayer.paused:not(.open)]:backdrop:bg-black/80","group-[&.nomercyplayer.paused:not(.open)]:backdrop:pointer-events-none"]).appendTo(l),this.preScreen.setAttribute("popover","manual"),this.preScreen.setAttribute("role","modal");const e=this.player.createElement("div","pre-screen").addClasses(["pre-screen","absolute","inset-0","flex","p-6","text-white","w-available","h-available","z-0"]).addClasses(["group-[&.nomercyplayer.paused.episode-screen]:hidden","group-[&.nomercyplayer.paused.language-screen]:hidden"]).appendTo(this.preScreen),i=this.player.createElement("div","left-side").addClasses(["flex","flex-col","justify-between","items-center","w-1/2","h-available"]).appendTo(e),a=this.createImageContainer(i),r=this.player.createElement("div","title-container").addClasses(["flex","flex-col","w-available","h-available"]).appendTo(a),t=this.player.createElement("div","title").addClasses(["flex","text-white","text-lg","font-bold","mx-2"]).appendTo(r),h=this.player.createElement("div","description").addClasses(["text-left","text-white","text-sm","line-clamp-4","font-bold","leading-5","overflow-hidden","mx-2"]).appendTo(r);this.player.on("item",()=>{t.innerHTML=this.player.playlistItem().title.replace(this.player.playlistItem().show??"","").replace("%S",this.player.localize("S")).replace("%E",this.player.localize("E")),h.innerHTML=this.player.playlistItem().description});const p=this.player.createElement("div","button-container").addClasses(["button-container","flex","flex-col","gap-3","w-available","h-1/2","mt-7","mb-3","overflow-auto","px-2","py-0.5","[*::-webkit-scrollbar]:hidden"]).appendTo(i);this.createTvButton(p,"play",null,this.player.play,this.buttons.play),this.createTvButton(p,"restart","Play from beginning",this.player.restart,this.buttons.restart);const o=this.createTvButton(p,"showEpisodeMenu","Episodes",()=>this.player.emit("showEpisodeScreen"),this.buttons.playlist);o.style.display="none",o.addEventListener("click",()=>{this.player.emit("switch-season",this.player.playlistItem().season),this.showEpisodeScreen()});const c=this.createTvButton(p,"showLanguageMenu","Audio and subtitles",()=>this.player.emit("showLanguageScreen"),this.buttons.language);c.style.display="none",c.addEventListener("click",()=>{this.showLanguageScreen()}),this.player.createElement("div","pre-screen-right-side").addClasses(["flex","flex-col","justify-center","w-1/3","h-available"]).appendTo(e),this.player.on("audioTracks",()=>{this.player.hasAudioTracks()||this.player.hasCaptions()?c.style.display="flex":c.style.display="none"}),this.player.on("item",()=>{this.player.getPlaylist().length>1?o.style.display="flex":o.style.display="none"})}showEpisodeScreen(){var l;this.episodeScreen.showModal(),this.player.container.classList.add("episode-screen"),this.player.container.classList.add("open"),(l=this.episodeScrollContainer.querySelector(".button-container>button"))==null||l.focus()}closeEpisodeScreen(){var l;this.episodeScreen.close(),this.player.container.classList.remove("episode-screen"),this.player.container.classList.remove("open"),(l=this.preScreen.querySelector(".button-container>button"))==null||l.focus()}createEpisodeScreen(l){this.episodeScreen=this.player.createElement("dialog","episode-screen-dialog").addClasses(this.tvDialogStyles).addClasses(["group-[&.nomercyplayer.paused.episode-screen]:backdrop:bg-black/80","group-[&.nomercyplayer.paused.episode-screen]:backdrop:pointer-events-none"]).appendTo(l),this.episodeScreen.setAttribute("popover","manual"),this.episodeScreen.setAttribute("role","modal");const e=this.player.createElement("div","episode-screen").addClasses(["episode-screen","absolute","inset-0","flex","gap-4","p-6","text-white","w-available","h-available","z-0"]).appendTo(this.episodeScreen),i=this.player.createElement("div","episode-screen-left-side").addClasses(["flex","flex-col","justify-between","items-center","w-2/5","h-available"]).appendTo(e);this.createImageContainer(i);const a=this.player.createElement("div","season-button-container").addClasses(["flex","flex-col","gap-3","w-available","h-available","mt-7","mb-3","overflow-auto","px-2","py-0.5","[*::-webkit-scrollbar]:hidden"]).appendTo(i);this.player.once("playlist",()=>{var h;const r=this.player.createElement("div","episode-screen-right-side").addClasses(["flex","flex-col","justify-center","w-3/5","h-available"]).appendTo(e);this.episodeScrollContainer=this.player.createElement("div","episode-button-container").addClasses(["button-container","flex","flex-col","overflow-auto","h-available","pt-6","gap-2","p-1","min-h-[50%]","scroll-p-4","scroll-smooth"]).appendTo(r);let t={};for(const p of this.player.getSeasons())t=this.createTvSeasonButton(a,`season-${p.season}`,p,()=>this.player.emit("switch-season",p.season));(h=t.addEventListener)==null||h.call(t,"keydown",p=>{var o,c;if(p.key!="ArrowLeft"){if(p.key!="ArrowRight"){if(!(p.key=="ArrowUp"&&!this.player.options.disableTouchControls)){if(p.key=="ArrowDown"&&!this.player.options.disableTouchControls){(o=t.nextElementSibling)==null||o.focus();const n=t.nextElementSibling;(n==null?void 0:n.nodeName)=="BUTTON"?n==null||n.focus():(c=t.parentElement.nextElementSibling)==null||c.focus()}}}}});for(const[p,o]of this.player.getPlaylist().entries()??[])this.createTvEpisodeMenuButton(this.episodeScrollContainer,o,p)})}showLanguageScreen(){var l;this.languageScreen.showModal(),this.player.container.classList.add("language-screen"),this.player.container.classList.add("open"),(l=this.languageScreen.querySelector(".button-container>button"))==null||l.focus()}closeLanguageScreen(){var l;this.languageScreen.close(),this.player.container.classList.remove("language-screen"),this.player.container.classList.remove("open"),(l=this.preScreen.querySelector(".button-container>button"))==null||l.focus()}createLanguageScreen(l){var n;this.languageScreen=this.player.createElement("dialog","language-screen-dialog").addClasses(this.tvDialogStyles).addClasses(["group-[&.nomercyplayer.paused.language-screen]:backdrop:bg-black/80","group-[&.nomercyplayer.paused.language-screen]:backdrop:pointer-events-none"]).appendTo(l),this.languageScreen.setAttribute("popover","manual"),this.languageScreen.setAttribute("role","modal");const e=this.player.createElement("div","language-screen").addClasses(["language-screen","absolute","inset-0","flex","p-6","text-white","w-available","h-available","z-0"]).appendTo(this.languageScreen),i=this.player.createElement("div","language-screen-left-side").addClasses(["flex","flex-col","items-center","overflow-clip","w-2/5","h-available"]).appendTo(e);this.createImageContainer(i);const a=this.player.createElement("div","language-scroll-container").addClasses(["flex","flex-col","overflow-auto","w-available","h-available","gap-3","scroll-p-4","scroll-smooth","border-transparent","outline-transparent","p-1"]).appendTo(i);a.addEventListener("focus",()=>{var s;(s=a.querySelector("button"))==null||s.focus()});const r=this.player.createElement("div","language-button-container").addClasses(["flex-shrink-0","h-auto","px-2","py-0.5","w-available","text-left","mt-3"]).appendTo(a);r.innerText=this.player.localize("Audio");const t=this.player.createElement("div","language-button-container").addClasses(["[*::-webkit-scrollbar]:hidden","flex","flex-col","flex-shrink-0","gap-3","px-2","py-0.5","w-available"]).appendTo(a);t.style.paddingRight="5rem";let h={};const p=s=>{var d,u;if(s.key!="ArrowLeft"){if(s.key!="ArrowRight"){if(s.key=="ArrowUp"&&!this.player.options.disableTouchControls)(d=s.target.previousElementSibling)==null||d.focus();else if(s.key=="ArrowDown"&&!this.player.options.disableTouchControls){const y=s.target.nextElementSibling;(y==null?void 0:y.nodeName)=="BUTTON"?y==null||y.focus():(u=h.parentElement.nextElementSibling)==null||u.focus()}}}};(n=h.removeEventListener)==null||n.call(h,"keydown",p),this.player.on("audioTracks",s=>{t.innerHTML="";for(const[d,u]of(s==null?void 0:s.entries())??[])h=this.createLanguageMenuButton(t,{language:u.language??"",label:u.label??"",type:u.type??"",id:u.id??d-1,buttonType:"audio"})});const o=this.player.createElement("div","language-button-container").addClasses(["flex-shrink-0","h-auto","px-2","py-0.5","w-available","text-left","mt-3"]).appendTo(a);o.innerText=this.player.localize("Subtitles");const c=this.player.createElement("div","subtitle-button-container").addClasses(["[*::-webkit-scrollbar]:hidden","flex","flex-col","flex-shrink-0","gap-3","flex-shrink-0","px-2","py-0.5","w-available"]).appendTo(a);c.style.paddingRight="5rem",c.style.marginTop="0",this.player.on("captionsList",s=>{c.innerHTML="";for(const[d,u]of s.entries()??[])this.createLanguageMenuButton(c,{language:u.language??"",label:u.label??"",type:u.type??"",id:u.id??d-1,buttonType:"subtitle"})})}createTvProgressBar(l){this.sliderBar=this.player.createElement("div","slider-bar").addClasses(["slider-bar","group/slider","overflow-clip","flex","rounded-full","bg-white/20","h-2","mx-4","relative","w-available"]).appendTo(l);const e=this.player.createElement("div","slider-progress").addClasses(["slider-progress","absolute","flex","h-full","pointer-events-none","rounded-full","bg-white","z-10","-left-full","w-full"]).appendTo(this.sliderBar);return this.chapterBar=this.player.createElement("div","chapter-progress").addClasses(["chapter-bar","bg-transparent","flex","h-2","relative","rounded-full","overflow-clip","w-available"]).appendTo(this.sliderBar),this.player.on("item",()=>{this.sliderBar.classList.add("bg-white/20"),this.previewTime=[],this.chapters=[],e.style.transform="translateX(0%)",this.fetchPreviewTime()}),this.player.on("chapters",()=>{var i;((i=this.player.getChapters())==null?void 0:i.length)>0&&!this.player.isTv()?this.sliderBar.classList.remove("bg-white/20"):this.sliderBar.classList.add("bg-white/20")}),this.player.on("time",i=>{e.style.transform=`translateX(${i.percentage}%)`}),this.player.on("currentScrubTime",i=>{e.style.transform=`translateX(${i.currentTime/i.duration*100}%)`}),this.sliderBar}createTvEpisodeMenuButton(l,e,i){var m,v,w;const a=this.player.createElement("button",`playlist-${e.id}`).addClasses(["playlist-menu-button","relative","flex","w-available","p-2","gap-2","rounded-lg","snap-center","outline-transparent","outline","outline-1","outline-solid","text-white","focus-visible:outline-2","focus-visible:outline-white","transition-all","duration-300"]).appendTo(l);this.player.playlistItem().season!==1&&(a.style.display="none");const r=this.player.createElement("div",`playlist-${e.id}-left`).addClasses(["episode-menu-button-left","relative","rounded-md","w-[50%]","overflow-clip","self-center"]).appendTo(a);this.player.createElement("div",`episode-${e.id}-shadow`).addClasses(["episode-menu-button-shadow","bg-[linear-gradient(0deg,rgba(0,0,0,0.87)_0%,rgba(0,0,0,0.7)_25%,rgba(0,0,0,0)_50%,rgba(0,0,0,0)_100%)]","shadow-[inset_0px_1px_0px_rgba(255,255,255,0.24),inset_0px_-1px_0px_rgba(0,0,0,0.24),inset_0px_-2px_0px_rgba(0,0,0,0.24)]","bottom-0","left-0","absolute","!h-available","w-available"]).appendTo(r);const t=this.player.createElement("img",`episode-${e.id}-image`).addClasses(["episode-menu-button-image","w-available","h-auto","aspect-video","object-cover",""]).appendTo(r);t.setAttribute("loading","lazy"),(m=e.image)!=null&&m.startsWith("http")?t.src=e.image??"":t.src=e.image&&e.image!=""?`${this.imageBaseUrl}${e.image}`:"";const h=this.player.createElement("div",`episode-${e.id}-progress-container`).addClasses(["episode-menu-progress-container","absolute","bottom-1","w-available","flex","flex-col","px-3"]).appendTo(r),p=this.player.createElement("div",`episode-${e.id}-progress-box`).addClasses(["episode-menu-progress-box","flex","justify-between","h-available","sm:mx-2","mb-1","px-1"]).appendTo(h),o=this.player.createElement("div",`episode-${e.id}-progress-item`).addClasses(["progress-item-text","text-[0.7rem]",""]).appendTo(p);e.episode&&e.show&&(o.innerText=`${this.player.localize("E")}${e.episode}`);const c=this.player.createElement("div",`episode-${e.id}-progress-duration`).addClasses(["progress-duration","text-[0.7rem]"]).appendTo(p);c.innerText=(v=e.duration)==null?void 0:v.replace(/^00:/u,"");const n=this.player.createElement("div",`episode-${e.id}-slider-container`).addClasses(["slider-container","group/slider","overflow-clip","hidden","rounded-full","bg-white/20","h-1","mx-4","relative","w-available"]).appendTo(h);n.style.display=e.progress?"flex":"none";const s=this.player.createElement("div",`episode-${e.id}-progress-bar`).addClasses(["progress-bar","absolute","flex","h-full","pointer-events-none","rounded-full","bg-white","z-10","-left-full","w-full"]).appendTo(n);(w=e.progress)!=null&&w.time&&(s.style.transform=`translateX(${e.progress.time/ge(e.duration)*100}%`);const d=this.player.createElement("div",`episode-${e.id}-right-side`).addClasses(["playlist-card-right","w-3/4","flex","flex-col","text-left","gap-1","px-1","outline-transparent","outline","outline-1","outline-solid","focus-visible:outline-2","focus-visible:outline-white","active:outline-white"]).appendTo(a),u=this.player.createElement("span",`episode-${e.id}-title`).addClasses(["playlist-menu-button-title","font-bold","text-lg","line-clamp-1","text-white",""]).appendTo(d);u.innerText=be((e.title??"").replace(e.show??"","").replace("%S",this.player.localize("S")).replace("%E",this.player.localize("E")));const y=this.player.createElement("span",`episode-${e.id}-overview`).addClasses(["playlist-menu-button-overview","font-bold","text-[0.7rem]","leading-4","line-clamp-4","overflow-hidden","text-white"]).appendTo(d);return y.innerText=me(e.description,600),this.player.on("item",()=>{this.player.playlistItem().season==e.season?a.style.display="flex":a.style.display="none",this.player.playlistItem().season==e.season&&this.player.playlistItem().episode==e.episode?a.style.background="rgba(255,255,255,.1)":a.style.background="transparent"}),this.player.on("switch-season",f=>{this.selectedSeason=f,this.player.playlistItem().id==e.id?setTimeout(()=>{this.scrollCenter(a,l,{margin:1,duration:100})},50):this.player.playlistItem().season!==f&&this.episodeScrollContainer.scrollTo(0,0),f==e.season?a.style.display="flex":a.style.display="none"}),this.player.on("active",()=>{s.style.transform=`translateX(${this.player.getTimeData().percentage}%)`}),this.player.on("time",f=>{var x;((x=this.player.playlistItem())==null?void 0:x.uuid)==e.uuid&&this.player.container.classList.contains("active")&&(n.style.display="flex",s.style.transform=`translateX(${f.percentage}%)`)}),e.episode&&e.show&&(o.innerText=e.season==null?`${e.episode}`:`${this.player.localize("S")}${e.season}: ${this.player.localize("E")}${e.episode}`),a.addEventListener("keydown",f=>{var x,C,k;f.key=="ArrowLeft"?(x=document.querySelector(`#season-${this.player.playlistItem().season}`))==null||x.focus():f.key=="ArrowRight"||(f.key=="ArrowUp"&&!this.player.options.disableTouchControls?(C=a.previousElementSibling)==null||C.focus():f.key=="ArrowDown"&&!this.player.options.disableTouchControls&&((k=a.nextElementSibling)==null||k.focus()))}),a.addEventListener("focus",()=>{this.scrollCenter(a,l,{margin:2,duration:50})}),a.addEventListener("click",()=>{e.episode&&e.season?this.setEpisode(e.season,e.episode):this.player.playlistItem(i),this.closeEpisodeScreen(),this.closePreScreen(),this.player.play()}),a}createTvSeasonButton(l,e,i,a,r){const t=this.player.createElement("button",e).addClasses(["w-available","mr-auto","h-8","px-1","py-2","flex","flex-nowrap","items-center","snap-center","rounded","outline-transparent","outline","outline-1","outline-solid","focus-visible:outline-2","focus-visible:outline-white","active:outline-white",`${e}-button`]).appendTo(l);if(t.type="button",t.addEventListener("focus",()=>{this.scrollIntoView(t)}),t.addEventListener("keyup",c=>{var n,s,d,u;c.key=="ArrowLeft"||c.key=="ArrowRight"&&(i.season==((n=this.player.playlistItem())==null?void 0:n.season)?(d=Array.from(document.querySelectorAll("[id^=playlist-]")).filter(y=>getComputedStyle(y).display=="flex").at((((s=this.player.playlistItem())==null?void 0:s.episode)??0)-1))==null||d.focus():(u=Array.from(document.querySelectorAll("[id^=playlist-]")).filter(y=>getComputedStyle(y).display=="flex").at(0))==null||u.focus())}),t.addEventListener("keydown",c=>{var n,s;c.key=="ArrowUp"&&!this.player.options.disableTouchControls?(n=t.previousElementSibling)==null||n.focus():c.key=="ArrowDown"&&!this.player.options.disableTouchControls&&((s=t.nextElementSibling)==null||s.focus())}),t.addEventListener("click",()=>{a==null||a.bind(this)()}),r){const c=document.createElementNS("http://www.w3.org/2000/svg","svg");c.setAttribute("viewBox","0 0 24 24"),c.id=e,this.player.addClasses(c,[`${e}-icon`,...r.classes,"svg-size","h-5","w-5","fill-current","pointer-events-none","group-hover/button:scale-110","duration-700"]);const n=document.createElementNS("http://www.w3.org/2000/svg","path");n.setAttribute("d",r.hover),c.appendChild(n),t.appendChild(c)}const h=this.player.createElement("div",`${e}-button-text`).addClasses(this.menuButtonTextStyles).addClasses(["flex","justify-between","items-center","w-available","gap-1","flex-nowrap"]).appendTo(t),p=this.player.createElement("span",`${e}-button-text-span-1`).addClasses(["line-clamp-1","text-nowrap","text-sm","w-auto"]).appendTo(h),o=this.player.createElement("span",`${e}-button-text-span-2`).addClasses(["line-clamp-1","text-nowrap","text-xs","w-min"]).appendTo(h);return i.seasonName?(p.innerText=i.seasonName,o.innerText=`${i.episodes} ${this.player.localize("ep")}`):i.season?(p.innerText=`${this.player.localize("Season")} ${i.season}`,o.innerText=`${i.episodes} ${this.player.localize("ep")}`):o.innerText=`${i.episodes} ${this.player.localize("ep")}`,t}getVisibleButtons(l){const e=l.parentElement,i=e==null?void 0:e.querySelectorAll("button");if(!i||(i==null?void 0:i.length)==0)return;const a=Array.from(i).filter(t=>t.style.display!="none"),r=a.findIndex(t=>t==l);return{visibleButtons:a,currentButtonIndex:r}}findPreviousVisibleButton(l){const e=this.getVisibleButtons(l);if(!e)return;const{visibleButtons:i,currentButtonIndex:a}=e;for(let r=a;r>=0;r--)return i[r-1]}findNextVisibleButton(l){const e=this.getVisibleButtons(l);if(!e)return;const{visibleButtons:i,currentButtonIndex:a}=e;for(let r=a;r<i.length;r++)return i[r+1]}createImageContainer(l){const e=this.player.createElement("div","left-side-top").addClasses(["flex","flex-col","justify-center","items-center","w-available","gap-2","h-auto"]).appendTo(l),i=this.player.createElement("div","logo-container").addClasses(["flex","flex-col","justify-center","items-center","w-available","h-[85px]","min-h-[85px]"]).appendTo(e),a=this.player.createElement("span","fallbackText").addClasses(["w-auto","h-available","items-center","py-0","max-w-[38vw]","mr-auto","leading-[1.2]","font-bold","object-fit"]).appendTo(i),r=this.player.createElement("img","logo").addClasses(["w-auto","px-2","py-2","mr-auto","object-fit","h-auto","max-w-[23rem]","max-h-available",""]).appendTo(i),t=this.player.createElement("div","left-side-top-overview").addClasses(["flex","flex-col","w-available","h-[40px]"]).appendTo(e),h=this.player.createElement("div","rating-container").addClasses(["flex","gap-2","items-center","w-available","text-white"]).appendTo(t),p=this.player.createElement("span","year-text").addClasses(["flex","text-white","text-sm","font-bold","mx-2"]).appendTo(h),o=this.player.createElement("img","rating-image").addClasses(["w-8","h-available","object-fit","invert"]).appendTo(h),c=this.player.createElement("span","episodes-count-text").addClasses(["flex","text-white","text-sm","font-bold","mx-2"]).appendTo(h);return this.player.on("item",()=>{var d,u,y,m,v,w;const n=(d=this.player.playlistItem())==null?void 0:d.logo;!n||n==""||n.includes("null")||n.includes("undefined")?(a.innerText=ve(((u=this.player.playlistItem())==null?void 0:u.show)??""),a.style.fontSize=`calc(110px / ${a.innerText.length} + 3ch)`,a.style.display="flex",r.style.display="none"):(r.style.display="block",a.style.display="none",n!=null&&n.startsWith("http")?r.src=n:r.src=n&&n!=""?`${this.imageBaseUrl}${n}`:""),p.innerHTML=((m=(y=this.player.playlistItem())==null?void 0:y.year)==null?void 0:m.toString())??"",(v=this.player.playlistItem())!=null&&v.year?p.style.display="flex":p.style.display="none",o.removeAttribute("src"),o.removeAttribute("alt"),o.style.opacity="0",this.player.getPlaylist().length>1&&(c.innerHTML=`${this.player.getPlaylist().length} ${this.player.localize("episodes")}`);const s=(w=this.player.playlistItem())==null?void 0:w.rating;s&&(o.src=`https://storage.nomercy.tv/laravel/kijkwijzer/${s.image}`,o.alt=s.rating.toString(),o.style.opacity="1")}),e}createTvButton(l,e,i,a,r){const t=this.player.createElement("button",e).addClasses(["w-9/12","mr-auto","h-8","px-1","py-2","flex","items-center","rounded","snap-center","outline-transparent","outline","outline-1","outline-solid","focus-visible:outline-2","focus-visible:outline-white","active:outline-white",`${e}-button`]).appendTo(l);if(t.type="button",t.addEventListener("focus",()=>{setTimeout(()=>{this.scrollCenter(t,l,{margin:1,duration:100})},50)}),t.addEventListener("keydown",p=>{var o,c,n;if(p.key=="ArrowUp"&&!this.player.options.disableTouchControls)(o=this.findPreviousVisibleButton(t))==null||o.focus();else if(p.key=="ArrowDown"&&!this.player.options.disableTouchControls){const s=this.findNextVisibleButton(t);s?s==null||s.focus():(n=(c=t.parentElement)==null?void 0:c.nextElementSibling)==null||n.focus()}}),t.addEventListener("click",a==null?void 0:a.bind(this.player)),r){const p=document.createElementNS("http://www.w3.org/2000/svg","svg");p.setAttribute("viewBox","0 0 24 24"),p.id=e,this.player.addClasses(p,[`${e}-icon`,...r.classes,"svg-size","h-5","w-5","fill-current","pointer-events-none","group-hover/button:scale-110","duration-700"]);const o=document.createElementNS("http://www.w3.org/2000/svg","path");o.setAttribute("d",r.hover),p.appendChild(o),t.appendChild(p)}const h=this.player.createElement("span",`${e}-buttonText`).addClasses(this.menuButtonTextStyles).appendTo(t);return i||(i="Play",setTimeout(()=>{this.player.once("firstFrame",()=>{i="Resume",h.innerHTML=this.player.localize("Resume")})},500)),h.innerHTML=this.player.localize(i),t}}const Le=W({__name:"Tv",setup(T){const{data:g,isError:l}=G({}),e=J(),i=()=>{var r,t;(r=e.value)==null||r.emit("back-button"),(t=e.value)==null||t.emit("back-button-hyjack")},a=r=>{var s,d,u,y,m,v,w,f,x,C,k,A,P,I,$,z,M,U,_,D,N,j;const t={muted:!1,controls:!1,preload:"auto",debug:!1,autoPlay:!0,playlist:(r==null?void 0:r.filter(b=>!!b.id))??[],controlsTimeout:3e3,doubleClickDelay:500,playbackRates:[.25,.5,.75,1,1.25,1.5,1.75,2],accessToken:((s=te.value)==null?void 0:s.accessToken)||localStorage.getItem("access_token")||"",basePath:(d=se.value)==null?void 0:d.serverBaseUrl,forceTvMode:(B("android")||B("ios"))&&!B("mobile"),disableTouchControls:!1,disableMediaControls:"mediaSession"in navigator||B("capacitor"),renderAhead:10};(u=e.value)==null||u.dispose(),e.value=we("player1").setup(t);const h=new Te;(y=e.value)==null||y.registerPlugin("tvUI",h),(m=e.value)==null||m.usePlugin("tvUI");const p=new ue;(v=e.value)==null||v.registerPlugin("autoSkip",p),(w=e.value)==null||w.usePlugin("autoSkip");const o=new xe;(f=e.value)==null||f.registerPlugin("keyHandler",o),(x=e.value)==null||x.usePlugin("keyHandler");const c=new he;(C=e.value)==null||C.registerPlugin("sync",c),(k=e.value)==null||k.usePlugin("sync");const n=new ye;(A=e.value)==null||A.registerPlugin("octopus",n),(P=e.value)==null||P.usePlugin("octopus"),(I=e.value)==null||I.once("play",()=>{var b;(b=e.value)==null||b.enterFullscreen()}),($=e.value)==null||$.once("back",()=>{}),(z=e.value)==null||z.on("playlistComplete",()=>{var b;(b=e.value)==null||b.dispose(),q.back()}),(M=e.value)==null||M.on("play",()=>{L(!0)}),(U=e.value)==null||U.on("pause",()=>{L(!1)}),(_=e.value)==null||_.on("ready",()=>{ae(),le.stop()}),(D=e.value)==null||D.on("item",b=>{var R;(R=e.value)==null||R.play()}),(N=e.value)==null||N.on("active",b=>{}),(j=e.value)==null||j.on("dispose",()=>{q.back(),ie()}),ne.addListener("backButton",i)};return Q(g,r=>{a(r)}),Y(()=>{V(!1),a(g.value)}),Z(()=>{var r;L(!1),V(!0),(r=e.value)==null||r.dispose()}),(r,t)=>(re(),ee(E(de),null,{default:H(()=>[oe(E(ce),{fullscreen:!0},{default:H(()=>[O("div",{class:pe(["absolute inset-0 flex h-full w-full overflow-clip bg-black z-1199",{"mb-28":E(X),"mb-0":!E(X)}])},t[0]||(t[0]=[O("div",{id:"player1",class:"group nomercyplayer"},null,-1)]),2)]),_:1})]),_:1}))}});export{Le as default};
//# sourceMappingURL=Tv-Uy1hzmV5.js.map
