import{K as R,ax as w,L as E,dP as j,bo as M,aP as _,dQ as T,dR as I,dS as A,dT as P,aG as N,cv as K,br as Q,j as $,a7 as O,a6 as L,t as b,o as h,cU as Y,cV as W,bQ as X,dU as Z,dV as F,dW as J,az as ee,aV as te,aY as se,dX as ae,dY as le,c as S,a as n,h as z,r as C,x as ne,aI as D,dZ as oe,bS as re,d_ as ce,C as V,av as ie}from"./index-BRRsWqGl.js";import{_ as de}from"./FloatingBackButton.vue_vue_type_script_setup_true_lang-C0Fn21M1.js";import{_ as ue}from"./Button.vue_vue_type_script_setup_true_lang-DAW0NDA6.js";const a=R(),He=w(()=>{var t;return(t=a.value)==null?void 0:t.connection}),y=R(!1),B=()=>{var t,l,s;y.value=!0,document.dispatchEvent(new Event("dashboardHub-connected")),(t=a.value)!=null&&t.connection&&(A((l=a.value)==null?void 0:l.connection),P((s=a.value)==null?void 0:s.connection))},k=t=>{y.value=!1,console.log("Disconnected from Dashboard SignalR",t),document.dispatchEvent(new Event("dashboardHub-disconnected"))},U=t=>{y.value=!1,console.error("Dashboard SignalR Error:",t),document.dispatchEvent(new Event("dashboardHub-error"))};E(_,async t=>{var s,o,u,x,g,f,v,p;const l=(s=M.value)==null?void 0:s.accessToken;t&&y.value&&((u=(o=a.value)==null?void 0:o.connection)==null||u.stop().then(),(x=a.value)==null||x.dispose(),a.value=new T(_.value.serverBaseUrl,l,"dashboardHub"),(f=(g=a.value)==null?void 0:g.connection)==null||f.on("connected",B),(p=(v=a.value)==null?void 0:v.connection)==null||p.on("disconnected",k),await G().catch(U))});const G=async()=>{var t,l,s,o;if(((l=(t=a.value)==null?void 0:t.connection)==null?void 0:l.state)!==j.Connected)return(o=(s=a.value)==null?void 0:s.connection)==null?void 0:o.start().then(B)},fe=async()=>{var t,l,s,o;try{return((l=(t=a.value)==null?void 0:t.connection)==null?void 0:l.state)===j.Disconnected||(o=(s=a.value)==null?void 0:s.connection)==null?void 0:o.stop().then(k).catch(k)}catch(u){console.error("Error stopping Dashboard SignalR:",u),k()}},H=async()=>{var l,s,o,u,x,g,f,v,p,e,c,i,d;const t=(l=M.value)==null?void 0:l.accessToken;_.value&&(!((o=(s=a.value)==null?void 0:s.connection)!=null&&o.state)||((x=(u=a.value)==null?void 0:u.connection)==null?void 0:x.state)===j.Disconnected)&&(a.value=new T(_.value.serverBaseUrl,t,"dashboardHub"),(f=(g=a.value)==null?void 0:g.connection)==null||f.on("connected",B),(p=(v=a.value)==null?void 0:v.connection)==null||p.on("disconnected",k),await G().catch(U),(c=(e=a.value)==null?void 0:e.connection)==null||c.onreconnecting(r=>{var m;console.log("SignalR Disconnected.",r==null?void 0:r.message),I((m=a.value)==null?void 0:m.connection),k()}),(d=(i=a.value)==null?void 0:i.connection)==null||d.onreconnected(()=>{var r;console.log("SignalR Reconnected."),A((r=a.value)==null?void 0:r.connection),B()}))},ve=N({__name:"HelpButton",setup(t){const l=Q(),s=w(()=>`https://docs${K}.nomercy.tv${l.path.replace(/\/\w{8}-\w{4}-\w{4}-\w{4}-\w{12}/gu,"")}`);return(o,u)=>(h(),$(ue,{id:"help",href:s.value,variant:"text",component:"link",target:"_blank",color:"auto",startIcon:"messageBubbleQuestion",class:"relative flex h-10 flex-shrink-0 flex-grow-0 items-center justify-center gap-2 overflow-hidden rounded-lg px-4 py-2.5"},{default:O(()=>[L(b(o.$t("Help")),1)]),_:1},8,["href"]))}}),he={key:0,class:"grid h-full w-full place-items-center"},pe={class:"relative flex items-center justify-start gap-8 overflow-hidden"},me={class:"relative flex w-full flex-col gap-4"},xe={class:"text-7xl font-bold text-center text-slate-light-12/80 dark:text-slate-dark-12/80"},ge={class:"left-0 text-2xl text-center text-slate-light-12/80 dark:text-slate-dark-12/80 whitespace-pre-line"},be=["inert"],ye={class:"z-10 flex h-20 items-center justify-between gap-4 self-stretch border-b px-4 py-4 border-auto-7/6 xl:px-6 bg-slate-light-4 dark:bg-slate-dark-2"},we={class:"relative flex h-full flex-col items-start justify-center gap-1 text-slate-light-12/80 dark:text-slate-dark-12/80"},ke={class:"w-auto flex-shrink-0 flex-grow-0 self-stretch whitespace-nowrap text-xl font-semibold"},_e={key:1,class:"hidden h-8 w-auto flex-shrink-0 flex-grow-0 items-center self-stretch text-sm empty:hidden lg:flex"},Se={class:"flex flex-col flex-nowrap items-end justify-center gap-x-3 gap-y-1 sm:flex-row"},$e={key:0,class:"grid h-full w-full place-items-center bg-slate-light-4 dark:bg-slate-dark-2"},Ce={class:"relative flex flex-col items-center justify-start gap-8 overflow-hidden"},Be={class:"relative flex w-full flex-col gap-4"},De={class:"text-7xl font-bold text-center text-slate-light-12/80 dark:text-slate-dark-12/80"},Ee={class:"left-0 text-2xl text-center text-slate-light-12/80 dark:text-slate-dark-12/80 whitespace-pre-line"},je={key:2,class:"sticky bottom-0 z-0 flex w-full flex-wrap items-center gap-4 border-t px-4 py-4 border-auto-7/6 empty:hidden sm:h-16 xl:px-6"},Re=N({__name:"DashboardLayout",props:Y({title:{type:String,required:!0},params:{type:Object,required:!1},description:{type:String,required:!1},gridStyle:{type:Number,required:!1,default:0},back:{type:Boolean,required:!1,default:!1},error:{type:Object,required:!1},allowAnyone:{type:Boolean,required:!1,default:!1},styles:{type:String,required:!1}},{modelValue:{required:!1,type:Boolean},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const l=W(t,"modelValue"),s=t,{dataUpdatedAt:o,error:u,isPending:x}=X({path:"dashboard/server",enabled:!s.allowAnyone,refetchInterval:1e4,queryKey:["dashboard","server",y.value]}),g=w(()=>s.gridStyle==1?Z.value:s.gridStyle==2?F.value:s.gridStyle==3?J.value:s.gridStyle==4?"flex flex-wrap h-available":"flex flex-wrap h-available overflow-clip"),f=w(()=>{var c,i,d,r,m;if(s.allowAnyone)return null;const e=u.value;if(((c=e==null?void 0:e.response)==null?void 0:c.status)!=200)return{code:((d=(i=e==null?void 0:e.response)==null?void 0:i.data)==null?void 0:d.status)??null,message:((m=(r=e==null?void 0:e.response)==null?void 0:r.data)==null?void 0:m.detail)??""}}),v=w(()=>{var c,i,d,r;const e=s.error;if(console.log(e),!(!(e!=null&&e.response)||((c=e==null?void 0:e.response)==null?void 0:c.status)==200))return{code:(i=e==null?void 0:e.response)==null?void 0:i.status,message:((r=(d=e==null?void 0:e.response)==null?void 0:d.data)==null?void 0:r.detail)??""}});ee(()=>{te(null),se(null)}),ae(H,fe,10);const p=w(()=>{var e;return(((e=f.value)==null?void 0:e.code)||x.value||!y.value)&&!s.allowAnyone});return E(p,e=>{e&&l.value!=null&&(l.value=!1)}),E(o,e=>{e&&!y.value&&H()}),(e,c)=>{var i,d,r,m,q;return h(),$(le,null,[p.value?(h(),S("div",he,[n("div",pe,[n("div",me,[n("p",xe,b((i=f.value)!=null&&i.code?(d=f.value)==null?void 0:d.code:"Offline"),1),n("p",ge,b((r=f.value)==null?void 0:r.message),1)])])])):(h(),S("div",{key:1,class:V([{" min-h-[92vh] sm:min-h-[92.75vh]":!e.$slots.cta," min-h-[92vh] sm:min-h-[90.1vh]":!!e.$slots.cta},"flex flex-col relative z-0 flex-1 h-available h-px overflow-clip items-start justify-start self-stretch w-available bg-slate-light-4 dark:bg-slate-dark-2"])},[n("div",{class:"sticky top-0 z-10 flex flex-shrink-0 flex-grow-0 flex-col items-start justify-start gap-5 self-stretch",inert:D(oe)},[c[0]||(c[0]=n("div",{class:"absolute inset-0 z-0 h-full w-full"},null,-1)),n("div",ye,[n("div",we,[n("p",ke,b(e.$t(t.title,t.params)),1),t.back?(h(),$(de,{key:0,position:"relative",class:"left-4"})):(h(),S("p",_e,b(e.$t(t.description??"")),1))]),C(e.$slots,"title"),n("div",Se,[ne(ve),C(e.$slots,"cta")])])],8,be),v.value?(h(),S("div",$e,[n("div",Ce,[n("div",Be,[n("p",De,b(v.value.code),1),n("p",Ee,b(v.value.message),1)])])])):(h(),$(re,{key:1,static:!0,frame:"",class:"z-0 w-full flex-1 overflow-y-auto overflow-x-hidden sm:p-4 bg-slate-light-4 dark:bg-slate-dark-2"},{default:O(()=>[n("div",{class:V(["h-auto w-full flex-wrap content-start gap-4 flex-1",g.value]),style:ie(t.styles)},[C(e.$slots,"default")],6)]),_:3})),!v.value&&e.$slots.actions?(h(),S("div",je,[c[1]||(c[1]=n("div",{class:"absolute inset-0 -z-10 h-full w-full"},null,-1)),C(e.$slots,"actions")])):z("",!0),(m=D(_))!=null&&m.is_owner||(q=D(_))!=null&&q.is_manager?(h(),$(ce,{key:3})):z("",!0)],2))],1024)}}});export{Re as _,He as c,y as d};
