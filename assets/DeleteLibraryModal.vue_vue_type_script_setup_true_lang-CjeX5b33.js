import{$ as q,ab as F,w,d as b,f as z,k as T,h as k,o as v,j as s,z as n,x as u,a0 as m,p as i,v as E,F as B,q as I,ae as K,a_ as V,c as D,A as g,R as L}from"./vue-ionic-CBB0-pQG.js";import{a as C,bf as R}from"./index-DWqVqnNr.js";import{_ as U}from"./ScrollContainer.vue_vue_type_script_setup_true_lang-DU0cWbfJ.js";import{_ as S}from"./OptimizedIcon.vue_vue_type_script_setup_true_lang-C9WRDkJA.js";import{_ as A}from"./Modal.vue_vue_type_script_setup_true_lang-BSRwTDW4.js";import{u as j}from"./primevue-C9gt6Imy.js";import{_ as N}from"./Button.vue_vue_type_script_setup_true_lang-A-Ix-vU7.js";const G={class:"relative mt-1 w-full"},O={class:"relative flex w-full flex-col overflow-clip h-[88%] even:text-lg"},P={class:"flex p-2 pt-4 border-b !bg-transparent text-sm select-none"},H={class:""},J={class:"mr-auto ml-4"},W={class:"relative flex w-full flex-col h-[85%]"},X={class:"relative w-full h-auto"},Y=["onClick"],Z={class:"mr-auto !ml-7 text-sm select-none"},ee=q({__name:"FolderBrowser",props:{selected:{type:String,required:!0},setSelected:{type:Function,required:!0}},setup(o){const e=o,{t:c}=F();w(e,a=>{t.value=a.selected});const t=b(e.selected??"/"),h=b(!1),f=b("/");w(t,a=>{e.setSelected(a),h.value=!1});const l=b([]),y=b(!1);function r(a){C().post("/dashboard/server/directorytree",{folder:a}).then(({data:p})=>{var x,d,$;l.value=p.data.filter(Q=>Q.type==="folder"),f.value=(($=(d=(x=p.data.at(0))==null?void 0:x.full_path)==null?void 0:d.match(/[\\/]/gu))==null?void 0:$.at(-1))??"/"}).then(()=>y.value=!1)}w(t,a=>{a&&r(a??"")});function _(){var a;h.value=!0,t.value=t.value.split(/[/\\]/gu).slice(0,-1).join(f.value),(a=t.value.match(/[/\\]/gu))!=null&&a.length||(t.value="/")}function M(a){t.value=a.full_path}return z(()=>{r(t.value??"")}),(a,p)=>{const x=T("InputText");return v(),k(B,null,[s("div",G,[n(x,{id:"folderName",modelValue:t.value,"onUpdate:modelValue":p[0]||(p[0]=d=>t.value=d),name:"",variant:"filled",class:"w-full"},null,8,["modelValue"])]),s("div",O,[s("div",P,[s("span",H,u(m(c)("Type")),1),s("span",J,u(m(c)("Name")),1)]),s("div",W,[n(U,{static:!1,"auto-hide":!1,"class-name":"ml-2"},{default:i(()=>[s("div",{class:E(["bg-auto-6/4 hover:bg-auto-200 border-t-0 border-b border-solid border-[rgba(34,34,34,0.9)] contain flex items-center text-current cursor-pointer overflow-hidden py-1 px-2 align-middle h-10 min-h-10 leading-6 select-none",t.value==="/"?"opacity-50":""]),onClick:_},[n(S,{icon:"returnPackage",class:"mt-1 h-5 w-5"}),p[1]||(p[1]=s("span",{class:"mr-auto !ml-7"},"...",-1))],2),s("div",X,[(v(!0),k(B,null,I(l.value,d=>(v(),k("div",{key:d.full_path,class:"even:bg-auto-6/2 odd:bg-auto-100 hover:bg-auto-200 border-t-0 border-b border-solid border-[rgba(34,34,34,0.9)] contain flex items-center bg-transparent text-current cursor-pointer overflow-hidden py-1 px-2 align-middle h-10 leading-6",onClick:()=>M(d)},[n(S,{icon:"folder",class:"h-5 w-5"}),s("span",Z,u(d.path.replace(/[\\\/]/u,"")),1)],8,Y))),128))])]),_:1})])])],64)}}}),te={class:"mx-auto flex w-full flex-col h-[44vh]"},de=q({__name:"NewFolderModal",props:{open:{type:Boolean,required:!0},close:{type:Function,required:!0},folder:{type:String,required:!0},setFolder:{type:Function,required:!0},library:{type:Object,required:!1}},setup(o){const e=o,c=K(),t=V(),h=j(),{t:f}=F();function l(){var y;C().post(`dashboard/libraries/${c.params.id??((y=e.library)==null?void 0:y.id)}/folders`,{path:e.folder}).then(({data:r})=>{r.status==="ok"&&r.data&&e.library&&(e.library.folder_library=[...L(e.library.folder_library||[]),r.data]),t.invalidateQueries({queryKey:["dashboard","libraries"]}),h.add({severity:r.status==="ok"?"success":"error",summary:R(r.message,...r.args),life:2e3}),e.setFolder("/"),e.close()}).catch(r=>{console.error("Error adding folder:",r),e.close()})}return(y,r)=>{const _=T("Button");return v(),D(A,{close:o.close,open:o.open,"max-width":"max-w-5xl",title:"Add folder"},{actions:i(()=>[n(_,{id:"yes","on-click":l,color:"theme",type:"button",variant:"contained"},{default:i(()=>[g(u(m(f)("Add")),1)]),_:1}),n(_,{id:"no","on-click":o.close,type:"button",color:"text-auto-alpha-11",variant:"text"},{default:i(()=>[g(u(m(f)("Cancel")),1)]),_:1},8,["on-click"])]),default:i(()=>[s("div",te,[n(ee,{selected:o.folder,"set-selected":o.setFolder},null,8,["selected","set-selected"])])]),_:1},8,["close","open"])}}}),ae={class:"my-6 text-sm text-auto-10"},ue=q({__name:"DeleteLibraryModal",props:{open:{type:Boolean,required:!0},close:{type:Function,required:!0},id:{type:String,required:!0},name:{type:String,required:!0},noRedirect:{type:Boolean,default:!1}},setup(o){const e=o,{t:c}=F(),t=V(),h=j();function f(){C().delete(`dashboard/libraries/${e.id}`).then(({data:l})=>{h.add({severity:l.status==="ok"?"success":"error",summary:R(l.message,...l.args??[]),life:2e3}),t.invalidateQueries({queryKey:["dashboard","libraries"]}),!e.noRedirect&&window.history.back()}),e.close()}return(l,y)=>(v(),D(A,{close:o.close,open:o.open,"max-width":"max-w-xl",params:{library:e.name},title:"Delete library {{library}}"},{actions:i(()=>[n(N,{id:"yes",onclick:f,"end-icon":"trash",color:"red",type:"button",variant:"contained"},{default:i(()=>[g(u(m(c)("Delete")),1)]),_:1}),n(N,{id:"no","on-click":o.close,type:"button",color:"text-auto-alpha-11",variant:"text"},{default:i(()=>[g(u(m(c)("Cancel")),1)]),_:1},8,["on-click"])]),default:i(()=>[s("div",ae,u(m(c)("Are you sure you want to delete this library?")),1)]),_:1},8,["close","open","params"]))}});export{ee as _,de as a,ue as b};
