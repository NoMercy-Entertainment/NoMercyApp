import{i as f,n as L,r as k,t as b}from"./routerHelper-CFJYCV3o.js";import{As as l,Ds as v,Is as w,Jo as C,Ka as E,Ms as I,Na as N,Os as S,Ss as V,Vs as c,aa as x,cs as D,hs as O,i as B,ls as _,nc as s,ps as F,qa as H,ss as P,ts as R,za as j}from"./index-OqMItaco.js";C();E();j();var z={key:0,class:"grid w-available h-available place-items-center"},A=O({__name:"NMComponent",props:{path:{type:String,required:!1,default:void 0},options:{type:Object,required:!1,default:()=>({keepForever:!0,queryKey:f()})}},setup(y){const o=y,i=o.options.queryKey??f(),g=b({queryKey:i,path:o.path}),{data:t,isLoading:h}=k({queryKey:i,path:o.path}),{data:q,mutate:m}=L({queryKey:i,homeData:t}),n=x(),u=H();function d(){if(!t.value||!n.value)return;const e=t.value.filter(a=>a?.update?.when==="pageLoad")??[];m(e)}function M(){if(!t.value||!n.value)return;const e=t.value.filter(a=>a?.update?.when==="online")??[];m(e)}function p(e){if(!t.value||!n.value)return;const a=t.value.filter(r=>r?.id===e.detail.id)??[];m(a)}return v(()=>{document.addEventListener("mutateId",p),!(!t.value||u.name!=="Home"&&u.name!=="Libraries"&&u.name!=="Music Start")&&n.value&&d()}),S(()=>{document.removeEventListener("mutateId",p)}),c(n,e=>{e&&M()}),c(t,e=>{e&&setTimeout(()=>{document.dispatchEvent(new Event("indexer"))},1e3)}),v(()=>{c(u,(e,a)=>{console.log("onIonViewWillEnter triggered",e.name),!(!t.value||e.name!==B.currentRoute.value.name||e.name!=="Home"&&e.name!=="Libraries"&&e.name!=="Music Start")&&n.value&&d()})}),(e,a)=>s(h)?(l(),_("div",z,[F(s(N),{class:"ion-padding",name:"crescent"})])):s(g)?D("",!0):(l(!0),_(R,{key:1},I(s(q)??s(t)??[],(r,K)=>(l(),P(w(r?.component),V({key:r.id,index:K},{ref_for:!0},r.props),null,16,["index"]))),128))}}),T=A;export{T as t};
