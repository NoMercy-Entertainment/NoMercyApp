import{Gt as l,Ln as x,Lt as B,Mt as M,Rt as f,Tt as T,Vn as p,Vt as V,Wt as v,cn as q,dn as N,kn as a,n as R,qt as L,xn as r,yn as O}from"./index-BvWvvCYJ.js";import{o as j}from"./ui-Dy-CmVFO.js";import{t as z}from"./currentServer-WcAeFY_n.js";import{s as A}from"./user-UVXKBmDM.js";import{t as D}from"./fileupload-BB9Gc9-2.js";import{t as m}from"./Button-4dOHt061.js";import{t as F}from"./Modal-DkbMeIf6.js";T();var E={class:"opacity-0 duration-150 transition-all group-hover/cover:opacity-100 group-hover/cover:bg-black/40 inset-0 absolute grid items-center text-lg font-semibold"},G=L({__name:"ClickUploadModal",props:{data:{type:Object,required:!0},url:{type:String,required:!0}},setup(g){const t=g,_=a(null),n=a(!1),s=a(t.data);function i(){n.value=!1}function h(){n.value=!0}const b=R(),u=a(),C=a(),o=a(t.data.cover),c=a(!0),k=B(()=>`${z.value?.serverApiUrl}${t.url}`);function U(){u.value.upload(),c.value=!0}function y(e){b.add({severity:"info",summary:"Success",detail:"File Uploaded",life:3e3});const{data:d}=JSON.parse(e.xhr.response);o.value=d.url,j(d.color_palette?.cover),i()}function S(e){o.value=e.files[0].objectURL,c.value=!1}function $(e){e.xhr.setRequestHeader("Authorization",`Bearer ${A.value.accessToken}`)}function w(){o.value=t.data.cover,u.value.clear(),i()}return O(o,e=>{s.value={...s.value,cover:e}}),(e,d)=>(q(),V(M,null,[f("button",{id:"uploadDialogTrigger",ref_key:"trigger",ref:_,class:"contents",onClick:h},[N(e.$slots,"default",{ref:C.value,data:s.value}),f("div",E,p(e.$t("Change cover")),1)],512),l(F,{close:i,open:n.value,"max-width":"max-w-2xl",title:"Upload image"},{actions:r(()=>[l(m,{id:"upload",color:"white","start-icon":"arrowCounterClockwise",variant:"text",onClick:w},{default:r(()=>[v(p(e.$t("Cancel")),1)]),_:1}),l(m,{id:"upload",disabled:c.value,color:"theme","start-icon":"cloudUpload",onClick:U},{default:r(()=>[v(p(e.$t("Save")),1)]),_:1},8,["disabled"])]),default:r(()=>[l(x(D),{ref_key:"fileUpload",ref:u,"cancel-label":e.$t("Cancel"),"choose-label":e.$t("Choose image"),"max-file-size":2*1024*1024,url:k.value,accept:"image/*",class:"p-button-outlined",mode:"basic",name:"image","with-credentials":"",onSelect:S,onUpload:y,onBeforeSend:$},null,8,["cancel-label","choose-label","url"])]),_:1},8,["open"])],64))}}),X=G;export{X as t};
