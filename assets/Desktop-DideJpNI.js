import{I as $,d as f,o as i,s,a as _,c as B,t as m,ds as E,R as C,l as x,f as q,j as o,K as u,bu as L,F as N,h as j,n as w,q as p,bh as A,O as v,dt as t,ao as I}from"./index-DkQngsHe.js";import{u as K}from"./useServerClient-CmW8VHrx.js";import{_ as V}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-DnCqx71_.js";import{_ as z}from"./DashboardCard.vue_vue_type_script_setup_true_lang-ca1oupPg.js";import{_ as D}from"./TMDBImage.vue_vue_type_script_setup_true_lang-TirsOY0V.js";import"./useQuery-jTNaBwZN.js";import"./useBaseQuery-BnGe7Aaf.js";import"./useQueryClient-Cy1MABnp.js";import"./useInfiniteServerClient-BHsBwDbE.js";import"./useMounted-BfGYJuv5.js";import"./HubConnection-CMQnVIkW.js";import"./FloatingBackButton.vue_vue_type_script_setup_true_lang-Da0SgVOE.js";import"./OptimizedIcon.vue_vue_type_script_setup_true_lang-BBYVQkaB.js";import"./Button.vue_vue_type_script_setup_true_lang-B5T8NTkB.js";import"./ScrollContainer.vue_vue_type_script_setup_true_lang-BJWiF2I-.js";import"./RipperOverlay.vue_vue_type_script_setup_true_lang-oED-RT0Y.js";import"./ripperSocket-BmFnZdbx.js";import"./AppLogoSquare-BLQmk_bo.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const F={class:"relative flex aspect-video flex-shrink-0 flex-grow-0 flex-col items-center justify-center self-stretch overflow-clip rounded-lg bg-theme-11 dark:bg-theme-8 text-slate-light-12/80 dark:text-slate-dark-12/80"},O={key:1,class:"text-xl font-bold"},T=$({__name:"LibraryCard",props:{data:{type:Object,required:!0}},setup(r){return(l,n)=>{var d,c,a;return i(),f(z,{route:`/dashboard/libraries/${r.data.id}`,line1:r.data.title,line2:r.data.folder_library&&((d=r.data.folder_library)==null?void 0:d.length)!==1?`${(c=r.data.folder_library)==null?void 0:c.length} folders`:`${(a=r.data.folder_library)==null?void 0:a.length}  folder`},{image:s(()=>[_("div",F,[n[0]||(n[0]=_("div",{class:"backdropCard-overlay"},null,-1)),r.data.image?(i(),f(D,{key:0,path:r.data.image,class:"z-0"},null,8,["path"])):(i(),B("span",O,m(r.data.title),1))])]),_:1},8,["route","line1","line2"])}}}),ne=$({__name:"Desktop",setup(r){var g;const l=E(),{data:n,error:d}=K({path:"dashboard/libraries",queryKey:["dashboard","libraries",(g=C.value)==null?void 0:g.serverBaseUrl]});function c(){v().post("dashboard/libraries").then(({data:e})=>{var b;l.add({severity:e.status==="ok"?"success":"error",summary:t(e.status==="ok"?"Success":"Error"),detail:t(e.message,...e.args),life:5e3}),I.invalidateQueries({queryKey:["dashboard","libraries",(b=C.value)==null?void 0:b.serverBaseUrl]})})}const a=x(!1);function S(){a.value=!0,v().post("dashboard/libraries/refresh").then(({data:e})=>{a.value=!1,l.add({severity:e.status==="ok"?"success":"error",summary:t(e.status==="ok"?"Success":"Error"),detail:t(e.message,...e.args),life:5e3})}).catch(()=>{a.value=!1,l.add({severity:"error",summary:t("Error"),detail:t("An error occurred while rescanning the libraries"),life:5e3})})}const h=x(!1);function R(){h.value=!0,v().post("dashboard/libraries/rescan").then(({data:e})=>{h.value=!1,l.add({severity:e.status==="ok"?"success":"error",summary:t(e.status==="ok"?"Success":"Error"),detail:t(e.message,...e.args),life:5e3})}).catch(()=>{h.value=!1,l.add({severity:"error",summary:t("Error"),detail:t("An error occurred while rescanning the libraries"),life:5e3})})}return(e,b)=>{const y=q("Button");return i(),f(u(A),null,{default:s(()=>[o(u(L),{fullscreen:!0},{default:s(()=>[o(V,{error:u(d),"grid-style":1,title:"Libraries",description:"Manage your media libraries and their content here."},{cta:s(()=>[o(y,{id:"newLibrary",color:"theme","start-icon":"folderAdd",onClick:c},{default:s(()=>[p(m(e.$t("New library")),1)]),_:1})]),actions:s(()=>[o(y,{id:"refresh",type:"button",variant:"text","start-icon":"folderSwap",disabled:a.value,class:w(a.value?"first:children:animate-spin cursor-not-allowed":""),onClick:S},{default:s(()=>[p(m(e.$t("Refresh all libraries")),1)]),_:1},8,["disabled","class"]),o(y,{id:"rescan",type:"button",variant:"text","start-icon":"folderSwap",disabled:a.value,class:w(a.value?"first:children:animate-spin cursor-not-allowed":""),onClick:R},{default:s(()=>[p(m(e.$t("Rescan all libraries")),1)]),_:1},8,["disabled","class"])]),default:s(()=>[(i(!0),B(N,null,j(u(n)??[],k=>(i(),f(T,{key:k.id,data:k},null,8,["data"]))),128))]),_:1},8,["error"])]),_:1})]),_:1})}}});export{ne as default};
