import{at as pe,au as ve,k as he}from"./index-C_qNKMWs.js";var Q={exports:{}},B={},ne;function me(){if(ne)return B;ne=1,B.byteLength=C,B.toByteArray=E,B.fromByteArray=w;for(var m=[],f=[],k=typeof Uint8Array<"u"?Uint8Array:Array,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",g=0,U=u.length;g<U;++g)m[g]=u[g],f[u.charCodeAt(g)]=g;f[45]=62,f[95]=63;function M(v){var h=v.length;if(h%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var S=v.indexOf("=");S===-1&&(S=h);var A=S===h?0:4-S%4;return[S,A]}function C(v){var h=M(v),S=h[0],A=h[1];return(S+A)*3/4-A}function e(v,h,S){return(h+S)*3/4-S}function E(v){for(var h,S=M(v),A=S[0],R=S[1],L=new k(e(v,A,R)),I=0,j=R>0?A-4:A,_=0;_<j;_+=4)h=f[v.charCodeAt(_)]<<18|f[v.charCodeAt(_+1)]<<12|f[v.charCodeAt(_+2)]<<6|f[v.charCodeAt(_+3)],L[I++]=h>>16&255,L[I++]=h>>8&255,L[I++]=h&255;return R===2&&(h=f[v.charCodeAt(_)]<<2|f[v.charCodeAt(_+1)]>>4,L[I++]=h&255),R===1&&(h=f[v.charCodeAt(_)]<<10|f[v.charCodeAt(_+1)]<<4|f[v.charCodeAt(_+2)]>>2,L[I++]=h>>8&255,L[I++]=h&255),L}function N(v){return m[v>>18&63]+m[v>>12&63]+m[v>>6&63]+m[v&63]}function K(v,h,S){for(var A,R=[],L=h;L<S;L+=3)A=(v[L]<<16&16711680)+(v[L+1]<<8&65280)+(v[L+2]&255),R.push(N(A));return R.join("")}function w(v){for(var h,S=v.length,A=S%3,R=[],L=16383,I=0,j=S-A;I<j;I+=L)R.push(K(v,I,I+L>j?j:I+L));return A===1?(h=v[S-1],R.push(m[h>>2]+m[h<<4&63]+"==")):A===2&&(h=(v[S-2]<<8)+v[S-1],R.push(m[h>>10]+m[h>>4&63]+m[h<<2&63]+"=")),R.join("")}return B}var oe;function ge(){return oe||(oe=1,function(m,f){(function(k,u){m.exports=u(pe(),me())})(window,function(k,u){if(typeof Promise>"u")throw Error("Keycloak requires an environment that supports Promises. Make sure that you include the appropriate polyfill.");var g=!1;function U(){g||(g=!0,console.warn("[KEYCLOAK] Usage of legacy style promise methods such as `.error()` and `.success()` has been deprecated and support will be removed in future versions. Use standard style promise methods such as `.then() and `.catch()` instead."))}function M(C){if(!(this instanceof M))return new M(C);for(var e=this,E,N=[],K,w={enable:!0,callbackList:[],interval:5},v=document.getElementsByTagName("script"),h=0;h<v.length;h++)(v[h].src.indexOf("keycloak.js")!==-1||v[h].src.indexOf("keycloak.min.js")!==-1)&&v[h].src.indexOf("version=")!==-1&&(e.iframeVersion=v[h].src.substring(v[h].src.indexOf("version=")+8).split("&")[0]);var S=!0,A=te(console.info),R=te(console.warn);e.init=function(r){e.authenticated=!1,K=fe();var t=["default","cordova","cordova-native","capacitor","capacitor-native"];if(r&&t.indexOf(r.adapter)>-1?E=V(r.adapter):r&&typeof r.adapter=="object"?E=r.adapter:window.Cordova||window.cordova?E=V("cordova"):window.Capacitor||window.capacitor?E=V("capacitor-native"):E=V(),r){if(typeof r.useNonce<"u"&&(S=r.useNonce),typeof r.checkLoginIframe<"u"&&(w.enable=r.checkLoginIframe),r.checkLoginIframeInterval&&(w.interval=r.checkLoginIframeInterval),r.onLoad==="login-required"&&(e.loginRequired=!0),r.responseMode)if(r.responseMode==="query"||r.responseMode==="fragment")e.responseMode=r.responseMode;else throw"Invalid value for responseMode";if(r.flow){switch(r.flow){case"standard":e.responseType="code";break;case"implicit":e.responseType="id_token token";break;case"hybrid":e.responseType="code id_token token";break;default:throw"Invalid value for flow"}e.flow=r.flow}if(r.timeSkew!=null&&(e.timeSkew=r.timeSkew),r.redirectUri&&(e.redirectUri=r.redirectUri),r.silentCheckSsoRedirectUri&&(e.silentCheckSsoRedirectUri=r.silentCheckSsoRedirectUri),typeof r.silentCheckSsoFallback=="boolean"?e.silentCheckSsoFallback=r.silentCheckSsoFallback:e.silentCheckSsoFallback=!0,r.pkceMethod){if(r.pkceMethod!=="S256")throw"Invalid value for pkceMethod";e.pkceMethod=r.pkceMethod}typeof r.enableLogging=="boolean"?e.enableLogging=r.enableLogging:e.enableLogging=!1,typeof r.scope=="string"&&(e.scope=r.scope)}e.responseMode||(e.responseMode="fragment"),e.responseType||(e.responseType="code",e.flow="standard");var s=b(),i=b();i.promise.then(function(){e.onReady&&e.onReady(e.authenticated),s.setSuccess(e.authenticated)}).catch(function(c){s.setError(c)});var a=ue();function d(){var c=function(y){y||(p.prompt="none"),e.login(p).then(function(){i.setSuccess()}).catch(function(){i.setError()})},l=function(){var y=document.createElement("iframe"),O=e.createLoginUrl({prompt:"none",redirectUri:e.silentCheckSsoRedirectUri});y.setAttribute("src",O),y.setAttribute("title","keycloak-silent-check-sso"),y.style.display="none",document.body.appendChild(y);var H=function(T){if(!(T.origin!==window.location.origin||y.contentWindow!==T.source)){var D=P(T.data);x(D,i),document.body.removeChild(y),window.removeEventListener("message",H)}};window.addEventListener("message",H)},p={};switch(r.onLoad){case"check-sso":w.enable?z().then(function(){q().then(function(y){y?i.setSuccess():e.silentCheckSsoRedirectUri?l():c(!1)}).catch(function(){i.setError()})}):e.silentCheckSsoRedirectUri?l():c(!1);break;case"login-required":c(!0);break;default:throw"Invalid value for onLoad"}}function n(){var c=P(window.location.href);if(c&&window.history.replaceState(window.history.state,null,c.newUrl),c&&c.valid)return z().then(function(){x(c,i)}).catch(function(l){i.setError()});r?r.token&&r.refreshToken?(J(r.token,r.refreshToken,r.idToken),w.enable?z().then(function(){q().then(function(l){l?(e.onAuthSuccess&&e.onAuthSuccess(),i.setSuccess(),X()):i.setSuccess()}).catch(function(){i.setError()})}):e.updateToken(-1).then(function(){e.onAuthSuccess&&e.onAuthSuccess(),i.setSuccess()}).catch(function(){e.onAuthError&&e.onAuthError(),r.onLoad?d():i.setError()})):r.onLoad?d():i.setSuccess():i.setSuccess()}function o(){var c=b(),l=function(){(document.readyState==="interactive"||document.readyState==="complete")&&(document.removeEventListener("readystatechange",l),c.setSuccess())};return document.addEventListener("readystatechange",l),l(),c.promise}return a.then(function(){o().then(de).then(n).catch(function(){s.setError()})}),a.catch(function(){s.setError()}),s.promise},e.login=function(r){return E.login(r)};function L(r){var t=null,s=window.crypto||window.msCrypto;if(s&&s.getRandomValues&&window.Uint8Array)return t=new Uint8Array(r),s.getRandomValues(t),t;t=new Array(r);for(var i=0;i<t.length;i++)t[i]=Math.floor(256*Math.random());return t}function I(r){return j(r,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789")}function j(r,t){for(var s=L(r),i=new Array(r),a=0;a<r;a++)i[a]=t.charCodeAt(s[a]%t.length);return String.fromCharCode.apply(null,i)}function _(r,t){switch(r){case"S256":var s=new Uint8Array(k.arrayBuffer(t)),i=u.fromByteArray(s).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"");return i;default:throw"Invalid value for pkceMethod"}}e.createLoginUrl=function(r){var t=ee(),s=ee(),i=E.redirectUri(r),a={state:t,nonce:s,redirectUri:encodeURIComponent(i)};r&&r.prompt&&(a.prompt=r.prompt);var d;r&&r.action=="register"?d=e.endpoints.register():d=e.endpoints.authorize();var n=r&&r.scope||e.scope;n?n.indexOf("openid")===-1&&(n="openid "+n):n="openid";var o=d+"?client_id="+encodeURIComponent(e.clientId)+"&redirect_uri="+encodeURIComponent(i)+"&state="+encodeURIComponent(t)+"&response_mode="+encodeURIComponent(e.responseMode)+"&response_type="+encodeURIComponent(e.responseType)+"&scope="+encodeURIComponent(n);if(S&&(o=o+"&nonce="+encodeURIComponent(s)),r&&r.prompt&&(o+="&prompt="+encodeURIComponent(r.prompt)),r&&r.maxAge&&(o+="&max_age="+encodeURIComponent(r.maxAge)),r&&r.loginHint&&(o+="&login_hint="+encodeURIComponent(r.loginHint)),r&&r.idpHint&&(o+="&kc_idp_hint="+encodeURIComponent(r.idpHint)),r&&r.action&&r.action!="register"&&(o+="&kc_action="+encodeURIComponent(r.action)),r&&r.locale&&(o+="&ui_locales="+encodeURIComponent(r.locale)),e.pkceMethod){var c=I(96);a.pkceCodeVerifier=c;var l=_(e.pkceMethod,c);o+="&code_challenge="+l,o+="&code_challenge_method="+e.pkceMethod}return K.add(a),o},e.logout=function(r){return E.logout(r)},e.createLogoutUrl=function(r){var t=e.endpoints.logout()+"?redirect_uri="+encodeURIComponent(E.redirectUri(r,!1));return t},e.register=function(r){return E.register(r)},e.createRegisterUrl=function(r){return r||(r={}),r.action="register",e.createLoginUrl(r)},e.createAccountUrl=function(r){var t=F(),s=void 0;return typeof t<"u"&&(s=t+"/account?referrer="+encodeURIComponent(e.clientId)+"&referrer_uri="+encodeURIComponent(E.redirectUri(r))),s},e.accountManagement=function(){return E.accountManagement()},e.hasRealmRole=function(r){var t=e.realmAccess;return!!t&&t.roles.indexOf(r)>=0},e.hasResourceRole=function(r,t){if(!e.resourceAccess)return!1;var s=e.resourceAccess[t||e.clientId];return!!s&&s.roles.indexOf(r)>=0},e.loadUserProfile=function(){var r=F()+"/account",t=new XMLHttpRequest;t.open("GET",r,!0),t.setRequestHeader("Accept","application/json"),t.setRequestHeader("Authorization","bearer "+e.token);var s=b();return t.onreadystatechange=function(){t.readyState==4&&(t.status==200?(e.profile=JSON.parse(t.responseText),s.setSuccess(e.profile)):s.setError())},t.send(),s.promise},e.loadUserInfo=function(){var r=e.endpoints.userinfo(),t=new XMLHttpRequest;t.open("GET",r,!0),t.setRequestHeader("Accept","application/json"),t.setRequestHeader("Authorization","bearer "+e.token);var s=b();return t.onreadystatechange=function(){t.readyState==4&&(t.status==200?(e.userInfo=JSON.parse(t.responseText),s.setSuccess(e.userInfo)):s.setError())},t.send(),s.promise},e.isTokenExpired=function(r){if(!e.tokenParsed||!e.refreshToken&&e.flow!="implicit")throw"Not authenticated";if(e.timeSkew==null)return A("[KEYCLOAK] Unable to determine if token is expired as timeskew is not set"),!0;var t=e.tokenParsed.exp-Math.ceil(new Date().getTime()/1e3)+e.timeSkew;if(r){if(isNaN(r))throw"Invalid minValidity";t-=r}return t<0},e.updateToken=function(r){var t=b();if(!e.refreshToken)return t.setError(),t.promise;r=r||5;var s=function(){var a=!1;if(r==-1?(a=!0,A("[KEYCLOAK] Refreshing token: forced refresh")):(!e.tokenParsed||e.isTokenExpired(r))&&(a=!0,A("[KEYCLOAK] Refreshing token: token expired")),!a)t.setSuccess(!1);else{var d="grant_type=refresh_token&refresh_token="+e.refreshToken,n=e.endpoints.token();if(N.push(t),N.length==1){var o=new XMLHttpRequest;o.open("POST",n,!0),o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.withCredentials=!0,d+="&client_id="+encodeURIComponent(e.clientId);var c=new Date().getTime();o.onreadystatechange=function(){if(o.readyState==4)if(o.status==200){A("[KEYCLOAK] Token refreshed"),c=(c+new Date().getTime())/2;var l=JSON.parse(o.responseText);J(l.access_token,l.refresh_token,l.id_token,c),e.onAuthRefreshSuccess&&e.onAuthRefreshSuccess();for(var p=N.pop();p!=null;p=N.pop())p.setSuccess(!0)}else{R("[KEYCLOAK] Failed to refresh token"),o.status==400&&e.clearToken(),e.onAuthRefreshError&&e.onAuthRefreshError();for(var p=N.pop();p!=null;p=N.pop())p.setError(!0)}},o.send(d)}}};if(w.enable){var i=q();i.then(function(){s()}).catch(function(){t.setError()})}else s();return t.promise},e.clearToken=function(){e.token&&(J(null,null,null),e.onAuthLogout&&e.onAuthLogout(),e.loginRequired&&e.login())};function F(){if(typeof e.authServerUrl<"u")return e.authServerUrl.charAt(e.authServerUrl.length-1)=="/"?e.authServerUrl+"realms/"+encodeURIComponent(e.realm):e.authServerUrl+"/realms/"+encodeURIComponent(e.realm)}function ce(){return window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")}function x(r,t){var s=r.code,i=r.error,a=r.prompt,d=new Date().getTime();if(r.kc_action_status&&e.onActionUpdate&&e.onActionUpdate(r.kc_action_status),i){if(a!="none"){var n={error:i,error_description:r.error_description};e.onAuthError&&e.onAuthError(n),t&&t.setError(n)}else t&&t.setSuccess();return}else e.flow!="standard"&&(r.access_token||r.id_token)&&p(r.access_token,null,r.id_token,!0);if(e.flow!="implicit"&&s){var o="code="+s+"&grant_type=authorization_code",c=e.endpoints.token(),l=new XMLHttpRequest;l.open("POST",c,!0),l.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o+="&client_id="+encodeURIComponent(e.clientId),o+="&redirect_uri="+r.redirectUri,r.pkceCodeVerifier&&(o+="&code_verifier="+r.pkceCodeVerifier),l.withCredentials=!0,l.onreadystatechange=function(){if(l.readyState==4)if(l.status==200){var y=JSON.parse(l.responseText);p(y.access_token,y.refresh_token,y.id_token,e.flow==="standard"),X()}else e.onAuthError&&e.onAuthError(),t&&t.setError()},l.send(o)}function p(y,O,H,T){d=(d+new Date().getTime())/2,J(y,O,H,d),S&&(e.tokenParsed&&e.tokenParsed.nonce!=r.storedNonce||e.refreshTokenParsed&&e.refreshTokenParsed.nonce!=r.storedNonce||e.idTokenParsed&&e.idTokenParsed.nonce!=r.storedNonce)?(A("[KEYCLOAK] Invalid nonce, clearing token"),e.clearToken(),t&&t.setError()):T&&(e.onAuthSuccess&&e.onAuthSuccess(),t&&t.setSuccess())}}function ue(r){var t=b(),s;C?typeof C=="string"&&(s=C):s="keycloak.json";function i(l){l?e.endpoints={authorize:function(){return l.authorization_endpoint},token:function(){return l.token_endpoint},logout:function(){if(!l.end_session_endpoint)throw"Not supported by the OIDC server";return l.end_session_endpoint},checkSessionIframe:function(){if(!l.check_session_iframe)throw"Not supported by the OIDC server";return l.check_session_iframe},register:function(){throw'Redirection to "Register user" page not supported in standard OIDC mode'},userinfo:function(){if(!l.userinfo_endpoint)throw"Not supported by the OIDC server";return l.userinfo_endpoint}}:e.endpoints={authorize:function(){return F()+"/protocol/openid-connect/auth"},token:function(){return F()+"/protocol/openid-connect/token"},logout:function(){return F()+"/protocol/openid-connect/logout"},checkSessionIframe:function(){var p=F()+"/protocol/openid-connect/login-status-iframe.html";return e.iframeVersion&&(p=p+"?version="+e.iframeVersion),p},thirdPartyCookiesIframe:function(){var p=F()+"/protocol/openid-connect/3p-cookies/step1.html";return e.iframeVersion&&(p=p+"?version="+e.iframeVersion),p},register:function(){return F()+"/protocol/openid-connect/registrations"},userinfo:function(){return F()+"/protocol/openid-connect/userinfo"}}}if(s){var a=new XMLHttpRequest;a.open("GET",s,!0),a.setRequestHeader("Accept","application/json"),a.onreadystatechange=function(){if(a.readyState==4)if(a.status==200||Z(a)){var l=JSON.parse(a.responseText);e.authServerUrl=l["auth-server-url"],e.realm=l.realm,e.clientId=l.resource,i(null),t.setSuccess()}else t.setError()},a.send()}else{if(!C.clientId)throw"clientId missing";e.clientId=C.clientId;var d=C.oidcProvider;if(d)if(typeof d=="string"){var c;d.charAt(d.length-1)=="/"?c=d+".well-known/openid-configuration":c=d+"/.well-known/openid-configuration";var a=new XMLHttpRequest;a.open("GET",c,!0),a.setRequestHeader("Accept","application/json"),a.onreadystatechange=function(){if(a.readyState==4)if(a.status==200||Z(a)){var p=JSON.parse(a.responseText);i(p),t.setSuccess()}else t.setError()},a.send()}else i(d),t.setSuccess();else{if(!C.url){for(var n=document.getElementsByTagName("script"),o=0;o<n.length;o++)if(n[o].src.match(/.*keycloak\.js/)){C.url=n[o].src.substr(0,n[o].src.indexOf("/js/keycloak.js"));break}}if(!C.realm)throw"realm missing";e.authServerUrl=C.url,e.realm=C.realm,i(null),t.setSuccess()}}return t.promise}function Z(r){return r.status==0&&r.responseText&&r.responseURL.startsWith("file:")}function J(r,t,s,i){if(e.tokenTimeoutHandle&&(clearTimeout(e.tokenTimeoutHandle),e.tokenTimeoutHandle=null),t?(e.refreshToken=t,e.refreshTokenParsed=Y(t)):(delete e.refreshToken,delete e.refreshTokenParsed),s?(e.idToken=s,e.idTokenParsed=Y(s)):(delete e.idToken,delete e.idTokenParsed),r){if(e.token=r,e.tokenParsed=Y(r),e.sessionId=e.tokenParsed.session_state,e.authenticated=!0,e.subject=e.tokenParsed.sub,e.realmAccess=e.tokenParsed.realm_access,e.resourceAccess=e.tokenParsed.resource_access,i&&(e.timeSkew=Math.floor(i/1e3)-e.tokenParsed.iat),e.timeSkew!=null&&(A("[KEYCLOAK] Estimated time difference between browser and server is "+e.timeSkew+" seconds"),e.onTokenExpired)){var a=(e.tokenParsed.exp-new Date().getTime()/1e3+e.timeSkew)*1e3;A("[KEYCLOAK] Token expires in "+Math.round(a/1e3)+" s"),a<=0?e.onTokenExpired():e.tokenTimeoutHandle=setTimeout(e.onTokenExpired,a)}}else delete e.token,delete e.tokenParsed,delete e.subject,delete e.realmAccess,delete e.resourceAccess,e.authenticated=!1}function Y(r){switch(r=r.split(".")[1],r=r.replace(/-/g,"+"),r=r.replace(/_/g,"/"),r.length%4){case 0:break;case 2:r+="==";break;case 3:r+="=";break;default:throw"Invalid token"}return r=decodeURIComponent(escape(atob(r))),r=JSON.parse(r),r}function ee(){var r="0123456789abcdef",t=j(36,r).split("");t[14]="4",t[19]=r.substr(t[19]&3|8,1),t[8]=t[13]=t[18]=t[23]="-";var s=t.join("");return s}function P(r){var t=le(r);if(t){var s=K.get(t.state);return s&&(t.valid=!0,t.redirectUri=s.redirectUri,t.storedNonce=s.nonce,t.prompt=s.prompt,t.pkceCodeVerifier=s.pkceCodeVerifier),t}}function le(r){var t;switch(e.flow){case"standard":t=["code","state","session_state","kc_action_status"];break;case"implicit":t=["access_token","token_type","id_token","state","session_state","expires_in","kc_action_status"];break;case"hybrid":t=["access_token","token_type","id_token","code","state","session_state","expires_in","kc_action_status"];break}t.push("error"),t.push("error_description"),t.push("error_uri");var s=r.indexOf("?"),i=r.indexOf("#"),a,d;if(e.responseMode==="query"&&s!==-1?(a=r.substring(0,s),d=re(r.substring(s+1,i!==-1?i:r.length),t),d.paramsString!==""&&(a+="?"+d.paramsString),i!==-1&&(a+=r.substring(i))):e.responseMode==="fragment"&&i!==-1&&(a=r.substring(0,i),d=re(r.substring(i+1),t),d.paramsString!==""&&(a+="#"+d.paramsString)),d&&d.oauthParams){if(e.flow==="standard"||e.flow==="hybrid"){if((d.oauthParams.code||d.oauthParams.error)&&d.oauthParams.state)return d.oauthParams.newUrl=a,d.oauthParams}else if(e.flow==="implicit"&&(d.oauthParams.access_token||d.oauthParams.error)&&d.oauthParams.state)return d.oauthParams.newUrl=a,d.oauthParams}}function re(r,t){for(var s=r.split("&"),i={paramsString:"",oauthParams:{}},a=0;a<s.length;a++){var d=s[a].indexOf("="),n=s[a].slice(0,d);t.indexOf(n)!==-1?i.oauthParams[n]=s[a].slice(d+1):(i.paramsString!==""&&(i.paramsString+="&"),i.paramsString+=s[a])}return i}function b(){var r={setSuccess:function(t){r.resolve(t)},setError:function(t){r.reject(t)}};return r.promise=new Promise(function(t,s){r.resolve=t,r.reject=s}),r.promise.success=function(t){return U(),this.then(function(i){t(i)}),this},r.promise.error=function(t){return U(),this.catch(function(i){t(i)}),this},r}function z(){var r=b();if(!w.enable||w.iframe)return r.setSuccess(),r.promise;var t=document.createElement("iframe");w.iframe=t,t.onload=function(){var a=e.endpoints.authorize();a.charAt(0)==="/"?w.iframeOrigin=ce():w.iframeOrigin=a.substring(0,a.indexOf("/",8)),r.setSuccess()};var s=e.endpoints.checkSessionIframe();t.setAttribute("src",s),t.setAttribute("title","keycloak-session-iframe"),t.style.display="none",document.body.appendChild(t);var i=function(a){if(!(a.origin!==w.iframeOrigin||w.iframe.contentWindow!==a.source)&&(a.data=="unchanged"||a.data=="changed"||a.data=="error")){a.data!="unchanged"&&e.clearToken();for(var d=w.callbackList.splice(0,w.callbackList.length),n=d.length-1;n>=0;--n){var o=d[n];a.data=="error"?o.setError():o.setSuccess(a.data=="unchanged")}}};return window.addEventListener("message",i,!1),r.promise}function X(){w.enable&&e.token&&setTimeout(function(){q().then(function(r){r&&X()})},w.interval*1e3)}function q(){var r=b();if(w.iframe&&w.iframeOrigin){var t=e.clientId+" "+(e.sessionId?e.sessionId:"");w.callbackList.push(r);var s=w.iframeOrigin;w.callbackList.length==1&&w.iframe.contentWindow.postMessage(t,s)}else r.setSuccess();return r.promise}function de(){var r=b();if(w.enable||e.silentCheckSsoRedirectUri){var t=document.createElement("iframe");t.setAttribute("src",e.endpoints.thirdPartyCookiesIframe()),t.setAttribute("title","keycloak-3p-check-iframe"),t.style.display="none",document.body.appendChild(t);var s=function(i){t.contentWindow===i.source&&(i.data!=="supported"&&i.data!=="unsupported"||(i.data==="unsupported"&&(w.enable=!1,e.silentCheckSsoFallback&&(e.silentCheckSsoRedirectUri=!1),R("[KEYCLOAK] 3rd party cookies aren't supported by this browser. checkLoginIframe and silent check-sso are not available.")),document.body.removeChild(t),window.removeEventListener("message",s),r.setSuccess()))};window.addEventListener("message",s,!1)}else r.setSuccess();return r.promise}function V(r,t){if(!r||r=="default")return{login:function(n){return window.location.replace(e.createLoginUrl(n)),b().promise},logout:function(n){return window.location.replace(e.createLogoutUrl(n)),b().promise},register:function(n){return window.location.replace(e.createRegisterUrl(n)),b().promise},accountManagement:function(){var n=e.createAccountUrl();if(typeof n<"u")window.location.href=n;else throw"Not supported by the OIDC server";return b().promise},redirectUri:function(n,o){return n&&n.redirectUri?n.redirectUri:e.redirectUri?e.redirectUri:location.href}};if(r=="cordova"){w.enable=!1;var s=function(n,o,c){return window.cordova&&window.cordova.InAppBrowser?window.cordova.InAppBrowser.open(n,o,c):window.open(n,o,c)},i=function(n){return n&&n.cordovaOptions?Object.keys(n.cordovaOptions).reduce(function(o,c){return o[c]=n.cordovaOptions[c],o},{}):{}},a=function(n){return Object.keys(n).reduce(function(o,c){return o.push(c+"="+n[c]),o},[]).join(",")},d=function(n){var o=i(n);return o.location="no",n&&n.prompt=="none"&&(o.hidden="yes"),a(o)};return{login:function(n){var o=b(),c=d(n),l=e.createLoginUrl(n),p=s(l,"_blank",c),y=!1,O=!1,H=function(){O=!0,p.close()};return p.addEventListener("loadstart",function(T){if(T.url.indexOf("http://localhost")==0){var D=P(T.url);x(D,o),H(),y=!0}}),p.addEventListener("loaderror",function(T){if(!y)if(T.url.indexOf("http://localhost")==0){var D=P(T.url);x(D,o),H(),y=!0}else o.setError(),H()}),p.addEventListener("exit",function(T){O||o.setError({reason:"closed_by_user"})}),o.promise},logout:function(n){var o=b(),c=e.createLogoutUrl(n),l=s(c,"_blank","location=no,hidden=yes"),p;return l.addEventListener("loadstart",function(y){y.url.indexOf("http://localhost")==0&&l.close()}),l.addEventListener("loaderror",function(y){y.url.indexOf("http://localhost")==0||(p=!0),l.close()}),l.addEventListener("exit",function(y){p?o.setError():(e.clearToken(),o.setSuccess())}),o.promise},register:function(n){var o=b(),c=e.createRegisterUrl(),l=d(n),p=s(c,"_blank",l);return p.addEventListener("loadstart",function(y){if(y.url.indexOf("http://localhost")==0){p.close();var O=P(y.url);x(O,o)}}),o.promise},accountManagement:function(){var n=e.createAccountUrl();if(typeof n<"u"){var o=s(n,"_blank","location=no");o.addEventListener("loadstart",function(c){c.url.indexOf("http://localhost")==0&&o.close()})}else throw"Not supported by the OIDC server"},redirectUri:function(n){return"http://localhost"}}}if(r=="cordova-native")return w.enable=!1,{login:function(n){var o=b(),c=e.createLoginUrl(n);return universalLinks.subscribe("keycloak",function(l){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close();var p=P(l.url);x(p,o)}),window.cordova.plugins.browsertab.openUrl(c),o.promise},logout:function(n){var o=b(),c=e.createLogoutUrl(n);return universalLinks.subscribe("keycloak",function(l){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close(),e.clearToken(),o.setSuccess()}),window.cordova.plugins.browsertab.openUrl(c),o.promise},register:function(n){var o=b(),c=e.createRegisterUrl(n);return universalLinks.subscribe("keycloak",function(l){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close();var p=P(l.url);x(p,o)}),window.cordova.plugins.browsertab.openUrl(c),o.promise},accountManagement:function(){var n=e.createAccountUrl();if(typeof n<"u")window.cordova.plugins.browsertab.openUrl(n);else throw"Not supported by the OIDC server"},redirectUri:function(n){return n&&n.redirectUri?n.redirectUri:e.redirectUri?e.redirectUri:"http://localhost"}};if(r=="capacitor")return w.enable=!1,{login:function(n){var o=b(),c=e.createLoginUrl(n);return window.Capacitor.Plugins.App.addListener("appUrlOpen",l=>{window.cordova.plugins.browsertab.close();var p=P(l.url);x(p,o)}),window.cordova.plugins.browsertab.openUrl(c),o.promise},logout:function(n){var o=b(),c=e.createLogoutUrl(n);return window.Capacitor.Plugins.App.addListener("appUrlOpen",l=>{window.cordova.plugins.browsertab.close(),e.clearToken(),o.setSuccess()}),window.cordova.plugins.browsertab.openUrl(c),o.promise},register:function(n){var o=b(),c=e.createRegisterUrl(n);return window.Capacitor.Plugins.App.addListener("appUrlOpen",l=>{window.cordova.plugins.browsertab.close();var p=P(l.url);x(p,o)}),window.cordova.plugins.browsertab.openUrl(c),o.promise},accountManagement:function(){var n=e.createAccountUrl();if(typeof n<"u")window.cordova.plugins.browsertab.openUrl(n);else throw"Not supported by the OIDC server"},redirectUri:function(n){return n&&n.redirectUri?n.redirectUri:e.redirectUri?e.redirectUri:"http://localhost"}};if(r=="capacitor-native")return w.enable=!1,{login:function(n){var o=b(),c=e.createLoginUrl(n);const l=window.Capacitor.Plugins.App.addListener("appUrlOpen",p=>{var y=P(p.url);x(y,o),l.remove()});return window.open(c,"_system"),o.promise},logout:function(n){var o=b(),c=e.createLogoutUrl(n);const l=window.Capacitor.Plugins.App.addListener("appUrlOpen",p=>{e.clearToken(),o.setSuccess(),l.remove()});return window.open(c,"_system"),o.promise},register:function(n){var o=b(),c=e.createRegisterUrl(n);return window.Capacitor.Plugins.App.addListener("appUrlOpen",l=>{var p=P(l.url);x(p,o)}),window.open(c,"_system"),o.promise},accountManagement:function(){var n=e.createAccountUrl();if(typeof n<"u")window.open(n,"_system");else throw"Not supported by the OIDC server"},redirectUri:function(n){return n&&n.redirectUri?n.redirectUri:e.redirectUri?e.redirectUri:"http://localhost"}};throw"invalid adapter type: "+r}var $=function(){if(!(this instanceof $))return new $;localStorage.setItem("kc-test","test"),localStorage.removeItem("kc-test");var r=this;function t(){for(var s=new Date().getTime(),i=0;i<localStorage.length;i++){var a=localStorage.key(i);if(a&&a.indexOf("kc-callback-")==0){var d=localStorage.getItem(a);if(d)try{var n=JSON.parse(d).expires;(!n||n<s)&&localStorage.removeItem(a)}catch{localStorage.removeItem(a)}}}}r.get=function(s){if(s){var i="kc-callback-"+s,a=localStorage.getItem(i);return a&&(localStorage.removeItem(i),a=JSON.parse(a)),t(),a}},r.add=function(s){t();var i="kc-callback-"+s.state;s.expires=new Date().getTime()+60*60*1e3,localStorage.setItem(i,JSON.stringify(s))}},G=function(){if(!(this instanceof G))return new G;var r=this;r.get=function(a){if(a){var d=s("kc-callback-"+a);if(i("kc-callback-"+a,"",t(-100)),d)return JSON.parse(d)}},r.add=function(a){i("kc-callback-"+a.state,JSON.stringify(a),t(60))},r.removeItem=function(a){i(a,"",t(-100))};var t=function(a){var d=new Date;return d.setTime(d.getTime()+a*60*1e3),d},s=function(a){for(var d=a+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){for(var c=n[o];c.charAt(0)==" ";)c=c.substring(1);if(c.indexOf(d)==0)return c.substring(d.length,c.length)}return""},i=function(a,d,n){var o=a+"="+d+"; expires="+n.toUTCString()+"; ";document.cookie=o}};function fe(){try{return new $}catch{}return new G}function te(r){return function(){e.enableLogging&&r.apply(console,Array.prototype.slice.call(arguments))}}}return M})}(Q)),Q.exports}var ke=ge();const we=ve(ke);let ae=!1;const ie=Symbol("keycloak"),Le={async install(m,f={}){if(ae)return;ae=!0;const k={config:window.__BASEURL__?`${window.__BASEURL__}/config`:"/config",init:{onLoad:"login-required"}},u=Object.assign({},k,f);if(se(u).hasError)throw new Error(`Invalid options given: ${se(u).error}`);const g=await be(m,ye());Se(u.config).then(U=>{Ue(U,g,u)}).catch(U=>{console.log(U)})},KeycloakSymbol:ie};function ye(){return{ready:!1,authenticated:!1,userName:void 0,fullName:void 0,token:void 0,tokenParsed:void 0,logoutFn:void 0,loginFn:void 0,login:void 0,createLoginUrl:void 0,createLogoutUrl:void 0,createRegisterUrl:void 0,register:void 0,accountManagement:void 0,createAccountUrl:void 0,loadUserProfile:void 0,subject:void 0,idToken:void 0,idTokenParsed:void 0,realmAccess:void 0,resourceAccess:void 0,refreshToken:void 0,refreshTokenParsed:void 0,timeSkew:void 0,responseMode:void 0,responseType:void 0,hasRealmRole:void 0,hasResourceRole:void 0,keycloak:void 0}}function be(m,f){return new Promise((k,u)=>{if(m.prototype)try{const g=m.observable(f);Object.defineProperty(m.prototype,"$keycloak",{get(){return g}}),k(g)}catch(g){u(g)}else{const g=he(f);m.config.globalProperties.$keycloak=g,m.provide(ie,g),k(g)}})}function Ue(m,f,k){const u=we(m);u.onReady=function(U){g(U),f.ready=!0,typeof k.onReady=="function"&&k.onReady(u,f)},u.onAuthSuccess=function(){g(!0),f.ready=!0;const U=setInterval(()=>u.updateToken(60).catch(()=>{u.clearToken()}),1e4);f.logoutFn=()=>{clearInterval(U),u.logout(k.logout)}},u.onAuthRefreshSuccess=function(){g(!0),typeof k.onAuthRefreshSuccess=="function"&&k.onAuthRefreshSuccess(u)},u.onAuthRefreshError=function(){g(!1),typeof k.onAuthRefreshError=="function"&&k.onAuthRefreshError(u)},g(!1),k.init!==void 0&&u.init(k.init).then(U=>{g(U),typeof k.onInitSuccess=="function"&&k.onInitSuccess(U)}).catch(U=>{g(!1);const M=new Error("Failure during initialization of keycloak-js adapter");typeof k.onInitError=="function"?k.onInitError(M,U):console.error(M,U)});function g(U=!1){f.authenticated=U,f.loginFn=u.login,f.login=u.login,f.createLoginUrl=u.createLoginUrl,f.createLogoutUrl=u.createLogoutUrl,f.createRegisterUrl=u.createRegisterUrl,f.register=u.register,f.keycloak=u,U&&(f.accountManagement=u.accountManagement,f.createAccountUrl=u.createAccountUrl,f.hasRealmRole=u.hasRealmRole,f.hasResourceRole=u.hasResourceRole,f.loadUserProfile=u.loadUserProfile,f.token=u.token,f.subject=u.subject,f.idToken=u.idToken,f.idTokenParsed=u.idTokenParsed,f.realmAccess=u.realmAccess,f.resourceAccess=u.resourceAccess,f.refreshToken=u.refreshToken,f.refreshTokenParsed=u.refreshTokenParsed,f.timeSkew=u.timeSkew,f.responseMode=u.responseMode,f.responseType=u.responseType,f.tokenParsed=u.tokenParsed,f.userName=u.tokenParsed.preferred_username,f.fullName=u.tokenParsed.name)}}function se(m){const{config:f,init:k,onReady:u,onInitError:g,onAuthRefreshError:U}=m;return typeof f!="string"&&!W(f)?{hasError:!0,error:`'config' option must be a string or an object. Found: '${f}'`}:!W(k)||typeof(k==null?void 0:k.onLoad)!="string"?{hasError:!0,error:`'init' option must be an object with an 'onLoad' property. Found: '${k}'`}:u&&typeof u!="function"?{hasError:!0,error:`'onReady' option must be a function. Found: '${u}'`}:g&&typeof g!="function"?{hasError:!0,error:`'onInitError' option must be a function. Found: '${g}'`}:U&&typeof U!="function"?{hasError:!0,error:`'onAuthRefreshError' option must be a function. Found: '${U}'`}:{hasError:!1,error:null}}function W(m){return m!==null&&typeof m=="object"&&Object.prototype.toString.call(m)!=="[object Array]"}function Se(m){return W(m)?Promise.resolve(m):new Promise((f,k)=>{const u=new XMLHttpRequest;u.open("GET",m),u.setRequestHeader("Accept","application/json"),u.onreadystatechange=()=>{u.readyState===4&&(u.status===200?f(JSON.parse(u.responseText)):k(new Error(u.statusText)))},u.send()})}export{Le as default};
