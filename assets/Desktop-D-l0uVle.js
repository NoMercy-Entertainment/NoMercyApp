import{Y as P,a8 as ee,C as te,j as L,c as B,o as p,l as c,h as _,b as F,i as e,v as l,Z as d,H as U,y as r,be as le,B as ae,aX as se,d as k,aR as oe,w as j,f as J,p as N,F as T,am as ne,ar as re,an as ie}from"./vue-ionic-Cv2or74p.js";import{u as A}from"./useServerClient-XE0oeQns.js";import{br as R,c0 as W,bo as D,bK as ue,a as ce}from"./index-BpZ_oSDG.js";import{_ as de,c as pe}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-DUIfKN5a.js";import{u as me}from"./RipperOverlay.vue_vue_type_script_setup_true_lang-DFqR553r.js";import{_ as I}from"./DropdownMenu.vue_vue_type_script_setup_true_lang-CMHEuco6.js";import{_ as O}from"./OptimizedIcon.vue_vue_type_script_setup_true_lang-Bi-0Ik3i.js";import{_ as fe}from"./Modal.vue_vue_type_script_setup_true_lang-BFuGhVNW.js";import{_ as ve}from"./ScrollContainer.vue_vue_type_script_setup_true_lang-D11xLr5F.js";import"./vendor-F08gofix.js";import"./icons-BW5E66pf.js";import"./rxjs-BCp2L9Rn.js";import"./media-C2AqgyMX.js";import"./api-BBofn2cc.js";import"./swiper-DhG1br88.js";import"./useInfiniteServerClient-CLpgdiih.js";import"./music-player-Dgg5bFLw.js";import"./useMounted-CS-UU_bv.js";import"./FloatingBackButton.vue_vue_type_script_setup_true_lang-BTZwEFHx.js";import"./Button.vue_vue_type_script_setup_true_lang-R7-60zhu.js";import"./Button.vue_vue_type_script_setup_true_lang-BDrzJc8T.js";const xe={key:0,class:"my-6 w-full text-sm text-white"},he={class:"flex h-min w-full flex-1 flex-col justify-center overflow-auto"},ye={class:"relative flex flex-grow items-center justify-start gap-2 whitespace-nowrap px-3 text-xs line-clamp-1 w-available"},ge={class:"relative flex flex-grow items-center justify-start gap-2 whitespace-nowrap px-3 text-xs line-clamp-1 w-available"},we={class:"relative flex flex-grow items-center justify-start gap-2 whitespace-nowrap px-3 text-xs line-clamp-1 w-available"},_e={class:"relative flex flex-grow flex-col items-start justify-start gap-4 overflow-clip px-3 text-xs line-clamp-1 w-available max-h-[60vh] whitespace-break-spaces"},be=P({__name:"LogModal",props:{open:{type:Boolean,required:!0},close:{type:Function,required:!0},id:{type:String,required:!0},name:{type:String,required:!0},data:{type:Object,required:!0}},setup(f){const v=f,{t:a}=ee(),o=te(()=>{if(v.data)try{return JSON.parse(R(v.data.message))}catch{return v.data.message}});return(x,g)=>{const i=L("Button");return p(),B(fe,{close:f.close,open:!0,maxWidth:"max-w-7xl max-h-[80vh]",title:""},{actions:c(()=>[r(i,{id:"no",onClick:f.close,type:"button",color:"text-auto-alpha-11",variant:"text"},{default:c(()=>[ae(l(d(a)("Close")),1)]),_:1},8,["onClick"])]),default:c(()=>[f.data?(p(),_("div",xe,[e("div",he,[e("div",ye,[e("span",null,l(x.$t("Time"))+":",1),e("span",null,l(d(W)(f.data.time)),1)]),e("div",ge,[e("span",null,l(x.$t("Type"))+":",1),e("span",{class:"h-5 w-20 rounded-full px-2 text-center leading-5",style:U(`background: ${f.data.color}`)},l(f.data.type),5)]),e("div",we,[e("span",null,l(x.$t("Level"))+":",1),e("span",null,l(f.data.level),1)]),e("div",_e,[e("span",null,l(x.$t("Message"))+":",1),r(ve,{static:!1},{default:c(()=>[r(d(le),{class:"h-fit",data:o.value},null,8,["data"])]),_:1})])])])):F("",!0)]),_:1},8,["close"])}}}),ke={class:"flex flex-col gap-2 overflow-auto py-2 max-h-[60vh]"},$e={class:"-mb-2 flex flex-grow items-center justify-start gap-3 rounded-md px-2.5"},je={class:"text-center text-xs font-semibold uppercase"},Ce=["onClick"],Te={class:"text-center text-xs font-semibold uppercase"},Ve=["onclick"],Le=P({__name:"LogTypeSelector",props:se({refetch:{type:Function,required:!0},logTypes:{type:Array,required:!0}},{selectedTypes:{type:Array,required:!1,default:()=>[]},selectedTypesModifiers:{}}),emits:["update:selectedTypes"],setup(f){const v=k(!1),a=oe(f,"selectedTypes"),o=f;j(v,i=>{o.logTypes&&console.log("checkboxState",i)}),j(o,()=>{a.value&&(v.value=D(a.value,o.logTypes),o.refetch())}),J(()=>{o.logTypes});const x=i=>{a.value.some(u=>u.name==i.name)?a.value=a.value.filter(u=>u.name!=i.name):a.value=[...a.value,i]},g=i=>{if(!o.logTypes)return;const u=o.logTypes.filter(h=>h.type===i.type);u.every(h=>a.value.some(y=>y.name===h.name))?a.value=a.value.filter(h=>!u.some(y=>y.name===h.name)):a.value=[...a.value,...u]};return(i,u)=>{const h=L("Checkbox");return p(),B(I,{class:"relative flex items-center justify-center gap-2 rounded-lg transition-colors duration-200 hover:bg-auto-5/6"},{button:c(()=>[r(O,{className:"w-6",icon:"chevronDown"})]),default:c(()=>{var y;return[e("div",ke,[e("div",$e,[r(h,{modelValue:v.value,"onUpdate:modelValue":u[0]||(u[0]=n=>v.value=n),label:"All"},null,8,["modelValue"]),e("p",je,l(i.$t("All")),1)]),(p(!0),_(T,null,N(d(ue)(((y=f.logTypes)==null?void 0:y.filter(n=>n.type!="spacer"))??[],"type"),n=>{var $,M,b;return p(),_(T,{key:n[0].type},[e("div",{class:"relative mt-2 -mb-1 flex items-center justify-start gap-2 self-stretch px-2.5",onClick:()=>g(n[0])},[r(h,{modelValue:d(D)(($=a.value)==null?void 0:$.filter(m=>m.type==n[0].type),n),color:d(D)((M=a.value)==null?void 0:M.filter(m=>m.type==n[0].type),n)==!0?((b=n[0])==null?void 0:b.color)+"44":""},null,8,["modelValue","color"]),e("p",Te,l(n[0].type),1),u[1]||(u[1]=e("div",{class:"flex-grow h-px bg-[#e2f0fd]/[0.08]"},null,-1))],8,Ce),(p(!0),_(T,null,N(n,m=>{var S,q;return p(),_("button",{key:m.name,class:"flex flex-grow items-center justify-start gap-3 rounded-md px-2.5",onclick:()=>x(m)},[r(h,{modelValue:(S=a.value)==null?void 0:S.some(V=>V.name==m.name),color:(q=a.value)!=null&&q.some(V=>V.name==m.name)?m.color+"44":""},null,8,["modelValue","color"]),e("span",{style:U(`background: ${m.color}44`),class:"flex-grow text-sm font-medium text-[#eeecec] rounded-full px-2 w-32 h-5 leading-5 text-center"},l(m.display_name),5)],8,Ve)}),128))],64)}),128))])]}),_:1})}}}),Be={class:"mx-2 flex flex-col overflow-auto rounded-lg outline outline-1 min-w-available min-h-available divide-y divide-auto-12/8 h-inherit outline-auto-alpha-5 max-h-[78vh] min-h-[78vh]"},Ne={class:"flex flex-grow-0 items-start justify-start self-stretch rounded-tl-lg rounded-tr-lg w-available"},Se={class:"flex w-full flex-1 gap-4 text-xs font-medium bg-auto-2/10"},qe={class:"relative flex h-11 items-center justify-between gap-3 self-stretch p-3 group/tableButton w-[150px] min-w-[150px]"},Me={class:"flex w-full flex-col items-start justify-between py-2 bg-auto-1"},Ae=["onClick"],De={class:"relative flex h-11 items-center justify-between gap-3 self-stretch p-3 group/tableButton w-[120px] min-w-[120px]"},Fe={class:"relative flex h-11 items-center justify-between gap-3 self-stretch p-3 group/tableButton w-[120px] min-w-[120px]"},Ie={class:"flex w-full flex-col items-start justify-between py-2 bg-auto-1"},Oe=["onClick"],Pe={class:"relative flex h-11 items-center justify-between gap-3 self-stretch p-3 group/tableButton w-available"},Ue={class:"relative flex h-11 w-20 items-center justify-between gap-3 self-stretch p-3 group/tableButton min-w-20"},ze={class:"overflow-auto divide-y divide-auto-12/5 max-h-available flex-1"},He={class:"flex h-12 w-full flex-1 justify-center gap-4 odd:bg-white/[0.04]"},Ke={class:"relative flex flex-grow items-center justify-start whitespace-nowrap px-3 text-xs line-clamp-1 w-[150px] min-w-[150px]"},Ee={class:"relative flex flex-grow items-center justify-center whitespace-nowrap text-xs line-clamp-1 w-[120px] min-w-[120px]"},Ge={class:"relative flex flex-grow items-center justify-start whitespace-nowrap px-3 text-xs line-clamp-1 w-[120px] min-w-[120px]"},Je=["onClick"],vt=P({__name:"Desktop",setup(f){const v=k([]),a=k([]),o=k([]),x=k(50),g=k([]),i=k(""),u=ne(i,500),{data:h,refetch:y}=A({path:"/dashboard/logs",queryKey:["logs"],refetchInterval:5*60*1e3,data:{limit:x,types:a,levels:o,filter:u}});j(h,t=>{t&&(g.value=t)});const{data:n}=A({path:"/dashboard/logs/types"}),{data:$}=A({path:"/dashboard/logs/levels"});j(x,()=>{y()}),j(u,()=>{y()}),j($,t=>{t&&(o.value=t)}),j(v,t=>{t&&(a.value=t.map(w=>w.name),y())}),me(pe,"NewLog",t=>{o.value.includes(t.level)&&(g.value=g.value.slice(0,g.value.length-1),g.value=[t,...g.value])}),J(()=>{!h.value||!$.value||!v.value||(g.value=h.value,o.value=$.value,y())});const b=k(null),m=k(!1),S=t=>{console.log(t),b.value=t,m.value=!0},q=t=>{t.stopPropagation(),b.value=null,m.value=!1},V=()=>{ce().delete("/dashboard/logs").catch(()=>{alert("you'd think this would actually do something huh ðŸ˜‹")}).then(()=>{g.value=[]})},X=t=>{o.value.some(w=>w==t)?o.value=o.value.filter(w=>w!=t):o.value.push(t),y()};return(t,w)=>{const z=L("Checkbox"),Y=L("InputText"),Z=L("Button");return p(),B(d(ie),null,{default:c(()=>[r(d(re),{fullscreen:!0},{default:c(()=>[r(de,{gridStyle:4,description:"",title:"Logs"},{cta:c(()=>w[2]||(w[2]=[])),default:c(()=>{var H,K,E;return[e("table",Be,[e("thead",Ne,[e("tr",Se,[e("th",qe,[e("span",null,l(t.$t("Limit"))+" ("+l(x.value)+")",1),r(I,{class:"relative flex items-center justify-center gap-2 rounded-lg transition-colors duration-200 hover:bg-auto-5/6",translate:"translate-x-1/4"},{button:c(()=>[r(O,{className:"w-6",icon:"chevronDown"})]),default:c(()=>[e("div",Me,[(p(),_(T,null,N([5,10,20,50,100,500,1e3,2e3],s=>e("button",{class:"flex flex-grow items-center justify-start gap-3 rounded-md px-2.5",onClick:C=>x.value=s},[r(z,{modelValue:x.value==s,label:s},null,8,["modelValue","label"]),e("span",null,l(s),1)],8,Ae)),64))])]),_:1})]),e("th",De,[e("span",null,l(t.$t("Type")),1),d(n)?(p(),B(Le,{key:0,logTypes:d(n),selectedTypes:v.value,"onUpdate:selectedTypes":w[0]||(w[0]=s=>v.value=s),refetch:d(y)},null,8,["logTypes","selectedTypes","refetch"])):F("",!0)]),e("th",Fe,[e("span",null,l(t.$t("Level")),1),r(I,{class:"relative flex items-center justify-center gap-2 rounded-lg transition-colors duration-200 hover:bg-auto-5/6"},{button:c(()=>[r(O,{className:"w-6",icon:"chevronDown"})]),default:c(()=>[e("div",Ie,[(p(!0),_(T,null,N(d($),s=>{var C;return p(),_("button",{class:"flex flex-grow items-center justify-start gap-3 rounded-md px-2.5",onClick:()=>X(s)},[r(z,{modelValue:(C=o.value)==null?void 0:C.includes(s),label:s},null,8,["modelValue","label"]),e("span",null,l(s),1)],8,Oe)}),256))])]),_:1})]),e("th",Pe,[e("span",null,l(t.$t("Message")),1),r(Y,{id:"filter",modelValue:i.value,"onUpdate:modelValue":w[1]||(w[1]=s=>i.value=s),variant:"filled",size:"small",class:"mr-auto ml-4 min-w-40",name:"",placeholder:"Filter..."},null,8,["modelValue"])]),e("th",Ue,[r(Z,{id:"clear",className:"!py-1 !h-8",color:"theme",title:"Clear logs",variant:"text",onClick:V},{default:c(()=>[e("span",null,l(t.$t("clear")),1)]),_:1})])])]),e("tbody",ze,[(p(!0),_(T,null,N(g.value??[],s=>{var C,G;return p(),_("tr",He,[e("td",Ke,l(d(W)(s.time)),1),e("td",Ee,[e("div",{style:U(`background: ${s.color}55`),class:"h-5 w-min rounded-full px-2 text-center leading-5"},l((G=(C=d(n))==null?void 0:C.find(Q=>Q.name==s.type))==null?void 0:G.display_name),5)]),e("td",Ge,l(s.level),1),e("td",{class:"relative flex flex-grow cursor-pointer items-center justify-start whitespace-nowrap px-3 text-xs line-clamp-1 w-available",onClick:()=>S(s)},l(d(R)(s.message)),9,Je)])}),256))])]),(H=b.value)!=null&&H.level?(p(),B(be,{key:0,id:(K=b.value)==null?void 0:K.level,close:q,data:b.value,name:(E=b.value)==null?void 0:E.level,open:!0},null,8,["id","data","name"])):F("",!0)]}),_:1})]),_:1})]),_:1})}}});export{vt as default};
