import{d as u,f as q,aC as K,Y as Q,C as ee,h as k,o as I,i as e,b as te,v as n,t as B,F as $,p as W,c as se,l as E,y as N,Z as O,aG as oe,az as ae,aV as ie,B as ne,ar as re,an as le}from"./vue-ionic-Cv2or74p.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{be as G,bf as ce}from"./index-BpZ_oSDG.js";import"./vendor-F08gofix.js";import"./icons-BW5E66pf.js";import"./rxjs-BCp2L9Rn.js";import"./media-C2AqgyMX.js";import"./api-BBofn2cc.js";import"./swiper-DhG1br88.js";import"./music-player-Dgg5bFLw.js";function de(){const a=u({}),h=u(!0),C=()=>{const o=performance.getEntriesByType("navigation")[0];o&&(a.value.loadTime=o.loadEventEnd-o.navigationStart,a.value.domContentLoaded=o.domContentLoadedEventEnd-o.navigationStart)},y=()=>{const r=performance.getEntriesByType("paint").find(l=>l.name==="first-contentful-paint");r&&(a.value.firstContentfulPaint=r.startTime)},b=()=>{if("PerformanceObserver"in window){const o=new PerformanceObserver(r=>{const l=r.getEntries(),_=l[l.length-1];a.value.largestContentfulPaint=_.startTime});try{o.observe({entryTypes:["largest-contentful-paint"]})}catch{}}},f=()=>{if("PerformanceObserver"in window){let o=0;const r=new PerformanceObserver(l=>{for(const _ of l.getEntries())_.hadRecentInput||(o+=_.value);a.value.cumulativeLayoutShift=o});try{r.observe({entryTypes:["layout-shift"]})}catch{}}},i=()=>{if("PerformanceObserver"in window){const o=new PerformanceObserver(r=>{for(const l of r.getEntries())a.value.firstInputDelay=l.processingStart-l.startTime});try{o.observe({entryTypes:["first-input"]})}catch{}}},L=()=>{if("memory"in performance){const o=performance.memory;a.value.memoryUsage=o.usedJSHeapSize/1024/1024}},m=async()=>{try{const o=performance.getEntriesByType("resource");let r=0;for(const l of o)(l.name.includes(".js")||l.name.includes(".css"))&&(r+=l.transferSize||0);a.value.bundleSize=r/1024/1024}catch(o){console.warn("Could not measure bundle size:",o)}},S=()=>{},v=()=>{C(),y(),b(),f(),i(),L(),m(),setTimeout(()=>{h.value=!1},3e3)},w=()=>{const o={performance:100,recommendations:[]};return a.value.largestContentfulPaint&&(a.value.largestContentfulPaint>4e3?(o.performance-=30,o.recommendations.push("Improve Largest Contentful Paint (>4s)")):a.value.largestContentfulPaint>2500&&(o.performance-=15,o.recommendations.push("Optimize Largest Contentful Paint (2.5-4s)"))),a.value.firstContentfulPaint&&(a.value.firstContentfulPaint>3e3?(o.performance-=20,o.recommendations.push("Improve First Contentful Paint (>3s)")):a.value.firstContentfulPaint>1800&&(o.performance-=10,o.recommendations.push("Optimize First Contentful Paint (1.8-3s)"))),a.value.cumulativeLayoutShift&&(a.value.cumulativeLayoutShift>.25?(o.performance-=25,o.recommendations.push("Fix Cumulative Layout Shift (>0.25)")):a.value.cumulativeLayoutShift>.1&&(o.performance-=10,o.recommendations.push("Improve Cumulative Layout Shift (0.1-0.25)"))),a.value.firstInputDelay&&(a.value.firstInputDelay>300?(o.performance-=20,o.recommendations.push("Improve First Input Delay (>300ms)")):a.value.firstInputDelay>100&&(o.performance-=10,o.recommendations.push("Optimize First Input Delay (100-300ms)"))),a.value.bundleSize&&a.value.bundleSize>2&&(o.performance-=15,o.recommendations.push("Reduce bundle size (>2MB)")),o};q(()=>{typeof window<"u"&&(document.readyState==="complete"?v():window.addEventListener("load",v))}),K(()=>{typeof window<"u"&&window.removeEventListener("load",v)});const F=async()=>({lcp:a.value.largestContentfulPaint??null,fid:a.value.firstInputDelay??null,cls:a.value.cumulativeLayoutShift??null}),R=async()=>({ttfb:performance.timing?performance.timing.responseStart-performance.timing.navigationStart:null,fcp:a.value.firstContentfulPaint??null,tti:a.value.loadTime??null}),p=async()=>{const o=performance.getEntriesByType("resource");let r=0,l=o.length,_=0;const x={};return o.forEach(z=>{var H;r+=z.transferSize||0,z.transferSize===0&&z.decodedBodySize>0&&_++;const J=((H=z.name.split(".").pop())==null?void 0:H.toLowerCase())||"other",g=P(J);x[g]||(x[g]={count:0,size:0,loadTime:0}),x[g].count++,x[g].size+=z.transferSize||0,x[g].loadTime+=z.duration}),{totalResources:l,totalSize:r,cacheHitRate:l>0?Math.round(_/l*100):0,byType:x}},P=o=>({js:"JavaScript",css:"CSS",png:"Images",jpg:"Images",jpeg:"Images",gif:"Images",svg:"Images",webp:"Images",woff:"Fonts",woff2:"Fonts",ttf:"Fonts",eot:"Fonts",json:"Data",xml:"Data"})[o]||"Other";return{metrics:a,isLoading:h,getScores:w,logMetrics:S,getWebVitals:F,getLoadingMetrics:R,getResourceMetrics:p,clearMetrics:()=>{a.value={},"PerformanceObserver"in window&&v()}}}const ue={class:"performance-dashboard"},me={class:"dashboard-header"},ve={class:"header-controls"},fe=["disabled"],pe={class:"metric-section"},ge={class:"metric-grid"},he={class:"metric-value"},ye={class:"metric-value"},be={class:"metric-value"},Se={class:"metric-section"},we={class:"metric-grid"},_e={class:"metric-card"},Ce={class:"metric-value"},xe={class:"metric-card"},ze={class:"metric-value"},Te={class:"metric-card"},Pe={class:"metric-value"},Me={class:"metric-section"},Ie={class:"resource-metrics"},Re={class:"resource-summary"},ke={class:"summary-item"},Le={class:"value"},Fe={class:"summary-item"},He={class:"value"},De={class:"summary-item"},Be={class:"value"},Ee={class:"resource-breakdown"},Ne={class:"breakdown-grid"},Oe={class:"resource-type"},Ve={class:"resource-count"},Je={class:"resource-size"},je={class:"resource-time"},Ue={class:"metric-section"},Ae={class:"memory-metrics"},$e={class:"memory-chart"},We={class:"memory-stats"},Ge={class:"stat-item"},qe={class:"value"},Ke={class:"stat-item"},Qe={class:"value"},Ye={class:"stat-item"},Ze={class:"value"},Xe={class:"stat-item"},et={class:"value"},tt={class:"metric-section"},st={class:"timeline-container"},ot={key:0,class:"metric-section"},at={class:"recommendations"},it={class:"recommendation-title"},nt={class:"recommendation-description"},rt={class:"recommendation-impact"},lt={class:"metric-section"},ct={class:"realtime-metrics"},dt={class:"realtime-item"},ut={class:"realtime-item"},mt={class:"value"},vt={class:"realtime-item"},ft={class:"value"},pt=Q({__name:"PerformanceDashboard",setup(a){const h=de(),C=u(!1),y=u(),b=u(),f=u(60),i=u(16.67),L=u(0),m=u({lcp:null,fid:null,cls:null}),S=u({ttfb:null,fcp:null,tti:null}),v=u({totalResources:0,totalSize:0,cacheHitRate:0,byType:{}}),w=u({usedJSHeapSize:0,totalJSHeapSize:0,jsHeapSizeLimit:0}),F=u([]),R=ee(()=>w.value.jsHeapSizeLimit===0?0:Math.round(w.value.usedJSHeapSize/w.value.jsHeapSizeLimit*100)),p=s=>s==null?"N/A":s<1e3?`${Math.round(s)}ms`:`${(s/1e3).toFixed(2)}s`,P=s=>{if(s===0)return"0 B";const t=1024,d=["B","KB","MB","GB"],c=Math.floor(Math.log(s)/Math.log(t));return`${(s/Math.pow(t,c)).toFixed(1)} ${d[c]}`},V=(s,t,d)=>s===null?"unknown":s<=t?"good":s<=d?"needs-improvement":"poor",o=s=>s>=55?"good":s>=30?"needs-improvement":"poor",r=async()=>{C.value=!0;try{if(m.value=await h.getWebVitals(),S.value=await h.getLoadingMetrics(),v.value=await h.getResourceMetrics(),"memory"in performance){const s=performance.memory;w.value={usedJSHeapSize:s.usedJSHeapSize,totalJSHeapSize:s.totalJSHeapSize,jsHeapSizeLimit:s.jsHeapSizeLimit}}_(),x(),z()}catch(s){console.error("Failed to refresh metrics:",s)}finally{C.value=!1}},l=()=>{h.clearMetrics(),r()},_=()=>{const s=[];m.value.lcp&&m.value.lcp>2500&&s.push({title:"Improve Largest Contentful Paint",description:"Optimize images, reduce server response times, and eliminate render-blocking resources",impact:"High",priority:"high"}),R.value>80&&s.push({title:"Reduce Memory Usage",description:"Consider implementing virtual scrolling and cleaning up unused resources",impact:"Medium",priority:"medium"}),v.value.totalSize>5*1024*1024&&s.push({title:"Reduce Bundle Size",description:"Implement code splitting and remove unused dependencies",impact:"High",priority:"high"}),v.value.cacheHitRate<70&&s.push({title:"Improve Cache Strategy",description:"Optimize service worker caching and implement better cache headers",impact:"Medium",priority:"medium"}),F.value=s},x=()=>{if(!y.value)return;const s=y.value.getContext("2d");if(!s)return;const t=y.value.width,d=y.value.height;s.clearRect(0,0,t,d);const c=R.value/100,T=t*c;s.fillStyle="#e5e7eb",s.fillRect(0,0,t,d),s.fillStyle=c>.8?"#ef4444":c>.6?"#f59e0b":"#10b981",s.fillRect(0,0,T,d),s.strokeStyle="#374151",s.lineWidth=2,s.strokeRect(0,0,t,d),s.fillStyle="#374151",s.font="14px Arial",s.textAlign="center",s.fillText(`${R.value}%`,t/2,d/2+5)},z=()=>{if(!b.value)return;const s=b.value.getContext("2d");if(!s)return;const t=b.value.width,d=b.value.height;s.clearRect(0,0,t,d);const c=[{name:"TTFB",value:S.value.ttfb,color:"#3b82f6"},{name:"FCP",value:S.value.fcp,color:"#10b981"},{name:"LCP",value:m.value.lcp,color:"#f59e0b"},{name:"TTI",value:S.value.tti,color:"#8b5cf6"}],T=Math.max(...c.map(M=>M.value||0)),D=t/c.length;c.forEach((M,Z)=>{if(M.value){const U=M.value/T*(d-40),j=Z*D+D*.1,A=d-U-20;s.fillStyle=M.color,s.fillRect(j,A,D*.8,U);const X=document.documentElement.classList.contains("scheme-dark");s.fillStyle=X?"#a1a1aa":"#374151",s.font="12px Arial",s.textAlign="center",s.fillText(M.name,j+D*.4,d-5),s.fillText(p(M.value),j+D*.4,A-5)}})};let J=performance.now(),g=0;const H=()=>{g++;const s=performance.now(),t=s-J;t>=1e3&&(f.value=Math.round(g*1e3/t),i.value=Math.round(t/g*100)/100,g=0,J=s),requestAnimationFrame(H)};return q(()=>{r(),H();const s=setInterval(r,1e4);K(()=>{clearInterval(s)})}),(s,t)=>{var d;return I(),k("div",ue,[e("div",me,[t[0]||(t[0]=e("h2",null,"Performance Dashboard",-1)),e("div",ve,[e("button",{onClick:r,disabled:C.value,class:"refresh-btn"},n(C.value?"Refreshing...":"Refresh"),9,fe),e("button",{onClick:l,class:"clear-btn"},"Clear Data")])]),e("div",pe,[t[7]||(t[7]=e("h3",null,"Core Web Vitals",-1)),e("div",ge,[e("div",{class:B(["metric-card",V(m.value.lcp,2500,4e3)])},[t[1]||(t[1]=e("div",{class:"metric-title"},"Largest Contentful Paint",-1)),e("div",he,n(p(m.value.lcp)),1),t[2]||(t[2]=e("div",{class:"metric-description"},"Good: <2.5s, Needs Improvement: 2.5s-4s",-1))],2),e("div",{class:B(["metric-card",V(m.value.fid,100,300)])},[t[3]||(t[3]=e("div",{class:"metric-title"},"First Input Delay",-1)),e("div",ye,n(p(m.value.fid)),1),t[4]||(t[4]=e("div",{class:"metric-description"},"Good: <100ms, Needs Improvement: 100ms-300ms",-1))],2),e("div",{class:B(["metric-card",V(m.value.cls,.1,.25)])},[t[5]||(t[5]=e("div",{class:"metric-title"},"Cumulative Layout Shift",-1)),e("div",be,n(((d=m.value.cls)==null?void 0:d.toFixed(3))||"N/A"),1),t[6]||(t[6]=e("div",{class:"metric-description"},"Good: <0.1, Needs Improvement: 0.1-0.25",-1))],2)])]),e("div",Se,[t[14]||(t[14]=e("h3",null,"Loading Performance",-1)),e("div",we,[e("div",_e,[t[8]||(t[8]=e("div",{class:"metric-title"},"Time to First Byte",-1)),e("div",Ce,n(p(S.value.ttfb)),1),t[9]||(t[9]=e("div",{class:"metric-description"},"Server response time",-1))]),e("div",xe,[t[10]||(t[10]=e("div",{class:"metric-title"},"First Contentful Paint",-1)),e("div",ze,n(p(S.value.fcp)),1),t[11]||(t[11]=e("div",{class:"metric-description"},"First content rendered",-1))]),e("div",Te,[t[12]||(t[12]=e("div",{class:"metric-title"},"Time to Interactive",-1)),e("div",Pe,n(p(S.value.tti)),1),t[13]||(t[13]=e("div",{class:"metric-description"},"Page becomes interactive",-1))])])]),e("div",Me,[t[19]||(t[19]=e("h3",null,"Resource Performance",-1)),e("div",Ie,[e("div",Re,[e("div",ke,[t[15]||(t[15]=e("span",{class:"label"},"Total Resources:",-1)),e("span",Le,n(v.value.totalResources),1)]),e("div",Fe,[t[16]||(t[16]=e("span",{class:"label"},"Total Size:",-1)),e("span",He,n(P(v.value.totalSize)),1)]),e("div",De,[t[17]||(t[17]=e("span",{class:"label"},"Cache Hit Rate:",-1)),e("span",Be,n(v.value.cacheHitRate)+"%",1)])]),e("div",Ee,[t[18]||(t[18]=e("h4",null,"Resource Breakdown",-1)),e("div",Ne,[(I(!0),k($,null,W(v.value.byType,(c,T)=>(I(),k("div",{key:T,class:"breakdown-item"},[e("div",Oe,n(T),1),e("div",Ve,n(c.count)+" files",1),e("div",Je,n(P(c.size)),1),e("div",je,n(p(c.loadTime)),1)]))),128))])])])]),e("div",Ue,[t[24]||(t[24]=e("h3",null,"Memory Usage",-1)),e("div",Ae,[e("div",$e,[e("canvas",{ref_key:"memoryChart",ref:y,width:"400",height:"200"},null,512)]),e("div",We,[e("div",Ge,[t[20]||(t[20]=e("span",{class:"label"},"Used JS Heap:",-1)),e("span",qe,n(P(w.value.usedJSHeapSize)),1)]),e("div",Ke,[t[21]||(t[21]=e("span",{class:"label"},"Total JS Heap:",-1)),e("span",Qe,n(P(w.value.totalJSHeapSize)),1)]),e("div",Ye,[t[22]||(t[22]=e("span",{class:"label"},"Heap Limit:",-1)),e("span",Ze,n(P(w.value.jsHeapSizeLimit)),1)]),e("div",Xe,[t[23]||(t[23]=e("span",{class:"label"},"Memory Usage:",-1)),e("span",et,n(R.value)+"%",1)])])])]),e("div",tt,[t[25]||(t[25]=e("h3",null,"Performance Timeline",-1)),e("div",st,[e("canvas",{ref_key:"timelineChart",ref:b,width:"800",height:"300"},null,512)])]),F.value.length>0?(I(),k("div",ot,[t[26]||(t[26]=e("h3",null,"Performance Recommendations",-1)),e("div",at,[(I(!0),k($,null,W(F.value,(c,T)=>(I(),k("div",{key:T,class:B(["recommendation-item",c.priority])},[e("div",it,n(c.title),1),e("div",nt,n(c.description),1),e("div",rt,"Impact: "+n(c.impact),1)],2))),128))])])):te("",!0),e("div",lt,[t[30]||(t[30]=e("h3",null,"Real-time Performance",-1)),e("div",ct,[e("div",dt,[t[27]||(t[27]=e("span",{class:"label"},"FPS:",-1)),e("span",{class:B(["value",o(f.value)])},n(f.value),3)]),e("div",ut,[t[28]||(t[28]=e("span",{class:"label"},"Frame Time:",-1)),e("span",mt,n(p(i.value)),1)]),e("div",vt,[t[29]||(t[29]=e("span",{class:"label"},"Active Requests:",-1)),e("span",ft,n(L.value),1)])])])])}}}),gt=Y(pt,[["__scopeId","data-v-91a5d3f3"]]),ht={class:"max-w-7xl mx-auto"},yt=Q({__name:"Dashboard",setup(a){const h=()=>{window.location.reload()},C=()=>{window.caches&&window.caches.keys().then(f=>{f.forEach(i=>{window.caches.delete(i)})}),localStorage.clear(),sessionStorage.clear(),location.reload(),window.location.reload()},y=()=>{window.open(window.location.origin+"?no-cache=1","_blank")},b=()=>{const f=localStorage.getItem("language")||navigator.language.split("-")[0]||"en",i=G[f]||G.en,L={id:`sw-update-test-${Date.now()}`,type:"update",title:i.newVersion,body:i.updateNow,from:"system",read:!1,created_at:Date.now(),updated_at:Date.now(),notify:!0,link:"reload"};ce(L),console.log("Test update notification added")};return(f,i)=>(I(),se(O(le),null,{default:E(()=>[N(O(oe),null,{default:E(()=>[N(O(ae),null,{default:E(()=>[N(O(ie),null,{default:E(()=>i[0]||(i[0]=[ne("Performance Dashboard")])),_:1})]),_:1})]),_:1}),N(O(re),{class:"ion-padding"},{default:E(()=>[e("div",ht,[i[6]||(i[6]=e("div",{class:"mb-6"},[e("h1",{class:"text-2xl font-bold text-auto-12 mb-2"},"Development Performance Dashboard"),e("p",{class:"text-auto-10"},"Monitor app performance, bundle metrics, and optimization status in real-time.")],-1)),N(gt),e("div",{class:"mt-8 p-4 bg-auto-3 rounded-lg border border-auto-6"},[i[5]||(i[5]=e("h2",{class:"text-lg font-semibold text-auto-12 mb-3"},"Quick Actions",-1)),e("div",{class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},[e("button",{onClick:h,class:"p-3 bg-auto-4 hover:bg-auto-5 rounded-md border border-auto-6 text-left transition-colors"},i[1]||(i[1]=[e("div",{class:"font-medium text-auto-12"},"Reload Page",-1),e("div",{class:"text-sm text-auto-10"},"Test cold start performance",-1)])),e("button",{onClick:C,class:"p-3 bg-auto-4 hover:bg-auto-5 rounded-md border border-auto-6 text-left transition-colors"},i[2]||(i[2]=[e("div",{class:"font-medium text-auto-12"},"Clear Cache",-1),e("div",{class:"text-sm text-auto-10"},"Reset all cached data",-1)])),e("button",{onClick:y,class:"p-3 bg-auto-4 hover:bg-auto-5 rounded-md border border-auto-6 text-left transition-colors"},i[3]||(i[3]=[e("div",{class:"font-medium text-auto-12"},"Test No Cache",-1),e("div",{class:"text-sm text-auto-10"},"Simulate first visit",-1)])),e("button",{onClick:b,class:"p-3 bg-theme-5 hover:bg-theme-6 rounded-md border border-blue-400 text-left transition-colors text-white"},i[4]||(i[4]=[e("div",{class:"font-medium"},"Test Update Notification",-1),e("div",{class:"text-sm opacity-90"},"Manually trigger update UI",-1)]))])]),i[7]||(i[7]=e("div",{class:"mt-6 p-4 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg border border-yellow-200 dark:border-yellow-800"},[e("div",{class:"flex items-start"},[e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})])]),e("div",{class:"ml-3"},[e("h3",{class:"text-sm font-medium text-yellow-800 dark:text-yellow-200"}," Development Only "),e("div",{class:"mt-2 text-sm text-yellow-700 dark:text-yellow-300"},[e("p",null,"This dashboard is only available in development mode. It will not be accessible in production builds.")])])])],-1))])]),_:1})]),_:1}))}}),It=Y(yt,[["__scopeId","data-v-62345242"]]);export{It as default};
