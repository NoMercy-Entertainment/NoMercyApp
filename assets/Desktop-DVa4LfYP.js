import{$ as O,At as v,C as b,Dt as Z,Et as H,O as k,Q as ee,R as J,S as r,T as w,Y as f,Z as A,_t as _,c as S,g as T,j as q,k as m,kt as Y,lt as h,n as te,ot as U,st as F,w as K,x as N,xt as Q}from"./i18n-DXLa9EKW.js";import"./ionic-B9XaRwPa.js";import{x as re,y as ae}from"./vue-core-DBpBuPMK.js";import{w as E}from"./primevue-wrrgrfJj.js";import{c as V}from"./query-DJ5OsBey.js";import{Ei as le,Qi as B,Qn as se,Ri as oe,Si as $,b as M,k as G,v as ie,x as R,xn as ne,y as D,za as W}from"./index-CLM6Y7vI.js";import"./useInfiniteServerClient-DbihGahL.js";import{t as z}from"./useServerClient-QYfn39K-.js";import{t as ue}from"./AppLogo-Bsr8aNwq.js";import"./ScrollContainer-aZQSs5X2.js";import{t as de}from"./useSortable-BsdiAA6X.js";import{t as ce}from"./FolderBrowser-fnKbeHm3.js";S();var fe={class:"-mt-12 px-4"},ve={class:"text-xl font-bold"},pe={"aria-hidden":"true",class:"mt-4"},me={class:"overflow-hidden rounded-full bg-surface-11"},he=q({__name:"Stepper",props:{steps:{type:Array,required:!0},currentStep:{type:String,required:!0}},setup(a){const e=a,l=N(()=>e.steps?e.steps?.indexOf(e.currentStep):0),o=N(()=>e.steps?(l.value+1)/e.steps.length*100:0);return(i,s)=>(f(),w("div",fe,[r("h4",ve,v(i.$t(a.currentStep)),1),r("div",pe,[r("div",me,[r("div",{style:Y(`width: ${o.value}%`),class:"h-1 rounded-full bg-focus transition-all duration-300"},null,4)]),r("div",{style:Y(`grid-template-columns: repeat(${a.steps.length}, minmax(0, 1fr))`),class:"mt-6 hidden text-sm font-medium text-surface-12/12 sm:grid"},[(f(!0),w(T,null,A(a.steps,t=>(f(),w("div",{key:t,class:"text-center font-semibold"},v(i.$t(t)),1))),128))],4)])]))}}),ye=he;S();var _e={class:"mx-auto grid h-available place-content-center px-4 sm:px-6 lg:px-8 text-surface-12 z-10"},xe={class:"mx-auto w-screen max-w-6xl"},be={class:"flex h-full w-full flex-col gap-4 overflow-hidden p-8 pb-0 min-h-[80vh] max-h-[80vh] h-available"},ge={class:"mx-auto h-44 w-auto p-2"},ke={class:"overflow-hidden p-4 h-available"},we={class:"mt-auto flex h-16 w-full justify-end gap-4 rounded-b-lg p-4"},$e=q({__name:"Frame",props:{steps:{type:Array,required:!0},nextButtonLocked:{type:Boolean,default:!1},currentStep:{type:String,required:!0},setCurrentStep:{type:Function,required:!0},finish:{type:Function,required:!0}},setup(a){const e=a,l=N(()=>e.steps.findIndex(t=>t===e.currentStep)===0),o=N(()=>e.steps.findIndex(t=>t===e.currentStep)===e.steps.length-1);function i(){e.steps.findIndex(t=>t===e.currentStep)<e.steps.length-1&&e.setCurrentStep(e.steps[e.steps.findIndex(t=>t===e.currentStep)+1])}function s(){e.steps.findIndex(t=>t===e.currentStep)>0&&e.setCurrentStep(e.steps[e.steps.findIndex(t=>t===e.currentStep)-1])}return(t,p)=>(f(),w("div",_e,[r("div",xe,[r("div",{class:Z(["animate-loading","w-full h-full gap-2.5 flex flex-col ml-auto overflow-hidden rounded-xl bg-surface-1 dark:bg-surface-2 bg-cover border-2 border-transparent text-start transition-all duration-300"]),style:{"--bg-color":"linear-gradient(rgb(var(--surface-2)), rgb(var(--surface-2)))","--border-color":`linear-gradient(var(--angle, 45deg),
						rgb(var(--color-theme-8) / 0.7) 0%,
						rgb(var(--color-theme-8) / 0.3) 33.33%,
						rgb(var(--color-theme-8) / 0.14) 66.67%,
						rgb(var(--color-theme-8) / 0.1) 100%
					)`}},[r("div",be,[r("div",ge,[m(ue,{class:"pb-8"})]),m(ye,{"current-step":a.currentStep,steps:a.steps},null,8,["current-step","steps"]),r("div",ke,[ee(t.$slots,"default")])]),r("div",we,[l.value?K("",!0):(f(),b(D,{key:0,id:"yes",class:"ml-auto !w-28",color:"contrast",type:"button",variant:"text",onClick:s},{default:h(()=>[k(v(t.$t("Back")),1)]),_:1})),o.value?(f(),b(D,{key:1,id:"cancel",disabled:a.nextButtonLocked,class:"!w-28",color:"theme",type:"button",variant:"default",onClick:a.finish},{default:h(()=>[k(v(t.$t("Finish")),1)]),_:1},8,["disabled","onClick"])):(f(),b(D,{key:2,id:"save",disabled:a.nextButtonLocked,class:"!w-28",color:"theme",type:"button",variant:"default",onClick:i},{default:h(()=>[k(v(t.$t("Next")),1)]),_:1},8,["disabled"]))])])])]))}}),Se=$e;S();var qe={class:"flex flex-col justify-start items-center flex-grow gap-4"},Be={class:"flex justify-start items-start flex-grow-0 flex-shrink-0 relative gap-2 rounded-lg"},Ce={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-0.5"},Fe={class:"flex justify-start items-start self-stretch flex-grow-0 flex-shrink-0 relative gap-1.5"},je={class:"flex-grow w-full text-base font-medium text-center"},Le=q({__name:"TypeButton",props:{type:{type:Object,required:!0},selected:{type:Boolean,default:!1},className:{type:String,required:!1,default:""}},setup(a){const e=a,l=N(()=>{let o="nomercy";switch(e.type?.value){case"music":o="noteDouble";break;case"tv":o="tv";break;case"image":o="picture";break;case"movie":o="film";break;default:o="nomercy"}return o});return(o,i)=>(f(),w("div",{class:Z([{"bg-white/11 dark:bg-black/8 outline outline-2 outline-focus hover:bg-focus/[0.15]":a.selected,"hover:bg-focus/[0.15]":!a.selected},"flex justify-start items-start flex-grow gap-1 px-2 py-4 rounded-xl"])},[r("div",qe,[r("div",Be,[m(M,{"class-name":a.className,icon:l.value},null,8,["class-name","icon"])]),r("div",Ce,[r("div",Fe,[r("p",je,v(a.type.name),1)])])])],2))}}),Me=Le;S();var Ve={class:"my-6 text-sm text-surface-10"},De=q({__name:"DeleteFolderModal",props:{open:{type:Boolean,required:!0},close:{type:Function,required:!0},id:{type:String,required:!0},libraryId:{type:String,required:!0},name:{type:String,required:!0},noRedirect:{type:Boolean,default:!1}},setup(a){const e=a,l=V(),o=E();function i(){B().delete(`dashboard/libraries/${e.libraryId}/folders/${e.id}`).then(({data:s})=>{l.invalidateQueries({queryKey:["dashboard","libraries"]}),o.add({severity:s.status==="ok"?"success":"error",summary:$(s.status==="ok"?"Success":"Error"),detail:$(s.message,...s.args??[]),life:5e3}),e.close()}).catch(s=>{o.add({severity:"error",summary:$("Error"),detail:s.message,life:5e3}),e.close()})}return(s,t)=>{const p=O("Button");return f(),b(R,{close:a.close,open:a.open,params:{folder:a.name},"max-width":"max-w-xl",title:"Delete folder {{folder}}"},{actions:h(()=>[m(p,{id:"yes",onclick:i,color:"red","end-icon":"trash",type:"button",variant:"contained"},{default:h(()=>[k(v(s.$t("Delete")),1)]),_:1}),m(p,{id:"no",onclick:a.close,color:"auto",type:"button",variant:"text"},{default:h(()=>[k(v(s.$t("Cancel")),1)]),_:1},8,["onclick"])]),default:h(()=>[r("div",Ve,v(s.$t("Are you sure you want to delete this folder?")),1)]),_:1},8,["close","open","params"])}}}),Ne=De;S();var Ee={class:"flex justify-start items-center self-stretch flex-grow-0 flex-shrink-0 gap-2 text-surface-1"},Ie={class:"flex flex-col justify-center items-center flex-grow gap-2"},Qe={class:"flex justify-start items-center self-stretch flex-grow-0 flex-shrink-0 h-10 relative overflow-hidden gap-2 pl-3 pr-2.5 py-2.5 rounded-[10px] bg-surface-10/5 hover:bg-surface-12/5 active:bg-surface-12/5 text-surface-12/12 hover:text-surface-12"},Te={class:"flex-grow w-available text-base font-semibold text-left"},Ke=q({__name:"FolderItem",props:J({folder:{type:Object,required:!0}},{modelValue:{type:Object,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(a){const e=a,l=E(),o=V(),i=U(a,"modelValue"),{data:s}=z({path:"dashboard/encoderProfiles",queryKey:["dashboard","encoderProfiles"]}),t=N(()=>{switch(i.value.type){case"anime":return s.value?.filter(d=>d.container==="m3u8").map(d=>Q(d));case"movie":return s.value?.filter(d=>d.container==="m3u8").map(d=>Q(d));case"tv":return s.value?.filter(d=>d.container==="m3u8").map(d=>Q(d));case"music":return s.value?.filter(d=>d.container==="mp3"||d.container==="flac").map(d=>Q(d));default:return[]}}),p=_(t.value?.filter(d=>e.folder.folder?.encoder_profiles?.some(y=>y.id===d.id))??[]);F([t,e],([d,y])=>{!d||!y||(p.value=d.filter(j=>y.folder.folder?.encoder_profiles.some(c=>c.id===j.id)))},{deep:!0});function n(d){const y=d.map(j=>Q(j));p.value=y,u(Q(e.folder),y)}function u(d,y){if(!i.value)return;const j=i.value.folder_library.map(c=>c.folder_id===d.folder_id?{...c,folder:{...c.folder,encoder_profiles:y.map(g=>g)}}:c);B().patch(`dashboard/libraries/${i.value.id}`,{folder_library:j}).then(()=>{o.invalidateQueries({queryKey:["dashboard","libraries"]})}).catch(c=>{l.add({severity:"error",summary:$("Error"),detail:c.message,life:5e3})})}F(i,()=>{t.value&&(p.value=t.value.filter(d=>e.folder.folder?.encoder_profiles.some(y=>y.id===d.id)))});const x=_(!1);function C(){x.value=!0}function I(){x.value=!1}return(d,y)=>{const j=O("MultiSelect");return f(),w(T,null,[r("div",Ee,[m(j,{id:"encoderProfiles","model-value":p.value,options:t.value,class:"w-[160px]","option-label":"name",placeholder:"Select","onUpdate:modelValue":n},null,8,["model-value","options"]),r("div",Ie,[r("div",Qe,[r("p",Te,v(a.folder.folder.path),1),r("button",{class:"flex-grow-0 flex-shrink-0 cursor-pointer hover:text-surface-1",onClick:C},[m(M,{"class-name":"w-6 h-6",icon:"trash"})])])])]),m(Ne,{id:a.folder.folder.id,close:I,"library-id":i.value?.id,name:a.folder.folder.path,open:x.value},null,8,["id","library-id","name","open"])],64)}}}),Oe=Ke;S();ae();var Ae={class:"mx-auto flex w-full flex-col h-available"},Re=q({__name:"NewFolderModal",props:{open:{type:Boolean,required:!0},close:{type:Function,required:!0},folder:{type:String,required:!0},setFolder:{type:Function,required:!0},library:{type:Object,required:!1}},setup(a){const e=a,l=re(),o=V(),i=E();function s(){B().post(`dashboard/libraries/${l.params.id??e.library?.id}/folders`,{path:e.folder}).then(({data:t})=>{o.invalidateQueries({queryKey:["dashboard","libraries"]}),i.add({severity:t.status==="ok"?"success":"error",summary:$(t.status==="ok"?"Success":"Error"),detail:$(t.message,...t.args),life:5e3}),e.setFolder("/"),e.close()}).catch(t=>{console.error("Error adding folder:",t),e.close()})}return(t,p)=>{const n=O("Button");return f(),b(R,{close:a.close,open:a.open,"max-width":"max-w-5xl overflow-clip max-h-[60vh] h-[60vh]",title:"Add folder"},{actions:h(()=>[m(n,{id:"yes",onclick:s,color:"theme",type:"button",variant:"contained"},{default:h(()=>[k(v(t.$t("Add")),1)]),_:1}),m(n,{id:"no",onclick:a.close,color:"auto",type:"button",variant:"text"},{default:h(()=>[k(v(t.$t("Cancel")),1)]),_:1},8,["onclick"])]),default:h(()=>[r("div",Ae,[m(ce,{selected:a.folder,"set-selected":a.setFolder},null,8,["selected","set-selected"])])]),_:1},8,["close","open"])}}}),Ue=Re;S();var ze={class:"flex flex-col justify-start items-start flex-grow-0 flex-shrink-0 w-full relative gap-8 p-1 px-6"},Pe={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-3"},Ye={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-6"},Ge={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-4"},Ze={class:"grid grid-cols-4 justify-start items-start self-stretch gap-2"},He={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-2"},Je={class:"flex justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-2"},We={class:"flex flex-col justify-start items-start flex-grow gap-1.5"},Xe={class:"flex justify-start items-center flex-grow-0 flex-shrink-0 relative gap-px"},et={class:"flex-grow-0 flex-shrink-0 text-sm font-medium text-left"},tt={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-3"},rt={class:"flex justify-start items-center self-stretch flex-grow-0 flex-shrink-0 relative gap-2 rounded"},at={class:"flex-grow w-[501px] text-lg font-medium text-left"},lt={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-6"},st={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-2"},ot={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-2"},it={class:"flex justify-start items-center self-stretch flex-grow-0 flex-shrink-0 relative gap-1"},nt={class:"flex-grow-0 flex-shrink-0 text-sm text-left"},ut={class:"flex w-full justify-end items-start self-stretch flex-grow-0 flex-shrink-0 gap-2 rounded-lg bg-white/[0.04] p-2"},dt=q({__name:"EditLibraryModal",props:J({open:{type:Boolean,required:!0},close:{type:Function,required:!0},id:{type:String,required:!0},noRedirect:{type:Boolean,default:!1}},{modelValue:{type:Object,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(a){const e=a,l=U(a,"modelValue"),o=V(),i=E(),s=_(l.value?.title),t=W(s,500),p=_(l.value?.type??"movie");F(l,c=>{c&&(s.value=c.title,p.value=c.type||"movie",l.value.folder_library||(l.value={...l.value,folder_library:[]}))},{deep:!0});const n=_([]),u=_("/");function x(c){u.value=c}const C=_(!1);function I(){C.value=!0}function d(){C.value=!1}const y=_(!1);async function j(){if(!y.value){y.value=!0;try{await B().patch(`dashboard/libraries/${l.value.id}`,{...l.value,subtitles:n.value.map(c=>c.iso_639_1),specialSeasonName:l.value.specialSeasonName}),o.invalidateQueries({queryKey:["dashboard","libraries"]}),e.close()}catch(c){i.add({severity:"error",summary:$("Error"),detail:c instanceof Error?c.message:"Unknown error",life:5e3})}finally{y.value=!1}}}return F(t,c=>{c&&B().patch(`dashboard/libraries/${l.value.id}`,{title:c}).then(()=>{o.invalidateQueries({queryKey:["dashboard","libraries"]})}).catch(g=>{i.add({severity:"error",summary:$("Error"),detail:g.message,life:5e3})})}),F(p,c=>{c&&B().patch(`dashboard/libraries/${l.value.id}`,{type:c}).then(()=>{o.invalidateQueries({queryKey:["dashboard","libraries"]})}).catch(g=>{i.add({severity:"error",summary:$("Error"),detail:g.message,life:5e3})})}),(c,g)=>{const X=O("InputText");return f(),w(T,null,[m(R,{id:"editLibraryModal",close:a.close,open:a.open,background:"","max-width":"max-w-[565px]","no-close":"",title:"Edit Library"},{actions:h(()=>[r("div",ut,[m(D,{id:"done",disabled:y.value,color:"theme",type:"button",variant:"contained",onClick:j},{default:h(()=>[k(v(y.value?c.$t("Saving..."):c.$t("Done")),1)]),_:1},8,["disabled"])])]),default:h(()=>[r("div",ze,[r("div",Pe,[r("div",Ye,[r("div",Ge,[r("div",Ze,[(f(!0),w(T,null,A(H(le),L=>(f(),b(Me,{key:L.value,selected:p.value===L.value,type:L,"class-name":"size-8",onClick:P=>p.value=L.value},null,8,["selected","type","onClick"]))),128))]),r("div",He,[r("div",Je,[r("div",We,[r("div",Xe,[r("p",et,v(c.$t("Library Title")),1),g[2]||(g[2]=r("p",{class:"flex-grow-0 flex-shrink-0 text-sm font-medium text-left text-focus"}," * ",-1))]),m(X,{id:"title",modelValue:s.value,"onUpdate:modelValue":g[0]||(g[0]=L=>s.value=L),class:"w-full",required:""},null,8,["modelValue"])])])])])])]),g[3]||(g[3]=r("div",{class:"flex-grow-0 flex-shrink-0 w-10 h-0.5 rounded bg-[#e2f0fd]/[0.08]"},null,-1)),r("div",tt,[r("div",rt,[r("p",at,v(c.$t("Select one or more folders")),1)]),r("div",lt,[r("div",st,[r("div",ot,[r("button",{id:"save",class:"group/button flex justify-start items-center self-stretch flex-grow-0 flex-shrink-0 h-11 relative overflow-hidden gap-2 pl-3 pr-2.5 py-2.5 rounded-[10px] font-semibold transition-colors bg-surface-10/5 hover:bg-surface-12/5 active:bg-surface-12/5 text-surface-12/12 hover:text-surface-12",type:"button",onClick:I},[r("span",null,v(c.$t("Add folder")),1),m(M,{"class-name":"w-6 h-6 flex-grow-0 flex-shrink-0 ml-auto",icon:"folderAdd"})])]),l.value?.folder_library?(f(!0),w(T,{key:0},A(l.value?.folder_library,L=>(f(),b(Oe,{key:L.folder_id,modelValue:l.value,"onUpdate:modelValue":g[1]||(g[1]=P=>l.value=P),folder:L},null,8,["modelValue","folder"]))),128)):K("",!0),r("div",it,[m(M,{"class-name":"w-4 h-4 flex-grow-0 flex-shrink-0",icon:"infoCircle"}),r("p",nt,v(c.$t("You can always add folder and change encoding profiles later")),1)])])])])])]),_:1},8,["close","open"]),m(Ue,{close:d,folder:u.value,library:l.value,open:C.value,"set-folder":x},null,8,["folder","library","open"])],64)}}}),ct=dt;S();var ft={class:"my-6 text-sm text-surface-10"},vt=q({__name:"DeleteLibraryModal",props:{open:{type:Boolean,required:!0},close:{type:Function,required:!0},id:{type:String,required:!0},name:{type:String,required:!0},noRedirect:{type:Boolean,default:!1}},setup(a){const e=a,l=V(),o=E(),i=_(!1);async function s(){if(!i.value){i.value=!0;try{const{data:t}=await B().delete(`dashboard/libraries/${e.id}`);o.add({severity:t.status==="ok"?"success":"error",summary:$(t.status==="ok"?"Success":"Error"),detail:$(t.message,...t.args??[]),life:5e3}),l.invalidateQueries({queryKey:["dashboard","libraries"]}),e.close()}catch{i.value=!1}}}return(t,p)=>(f(),b(R,{close:a.close,open:a.open,params:{library:e.name},"max-width":"max-w-xl",title:"Delete library {{library}}"},{actions:h(()=>[m(D,{id:"yes",disabled:i.value,onclick:s,color:"red","end-icon":"trash",type:"button",variant:"contained"},{default:h(()=>[k(v(i.value?t.$t("Deleting..."):t.$t("Delete")),1)]),_:1},8,["disabled"]),m(D,{id:"no",disabled:i.value,onclick:a.close,color:"auto",type:"button",variant:"text"},{default:h(()=>[k(v(t.$t("Cancel")),1)]),_:1},8,["disabled","onclick"])]),default:h(()=>[r("div",ft,v(t.$t("Are you sure you want to delete this library?")),1)]),_:1},8,["close","open","params"]))}}),pt=vt;S();var mt={class:"flex h-min children:cursor-default flex-col items-center rounded-lg w-inherit odd:bg-surface-12/5 even:bg-surface-12/2 dark:odd:bg-surface-12/5 dark:even:bg-surface-12/2 text-surface-12/80"},ht={class:"flex items-center gap-2 overflow-x-hidden py-2 pr-2 w-inherit overflow-y-show"},yt={class:"ml-2 h-auto w-8 p-2 handle"},_t={class:"w-full line-clamp-1"},xt=q({__name:"LibraryItem",props:{modelValue:{type:Object,required:!0},modelModifiers:{}},emits:["update:modelValue"],setup(a){const e=U(a,"modelValue"),l=_(!1);function o(){l.value=!0}function i(){l.value=!1}const s=_(!1);function t(){s.value=!0}function p(){s.value=!1}const n=N(()=>{let u;switch(e.value.type){case"music":u="noteDouble";break;case"tv":u="tv";break;case"image":u="camera";break;case"movie":u="film";break;default:u="nomercy"}return u});return(u,x)=>(f(),w("div",mt,[r("div",ht,[r("button",yt,[m(M,{class:"h-6 w-6",icon:"menuDotsVertical"})]),m(M,{icon:n.value,class:"h-6 w-6"},null,8,["icon"]),r("span",_t,v(e.value?.title),1),r("button",{class:"ml-auto flex justify-center items-center h-10 px-2.5 py-2 gap-2 rounded-lg text-sm select-none w-auto font-semibold leading-[100%] transition-all duration-150 button-text hover:outline-slate-11 dark:hover:outline-slate-11 outline-1 outline outline-transparent",type:"button",onClick:t},[m(M,{class:"h-6 w-6",icon:"folderEdit"})]),r("button",{class:"ml-auto flex justify-center items-center h-10 px-2.5 py-2 gap-2 rounded-lg text-sm select-none w-auto font-semibold leading-[100%] transition-all duration-150 button-text hover:outline-slate-11 dark:hover:outline-slate-11 outline-1 outline outline-transparent",type:"button",onClick:o},[m(M,{class:"h-6 w-6",icon:"folderRemove"})])]),e.value?(f(),b(ct,{key:0,id:e.value?.id,modelValue:e.value,"onUpdate:modelValue":x[0]||(x[0]=C=>e.value=C),close:p,open:s.value},null,8,["id","modelValue","open"])):K("",!0),e.value?(f(),b(pt,{key:1,id:e.value?.id,close:i,name:e.value.title,open:l.value},null,8,["id","name","open"])):K("",!0)]))}}),bt=ie(xt,[["__scopeId","data-v-a50b62c6"]]);S();var gt={class:"flex flex-col overflow-hidden text-start h-available"},kt={class:"mb-2 text-xl font-semibold"},wt={class:"mb-4 text-sm"},$t={key:0,class:"grid w-available h-available place-items-center overflow-hidden p-4"},St={class:"mt-4 flex w-full justify-start"},qt=q({__name:"Libraries",props:{setNextButtonLocked:{type:Function,required:!0}},setup(a){const e=a,l=V(),{data:o,isLoading:i}=z({path:"dashboard/libraries",queryKey:["dashboard","libraries"]}),s=_(null),t=_(o.value??[]);F(o,u=>{console.log("Libraries updated:",u),u&&(t.value=u,e.setNextButtonLocked(u?.length===0))});function p(){B().post("dashboard/libraries").then(()=>{l.invalidateQueries({queryKey:["dashboard","libraries"]})})}function n(){B().patch("dashboard/libraries/sort",{libraries:t.value.map((u,x)=>({id:u.id,order:x}))}).then(()=>{l.invalidateQueries({queryKey:["dashboard","libraries"]})})}return F(t,()=>{n()}),de(s,t,{animation:150,handle:".handle"}),(u,x)=>(f(),w("div",gt,[r("h2",kt,v(u.$t("Organize your media library")),1),r("p",wt,v(u.$t("Add your media libraries to organize your content.")),1),H(i)?(f(),w("div",$t,[...x[0]||(x[0]=[r("div",{class:"w-8 h-8 border-2 border-focus border-t-transparent rounded-full animate-spin"},null,-1)])])):K("",!0),r("div",{ref_key:"el",ref:s,class:"flex h-auto w-full flex-col overflow-y-auto text-start gap-1"},[(f(!0),w(T,null,A(t.value,(C,I)=>(f(),b(bt,{key:C.id,modelValue:t.value[I],"onUpdate:modelValue":d=>t.value[I]=d},null,8,["modelValue","onUpdate:modelValue"]))),128))],512),r("div",St,[m(D,{id:"yes",color:"theme",type:"button",variant:"contained",onClick:p},{default:h(()=>[k(v(u.$t("Add media library")),1)]),_:1})])]))}}),Bt=qt;S();var Ct=q({__name:"Finish",props:{setNextButtonLocked:{type:Function,required:!0}},setup(a){const{t:e}=te();return V(),(l,o)=>null}}),Ft=Ct;S();var jt={class:"flex flex-col gap-2 h-available"},Lt={class:"flex flex-col gap-2"},Mt={class:"mt-auto flex flex-col"},Vt={class:"mb-4 text-sm"},Dt={class:"text-theme-10 hover:underline",href:"https://nomercy.tv/privacy-policy",target:"_blank"},Nt={class:"text-theme-10 hover:underline",href:"https://nomercy.tv/terms-of-service",target:"_blank"},Et=q({__name:"Base",props:{setNextButtonLocked:{type:Function,required:!0}},setup(a){const e=a,l=V(),o=E(),{data:i}=z({path:"dashboard/server/info",queryKey:["serverinfo"]}),s=_(i.value?.server??""),t=W(s,500);F(i,n=>{n&&(s.value=n.server)});function p(){B().patch("dashboard/server/info",{name:t.value}).then(({data:n})=>{o.add({severity:"success",summary:$("Success"),detail:$(n.message,...n.args??[]),life:5e3}),l.invalidateQueries({queryKey:["servers"]})})}return F(t,(n,u)=>{!n||n===u||u===""||p()}),F(s,n=>{e.setNextButtonLocked(!n)}),(n,u)=>{const x=O("InputText");return f(),w("div",jt,[r("div",Lt,[u[1]||(u[1]=r("label",{for:"serverName"},"Server name",-1)),m(x,{id:"serverName",modelValue:s.value,"onUpdate:modelValue":u[0]||(u[0]=C=>s.value=C),class:"w-1/3",name:"Give your server a friendly name to help identify it."},null,8,["modelValue"])]),r("div",Mt,[r("p",Vt,[k(v(n.$t("By using this NoMercy app, a NoMercy MediaServer, or any of our services, you agree to the"))+" ",1),r("a",Dt,v(n.$t("Privacy Policy")),1),k(" "+v(n.$t("and"))+" ",1),r("a",Nt,v(n.$t("Terms of Service")),1),u[2]||(u[2]=k(". ",-1))])])])}}}),It=Et;S();var Qt=q({__name:"Desktop",setup(a){const e=E(),l=_(["Base info","Media libraries","Finish"]),o=_("Base info"),i=_(!1);async function s(){console.log("Finish"),await B().post("/dashboard/libraries/refresh").then(()=>{e.add({severity:"success",summary:$("Success"),detail:"Your media libraries are being scanned in the background.",life:16e3})}).catch(n=>{e.add({severity:"error",summary:"Error refreshing libraries",detail:n.message,life:16e3})}),await B().get("libraries").then(({data:n})=>{oe(n.data),se.value=!0,ne.value=!0,G.replace("/")}).catch(()=>{G.replace({name:"Server offline"})})}function t(n){o.value=n}function p(n){i.value=n}return(n,u)=>(f(),b(Se,{"current-step":o.value,finish:s,"next-button-locked":i.value,"set-current-step":t,steps:l.value},{default:h(()=>[o.value==="Base info"?(f(),b(It,{key:0,"set-next-button-locked":p})):o.value==="Media libraries"?(f(),b(Bt,{key:1,"set-next-button-locked":p})):o.value==="Finish"?(f(),b(Ft,{key:2,"set-next-button-locked":p})):K("",!0)]),_:1},8,["current-step","next-button-locked","steps"]))}}),Jt=Qt;export{Jt as default};
