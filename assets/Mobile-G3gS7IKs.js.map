{"version":3,"file":"Mobile-G3gS7IKs.js","sources":["../../src/views/Search/Mobile.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport {onMounted, ref, watch} from 'vue';\nimport {IonPage, IonContent, onIonViewWillEnter, useKeyboard, isPlatform} from '@ionic/vue';\nimport {useRoute} from \"vue-router\";\nimport {refDebounced} from \"@vueuse/core\";\n\nimport {setBackground, setColorPalette} from '@/store/ui';\nimport {\n  search,\n  searchValue,\n  searchType,\n  hasMoreResults,\n  fetchNextPage,\n  musicSearchResult,\n  videoSearchResult,\n} from '@/store/search';\nimport {greetingValue, isNative} from '@/config/global';\nimport { showScreensaver } from \"@/store/imageModal\";\n\nimport MoooomIcon from '@/components/Images/icons/MoooomIcon.vue';\nimport CosmosBg2 from '@/components/Images/CosmosBg2.vue';\nimport SearchCard from \"@/components/Cards/SearchCard.vue\";\n\nconst route = useRoute();\nconst content = ref<VueDivElement>();\n\nonIonViewWillEnter(() => {\n  searchType.value = route.query.from == 'music' ? 'music' : 'video';\n  setColorPalette(null);\n  setBackground(null);\n  setTimeout(() => {\n    search.value.focus();\n    // @ts-ignore\n    content.value?.$el?.scrollToBottom();\n  }, 100);\n});\n\nonMounted(() => {\n  searchType.value = route.query.from == 'music' ? 'music' : 'video';\n  setColorPalette(null);\n  setBackground(null);\n  setTimeout(() => {\n    search.value.focus();\n    // @ts-ignore\n    content.value?.$el?.scrollToBottom();\n  }, 100);\n});\n\nconst { isOpen, keyboardHeight } = useKeyboard();\nconst debouncedIsOpen = refDebounced(isOpen, 300);\nconst debouncedKeyboardHeight = refDebounced(keyboardHeight, 300);\n\nonIonViewWillEnter(() => {\n  setColorPalette(null);\n  setBackground(null);\n});\n\nonMounted(() => {\n  setTimeout(() => {\n    search.value.focus();\n    // @ts-ignore\n    content.value?.$el?.scrollToBottom();\n  }, 100);\n});\n\nwatch(showScreensaver, (value) => {\n  if (value) {\n    document.body.focus();\n  }\n});\n\nwatch(searchType, () => {\n  setTimeout(() => {\n    if(searchValue.value?.length == 0) {\n      search.value.focus();\n    }\n    // @ts-ignore\n    content.value?.$el?.scrollToBottom();\n  }, 100);\n});\n\nwatch(debouncedKeyboardHeight, () => {\n  setTimeout(() => {\n    // @ts-ignore\n    content.value?.$el?.scrollToBottom(0);\n  }, 100);\n});\n\n</script>\n\n<template>\n  <ion-page >\n    <ion-content :fullscreen=\"true\" ref=\"content\">\n      <div :class=\"{\n        'relative flex flex-grow flex-col items-center justify-start gap-12 self-stretch overflow-clip px-4 pt-8 will-change-auto': true,\n        'mb-24': debouncedIsOpen && searchValue?.length == 0,\n      }\">\n        <CosmosBg2 v-if=\"greetingValue && searchValue?.length == 0\" class=\"!h-[90vh]\" />\n        <div v-if=\"greetingValue && searchValue?.length == 0\"\n          class=\"relative z-10 mt-16 flex flex-shrink-0 flex-grow-0 flex-col items-center justify-end gap-3\">\n          <p\n            class=\"flex-grow-0 flex-shrink-0 text-5xl font-black text-left  text-slate-light-11 dark:text-slate-dark-11\">\n            {{ $t(`Good ${greetingValue}`) }}\n          </p>\n          <p class=\"flex-grow-0 flex-shrink-0 w-[333px] text-2xl text-center text-[#eff7ff]/[0.62]\">\n            {{\n              searchType == 'video'\n                  ? $t('What would you like to see?')\n                  : $t('What would you like to listen to?')\n            }}\n          </p>\n        </div>\n\n        <div class=\"absolute top-0 flex w-full flex-col gap-4 px-2 pt-2 h-full overflow-clip\" :style=\"{\n          height: debouncedIsOpen && searchValue?.length == 0\n            ? `calc(100vh - ${debouncedKeyboardHeight + 104}px)`\n            : debouncedIsOpen && searchValue?.length > 0\n              ? `calc(100vh - ${debouncedKeyboardHeight + 70}px)`\n              : '92%',\n        }\" :class=\"searchValue?.length > 0 ? '' : ''\">\n\n          <div v-if=\"searchType == 'video'\" class=\"flex flex-wrap gap-2 sm:gap-4 overflow-auto\">\n            <template v-for=\"item in videoSearchResult ?? []\" :key=\"item.id\">\n              <SearchCard :item=\"item\" />\n            </template>\n            <div class=\"z-50 mt-4 flex justify-center\" ref=\"loadMore\" v-if=\"hasMoreResults && videoSearchResult.length > 0\">\n              <button @click=\"fetchNextPage()\" class=\"h-12 rounded bg-blue-500 px-4 py-2 text-white\">\n                {{ $t('Load more') }}\n              </button>\n            </div>\n          </div>\n\n          <div v-else-if=\"musicSearchResult\"\n               class=\"flex w-full flex-col p-1 h-available sm:p-4 sm:pt-0 overflow-auto\">\n            <component v-for=\"(render, index) in musicSearchResult ?? []\" :index=\"index\" :key=\"render.id\"\n                       :is=\"render.component\" v-bind=\"render.props\" />\n          </div>\n        </div>\n\n        <div\n          class=\"absolute flex justify-center items-center self-center flex-grow-0 flex-shrink-0 w-available h-14 sm:w-1/2 overflow-hidden gap-2 p-1.5 rounded-[20px] border-2 bg-[#d7dbdf] border-[#eceef0] dark:bg-black dark:border-[#202425] transition-all duration-300\"\n          :style=\"{\n            bottom: debouncedIsOpen && searchValue.length == 0\n              ? `${debouncedKeyboardHeight - (isPlatform('mobile') ? 180 : 80)}px`\n              : debouncedIsOpen && searchValue.length > 0\n                ? `${debouncedKeyboardHeight - 80}px`\n                : !debouncedIsOpen && searchValue.length > 0\n                  ? '0vh'\n                  : '50vh',\n          }\" :class=\"{\n              'mx-2': !debouncedIsOpen && searchValue.length == 0,\n              'rounded-none': debouncedIsOpen || searchValue.length > 0,\n              'translate-y-[calc(var(--safe-area-inset-top)*-1.5)]': debouncedIsOpen && isNative\n            }\">\n\n          <div\n              class=\"flex flex-col justify-start items-start flex-grow-0 flex-shrink-0 gap-2 p-1 rounded-xl bg-[#012139]/[0.13] dark:bg-[#dfeffe]/[0.14] backdrop-blur\"\n          >\n            <div class=\"relative flex justify-center items-start flex-grow-0 flex-shrink-0 gap-2\">\n              <div class=\"absolute w-9 h-available inset-0 bg-focus z-0 rounded-lg transition-all duration-150\"\n                   :class=\"{\n                      'translate-x-0': searchType == 'video',\n                      'translate-x-[120%]': searchType == 'music',\n                    }\"\n              ></div>\n              <button @click=\"searchType = 'video'\"\n                      class=\"flex justify-center items-center flex-grow-0 flex-shrink-0 relative gap-2 p-1 rounded-lg w-9 h-9\"\n                      :class=\"{\n                         'text-slate-dark-12': searchType == 'video',\n                      }\"\n              >\n                <MoooomIcon icon=\"film\" class=\"h-6 w-6 flex-grow-0 flex-shrink-0 transition-all duration-150\"/>\n              </button>\n              <button @click=\"searchType = 'music'\"\n                      class=\"flex justify-center items-center flex-grow-0 flex-shrink-0 relative gap-2 p-1 rounded-lg w-9 h-9\"\n                      :class=\"{\n                         'text-slate-dark-12': searchType == 'music',\n                      }\"\n              >\n                <MoooomIcon icon=\"noteDouble\" class=\"h-6 w-6 flex-grow-0 flex-shrink-0 transition-all duration-150\"/>\n              </button>\n            </div>\n          </div>\n\n          <label class=\"flex w-available\">\n            <input enterkeyhint=\"search\" id=\"search\"\n                   :placeholder=\"searchType == 'video'\n                              ? `${$t('Movie')}, ${$t('Show')} ${$t('or')} ${$t('Person')}...`\n                              : `${$t('Artist')}, ${$t('Album')} ${$t('or')} ${$t('Track')}...`\"\n\n              class=\"w-available flex-shrink-0 border-transparent bg-transparent px-1 mr-1 text-lg shadow-transparent flex-grow-1 focus:outline-none\"\n              :class=\"{\n                '!py-1': !debouncedIsOpen,\n              }\" v-model=\"searchValue\" name=\"search\" type=\"search\" ref=\"search\" autocomplete=\"off\" />\n          </label>\n        </div>\n      </div>\n    </ion-content>\n  </ion-page>\n</template>\n"],"names":["route","useRoute","content","ref","onIonViewWillEnter","searchType","setColorPalette","setBackground","search","_b","_a","onMounted","isOpen","keyboardHeight","useKeyboard","debouncedIsOpen","refDebounced","debouncedKeyboardHeight","watch","showScreensaver","value","searchValue","_c"],"mappings":"uxCAuBA,MAAMA,EAAQC,EAAS,EACjBC,EAAUC,EAAmB,EAEnCC,EAAmB,IAAM,CACvBC,EAAW,MAAQL,EAAM,MAAM,MAAQ,QAAU,QAAU,QAC3DM,EAAgB,IAAI,EACpBC,EAAc,IAAI,EAClB,WAAW,IAAM,SACfC,EAAO,MAAM,MAAM,GAEXC,GAAAC,EAAAR,EAAA,QAAA,YAAAQ,EAAO,MAAP,MAAAD,EAAY,kBACnB,GAAG,CAAA,CACP,EAEDE,EAAU,IAAM,CACdN,EAAW,MAAQL,EAAM,MAAM,MAAQ,QAAU,QAAU,QAC3DM,EAAgB,IAAI,EACpBC,EAAc,IAAI,EAClB,WAAW,IAAM,SACfC,EAAO,MAAM,MAAM,GAEXC,GAAAC,EAAAR,EAAA,QAAA,YAAAQ,EAAO,MAAP,MAAAD,EAAY,kBACnB,GAAG,CAAA,CACP,EAED,KAAM,CAAE,OAAAG,EAAQ,eAAAC,CAAe,EAAIC,EAAY,EACzCC,EAAkBC,EAAaJ,EAAQ,GAAG,EAC1CK,EAA0BD,EAAaH,EAAgB,GAAG,EAEhE,OAAAT,EAAmB,IAAM,CACvBE,EAAgB,IAAI,EACpBC,EAAc,IAAI,CAAA,CACnB,EAEDI,EAAU,IAAM,CACd,WAAW,IAAM,SACfH,EAAO,MAAM,MAAM,GAEXC,GAAAC,EAAAR,EAAA,QAAA,YAAAQ,EAAO,MAAP,MAAAD,EAAY,kBACnB,GAAG,CAAA,CACP,EAEKS,EAAAC,EAAkBC,GAAU,CAC5BA,GACF,SAAS,KAAK,MAAM,CACtB,CACD,EAEDF,EAAMb,EAAY,IAAM,CACtB,WAAW,IAAM,aACZK,EAAAW,EAAY,QAAZ,YAAAX,EAAmB,SAAU,GAC9BF,EAAO,MAAM,MAAM,GAGbc,GAAAb,EAAAP,EAAA,QAAA,YAAAO,EAAO,MAAP,MAAAa,EAAY,kBACnB,GAAG,CAAA,CACP,EAEDJ,EAAMD,EAAyB,IAAM,CACnC,WAAW,IAAM,UAEPR,GAAAC,EAAAR,EAAA,QAAA,YAAAQ,EAAO,MAAP,MAAAD,EAAY,eAAe,IAClC,GAAG,CAAA,CACP"}