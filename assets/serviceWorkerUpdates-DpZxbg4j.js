import{bf as r,be as t}from"./index-pz_asidw.js";import"./icons-BW5E66pf.js";import"./vue-ionic-Cv2or74p.js";import"./vendor-F08gofix.js";import"./rxjs-BCp2L9Rn.js";import"./media-C2AqgyMX.js";import"./api-BBofn2cc.js";import"./swiper-DhG1br88.js";import"./music-player-Dgg5bFLw.js";function a(){return localStorage.getItem("language")||navigator.language.split("-")[0]||"en"}function i(){const e=a(),o=t[e]||t.en;return{id:`sw-update-${Date.now()}`,type:"update",title:o.newVersion,body:o.updateNow,from:"system",read:!1,created_at:Date.now(),updated_at:Date.now(),notify:!0,link:"reload"}}function v(){if(!("serviceWorker"in navigator)){console.log("Service worker not supported");return}console.log("Setting up service worker update detection..."),navigator.serviceWorker.ready.then(e=>{console.log("Service worker ready, checking for updates..."),e.waiting?(console.log("Update already waiting, showing notification"),n()):console.log("No update waiting"),e.addEventListener("updatefound",()=>{console.log("New service worker found!");const o=e.installing;if(!o){console.log("No installing worker found");return}console.log("New worker state:",o.state),o.addEventListener("statechange",()=>{console.log("Service worker state changed to:",o.state),o.state==="installed"&&navigator.serviceWorker.controller?(console.log("New version installed, showing notification"),n()):o.state==="installed"&&console.log("Service worker installed but no controller (first install)")})})}).catch(e=>{console.error("Service worker ready failed:",e)}),document.addEventListener("sw-update-accepted",()=>{console.log("User accepted update, reloading..."),window.location.reload()})}function n(){const e=i();r(e)}export{v as setupServiceWorkerUpdates};
