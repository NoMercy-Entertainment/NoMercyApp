import{An as v,Bn as y,Gt as l,Mt as D,Rt as _,Sn as a,Tt as k,Un as u,Vt as C,Wt as f,cn as o,fn as R,i as E,n as $,qt as w,u as q,un as z,zn as d,zt as m}from"./index-Dv83kAv_.js";import"./dist-BWFEUpD5.js";import"./esm-CjYSFQTD.js";import"./esm-B--WsoEr.js";import"./dist-CkXwLdCd.js";import"./client-Lt1iJPRU.js";import"./ionic-global-BrT5QOOk.js";import"./hardware-back-button-DUNt_0t6.js";import"./index3-D57DmiIb.js";import"./index8-CrgDNp2f.js";import"./keyboard-BGaVckUv.js";import"./index2-Bme3R7x6.js";import"./ios.transition-CmHvz4bI.js";import"./keyboard2-DeMt_g_-.js";import"./md.transition-DBZTZPtp.js";import"./ui-Dy0BhNPE.js";import"./client-D4e5iciK.js";import{C as t,t as g}from"./currentServer-CyRP1M2f.js";import"./config-BZ-AEJ_J.js";import"./esm-ANv1qkIu.js";import"./global-Cl9NRZH-.js";import"./esm-CLtwhlBL.js";import"./bundle-mjs-m3ebY3zV.js";import"./user-Cpc-QsaC.js";import{t as b}from"./serverClient-Dh7JrGPq.js";import"./router-LUtA4OvS.js";import"./utils-S5luT9U1.js";import"./useInfiniteServerClient-r3ptfaNG.js";import{tt as A}from"./SocketClient-CLd4yl1R.js";import"./apiClient-9DYr7MVK.js";import"./notifications-qUxNFD5p.js";import"./utils-DRKz5xy4.js";import"./deviceInfo-DoGAY46a.js";import"./auth-hpDtC4ST.js";import"./AppLogoSquare-i1IW1kFU.js";import{t as N}from"./TMDBImage-Bq86Jy-T.js";import{t as T}from"./useServerClient-CvCiAwnH.js";import"./ScrollContainer-UnRcXO1f.js";import"./useMounted-BO0RWNIx.js";import"./RipperOverlay-DPcurQGk.js";import"./ripperSocket-66QK4sK-.js";import"./FloatingBackButton-DBcoXYDj.js";import{t as V}from"./DashboardLayout-CDV4ClI3.js";import{t as I}from"./DashboardCard-DtIzMUXG.js";k();var M={class:"relative flex aspect-video flex-shrink-0 flex-grow-0 flex-col items-center justify-center self-stretch overflow-clip rounded-lg bg-theme-8"},U={key:1,class:"text-xl font-bold"},j=w({__name:"LibraryCard",props:{data:{type:Object,required:!0}},setup(r){return(i,n)=>(o(),m(I,{line1:r.data.title,line2:r.data.folder_library&&r.data.folder_library?.length!==1?`${r.data.folder_library?.length} folders`:`${r.data.folder_library?.length}  folder`,route:`/dashboard/libraries/${r.data.id}`},{image:a(()=>[_("div",M,[n[0]||(n[0]=_("div",{class:"backdropCard-overlay"},null,-1)),r.data.image?(o(),m(N,{key:0,path:r.data.image,aspect:"backdrop",class:"z-0"},null,8,["path"])):(o(),C("span",U,u(r.data.title),1))])]),_:1},8,["line1","line2","route"]))}}),K=j;k();var F=w({__name:"Desktop",setup(r){const i=$(),{data:n,error:x}=T({path:"dashboard/libraries",queryKey:["dashboard","libraries",g.value?.serverBaseUrl]});function B(){b().post("dashboard/libraries").then(({data:e})=>{i.add({severity:e.status==="ok"?"success":"error",summary:t(e.status==="ok"?"Success":"Error"),detail:t(e.message,...e.args),life:5e3}),A.invalidateQueries({queryKey:["dashboard","libraries",g.value?.serverBaseUrl]})})}const s=v(!1);function S(){s.value=!0,b().post("dashboard/libraries/refresh").then(({data:e})=>{s.value=!1,i.add({severity:e.status==="ok"?"success":"error",summary:t(e.status==="ok"?"Success":"Error"),detail:t(e.message,...e.args),life:5e3})}).catch(()=>{s.value=!1,i.add({severity:"error",summary:t("Error"),detail:t("An error occurred while rescanning the libraries"),life:5e3})})}const c=v(!1);function L(){c.value=!0,b().post("dashboard/libraries/rescan").then(({data:e})=>{c.value=!1,i.add({severity:e.status==="ok"?"success":"error",summary:t(e.status==="ok"?"Success":"Error"),detail:t(e.message,...e.args),life:5e3})}).catch(()=>{c.value=!1,i.add({severity:"error",summary:t("Error"),detail:t("An error occurred while rescanning the libraries"),life:5e3})})}return(e,G)=>{const p=R("Button");return o(),m(d(q),null,{default:a(()=>[l(d(E),{fullscreen:!0},{default:a(()=>[l(V,{error:d(x),"grid-style":1,title:"Libraries",description:"Manage your media libraries and their content here."},{cta:a(()=>[l(p,{id:"newLibrary",color:"theme","start-icon":"folderAdd",onClick:B},{default:a(()=>[f(u(e.$t("New library")),1)]),_:1})]),actions:a(()=>[l(p,{id:"refresh",type:"button",variant:"text","start-icon":"folderSwap",disabled:s.value,class:y(s.value?"first:children:animate-spin cursor-not-allowed":""),onClick:S},{default:a(()=>[f(u(e.$t("Refresh all libraries")),1)]),_:1},8,["disabled","class"]),l(p,{id:"rescan",type:"button",variant:"text","start-icon":"folderSwap",disabled:s.value,class:y(s.value?"first:children:animate-spin cursor-not-allowed":""),onClick:L},{default:a(()=>[f(u(e.$t("Rescan all libraries")),1)]),_:1},8,["disabled","class"])]),default:a(()=>[(o(!0),C(D,null,z(d(n)??[],h=>(o(),m(K,{key:h.id,data:h},null,8,["data"]))),128))]),_:1},8,["error"])]),_:1})]),_:1})}}}),Ne=F;export{Ne as default};
