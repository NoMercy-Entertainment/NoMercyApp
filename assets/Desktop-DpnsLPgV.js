import{Y as ee,d as l,w as n,f as re,C as oe,aW as te,j as se,c as ae,o as S,l as v,y as i,Z as d,aq as le,h as y,b as C,i as s,v as Y,B as ne,am as ue,R as ie}from"./vue-ionic-Cb5qD3-A.js";import{h as a,t as de,c2 as G,c3 as I,c4 as N}from"./index-CHxijYRy.js";import{_ as me}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-CMm2hAmR.js";import{u as pe}from"./useServerClient-SbrVMURt.js";import{T as fe}from"./Toggle-iVsRPEyT.js";import{_ as ve}from"./OptimizedIcon.vue_vue_type_script_setup_true_lang-BgDponKe.js";import{h as _e,g as q}from"./primevue-DqDJv11l.js";import"./vendor-CKnYbqeP.js";import"./icons-BW5E66pf.js";import"./rxjs-BCp2L9Rn.js";import"./media-C2AqgyMX.js";import"./api-BBofn2cc.js";import"./swiper-D00Cnjmx.js";import"./music-player-gfKAgRMD.js";import"./useMounted-BtHEVk7C.js";import"./FloatingBackButton.vue_vue_type_script_setup_true_lang-Dh5uYVRY.js";import"./Button.vue_vue_type_script_setup_true_lang-CP8BDQd9.js";import"./ScrollContainer.vue_vue_type_script_setup_true_lang-Dnkt33Fj.js";import"./RipperOverlay.vue_vue_type_script_setup_true_lang-CyadC428.js";import"./Button.vue_vue_type_script_setup_true_lang-BK8DxUcQ.js";import"./useInfiniteServerClient-CascTl9C.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const we={key:0,class:"col-span-2 col-start-1 2xl:col-start-1"},ge={class:"flex flex-col gap-2"},ce={class:"flex flex-col gap-2"},ke={class:"flex flex-col gap-2"},xe={key:1,class:"col-span-2 col-start-1 2xl:col-start-3"},be={class:"flex flex-col gap-2"},Ve={class:"flex flex-col gap-2"},Se={class:"flex flex-col gap-2"},qe={key:2,class:"col-span-2 col-start-1 2xl:col-start-5"},Be={class:"flex flex-col gap-2"},ye={class:"flex gap-4"},Ce=["aria-label","href"],Je=ee({__name:"Desktop",setup(Ue){var O,P,Q,T,j,A,D,E,R,z;const{data:o,refetch:Z,error:H}=pe({path:"/dashboard/configuration"}),_=l(!1),u=l(o.value??{}),m=(e,r)=>{if(o.value){if(ie(o.value[e])===r){delete u.value[e],u.value={...u.value};return}u.value={...u.value,[e]:r??void 0}}};n(o,e=>{e&&(u.value={},w.value=e==null?void 0:e.name,g.value=e==null?void 0:e.external_port,c.value=e==null?void 0:e.internal_port,k.value=e==null?void 0:e.queue_workers,U.value=e==null?void 0:e.cron_workers,$.value=e==null?void 0:e.data_workers,h.value=e==null?void 0:e.request_workers,b.value=e==null?void 0:e.encoder_workers,x.value=e==null?void 0:e.image_workers,p.value=e==null?void 0:e.swagger,_.value=!0)}),re(()=>{var e,r,B,f,V,t,F,K,M,W;o.value&&(u.value={},w.value=(e=o.value)==null?void 0:e.name,g.value=(r=o.value)==null?void 0:r.external_port,c.value=(B=o.value)==null?void 0:B.internal_port,k.value=(f=o.value)==null?void 0:f.queue_workers,U.value=(V=o.value)==null?void 0:V.cron_workers,$.value=(t=o.value)==null?void 0:t.data_workers,h.value=(F=o.value)==null?void 0:F.request_workers,b.value=(K=o.value)==null?void 0:K.encoder_workers,x.value=(M=o.value)==null?void 0:M.image_workers,p.value=(W=o.value)==null?void 0:W.swagger,_.value=!0)});const w=l(((O=o.value)==null?void 0:O.name)??"");n(w,e=>{m("name",e),a.value&&(G([...I.value.filter(r=>r.id!==a.value.id),{...a.value,name:e.toString()}]),N({...a.value,name:e.toString()}))});const g=l(((P=o.value)==null?void 0:P.external_port)??0);n(g,e=>{m("external_port",e),a.value&&(G([...I.value.filter(r=>r.id!==a.value.id),{...a.value,external_port:e.toString()}]),N({...a.value,external_port:e.toString()}))});const c=l(((Q=o.value)==null?void 0:Q.internal_port)??0);n(c,e=>{m("internal_port",e),a.value&&(G([...I.value.filter(r=>r.id!==a.value.id),{...a.value,internal_port:e.toString()}]),N({...a.value,internal_port:e.toString()}))});const k=l(((T=o.value)==null?void 0:T.queue_workers)??0);n(k,e=>{m("queue_workers",e)});const U=l(((j=o.value)==null?void 0:j.cron_workers)??0);n(U,e=>{m("cron_workers",e)});const $=l(((A=o.value)==null?void 0:A.data_workers)??0);n($,e=>{m("data_workers",e)});const h=l(((D=o.value)==null?void 0:D.request_workers)??0);n(h,e=>{m("request_workers",e)});const x=l(((E=o.value)==null?void 0:E.image_workers)??0);n(x,e=>{m("image_workers",e)});const b=l(((R=o.value)==null?void 0:R.encoder_workers)??0);n(b,e=>{m("encoder_workers",e)});const p=l(((z=o.value)==null?void 0:z.swagger)??!1);n(p,e=>{m("swagger",e)});const J=oe(()=>Object.keys(u.value).length>0);n(u,e=>{console.log(e)});const L=te(),X=()=>{console.raw(u.value),de().patch("/dashboard/configuration",u.value).then(()=>{Z(),L.invalidateQueries({queryKey:["serverInfo"]})})};return(e,r)=>{const B=se("Button");return S(),ae(d(ue),null,{default:v(()=>[i(d(le),{fullscreen:!0},{default:v(()=>[i(me,{error:d(H),gridStyle:2,title:"General",description:""},{cta:v(()=>r[8]||(r[8]=[])),actions:v(()=>[i(B,{type:"submit",id:"save",disabled:!J.value,color:"theme",class:"ml-auto",form:"myForm",onClick:r[7]||(r[7]=f=>X())},{default:v(()=>[ne(Y(e.$t("Save")),1)]),_:1},8,["disabled"])]),default:v(()=>{var f,V;return[_.value?(S(),y("div",we,[s("div",ge,[r[9]||(r[9]=s("label",{for:"name"},"Server name",-1)),i(d(_e),{id:"name",modelValue:w.value,"onUpdate:modelValue":r[0]||(r[0]=t=>w.value=t),class:"mb-4"},null,8,["modelValue"])]),s("div",ce,[r[10]||(r[10]=s("label",{for:"internal_port"},"Secure internal port",-1)),i(d(q),{id:"internal_port",modelValue:c.value,"onUpdate:modelValue":r[1]||(r[1]=t=>c.value=t),class:"mb-4",useGrouping:!1,showButtons:"",min:2e3},null,8,["modelValue"])]),s("div",ke,[r[11]||(r[11]=s("label",{for:"external_port"},"Secure external port",-1)),i(d(q),{id:"external_port",modelValue:g.value,"onUpdate:modelValue":r[2]||(r[2]=t=>g.value=t),class:"mb-4",useGrouping:!1,showButtons:"",min:2e3},null,8,["modelValue"])])])):C("",!0),_.value?(S(),y("div",xe,[s("div",be,[r[12]||(r[12]=s("label",{for:"encoder_workers"},"Encoder workers",-1)),i(d(q),{id:"encoder_workers",modelValue:b.value,"onUpdate:modelValue":r[3]||(r[3]=t=>b.value=t),class:"mb-4",useGrouping:!1,showButtons:"",min:0},null,8,["modelValue"])]),s("div",Ve,[r[13]||(r[13]=s("label",{for:"image_workers"},"Image workers",-1)),i(d(q),{id:"image_workers",modelValue:x.value,"onUpdate:modelValue":r[4]||(r[4]=t=>x.value=t),class:"mb-4",useGrouping:!1,showButtons:"",min:0},null,8,["modelValue"])]),s("div",Se,[r[14]||(r[14]=s("label",{for:"queue_workers"},"Queue workers",-1)),i(d(q),{id:"queue_workers",modelValue:k.value,"onUpdate:modelValue":r[5]||(r[5]=t=>k.value=t),class:"mb-4",useGrouping:!1,showButtons:"",min:0},null,8,["modelValue"])])])):C("",!0),_.value?(S(),y("div",qe,[s("div",Be,[s("span",ye,[r[15]||(r[15]=s("label",{for:"swagger"},"Open API / Swagger Ui",-1)),p.value&&((f=d(a))!=null&&f.serverBaseUrl)?(S(),y("a",{key:0,target:"_blank","aria-label":e.$t("Open API / Swagger Ui in a new tab"),href:(V=d(a))==null?void 0:V.serverBaseUrl,class:"flex gap-1 items-center underline underline-offset-4 h-4 text-sm"},[s("span",null,Y(e.$t("Open")),1),i(ve,{icon:"shareSquare",className:"size-4",color:"theme"})],8,Ce)):C("",!0)]),i(fe,{"model-value":p.value,"onUpdate:modelValue":r[6]||(r[6]=t=>p.value=t)},null,8,["model-value"])])])):C("",!0)]}),_:1},8,["error"])]),_:1})]),_:1})}}});export{Je as default};
