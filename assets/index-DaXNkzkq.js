import{bk as d}from"./vendor-C28OoIfY.js";import{G as f}from"./vue-ionic-DerxjBh9.js";import"./icons-BW5E66pf.js";import"./rxjs-BCp2L9Rn.js";import"./media-C2AqgyMX.js";import"./api-BBofn2cc.js";import"./swiper-D00Cnjmx.js";let u=!1;const l=Symbol("keycloak"),P={async install(i,r={}){if(u)return;u=!0;const o={config:window.__BASEURL__?`${window.__BASEURL__}/config`:"/config",init:{onLoad:"login-required"}},e=Object.assign({},o,r);if(c(e).hasError)throw new Error(`Invalid options given: ${c(e).error}`);const n=await g(i,y());p(e.config).then(t=>{k(t,n,e)}).catch(t=>{console.log(t)})},KeycloakSymbol:l};function y(){return{ready:!1,authenticated:!1,userName:void 0,fullName:void 0,token:void 0,tokenParsed:void 0,logoutFn:void 0,loginFn:void 0,login:void 0,createLoginUrl:void 0,createLogoutUrl:void 0,createRegisterUrl:void 0,register:void 0,accountManagement:void 0,createAccountUrl:void 0,loadUserProfile:void 0,subject:void 0,idToken:void 0,idTokenParsed:void 0,realmAccess:void 0,resourceAccess:void 0,refreshToken:void 0,refreshTokenParsed:void 0,timeSkew:void 0,responseMode:void 0,responseType:void 0,hasRealmRole:void 0,hasResourceRole:void 0,keycloak:void 0}}function g(i,r){return new Promise((o,e)=>{if(i.prototype)try{const n=i.observable(r);Object.defineProperty(i.prototype,"$keycloak",{get(){return n}}),o(n)}catch(n){e(n)}else{const n=f(r);i.config.globalProperties.$keycloak=n,i.provide(l,n),o(n)}})}function k(i,r,o){const e=d(i);e.onReady=function(t){n(t),r.ready=!0,typeof o.onReady=="function"&&o.onReady(e,r)},e.onAuthSuccess=function(){n(!0),r.ready=!0;const t=setInterval(()=>e.updateToken(60).catch(()=>{e.clearToken()}),1e4);r.logoutFn=()=>{clearInterval(t),e.logout(o.logout)}},e.onAuthRefreshSuccess=function(){n(!0),typeof o.onAuthRefreshSuccess=="function"&&o.onAuthRefreshSuccess(e)},e.onAuthRefreshError=function(){n(!1),typeof o.onAuthRefreshError=="function"&&o.onAuthRefreshError(e)},n(!1),o.init!==void 0&&e.init(o.init).then(t=>{n(t),typeof o.onInitSuccess=="function"&&o.onInitSuccess(t)}).catch(t=>{n(!1);const a=new Error("Failure during initialization of keycloak-js adapter");typeof o.onInitError=="function"?o.onInitError(a,t):console.error(a,t)});function n(t=!1){r.authenticated=t,r.loginFn=e.login,r.login=e.login,r.createLoginUrl=e.createLoginUrl,r.createLogoutUrl=e.createLogoutUrl,r.createRegisterUrl=e.createRegisterUrl,r.register=e.register,r.keycloak=e,t&&(r.accountManagement=e.accountManagement,r.createAccountUrl=e.createAccountUrl,r.hasRealmRole=e.hasRealmRole,r.hasResourceRole=e.hasResourceRole,r.loadUserProfile=e.loadUserProfile,r.token=e.token,r.subject=e.subject,r.idToken=e.idToken,r.idTokenParsed=e.idTokenParsed,r.realmAccess=e.realmAccess,r.resourceAccess=e.resourceAccess,r.refreshToken=e.refreshToken,r.refreshTokenParsed=e.refreshTokenParsed,r.timeSkew=e.timeSkew,r.responseMode=e.responseMode,r.responseType=e.responseType,r.tokenParsed=e.tokenParsed,r.userName=e.tokenParsed.preferred_username,r.fullName=e.tokenParsed.name)}}function c(i){const{config:r,init:o,onReady:e,onInitError:n,onAuthRefreshError:t}=i;return typeof r!="string"&&!s(r)?{hasError:!0,error:`'config' option must be a string or an object. Found: '${r}'`}:!s(o)||typeof(o==null?void 0:o.onLoad)!="string"?{hasError:!0,error:`'init' option must be an object with an 'onLoad' property. Found: '${o}'`}:e&&typeof e!="function"?{hasError:!0,error:`'onReady' option must be a function. Found: '${e}'`}:n&&typeof n!="function"?{hasError:!0,error:`'onInitError' option must be a function. Found: '${n}'`}:t&&typeof t!="function"?{hasError:!0,error:`'onAuthRefreshError' option must be a function. Found: '${t}'`}:{hasError:!1,error:null}}function s(i){return i!==null&&typeof i=="object"&&Object.prototype.toString.call(i)!=="[object Array]"}function p(i){return s(i)?Promise.resolve(i):new Promise((r,o)=>{const e=new XMLHttpRequest;e.open("GET",i),e.setRequestHeader("Accept","application/json"),e.onreadystatechange=()=>{e.readyState===4&&(e.status===200?r(JSON.parse(e.responseText)):o(new Error(e.statusText)))},e.send()})}export{P as default};
