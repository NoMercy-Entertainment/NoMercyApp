import{$ as O,a7 as ee,C as te,j as B,c as V,o as p,l as c,h as w,b as F,i as e,v as a,a0 as d,H as P,y as n,bg as le,B as ae,a_ as se,d as $,aU as oe,w as j,f as K,p as S,F as T,ao as ne,au as re,ar as ie}from"./vue-ionic-DerxjBh9.js";import{u as A}from"./useServerClient-CfG73rS5.js";import{bn as Y,bY as Q,bk as D,by as ue,t as ce}from"./index-Dq_Cm6ym.js";import{_ as de,c as pe}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-DX4sxqlS.js";import{u as fe}from"./RipperOverlay.vue_vue_type_script_setup_true_lang-B8zcub6V.js";import{_ as I}from"./DropdownMenu.vue_vue_type_script_setup_true_lang-CoxkHkq0.js";import{_ as U}from"./OptimizedIcon.vue_vue_type_script_setup_true_lang--O4NX453.js";import{_ as me}from"./Modal.vue_vue_type_script_setup_true_lang-BGuRZarG.js";import{_ as ve}from"./ScrollContainer.vue_vue_type_script_setup_true_lang-333syLwA.js";import"./vendor-C28OoIfY.js";import"./icons-BW5E66pf.js";import"./rxjs-BCp2L9Rn.js";import"./media-C2AqgyMX.js";import"./api-BBofn2cc.js";import"./swiper-D00Cnjmx.js";import"./useInfiniteServerClient-D2a2G1H-.js";import"./music-player-B5BcR-ht.js";import"./useMounted-CuGMmass.js";import"./FloatingBackButton.vue_vue_type_script_setup_true_lang-kulpK_lc.js";import"./Button.vue_vue_type_script_setup_true_lang-RykQrIq9.js";import"./Button.vue_vue_type_script_setup_true_lang-DHL8wjTc.js";const xe={key:0,class:"my-6 w-full text-sm text-white"},he={class:"flex h-min w-full flex-1 flex-col justify-center overflow-auto"},ye={class:"relative flex flex-grow items-center justify-start gap-2 whitespace-nowrap px-3 text-xs line-clamp-1 w-available"},ge={class:"relative flex flex-grow items-center justify-start gap-2 whitespace-nowrap px-3 text-xs line-clamp-1 w-available"},we={class:"relative flex flex-grow items-center justify-start gap-2 whitespace-nowrap px-3 text-xs line-clamp-1 w-available"},_e={class:"relative flex flex-grow flex-col items-start justify-start gap-4 overflow-clip px-3 text-xs line-clamp-1 w-available max-h-[60vh] whitespace-break-spaces"},be=O({__name:"LogModal",props:{open:{type:Boolean,required:!0},close:{type:Function,required:!0},id:{type:String,required:!0},name:{type:String,required:!0},data:{type:Object,required:!0}},setup(m){const r=m,{t:_}=ee(),t=te(()=>{if(r.data)try{return JSON.parse(Y(r.data.message))}catch{return r.data.message}});return(v,y)=>{const i=B("Button");return p(),V(me,{close:m.close,open:!0,"max-width":"max-w-7xl max-h-[80vh]",title:""},{actions:c(()=>[n(i,{id:"no","on-click":m.close,type:"button",color:"text-auto-alpha-11",variant:"text"},{default:c(()=>[ae(a(d(_)("Close")),1)]),_:1},8,["on-click"])]),default:c(()=>[m.data?(p(),w("div",xe,[e("div",he,[e("div",ye,[e("span",null,a(v.$t("Time"))+":",1),e("span",null,a(d(Q)(m.data.time)),1)]),e("div",ge,[e("span",null,a(v.$t("Type"))+":",1),e("span",{class:"h-5 w-20 rounded-full px-2 text-center leading-5",style:P(`background: ${m.data.color}`)},a(m.data.type),5)]),e("div",we,[e("span",null,a(v.$t("Level"))+":",1),e("span",null,a(m.data.level),1)]),e("div",_e,[e("span",null,a(v.$t("Message"))+":",1),n(ve,{static:!1},{default:c(()=>[n(d(le),{class:"h-fit",data:t.value},null,8,["data"])]),_:1})])])])):F("",!0)]),_:1},8,["close"])}}}),$e={class:"flex flex-col gap-2 overflow-auto py-2 max-h-[60vh]"},ke={class:"-mb-2 flex flex-grow items-center justify-start gap-3 rounded-md px-2.5"},je={class:"text-center text-xs font-semibold uppercase"},Ce=["onClick"],Te={class:"text-center text-xs font-semibold uppercase"},Le=["onclick"],Be=O({__name:"LogTypeSelector",props:se({refetch:{type:Function,required:!0},logTypes:{type:Array,required:!0}},{selectedTypes:{type:Array,required:!1,default:()=>[]},selectedTypesModifiers:{}}),emits:["update:selectedTypes"],setup(m){const r=m,_=$(!1),t=oe(m,"selectedTypes");j(_,i=>{r.logTypes&&console.log("checkboxState",i)}),j(r,()=>{t.value&&(_.value=D(t.value,r.logTypes),r.refetch())}),K(()=>{r.logTypes});function v(i){t.value.some(u=>u.name===i.name)?t.value=t.value.filter(u=>u.name!==i.name):t.value=[...t.value,i]}function y(i){if(!r.logTypes)return;const u=r.logTypes.filter(x=>x.type===i.type);u.every(x=>t.value.some(h=>h.name===x.name))?t.value=t.value.filter(x=>!u.some(h=>h.name===x.name)):t.value=[...t.value,...u]}return(i,u)=>{const x=B("Checkbox");return p(),V(I,{class:"relative flex items-center justify-center gap-2 rounded-lg transition-colors duration-200 hover:bg-auto-5/6"},{button:c(()=>[n(U,{"class-name":"w-6",icon:"chevronDown"})]),default:c(()=>{var h;return[e("div",$e,[e("div",ke,[n(x,{modelValue:_.value,"onUpdate:modelValue":u[0]||(u[0]=o=>_.value=o),label:"All"},null,8,["modelValue"]),e("p",je,a(i.$t("All")),1)]),(p(!0),w(T,null,S(d(ue)(((h=m.logTypes)==null?void 0:h.filter(o=>o.type!=="spacer"))??[],"type"),o=>{var k,q,b;return p(),w(T,{key:o[0].type},[e("div",{class:"relative mt-2 -mb-1 flex items-center justify-start gap-2 self-stretch px-2.5",onClick:()=>y(o[0])},[n(x,{"model-value":d(D)((k=t.value)==null?void 0:k.filter(f=>f.type===o[0].type),o),color:d(D)((q=t.value)==null?void 0:q.filter(f=>f.type===o[0].type),o)===!0?`${(b=o[0])==null?void 0:b.color}44`:""},null,8,["model-value","color"]),e("p",Te,a(o[0].type),1),u[1]||(u[1]=e("div",{class:"flex-grow h-px bg-[#e2f0fd]/[0.08]"},null,-1))],8,Ce),(p(!0),w(T,null,S(o,f=>{var M,N;return p(),w("button",{key:f.name,class:"flex flex-grow items-center justify-start gap-3 rounded-md px-2.5",onclick:()=>v(f)},[n(x,{"model-value":(M=t.value)==null?void 0:M.some(L=>L.name===f.name),color:(N=t.value)!=null&&N.some(L=>L.name===f.name)?`${f.color}44`:""},null,8,["model-value","color"]),e("span",{style:P(`background: ${f.color}44`),class:"flex-grow text-sm font-medium text-[#eeecec] rounded-full px-2 w-32 h-5 leading-5 text-center"},a(f.display_name),5)],8,Le)}),128))],64)}),128))])]}),_:1})}}}),Ve={class:"mx-2 flex flex-col overflow-auto rounded-lg outline outline-1 min-w-available min-h-available divide-y divide-auto-12/8 h-inherit outline-auto-alpha-5 max-h-[78vh] min-h-[78vh]"},Se={class:"flex flex-grow-0 items-start justify-start self-stretch rounded-tl-lg rounded-tr-lg w-available"},qe={class:"flex w-full flex-1 gap-4 text-xs font-medium bg-auto-2/10"},Me={class:"relative flex h-11 items-center justify-between gap-3 self-stretch p-3 group/tableButton w-[150px] min-w-[150px]"},Ne={class:"flex w-full flex-col items-start justify-between py-2 bg-auto-1"},Ae=["onClick"],De={class:"relative flex h-11 items-center justify-between gap-3 self-stretch p-3 group/tableButton w-[120px] min-w-[120px]"},Fe={class:"relative flex h-11 items-center justify-between gap-3 self-stretch p-3 group/tableButton w-[120px] min-w-[120px]"},Ie={class:"flex w-full flex-col items-start justify-between py-2 bg-auto-1"},Ue=["onClick"],Oe={class:"relative flex h-11 items-center justify-between gap-3 self-stretch p-3 group/tableButton w-available"},Pe={class:"relative flex h-11 w-20 items-center justify-between gap-3 self-stretch p-3 group/tableButton min-w-20"},ze={class:"overflow-auto divide-y divide-auto-12/5 max-h-available flex-1"},He={class:"flex h-12 w-full flex-1 justify-center gap-4 odd:bg-white/[0.04]"},Ee={class:"relative flex flex-grow items-center justify-start whitespace-nowrap px-3 text-xs line-clamp-1 w-[150px] min-w-[150px]"},Ge={class:"relative flex flex-grow items-center justify-center whitespace-nowrap text-xs line-clamp-1 w-[120px] min-w-[120px]"},Je={class:"relative flex flex-grow items-center justify-start whitespace-nowrap px-3 text-xs line-clamp-1 w-[120px] min-w-[120px]"},Ke=["onClick"],vt=O({__name:"Desktop",setup(m){const r=$([]),_=$([]),t=$([]),v=$(50),y=$([]),i=$(""),u=ne(i,500),{data:x,refetch:h}=A({path:"/dashboard/logs",queryKey:["logs"],refetchInterval:5*60*1e3,data:{limit:v,types:_,levels:t,filter:u}});j(x,l=>{l&&(y.value=l)});const{data:o}=A({path:"/dashboard/logs/types"}),{data:k}=A({path:"/dashboard/logs/levels"});j(v,()=>{h()}),j(u,()=>{h()}),j(k,l=>{l&&(t.value=l)}),j(r,l=>{l&&(_.value=l.map(g=>g.name),h())});function q(l){t.value.includes(l.level)&&(y.value=y.value.slice(0,y.value.length-1),y.value=[l,...y.value])}fe(pe,"NewLog",q),K(()=>{!x.value||!k.value||!r.value||(y.value=x.value,t.value=k.value,h())});const b=$(null),f=$(!1);function M(l){console.log(l),b.value=l,f.value=!0}function N(l){l.stopPropagation(),b.value=null,f.value=!1}function L(){ce().delete("/dashboard/logs").catch(()=>{alert("you'd think this would actually do something huh ðŸ˜‹")}).then(()=>{y.value=[]})}function R(l){t.value.includes(l)?t.value=t.value.filter(g=>g!==l):t.value.push(l),h()}return(l,g)=>{const z=B("Checkbox"),W=B("InputText"),X=B("Button");return p(),V(d(ie),null,{default:c(()=>[n(d(re),{fullscreen:!0},{default:c(()=>[n(de,{"grid-style":4,description:"",title:"Logs"},{cta:c(()=>g[2]||(g[2]=[])),default:c(()=>{var H,E,G;return[e("table",Ve,[e("thead",Se,[e("tr",qe,[e("th",Me,[e("span",null,a(l.$t("Limit"))+" ("+a(v.value)+")",1),n(I,{class:"relative flex items-center justify-center gap-2 rounded-lg transition-colors duration-200 hover:bg-auto-5/6",translate:"translate-x-1/4"},{button:c(()=>[n(U,{"class-name":"w-6",icon:"chevronDown"})]),default:c(()=>[e("div",Ne,[(p(),w(T,null,S([5,10,20,50,100,500,1e3,2e3],s=>e("button",{class:"flex flex-grow items-center justify-start gap-3 rounded-md px-2.5",onClick:C=>v.value=s},[n(z,{"model-value":v.value===s,label:s},null,8,["model-value","label"]),e("span",null,a(s),1)],8,Ae)),64))])]),_:1})]),e("th",De,[e("span",null,a(l.$t("Type")),1),d(o)?(p(),V(Be,{key:0,"selected-types":r.value,"onUpdate:selectedTypes":g[0]||(g[0]=s=>r.value=s),"log-types":d(o),refetch:d(h)},null,8,["selected-types","log-types","refetch"])):F("",!0)]),e("th",Fe,[e("span",null,a(l.$t("Level")),1),n(I,{class:"relative flex items-center justify-center gap-2 rounded-lg transition-colors duration-200 hover:bg-auto-5/6"},{button:c(()=>[n(U,{"class-name":"w-6",icon:"chevronDown"})]),default:c(()=>[e("div",Ie,[(p(!0),w(T,null,S(d(k),s=>{var C;return p(),w("button",{class:"flex flex-grow items-center justify-start gap-3 rounded-md px-2.5",onClick:()=>R(s)},[n(z,{"model-value":(C=t.value)==null?void 0:C.includes(s),label:s},null,8,["model-value","label"]),e("span",null,a(s),1)],8,Ue)}),256))])]),_:1})]),e("th",Oe,[e("span",null,a(l.$t("Message")),1),n(W,{id:"filter",modelValue:i.value,"onUpdate:modelValue":g[1]||(g[1]=s=>i.value=s),variant:"filled",size:"small",class:"mr-auto ml-4 min-w-40",name:"",placeholder:"Filter..."},null,8,["modelValue"])]),e("th",Pe,[n(X,{id:"clear","class-name":"!py-1 !h-8",color:"theme",title:"Clear logs",variant:"text",onClick:L},{default:c(()=>[e("span",null,a(l.$t("clear")),1)]),_:1})])])]),e("tbody",ze,[(p(!0),w(T,null,S(y.value??[],s=>{var C,J;return p(),w("tr",He,[e("td",Ee,a(d(Q)(s.time)),1),e("td",Ge,[e("div",{style:P(`background: ${s.color}55`),class:"h-5 w-min rounded-full px-2 text-center leading-5"},a((J=(C=d(o))==null?void 0:C.find(Z=>Z.name===s.type))==null?void 0:J.display_name),5)]),e("td",Je,a(s.level),1),e("td",{class:"relative flex flex-grow cursor-pointer items-center justify-start whitespace-nowrap px-3 text-xs line-clamp-1 w-available",onClick:()=>M(s)},a(d(Y)(s.message)),9,Ke)])}),256))])]),(H=b.value)!=null&&H.level?(p(),V(be,{key:0,id:(E=b.value)==null?void 0:E.level,close:N,data:b.value,name:(G=b.value)==null?void 0:G.level,open:!0},null,8,["id","data","name"])):F("",!0)]}),_:1})]),_:1})]),_:1})}}});export{vt as default};
