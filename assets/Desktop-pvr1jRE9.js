import{I as _,d as u,o as i,s as t,a as y,c as C,t as c,du as S,R as v,l as g,f as R,j as o,K as d,bu as E,F as q,h as L,n as k,q as h,bh as N,O as b,dv as a,ap as j}from"./index-BlsCkKvU.js";import{u as A}from"./useServerClient-6Bqhc4IC.js";import{_ as I}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-flUV20CT.js";import{_ as K}from"./DashboardCard.vue_vue_type_script_setup_true_lang-BX_unzld.js";import{_ as V}from"./TMDBImage.vue_vue_type_script_setup_true_lang-BloXBgAN.js";import"./useQuery-f3S0rg_a.js";import"./useBaseQuery-z80KnmTz.js";import"./useQueryClient-DkDUGw6x.js";import"./useInfiniteServerClient-BSu1htWg.js";import"./useMounted-saEqA_9z.js";import"./HubConnection-CMQnVIkW.js";import"./FloatingBackButton.vue_vue_type_script_setup_true_lang-BgnfoS3j.js";import"./OptimizedIcon.vue_vue_type_script_setup_true_lang-CcyaU_rN.js";import"./Button.vue_vue_type_script_setup_true_lang-C_oWPest.js";import"./ScrollContainer.vue_vue_type_script_setup_true_lang-xwr-mDAl.js";import"./RipperOverlay.vue_vue_type_script_setup_true_lang-BPZ8n35z.js";import"./ripperSocket-D2R3KSkq.js";import"./AppLogoSquare-BmoFbbIa.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const z={class:"relative flex aspect-video flex-shrink-0 flex-grow-0 flex-col items-center justify-center self-stretch overflow-clip rounded-lg bg-theme-11 dark:bg-theme-8 text-slate-light-12/80 dark:text-slate-dark-12/80"},D={key:1,class:"text-xl font-bold"},F=_({__name:"LibraryCard",props:{data:{type:Object,required:!0}},setup(r){return(l,n)=>(i(),u(K,{route:`/dashboard/libraries/${r.data.id}`,line1:r.data.title,line2:r.data.folder_library&&r.data.folder_library?.length!==1?`${r.data.folder_library?.length} folders`:`${r.data.folder_library?.length}  folder`},{image:t(()=>[y("div",z,[n[0]||(n[0]=y("div",{class:"backdropCard-overlay"},null,-1)),r.data.image?(i(),u(V,{key:0,path:r.data.image,class:"z-0"},null,8,["path"])):(i(),C("span",D,c(r.data.title),1))])]),_:1},8,["route","line1","line2"]))}}),oe=_({__name:"Desktop",setup(r){const l=S(),{data:n,error:x}=A({path:"dashboard/libraries",queryKey:["dashboard","libraries",v.value?.serverBaseUrl]});function w(){b().post("dashboard/libraries").then(({data:e})=>{l.add({severity:e.status==="ok"?"success":"error",summary:a(e.status==="ok"?"Success":"Error"),detail:a(e.message,...e.args),life:5e3}),j.invalidateQueries({queryKey:["dashboard","libraries",v.value?.serverBaseUrl]})})}const s=g(!1);function $(){s.value=!0,b().post("dashboard/libraries/refresh").then(({data:e})=>{s.value=!1,l.add({severity:e.status==="ok"?"success":"error",summary:a(e.status==="ok"?"Success":"Error"),detail:a(e.message,...e.args),life:5e3})}).catch(()=>{s.value=!1,l.add({severity:"error",summary:a("Error"),detail:a("An error occurred while rescanning the libraries"),life:5e3})})}const m=g(!1);function B(){m.value=!0,b().post("dashboard/libraries/rescan").then(({data:e})=>{m.value=!1,l.add({severity:e.status==="ok"?"success":"error",summary:a(e.status==="ok"?"Success":"Error"),detail:a(e.message,...e.args),life:5e3})}).catch(()=>{m.value=!1,l.add({severity:"error",summary:a("Error"),detail:a("An error occurred while rescanning the libraries"),life:5e3})})}return(e,O)=>{const f=R("Button");return i(),u(d(N),null,{default:t(()=>[o(d(E),{fullscreen:!0},{default:t(()=>[o(I,{error:d(x),"grid-style":1,title:"Libraries",description:"Manage your media libraries and their content here."},{cta:t(()=>[o(f,{id:"newLibrary",color:"theme","start-icon":"folderAdd",onClick:w},{default:t(()=>[h(c(e.$t("New library")),1)]),_:1})]),actions:t(()=>[o(f,{id:"refresh",type:"button",variant:"text","start-icon":"folderSwap",disabled:s.value,class:k(s.value?"first:children:animate-spin cursor-not-allowed":""),onClick:$},{default:t(()=>[h(c(e.$t("Refresh all libraries")),1)]),_:1},8,["disabled","class"]),o(f,{id:"rescan",type:"button",variant:"text","start-icon":"folderSwap",disabled:s.value,class:k(s.value?"first:children:animate-spin cursor-not-allowed":""),onClick:B},{default:t(()=>[h(c(e.$t("Rescan all libraries")),1)]),_:1},8,["disabled","class"])]),default:t(()=>[(i(!0),C(q,null,L(d(n)??[],p=>(i(),u(F,{key:p.id,data:p},null,8,["data"]))),128))]),_:1},8,["error"])]),_:1})]),_:1})}}});export{oe as default};
