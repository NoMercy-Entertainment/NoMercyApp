{"version":3,"file":"Mobile-CzKm4rtY.js","sources":["../../src/views/Music/Start/Mobile.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { watch} from 'vue';\nimport { IonPage, IonContent, onIonViewWillEnter } from '@ionic/vue';\n\nimport {getMutating, getMutation, getQuery} from '@/lib/routerHelper';\n\nimport {currentServer} from \"@/store/currentServer\";\nimport {useRoute} from \"vue-router\";\nimport router from \"@/router\";\nimport {setBackground, setColorPalette} from \"@/store/ui\";\n\nconst route = useRoute();\nconst routeName = router.currentRoute.value.name;\n\nconst isMutating = getMutating({ queryKey: ['music', 'home'], path: route.path });\n\nconst { data: homeData, refetch } = getQuery({ queryKey: ['music', 'home'], path: route.path });\n\nconst { data: mutatedData, mutate, reset } = getMutation({ queryKey: ['music', 'home'], homeData: homeData, path: route.path });\n\nonIonViewWillEnter(() => {\n  setColorPalette(null);\n  setBackground(null);\n  \n  if (!homeData.value) {\n    refetch();\n    return;\n  }\n\n  if (route.name !== routeName) return;\n\n  const mutations = homeData.value?.filter?.(item => item?.update?.when == 'pageLoad') ?? [];\n  mutate(mutations);\n});\n\nwatch(currentServer, (value) => {\n  if (!value) {\n    mutatedData.value = undefined;\n    homeData.value = undefined;\n  }\n  else {\n    refetch();\n    reset();\n  }\n});\n\n</script>\n\n<template>\n  <ion-page>\n    <ion-content :fullscreen=\"true\">\n      <template v-if=\"!isMutating && (mutatedData?.every?.(d => d.component) || homeData?.every?.(d => d.component))\">\n        <component v-for=\"(render, index) in mutatedData ?? homeData\" :index=\"index\" :key=\"render.id\"\n                   :is=\"render.component\" v-bind=\"render.props\" />\n      </template>\n    </ion-content>\n  </ion-page>\n</template>\n"],"names":["route","useRoute","routeName","router","isMutating","getMutating","homeData","refetch","getQuery","mutatedData","mutate","reset","getMutation","onIonViewWillEnter","setColorPalette","setBackground","mutations","_b","_a","item","watch","currentServer","value"],"mappings":"2PAWA,MAAMA,EAAQC,EAAS,EACjBC,EAAYC,EAAO,aAAa,MAAM,KAEtCC,EAAaC,EAAY,CAAE,SAAU,CAAC,QAAS,MAAM,EAAG,KAAML,EAAM,KAAM,EAE1E,CAAE,KAAMM,EAAU,QAAAC,GAAYC,EAAS,CAAE,SAAU,CAAC,QAAS,MAAM,EAAG,KAAMR,EAAM,KAAM,EAExF,CAAE,KAAMS,EAAa,OAAAC,EAAQ,MAAAC,CAAA,EAAUC,EAAY,CAAE,SAAU,CAAC,QAAS,MAAM,EAAG,SAAAN,EAAoB,KAAMN,EAAM,KAAM,EAE9H,OAAAa,EAAmB,IAAM,SAInB,GAHJC,EAAgB,IAAI,EACpBC,EAAc,IAAI,EAEd,CAACT,EAAS,MAAO,CACXC,EAAA,EACR,MAAA,CAGF,GAAIP,EAAM,OAASE,EAAW,OAExB,MAAAc,IAAYC,GAAAC,EAAAZ,EAAS,QAAT,YAAAY,EAAgB,SAAhB,YAAAD,EAAA,KAAAC,EAAyBC,GAAQ,OAAA,QAAAD,EAAAC,GAAA,YAAAA,EAAM,SAAN,YAAAD,EAAc,OAAQ,eAAe,CAAC,EACzFR,EAAOM,CAAS,CAAA,CACjB,EAEKI,EAAAC,EAAgBC,GAAU,CACzBA,GAKKf,EAAA,EACFI,EAAA,IALNF,EAAY,MAAQ,OACpBH,EAAS,MAAQ,OAKnB,CACD"}