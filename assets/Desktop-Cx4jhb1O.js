import{$,d as j,w as q,f as z,aG as E,c as J,o as L,l as H,y as W,a0 as V,au as X,i as Y,ar as Z,Q as s}from"./vue-ionic-DNlOg-eX.js";import{g as t}from"./imageModal-C87_bPhe.js";import{S as ee}from"./syncPlugin-DlWfFr6v.js";import{A as oe}from"./autoSkipPlugin-BnD9FITW.js";import"./vendor-C28OoIfY.js";import{u as n,l as ae,k as ne,r as F}from"./index-NjjXUda8.js";import{D as le}from"./desktopUIPlugin-Mn3nehE_.js";import{n as re,O as se}from"./video-player-B6aT_OKA.js";import{K as te}from"./keyHandlerPlugin-Dxxjh9bT.js";import{u as ue}from"./useServerClient-CDyTS9IJ.js";import{V as ie}from"./videoNoMercyConnectPlugin-Cc0KzwWJ.js";import"./media-C2AqgyMX.js";import"./icons-BW5E66pf.js";import"./api-BBofn2cc.js";import"./swiper-D00Cnjmx.js";import"./buttons-DnucOQvv.js";import"./rxjs-BCp2L9Rn.js";import"./music-player-JWnzXDV1.js";import"./baseUIPlugin-VxF8PK2A.js";import"./subtitles-octopus-By2PrHjB.js";import"./useInfiniteServerClient-B3vEkU8Q.js";const Te=$({__name:"Desktop",setup(ce){var i;const{data:K}=ue({enabled:!((i=n.value.features)!=null&&i.nomercyConnect)}),e=j();function u(o){var c,p,m,d,g,f,y,v,P,k,C,b,w,S,M,_,U,I,N,h,x,D,T,A;const l={muted:!1,controls:!1,preload:"auto",debug:!1,autoPlay:!0,playlist:(o==null?void 0:o.filter(a=>!!a.id))??[],controlsTimeout:3e3,doubleClickDelay:300,playbackRates:[.25,.5,.75,1,1.25,1.5,1.75,2],accessToken:(c=n.value)==null?void 0:c.accessToken,basePath:(p=ne.value)==null?void 0:p.serverBaseUrl,forceTvMode:(s("android")||s("ios"))&&!s("mobile"),disableTouchControls:!1,disableMediaControls:"mediaSession"in navigator||s("capacitor"),renderAhead:100,disableAutoPlayback:(m=n.value.features)==null?void 0:m.nomercyConnect};if((d=e.value)==null||d.dispose(),e.value=re("player1").setup(l),(g=e.value)==null||g.once("back",()=>{F.back()}),(f=n.value.features)!=null&&f.nomercyConnect){const a=new ie;(y=e.value)==null||y.registerPlugin("videoNoMercyConnect",a),(v=e.value)==null||v.usePlugin("videoNoMercyConnect")}const O=new le;(P=e.value)==null||P.registerPlugin("desktopUI",O),(k=e.value)==null||k.usePlugin("desktopUI");const G=new oe;(C=e.value)==null||C.registerPlugin("autoSkip",G),(b=e.value)==null||b.usePlugin("autoSkip");const Q=new te;if((w=e.value)==null||w.registerPlugin("keyHandler",Q),(S=e.value)==null||S.usePlugin("keyHandler"),!((M=n.value.features)!=null&&M.nomercyConnect)){const a=new ee;(_=e.value)==null||_.registerPlugin("sync",a),(U=e.value)==null||U.usePlugin("sync")}const R=new se;(I=e.value)==null||I.registerPlugin("octopus",R),(N=e.value)==null||N.usePlugin("octopus"),(h=e.value)==null||h.once("play",()=>{var a;(a=e.value)==null||a.enterFullscreen()}),(x=e.value)==null||x.on("playlistComplete",()=>{console.log("Playlist complete"),F.back()}),(D=e.value)==null||D.on("play",()=>{t(!0)}),(T=e.value)==null||T.on("pause",()=>{t(!1)}),(A=e.value)==null||A.on("fullscreen",a=>{var r,B;(B=(r=window.external)==null?void 0:r.sendMessage)==null||B.call(r,a?"enterFullscreen":"exitFullscreen")})}return q(K,o=>{!o||!o.length||u(o)}),z(()=>{var o;ae.stop(),(o=n.value.features)!=null&&o.nomercyConnect&&u()}),E(()=>{var o;console.log("Unmounting player"),(o=e.value)==null||o.dispose(),t(!1)}),(o,l)=>(L(),J(V(Z),null,{default:H(()=>[W(V(X),{fullscreen:!0},{default:H(()=>l[0]||(l[0]=[Y("div",{id:"player1",class:"group nomercyplayer"},null,-1)])),_:1})]),_:1}))}});export{Te as default};
