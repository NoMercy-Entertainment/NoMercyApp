import{$ as j,a7 as K,C as L,h as w,o as i,i as t,v as b,a0 as S,H as X,F as I,p as P,t as z,c as k,y as h,a as le,b as O,l as C,B as D,d as _,a_ as Q,aU as G,R as M,w as N,j as Y,aZ as R,bj as se,ao as re,au as ae,ar as oe}from"./vue-ionic-Ct1zWn9G.js";import{u as T}from"./useServerClient-CPrJWzOi.js";import{_ as A}from"./Button.vue_vue_type_script_setup_true_lang-CGuznGqP.js";import{A as ne}from"./AppLogo-BVcW5UpX.js";import{cm as ie,t as Z,r as te}from"./index-BFqbVQ32.js";import{_ as ue}from"./Modal.vue_vue_type_script_setup_true_lang-owdQl3vO.js";import{aI as de}from"./vendor-BO8Pa1dw.js";import{i as ce}from"./OptimizedIcon.vue_vue_type_script_setup_true_lang-DUdofUmv.js";import{_ as ee}from"./Button.vue_vue_type_script_setup_true_lang-C21kO0HY.js";import{_ as fe}from"./DeleteEncoderProfileModal.vue_vue_type_script_setup_true_lang-CVPSRCw5.js";import{a as pe,b as me}from"./DeleteLibraryModal.vue_vue_type_script_setup_true_lang-sAcdvVt6.js";import"./media-C2AqgyMX.js";import"./icons-BW5E66pf.js";import"./api-BBofn2cc.js";import"./swiper-D00Cnjmx.js";import"./useInfiniteServerClient-DqQ-M9FJ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./music-player-DBCNDz4q.js";import"./rxjs-BCp2L9Rn.js";import"./ScrollContainer.vue_vue_type_script_setup_true_lang-BNgKgKdG.js";const ve={class:"-mt-12 px-4"},xe={class:"text-xl font-bold text-contrast"},he={"aria-hidden":"true",class:"mt-4"},_e={class:"overflow-hidden rounded-full bg-gray-200"},ye=j({__name:"Stepper",props:{steps:{type:Array,required:!0},currentStep:{type:String,required:!0}},setup(s){const l=s,{t:r}=K(),o=L(()=>{var d;return l.steps?(d=l.steps)==null?void 0:d.indexOf(l.currentStep):0}),e=L(()=>l.steps?(o.value+1)/l.steps.length*100:0);return(d,n)=>(i(),w("div",ve,[t("h4",xe,b(S(r)(s.currentStep)),1),t("div",he,[t("div",_e,[t("div",{style:X(`width: ${e.value}%`),class:"h-1 rounded-full bg-theme-600"},null,4)]),t("div",{style:X(`grid-template-columns: repeat(${s.steps.length}, minmax(0, 1fr))`),class:"mt-6 hidden text-sm font-medium text-auto-600 sm:grid"},[(i(!0),w(I,null,P(s.steps,a=>(i(),w("div",{key:a,class:"text-center"},b(S(r)(a)),1))),128))],4)])]))}}),be={class:"mx-auto grid h-screen place-content-center px-4 sm:px-6 lg:px-8"},ge={class:"mx-auto -mt-24 w-screen max-w-6xl"},ke={class:"flex h-full w-full flex-col gap-4 overflow-hidden p-8 pb-0 min-h-[80vh] max-h-[80vh] h-available"},we={class:"mx-auto h-44 w-auto p-2"},$e={class:"overflow-hidden p-4 h-available"},Se={class:"mt-auto flex h-16 w-full justify-end gap-4 rounded-b-lg p-4 bg-slate-light-1/70 dark:bg-slate-dark-1/70"},Ce=j({__name:"Frame",props:{steps:{type:Array,required:!0},nextButtonLocked:{type:Boolean,default:!1},currentStep:{type:String,required:!0},setCurrentStep:{type:Function,required:!0},finish:{type:Function,required:!0}},setup(s){const l=s,{t:r}=K(),o=L(()=>l.steps.findIndex(a=>a===l.currentStep)===0),e=L(()=>l.steps.findIndex(a=>a===l.currentStep)===l.steps.length-1);function d(){l.steps.findIndex(a=>a===l.currentStep)<l.steps.length-1&&l.setCurrentStep(l.steps[l.steps.findIndex(a=>a===l.currentStep)+1])}function n(){l.steps.findIndex(a=>a===l.currentStep)>0&&l.setCurrentStep(l.steps[l.steps.findIndex(a=>a===l.currentStep)-1])}return T({path:"/dashboard/configuration/languages"}),T({path:"/dashboard/libraries"}),T({path:"/dashboard/encoderProfiles"}),(a,m)=>(i(),w("div",be,[t("div",ge,[t("div",{class:z(["animate-loading","w-full h-full gap-2.5 flex flex-col ml-auto overflow-hidden rounded-xl bg-slate-light-1 dark:bg-slate-dark-1 bg-cover border-2 border-transparent text-start [background:padding-box_var(--bg-color),border-box_var(--border-color)] transition-all duration-300"]),style:{"--bg-color":"linear-gradient(rgb(var(--color-auto-50)), rgb(var(--color-auto-50)))","--border-color":`linear-gradient(var(--angle),
						rgb(var(--color-logo-light) / 0.7) 0%,
						rgb(var(--color-logo-light) / 0.3) 33.33%,
						rgb(var(--color-logo-light) / 0.14) 66.67%,
						rgb(var(--color-logo-light) / 0.1) 100%
					)`}},[t("div",ke,[t("div",we,[h(ne,{class:"pb-8"})]),(i(),k(ye,{key:s.currentStep,"current-step":s.currentStep,steps:s.steps},null,8,["current-step","steps"])),t("div",$e,[le(a.$slots,"default")])]),t("div",Se,[o.value?O("",!0):(i(),k(A,{key:0,id:"yes",class:"ml-auto !w-28",color:"white",type:"button",variant:"text",onClick:n},{default:C(()=>[D(b(S(r)("Back")),1)]),_:1})),e.value?(i(),k(A,{key:1,id:"cancel",disabled:s.nextButtonLocked,class:"!w-28",color:"theme",type:"button",variant:"default",onClick:s.finish},{default:C(()=>[D(b(S(r)("Finish")),1)]),_:1},8,["disabled","onClick"])):(i(),k(A,{key:2,id:"save",disabled:s.nextButtonLocked,class:"!w-28",color:"theme",type:"button",variant:"default",onClick:d},{default:C(()=>[D(b(S(r)("Next")),1)]),_:1},8,["disabled"]))])])])]))}}),je=["innerHTML"],Ve=["xlink:href"],B=j({__name:"MoooomIcon",props:{icon:{type:String,required:!0},className:{type:String,required:!1,default:""}},setup(s){const l=s,r=_(""),o=_(!0),e=L(()=>de("w-6 h-auto aspect-square flex-shrink-0 flex pointer-events-none",l.className));return(d,n)=>!o.value&&r.value?(i(),w("div",{key:0,class:z(e.value),innerHTML:r.value},null,10,je)):(i(),w("svg",{key:1,class:z(e.value)},[t("use",{"xlink:href":`${S(ce)}#${s.icon}`},null,8,Ve)],2))}}),qe={class:"flex flex-col justify-start items-center flex-grow gap-4"},Ne={class:"flex justify-start items-start flex-grow-0 flex-shrink-0 relative gap-2 p-2 rounded-lg"},Le={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-0.5"},Fe={class:"flex justify-start items-start self-stretch flex-grow-0 flex-shrink-0 relative gap-1.5"},Be={class:"flex-grow w-[109.25px] text-base font-medium text-center text-[#eeecec]"},Me=j({__name:"TypeButton",props:{type:{type:Object,required:!0},selected:{type:Boolean,default:!1},className:{type:String,required:!1,default:""}},setup(s){const l=s,r=L(()=>{var e;let o="nomercy";switch((e=l.type)==null?void 0:e.value){case"music":o="noteDouble";break;case"tv":o="tv";break;case"image":o="camera";break;case"movie":o="film";break;default:o="nomercy"}return o});return(o,e)=>(i(),w("div",{class:z(["flex justify-start items-start flex-grow gap-1 px-2 py-4 rounded-xl",{"bg-[#1c172b] outline outline-2 outline-[#7c66dc] hover:bg-[#7452fe]/[0.15]":s.selected,"hover:bg-[#7452fe]/[0.15]":!s.selected}])},[t("div",qe,[t("div",Ne,[h(B,{icon:r.value,"class-name":s.className},null,8,["icon","class-name"])]),t("div",Le,[t("div",Fe,[t("p",Be,b(s.type.name),1)])])])],2))}}),Ie={class:"flex justify-start items-center self-stretch flex-grow-0 flex-shrink-0 gap-2"},De={class:"flex flex-col justify-center items-center flex-grow gap-2"},Te={class:"flex justify-start items-center self-stretch flex-grow-0 flex-shrink-0 h-10 relative overflow-hidden gap-2 pl-3 pr-2.5 py-2.5 rounded-[10px] bg-[#d5feff]/[0.03]"},Oe={class:"flex-grow w-available text-base font-semibold text-left text-[#9ba1a6]"},Ee=j({__name:"FolderItem",props:Q({handleDeleteFolder:{type:Function,required:!0},folder:{type:Object,required:!0},setEncoderQualities:{type:Function,required:!0}},{modelValue:{type:Object,required:!0},modelModifiers:{}}),emits:Q({"update:modelValue":s=>!0},["update:modelValue"]),setup(s,{emit:l}){var g;const r=s,o=G(s,"modelValue"),{data:e}=T({path:"dashboard/encoderProfiles",queryKey:["dashboard","encoderProfiles"]}),d=L(()=>{var v,c,x,V;switch(o.value.type){case"anime":return(v=e.value)==null?void 0:v.filter(p=>p.container==="m3u8").map(p=>M(p));case"movie":return(c=e.value)==null?void 0:c.filter(p=>p.container==="m3u8").map(p=>M(p));case"tv":return(x=e.value)==null?void 0:x.filter(p=>p.container==="m3u8").map(p=>M(p));case"music":return(V=e.value)==null?void 0:V.filter(p=>p.container==="mp3"||p.container==="flac").map(p=>M(p));default:return[]}}),n=_(((g=d.value)==null?void 0:g.filter(v=>{var c;return(c=r.folder.folder.encoder_profiles)==null?void 0:c.some(x=>x.id===v.id)}))??[]);N([d,()=>r.folder.folder.encoder_profiles],([v,c])=>{!v||!c||(n.value=v.filter(x=>c.some(V=>V.id===x.id)))},{deep:!0});function a(v){const c=v.map(x=>M(x));n.value=c,r.setEncoderQualities(M(r.folder),c)}N(o,()=>{d.value&&(n.value=d.value.filter(v=>r.folder.folder.encoder_profiles.some(c=>c.id===v.id)))});const m=_(!1);function u(){m.value=!0}function y(){m.value=!1}return(v,c)=>{var V,p,E;const x=Y("MultiSelect");return i(),w(I,null,[t("div",Ie,[h(x,{id:"encoderProfiles","model-value":n.value,placeholder:"Select",class:"w-[160px]",options:d.value,"option-label":"name","onUpdate:modelValue":a},null,8,["model-value","options"]),t("div",De,[t("div",Te,[t("p",Oe,b(s.folder.folder.path),1),t("button",{onClick:u},[h(B,{icon:"trash","class-name":"w-6 h-6 text-[#9ba1a6] flex-grow-0 flex-shrink-0 cursor-pointer"})])])])]),(V=o.value)!=null&&V.id?(i(),k(fe,{key:0,id:((p=o.value)==null?void 0:p.id)??"",name:((E=o.value)==null?void 0:E.title)??"",close:y,open:m.value},null,8,["id","name","open"])):O("",!0)],64)}}}),Qe={class:"flex flex-col justify-start items-start flex-grow-0 flex-shrink-0 w-full relative gap-8 p-1 px-6"},Ue={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-3"},Ae={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-6"},Pe={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-4"},ze={class:"flex justify-start items-start self-stretch flex-grow-0 flex-shrink-0"},Ke={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-2"},Re={class:"flex justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-2"},He={class:"flex flex-col justify-start items-start flex-grow gap-1.5"},Ge={class:"flex justify-start items-center flex-grow-0 flex-shrink-0 relative gap-px"},Ye={class:"flex-grow-0 flex-shrink-0 text-sm font-medium text-left text-[#eeecec]"},Ze={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-3"},Je={class:"flex justify-start items-center self-stretch flex-grow-0 flex-shrink-0 relative gap-2 rounded"},We={class:"flex-grow w-[501px] text-lg font-medium text-left text-[#eeecec]"},Xe={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-6"},et={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-2"},tt={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-2"},lt={class:"flex justify-start items-center self-stretch flex-grow-0 flex-shrink-0 relative gap-1"},st={class:"flex-grow-0 flex-shrink-0 text-sm text-left text-[#9ba1a6]"},rt={class:"flex w-full justify-end items-start self-stretch flex-grow-0 flex-shrink-0 gap-2 rounded-lg bg-white/[0.04] p-2"},at=j({__name:"EditLibraryModal",props:Q({open:{type:Boolean,required:!0},close:{type:Function,required:!0},id:{type:String,required:!0},noRedirect:{type:Boolean,default:!1}},{modelValue:{type:Object,required:!0},modelModifiers:{}}),emits:Q({"update:modelValue":s=>!0},["update:modelValue"]),setup(s,{emit:l}){var E,J;const r=s,o=l,e=G(s,"modelValue"),d=R(),n=_((E=e.value)==null?void 0:E.title),a=_(((J=e.value)==null?void 0:J.type)??"movie");N(n,f=>{!f||!e.value||(e.value={...e.value,title:f})}),N(a,f=>{!f||!e.value||(e.value={...e.value,type:f})}),N(()=>e.value,f=>{f&&(n.value=f.title,a.value=f.type||"movie",e.value.folder_library||(e.value={...e.value,folder_library:[]}))},{deep:!0});const m=_([]),u=_("/");function y(f){u.value=f}const g=_(!1);function v(){g.value=!0}function c(){g.value=!1,e.value&&!e.value.folder_library&&(e.value={...e.value,folder_library:[]})}function x(){e.value&&(Z().patch(`dashboard/libraries/${e.value.id}`,{...e.value,subtitles:m.value.map(f=>f.iso_639_1),specialSeasonName:e.value.specialSeasonName}).then(()=>{d.invalidateQueries({queryKey:["dashboard","libraries"]}),!r.noRedirect&&te.replace("/dashboard/system/libraries")}),r.close())}function V(f,$){if(!e.value)return;const H=e.value.folder_library.map(F=>F.folder_id===f.folder_id?{...F,folder:{...F.folder,encoder_profiles:$.map(U=>U)}}:F);o("update:modelValue",{...e.value,folder_library:H})}function p(f){e.value&&(e.value={...e.value,folder_library:e.value.folder_library.filter($=>$.folder_id!==f.folder_id)})}return(f,$)=>{const H=Y("InputText");return i(),w(I,null,[h(ue,{id:"editLibraryModal",close:s.close,open:s.open,"max-width":"max-w-[565px]",title:"Edit Library"},{actions:C(()=>[t("div",rt,[h(ee,{id:"save",type:"button",color:"theme",onClick:x},{default:C(()=>[D(b(f.$t("Create library")),1)]),_:1})])]),default:C(()=>{var F,U;return[t("div",Qe,[t("div",Ue,[t("div",Ae,[t("div",Pe,[t("div",ze,[(i(!0),w(I,null,P(S(ie),q=>(i(),k(Me,{key:q.value,type:q,selected:a.value===q.value,"class-name":"size-10",onClick:W=>a.value=q.value},null,8,["type","selected","onClick"]))),128))]),t("div",Ke,[t("div",Re,[t("div",He,[t("div",Ge,[t("p",Ye,b(f.$t("Library Title")),1),$[2]||($[2]=t("p",{class:"flex-grow-0 flex-shrink-0 text-sm font-medium text-left text-[#6e56cf]"}," * ",-1))]),h(H,{id:"title",modelValue:n.value,"onUpdate:modelValue":$[0]||($[0]=q=>n.value=q),class:"w-full",required:""},null,8,["modelValue"])])])])])])]),$[3]||($[3]=t("div",{class:"flex-grow-0 flex-shrink-0 w-10 h-0.5 rounded bg-[#e2f0fd]/[0.08]"},null,-1)),t("div",Ze,[t("div",Je,[t("p",We,b(f.$t("Select one or more folders")),1)]),t("div",Xe,[t("div",et,[t("div",tt,[h(ee,{id:"save",type:"button",color:"slate",class:"w-full flex justify-between","end-icon":"folderAdd",onClick:v},{default:C(()=>[D(b(f.$t("Add folder")),1)]),_:1})]),(F=e.value)!=null&&F.folder_library?(i(!0),w(I,{key:0},P((U=e.value)==null?void 0:U.folder_library,q=>(i(),k(Ee,{key:q.folder_id,modelValue:e.value,"onUpdate:modelValue":$[1]||($[1]=W=>e.value=W),folder:q,"set-encoder-qualities":V,"handle-delete-folder":p},null,8,["modelValue","folder"]))),128)):O("",!0),t("div",lt,[h(B,{icon:"infoCircle","class-name":"w-4 h-4 text-[#9ba1a6] flex-grow-0 flex-shrink-0"}),t("p",st,b(f.$t("You can always add folder and change encoding profiles later")),1)])])])])])]}),_:1},8,["close","open"]),h(pe,{close:c,folder:u.value,open:g.value,"set-folder":y,library:e.value},null,8,["folder","open","library"])],64)}}}),ot={class:"flex h-min children:cursor-default flex-col items-center rounded-lg w-inherit odd:bg-auto-300/20 even:bg-auto-300/0"},nt={class:"flex items-center gap-2 overflow-x-hidden py-2 pr-2 w-inherit overflow-y-show"},it={class:"ml-2 h-auto w-8 p-2 handle"},ut={class:"w-full line-clamp-1"},dt=j({__name:"LibraryItem",props:{modelValue:{type:Object,required:!0},modelModifiers:{}},emits:Q({"update:modelValue":s=>!0},["update:modelValue"]),setup(s){const l=G(s,"modelValue"),r=_(!1);function o(){r.value=!0}function e(){r.value=!1}const d=_(!1);function n(){d.value=!0}function a(){d.value=!1}const m=L(()=>{let u;switch(l.value.type){case"music":u="noteDouble";break;case"tv":u="tv";break;case"image":u="camera";break;case"movie":u="film";break;default:u="nomercy"}return u});return(u,y)=>{var g,v,c;return i(),w("div",ot,[t("div",nt,[t("button",it,[h(B,{icon:"menuDotsVertical",class:"h-6 w-6"})]),h(B,{icon:m.value,class:"h-6 w-6"},null,8,["icon"]),t("span",ut,b((g=l.value)==null?void 0:g.title),1),t("button",{class:"ml-auto flex justify-center items-center h-10 px-2.5 py-2 gap-2 rounded-lg text-sm select-none w-auto font-semibold leading-[100%] transition-all duration-150 button-text hover:outline-[rgba(var(--color-500),.1)] hover:outline-1 hover:outline text-[var(--color-500)]",type:"button",onClick:n},[h(B,{icon:"folderEdit",class:"h-6 w-6"})]),t("button",{class:"ml-auto flex justify-center items-center h-10 px-2.5 py-2 gap-2 rounded-lg text-sm select-none w-auto font-semibold leading-[100%] transition-all duration-150 button-text hover:outline-[rgba(var(--color-500),.1)] hover:outline-1 hover:outline text-[var(--color-500)]",type:"button",onClick:o},[h(B,{icon:"folderRemove",class:"h-6 w-6"})])]),l.value?(i(),k(at,{key:0,id:(v=l.value)==null?void 0:v.id,modelValue:l.value,"onUpdate:modelValue":[y[0]||(y[0]=x=>l.value=x),y[1]||(y[1]=x=>{console.log("emit",x),u.$emit("update:modelValue",x)})],close:a,open:d.value,"no-redirect":""},null,8,["id","modelValue","open"])):O("",!0),l.value?(i(),k(me,{key:1,id:(c=l.value)==null?void 0:c.id,name:l.value.title,close:e,open:r.value,"no-redirect":""},null,8,["id","name","open"])):O("",!0)])}}}),ct={class:"flex flex-col overflow-hidden text-start h-available"},ft={class:"mb-2 text-xl font-semibold"},pt={class:"mb-4 text-sm"},mt={class:"mt-4 flex w-full justify-start"},vt=j({__name:"Libraries",props:{setNextButtonLocked:{type:Function,required:!0}},setup(s){const l=s,{t:r}=K(),o=R(),{data:e}=T({path:"dashboard/libraries"}),d=_(null),n=_(e.value??[]);N(e,u=>{console.log("Libraries updated:",u),u&&(n.value=u,l.setNextButtonLocked((u==null?void 0:u.length)===0))});function a(u){const y=n.value.findIndex(g=>g.id===u.id);y!==-1&&(n.value=[...n.value.slice(0,y),u])}function m(){Z().post("dashboard/libraries").then(()=>{o.invalidateQueries({queryKey:["dashboard","libraries"]})})}return se(d,n,{animation:150,handle:".handle"}),(u,y)=>(i(),w("div",ct,[t("h2",ft,b(S(r)("Organize your media library")),1),t("p",pt,b(S(r)("Add your media libraries to organize your content.")),1),t("div",{ref_key:"el",ref:d,class:"flex h-auto w-full flex-col overflow-y-auto text-start"},[(i(!0),w(I,null,P(n.value,(g,v)=>(i(),k(dt,{key:g.id,modelValue:n.value[v],"onUpdate:modelValue":[c=>n.value[v]=c,y[0]||(y[0]=c=>a(c))]},null,8,["modelValue","onUpdate:modelValue"]))),128))],512),t("div",mt,[h(A,{id:"yes",color:"theme",type:"button",variant:"contained",onClick:m},{default:C(()=>[D(b(S(r)("Add media library")),1)]),_:1})])]))}}),xt=j({__name:"Finish",props:{setNextButtonLocked:{type:Function,required:!0}},setup(s){return K(),R(),(l,r)=>null}}),ht=j({__name:"Name",props:{setNextButtonLocked:{type:Function,required:!0}},setup(s){var a;const l=s,r=R(),{data:o}=T({path:"dashboard/server/info",queryKey:["serverinfo"]}),e=_(((a=o.value)==null?void 0:a.server)??""),d=re(e,500);N(o,m=>{m&&(e.value=m.server)});function n(){Z().patch("dashboard/server/info",{name:d.value}).then(({data:m})=>{r.invalidateQueries({queryKey:["servers"]})})}return N(d,m=>{m&&n()}),N(e,m=>{l.setNextButtonLocked(!m)}),(m,u)=>{const y=Y("Textarea");return i(),k(y,{id:"serverName",modelValue:e.value,"onUpdate:modelValue":u[0]||(u[0]=g=>e.value=g),name:"Give your server a friendly name to help identify it."},null,8,["modelValue"])}}}),Ot=j({__name:"Desktop",setup(s){const l=_(["Name","Media libraries","Finish"]),r=_("Name"),o=_(!1);function e(){console.log("Finish"),te.replace("/")}function d(a){r.value=a}function n(a){o.value=a}return(a,m)=>(i(),k(S(oe),null,{default:C(()=>[h(S(ae),{fullscreen:!0},{default:C(()=>[h(Ce,{"current-step":r.value,finish:e,"next-button-locked":o.value,"set-current-step":d,steps:l.value},{default:C(()=>[r.value==="Name"?(i(),k(ht,{key:0,"set-next-button-locked":n})):r.value==="Media libraries"?(i(),k(vt,{key:1,"set-next-button-locked":n})):r.value==="Finish"?(i(),k(xt,{key:2,"set-next-button-locked":n})):O("",!0)]),_:1},8,["current-step","next-button-locked","steps"])]),_:1})]),_:1}))}});export{Ot as default};
