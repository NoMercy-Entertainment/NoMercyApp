import"./useBaseQuery-BpQmVyGr.js";import{n as K}from"./useInfiniteServerClient-CmF5E4L1.js";import"./useQueryClient-uPahzja3.js";import"./useQuery-Djpo7kUO.js";import{Bs as g,Co as U,Ec as L,Gc as H,Gs as s,Js as f,Ks as x,Lo as M,Ns as C,Oc as N,Pc as m,Qs as S,Vc as c,Wc as P,_c as T,ec as D,fc as R,hc as u,ho as z,qr as G,qs as w,yc as O}from"./index-BK3EmIoe.js";import"./_plugin-vue_export-helper-CEc1WwrB.js";import"./AppLogoSquare-34otkQeb.js";import{t as W}from"./TMDBImage-BobiqGtC.js";import{t as J}from"./useServerClient-tUZ9DQel.js";C();var Q={key:0,class:"grid grid-rows-[auto_1fr] grid-cols-7 relative justify-start flex-1 w-full gap-3 mb-2","data-row":""},X={class:"row-start-1 col-span-7 pointer-events-none font-semibold font-3xl"},Y=D({__name:"TvCarousel2",props:{data:{type:Array,required:!0},title:{type:String,required:!0},handleFocus:{type:Function,required:!0},handleDown:{type:Function,required:!0},handleUp:{type:Function,required:!0},suffix:{type:String,required:!1,default:""}},setup(t){return(v,r)=>{const _=O("RouterLink");return t.data.length?(u(),f("div",Q,[s("h3",X,H(t.title),1),(u(!0),f(g,null,T(t.data.slice(0,7),(o,n)=>(u(),x(_,{key:o.id,"data-card":o.id,"data-index":n,style:P(`background-image: url('https://app.nomercy.tv/tmdb-images${o.poster}?width=300')`),to:`${o.link}${t.suffix}`,class:"row-start-2 w-full h-auto rounded-xl bg-cover aspect-poster focus:scale-105 focus:outline outline-[2.2px] outline-white transition-transform duration-200 scroll-mb-20 scroll-mt-12 snap-center snap-mandatory",onFocus:i=>t.handleFocus(i,o),onKeydown:r[0]||(r[0]=i=>t.handleDown(i)),onKeyup:r[1]||(r[1]=i=>t.handleUp(i))},null,8,["data-card","data-index","style","to","onFocus"]))),128))])):w("",!0)}}}),V=Y;C();var Z={class:"w-available h-auto absolute left-[250px] top-0 overflow-hidden bg-black aspect-video"},ee={class:"flex flex-col justify-start items-start w-[484px] relative left-[58px] top-20 gap-7"},te={class:"flex flex-col justify-start items-start self-stretch relative gap-5"},ae={class:"flex flex-col justify-start items-start w-full relative gap-0"},le=["innerHTML"],re={class:"line-clamp-4 text-sm -mt-4"},se=D({__name:"TvHeader",props:{selected:{type:Object,required:!1}},setup(t){return(v,r)=>(u(),f("div",{key:t.selected?.id,class:"w-full h-full absolute left-0 top-0 bg-[#131314]"},[s("div",Z,[S(W,{alt:t.selected?.title,path:t.selected?.backdrop,size:540,class:"w-available h-available absolute left-[-0.39px] top-[-0.39px] object-cover"},null,8,["alt","path"]),r[0]||(r[0]=s("div",{class:"w-available h-available absolute left-[-0.39px] top-[-0.39px]"},null,-1)),r[1]||(r[1]=s("div",{class:"w-[150vw] h-[150vw] absolute left-[-30%] bottom-[-50%]",style:{background:`radial-gradient(
            closest-side,
            rgba(19, 19, 20, 0.1) 0%,
            rgba(19, 19, 20, 1) 70.73974609375%
          )`}},null,-1))]),s("div",ee,[s("div",te,[s("div",ae,[s("div",{class:"self-stretch w-full text-xl text-left mt-2 flex flex-col",innerHTML:c(G)(t.selected?.title||"","text-lg")},null,8,le)]),s("div",re,H(t.selected?.overview),1)])])]))}}),oe=se;C();var ne={class:"w-screen h-screen relative overflow-hidden bg-[#131314]"},ue=D({__name:"Tv",setup(t){const{data:v,fetchNextPage:r,hasNextPage:_}=K({path:"/",queryKey:["home"]});L(v,()=>{_&&r()});const{data:o}=J({path:"userdata/continue",queryKey:["continue"],refetchInterval:1e3*60*5}),n=m();L(o,e=>{e&&(n.value=e?.filter(l=>l.id)?.at(0))}),R(()=>{n.value=o.value?.filter(e=>e.id)?.at(0),setTimeout(()=>{const e=document.querySelector(`[data-card="${n.value?.id}"]`);e&&e.focus()},1e3)}),M(()=>{n.value=o.value?.filter(e=>e.id)?.at(0),setTimeout(()=>{const e=document.querySelector(`[data-card="${n.value?.id}"]`);e&&e.focus()},1e3)});const i=m(),b=m(!1),A=m(),B=m();function k(e,l){const a=e.target;if(a?.nodeName==="DIV"){(B.value??a.querySelector("a"))?.focus();return}l&&(n.value=l,B.value=a)}function $(e){if(b.value){e.preventDefault();return}clearTimeout(A.value),b.value=!0;const l=e.target,a=l.getAttribute("data-index"),h=l.closest("[data-row]"),d=h?.previousElementSibling,y=d?.querySelector(`a[data-index="${a}"]`),q=h?.nextElementSibling,I=q?.querySelector(`a[data-index="${a}"]`),j=l.previousElementSibling,E=l.nextElementSibling;if(y&&e.key==="ArrowUp")e.preventDefault(),y.focus();else if(I&&e.key==="ArrowDown")e.preventDefault(),I.focus();else if(j&&e.key==="ArrowLeft")e.preventDefault(),j.focus();else if(E&&e.key==="ArrowRight")e.preventDefault(),E.focus();else if(d&&e.key==="ArrowUp"){const p=Array.from(d?.querySelectorAll("a"))?.at(-1);p&&p.focus()}else if(q&&e.key==="ArrowDown"){const p=Array.from(q?.querySelectorAll("a"))?.at(-1);p&&p.focus()}}function F(){A.value=setTimeout(()=>{b.value=!1},150)}return(e,l)=>(u(),x(c(U),null,{default:N(()=>[S(c(z),{fullscreen:!0},{default:N(()=>[s("div",ne,[n.value?(u(),x(oe,{key:0,selected:n.value},null,8,["selected"])):w("",!0),s("div",{ref_key:"scrollContainer",ref:i,class:"flex flex-col justify-start items-start w-available -mx-3 px-3 absolute left-14 right-14 top-[264px] h-available overflow-auto scroll-smooth gap-4 flex-1 pb-16",tabindex:"0",onFocus:l[0]||(l[0]=a=>k(a))},[S(V,{data:c(o)?.filter(a=>!!a.id)??[],"handle-down":$,"handle-focus":k,"handle-up":F,title:"Continue watching"},null,8,["data"]),c(v)?.pages?(u(!0),f(g,{key:0},T(c(v).pages,(a,h)=>(u(),f(g,{key:h},[a?(u(!0),f(g,{key:0},T(a?.data??[],(d,y)=>(u(),x(V,{key:y,data:d.items,"handle-down":$,"handle-focus":k,"handle-up":F,title:d.title,suffix:"/watch"},null,8,["data","title"]))),128)):w("",!0)],64))),128)):w("",!0)],544)])]),_:1})]),_:1}))}}),ge=ue;export{ge as default};
