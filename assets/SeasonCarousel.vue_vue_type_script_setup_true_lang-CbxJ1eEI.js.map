{"version":3,"file":"SeasonCarousel.vue_vue_type_script_setup_true_lang-CbxJ1eEI.js","sources":["../../src/views/Base/Info/components/Trailer.vue","../../src/components/Cards/SeasonCard.vue","../../src/components/Carousel/SeasonCarousel.vue"],"sourcesContent":["<script lang=\"ts\" setup>\nimport { onMounted, onUnmounted, type PropType, ref, toRaw } from 'vue';\n\nimport type { InfoResponse } from '@/types/api/base/info';\n\nimport type { NMPlayer, PlaylistItem, SetupConfig } from '@/lib/VideoPlayer';\nimport { DesktopUIPlugin, KeyHandlerPlugin, nmplayer, } from '@/lib/VideoPlayer';\nimport { closeSidebar, setSidebar, sidebar } from '@/store/sidebar';\nimport { setDisableScreensaver } from '@/store/imageModal';\nimport { musicVisibility } from '@/store/audioPlayer';\nimport { App } from \"@capacitor/app\";\nimport { isNative } from \"@/config/global\";\n\nconst props = defineProps({\n  videos: {\n    type: Array as PropType<InfoResponse['videos']>,\n    required: true,\n  },\n  toggle: {\n    type: Function as PropType<() => void>,\n    required: true,\n  },\n  open: {\n    type: Boolean,\n    required: true,\n  },\n  title: {\n    type: String,\n    required: true,\n  },\n  index: {\n    type: Number,\n    required: true,\n  },\n  incrementTrailerIndex: {\n    type: Function as PropType<() => void>,\n    required: true,\n  },\n});\n\nconst trailerContainer = ref<HTMLElement>();\nconst sidebarState = ref();\n\ninterface MyNmPlayer extends NMPlayer {\n  showInProduction: () => boolean;\n  getPlaylistItem: () => PlaylistItem & {\n    tmdb_id: number,\n    special_id: number,\n    video_type: string,\n    video_id: number;\n  };\n}\n\nconst trailer = ref<MyNmPlayer>();\n\nonMounted(() => {\n  sidebarState.value = sidebar.value;\n\n  closeSidebar();\n\n  setDisableScreensaver(true);\n\n  if (!props.videos[props.index]?.src) return;\n\n  const config: SetupConfig = {\n    muted: false,\n    controls: false,\n    autoPlay: true,\n    chapters: false,\n    preload: 'auto',\n    playlist: [\n      {\n        id: props.videos[props.index].src,\n        image: `https://trailer.nomercy.tv/${props.videos[props.index].src}/${props.videos[props.index].src}.jpg`,\n        file: `https://trailer.nomercy.tv/${props.videos[props.index].src}/${props.videos[props.index].src}.webm`,\n        title: `${props.videos[props.index].name.toLocaleLowerCase().includes(props.title.toLocaleLowerCase())\n          ? ''\n          : `${props.title} - `}${props.videos[props.index].name}`.toTitleCase(),\n        duration: '',\n        description: '',\n        tracks: [\n          {\n            label: 'full',\n            file: `https://trailer.nomercy.tv/${props.videos[props.index].src}/${props.videos[props.index].src}.en.vtt`,\n            language: 'eng',\n            kind: 'subtitles',\n          },\n        ],\n      },\n    ],\n    playbackRates: [],\n  };\n\n  // @ts-ignore\n  trailer.value = nmplayer('trailer')\n    .setup(config);\n\n  trailer.value?.once('back', () => {\n    props.toggle();\n  });\n\n  const desktopUIPlugin = new DesktopUIPlugin();\n  trailer.value?.registerPlugin('desktopUI', desktopUIPlugin);\n  trailer.value?.usePlugin('desktopUI');\n\n  const keyHandlerPlugin = new KeyHandlerPlugin();\n  trailer.value?.registerPlugin('keyHandler', keyHandlerPlugin);\n  trailer.value?.usePlugin('keyHandler');\n\n  // @ts-ignore\n  window.trailer = toRaw(trailer.value);\n\n  trailer.value?.once('ready', () => {\n    if (isNative.value) {\n      trailer.value?.enterFullscreen();\n    }\n  });\n\n  trailer.value?.on('ended', () => {\n\n    setSidebar(sidebarState.value);\n    props.toggle();\n  });\n  trailer.value?.on('remove', () => {\n    props.toggle();\n    props.incrementTrailerIndex();\n  });\n  trailer.value?.on('error', () => {\n    props.toggle();\n  });\n  trailer.value?.on('close', () => {\n    props.toggle();\n  });\n\n  trailer.value?.on('captionsChanged', (item: any) => {\n    if (item.track == -1) {\n      localStorage.setItem('trailerSubtitles', 'off');\n    } else {\n      localStorage.setItem('trailerSubtitles', item.track);\n    }\n  });\n\n  trailer.value?.on('play', () => {\n    if (localStorage.getItem('trailerSubtitles') == 'off') {\n      trailer.value?.setCurrentCaption(-1);\n    } else {\n      trailer.value?.setCurrentCaption(parseInt(localStorage.getItem('trailerSubtitles') ?? '-1', 10));\n    }\n  });\n\n  App.addListener('backButton', props.toggle);\n\n});\n\nonUnmounted(() => {\n  setSidebar(sidebarState.value);\n  setDisableScreensaver(false);\n\n  if (trailer.value) {\n    try {\n      trailer.value?.dispose();\n    } catch (e) {\n      //\n    }\n  }\n});\n\n</script>\n\n<style scoped></style>\n\n<template>\n  <div @click=\"toggle\" class=\"fixed h-full w-full overflow-hidden rounded-lg bg-black/50\">\n    <div :data-music=\"musicVisibility\" :data-sidebar=\"sidebar\" class=\"absolute w-screen h-available sm:w-auto sm:overflow-hidden sm:inset-1/2 sm:aspect-video sm:-translate-y-[50%]\n              sidebar-closed:sm:h-full\n              sidebar-closed:sm:max-w-[90vw]\n              sidebar-closed:sm:max-h-[93%]\n              sidebar-closed:px-4\n              sidebar-closed:py-2\n              sidebar-closed:xl:px-[1.8rem]\n              sidebar-closed:xl:py-4\n\n              sm:-translate-x-[50%]\n              sidebar-open:h-5/6\n              sidebar-open:px-10\n              sidebar-open:py-6\n              sidebar-open:xl:px-[2.8rem]\n              sidebar-open:xl:py-6\n      \">\n      <div ref=\"trailerContainer\" @click=\"(e: MouseEvent) => e.stopPropagation()\"\n        class=\"relative rounded-2xl flex overflow-clip children:overflow-clip h-auto top-1/2 -translate-y-1/2 w-full sm:h-full children:!w-full children:!h-auto children:!aspect-video\">\n        <div id=\"trailer\" class=\"group nomercyplayer\"></div>\n      </div>\n    </div>\n  </div>\n</template>\n","<script setup lang=\"ts\">\nimport { PropType } from 'vue';\n\nimport type { Episode } from '@/types/api/base/info';\n\nimport { scrollIntoView } from '@/lib/utils';\n\nimport { pickPaletteColor } from '@/lib/colorHelper';\nimport TMDBImage from '@/components/Images/TMDBImage.vue';\nimport MoooomIcon from '@/components/Images/icons/MoooomIcon.vue';\n\nconst props = defineProps({\n  data: {\n    type: Object as PropType<Episode>,\n    required: true,\n  },\n  suffix: {\n    type: String,\n    required: false,\n    default: '',\n  },\n});\n\n</script>\n\n<template>\n  <RouterLink v-if=\"data?.id && data?.available\"\n    :class=\"`frosting border-0 border-[rgb(var(--color-focus))] flex flex-col h-auto items-center group/season focus-shift focus-outline transition-all duration-200 overflow-clip relative !rounded-lg select-none shadow-[0px_0px_0_1px_rgb(var(--color-focus,var(--color-theme-6))/70%)] w-full z-0 bg-auto-1/12  text-slate-lightA-12/70  dark:text-slate-darkA-12/80 ${data?.available ? 'cursor-pointer' : 'cursor-not-allowed'}`\"\n    :id=\"data?.id\" :onfocus=\"scrollIntoView()\" :style=\"`--color-focus: ${pickPaletteColor(props.data?.color_palette?.still)\n      .replace(/,/gu, ' ')\n      .replace(')', '')\n      .replace('rgb(', '')};`\" data-card=\"true\" :to=\"data?.available ? data?.link : '#'\">\n    <div\n      class=\"relative mb-1 h-auto w-full overflow-clip rounded-t-md group-focus-visible/season:rounded-b-none group-hover/season:rounded-b-none aspect-backdrop bg-auto-1\">\n      <TMDBImage :path=\"data?.still\" :title=\"data?.title\" :colorPalette=\"data?.color_palette?.still\" class=\"h-40\"\n        :size=\"660\" aspect=\"backdrop\"\n        className=\"pointer-events-none absolute z-20 flex h-full w-full select-none object-cover transitioning trickle-div\"\n        type=\"image\" />\n      <div\n        :class=\"`absolute inset-0 z-30 grid w-full text-white place-items-center group-focus-visible/season:bg-black opacity-0 group-focus-visible/season:opacity-100 transitioning group-hover/season:opacity-100 [background:radial-gradient(75%_50%_at_50%_50%,_rgba(0,_0,_0,_0.40)_0%,_rgba(0,_0,_0,_0.00)_100%),_rgba(0,_0,_0,_0.09)] ${data?.available ? '' : 'hidden'}`\">\n        <div class=\"transitioning hover:scale-110\" style=\"--stroke-width: 1\">\n          <MoooomIcon icon=\"playCircle\" className=\"w-20\" stroke=\"1\" />\n        </div>\n      </div>\n      <div class=\"absolute bottom-0 left-0 z-40 mb-3 w-full px-3\" v-if=\"data?.progress\">\n        <div :id=\"`episode-${data?.id}-slider-container`\"\n          class=\"relative z-40 flex h-1 w-full overflow-clip rounded-full pt-2 pr-8 bg-gray-dark-12\">\n          <div :id=\"`episode-${data?.id}-progress-bar`\"\n            class=\"absolute top-0 left-0 h-full bg-[rgb(var(--color-focus))]\" :style=\"{\n              width: data?.progress >= 99 ? '100%' : `${data?.progress}%`\n            }\"></div>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"grid w-full items-stretch gap-1 rounded-b-md p-2 transitioning text-left\">\n      <p class=\"z-10 w-auto flex-shrink-0 flex-grow-0 self-stretch text-2xs sm:text-sm font-bold !leading-5 h-11 line-clamp-2 sm:line-clamp-1\"\n        :title=\"`${data?.episode_number ? data?.episode_number + ' - ' : ''}${data?.title}`\">\n        {{ data?.episode_number ? data?.episode_number + ' - ' : '' }}{{ data?.title }}\n      </p>\n      <p class=\"z-10 h-8 w-auto flex-shrink-0 flex-grow-0 self-stretch hidden sm:flex text-xs min-h-8 line-clamp-2 leading-[1.2] text-auto-12/80\"\n        :title=\"data?.overview\">\n        {{ data?.overview }}\n      </p>\n    </div>\n  </RouterLink>\n  <div v-else-if=\"data?.id\"\n    :class=\"`border-0 border-[rgb(var(--color-focus))] flex flex-col h-auto items-center group/season focus-shift focus-outline transition-all duration-200 overflow-clip relative !rounded-lg select-none shadow-[0px_0px_0_1px_rgb(var(--color-focus,var(--color-theme-6))/70%)] w-full z-0 bg-auto-1/12 ${data?.available ? 'cursor-pointer' : 'cursor-not-allowed'}`\"\n    @focus=\"scrollIntoView()\" :style=\"`--color-focus: ${pickPaletteColor(props.data?.color_palette?.still)\n      .replace(/,/gu, ' ')\n      .replace(')', '')\n      .replace('rgb(', '')};`\" data-card=\"true\">\n    <div\n      class=\"relative mb-1 h-auto w-full overflow-clip rounded-t-md group-focus-visible/season:rounded-b-none group-hover/season:rounded-b-none aspect-backdrop bg-auto-1\">\n      <TMDBImage :path=\"data?.still\" :title=\"data?.title\" :colorPalette=\"data?.color_palette?.still\" class=\"h-40\"\n        :size=\"660\" aspect=\"backdrop\"\n        className=\"pointer-events-none absolute z-20 flex h-full w-full select-none object-cover transitioning trickle-div\"\n        type=\"image\" />\n      <div\n        :class=\"`absolute inset-0 z-30 grid w-full text-white place-items-center group-focus-visible/season:bg-black opacity-0 group-focus-visible/season:opacity-100 transitioning group-hover/season:opacity-100 [background:radial-gradient(75%_50%_at_50%_50%,_rgba(0,_0,_0,_0.40)_0%,_rgba(0,_0,_0,_0.00)_100%),_rgba(0,_0,_0,_0.09)] ${data?.available ? '' : 'hidden'}`\">\n        <div class=\"transitioning hover:scale-110\" style=\"--stroke-width: 1\">\n          <MoooomIcon icon=\"playCircle\" className=\"w-20\" stroke=\"1\" />\n        </div>\n      </div>\n      <div class=\"absolute bottom-0 left-0 z-40 mb-3 w-full px-3\" v-if=\"data?.progress\">\n        <div :id=\"`episode-${data?.id}-slider-container`\"\n          class=\"relative z-40 flex h-1 w-full overflow-clip rounded-full pt-2 pr-8 bg-gray-dark-12\">\n          <div :id=\"`episode-${data?.id}-progress-bar`\"\n            class=\"absolute top-0 left-0 h-full bg-[rgb(var(--color-focus))]\" :style=\"{\n              width: data?.progress >= 99 ? '100%' : `${data?.progress}%`\n            }\"></div>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"grid w-full items-stretch gap-1 rounded-b-md p-2 transitioning text-left\">\n      <p class=\"z-10 w-auto flex-shrink-0 flex-grow-0 self-stretch text-sm font-bold !leading-5 line-clamp-1\"\n        :title=\"`${data?.episode_number ? data?.episode_number + ' - ' : ''}${data?.title}`\">\n        {{ data?.episode_number ? data?.episode_number + ' - ' : '' }}{{ data?.title }}\n      </p>\n      <p class=\"z-10 h-8 w-auto flex-shrink-0 flex-grow-0 self-stretch text-xs min-h-8 line-clamp-2 leading-[1.2] text-auto-12/80\"\n        :title=\"data?.overview\">\n        {{ data?.overview }}\n      </p>\n    </div>\n  </div>\n</template>\n","<script lang=\"ts\" setup>\nimport { PropType, ref, watch } from 'vue';\nimport { SwiperSlide } from 'swiper/vue';\n\nimport type { Episode, Season } from '@/types/api/base/info';\n\nimport Carousel from '@/components/Carousel/Carousel.vue';\nimport Select from '@/components/Forms/Select.vue';\nimport { Swiper } from 'swiper';\nimport { useTranslation } from 'i18next-vue';\nimport { SwiperContainer } from 'swiper/element/bundle';\nimport SeasonCard from '@/components/Cards/SeasonCard.vue';\n\nconst { t } = useTranslation();\n\nconst props = defineProps({\n  data: {\n    type: Array as PropType<Array<Season>> | undefined,\n    required: true,\n  },\n  type: {\n    type: String as PropType<'poster' | 'backdrop'>,\n    required: false,\n    default: 'poster',\n  },\n  limitCardCountBy: {\n    type: Number,\n    required: false,\n  },\n});\n\nconst handleClick = (item: Episode) => {\n  //\n};\n\nlet index = props.data?.findIndex(s => s.season_number == 1);\nif (index == -1) {\n  index = 0;\n}\n\nconst seasonSelectorData = props.data?.map((s, index: number) => ({\n  index,\n  id: s.id,\n  name: `${s.season_number} - ${s.title}`,\n  season_number: s.season_number,\n  episodes: s.episodes,\n})) ?? [];\n\nconst currentSeason = ref(seasonSelectorData[index]);\n\nconst reset = () => {\n  const swiper: Swiper = document.querySelector<SwiperContainer>('.swiper-undefined')?.swiper as Swiper;\n  swiper?.slideTo(0, 300);\n};\n\nwatch(currentSeason, reset);\n\n</script>\n\n<template>\n  <Carousel :index=\"currentSeason.season_number\" :limitCardCountBy=\"limitCardCountBy\" :type=\"type\">\n    <template v-slot:selector>\n      <Select id=\"season-selector\" v-model=\"currentSeason\" :disabled=\"seasonSelectorData.length == 1\"\n        :items=\"seasonSelectorData\" optionLabel=\"title\" class=\"min-w-[21rem] ml-3\" label=\"\" variant=\"normal\" />\n    </template>\n\n    <swiper-slide v-if=\"currentSeason.episodes?.length == 0\" class=\"flex sm:p-1 sm:pl-0\">\n\n      <SeasonCard id=\"item-0\" :key=\"0\" :data=\"{\n        id: 1,\n        title: t('To be announced'),\n        season_number: null,\n        episode_number: null,\n        available: false,\n        overview: '',\n        airDate: '',\n        still: '',\n        link: '',\n        color_palette: { still: { darkVibrant: '', lightVibrant: '' } },\n        progress: null\n      }\" :onclick=\"() => { }\" />\n\n    </swiper-slide>\n\n    <swiper-slide v-for=\"item in currentSeason.episodes\" v-else :key=\"item.id\" class=\"flex sm:p-1 sm:pl-0\">\n      <SeasonCard :id=\"`item-${item.id}`\" :data=\"item\" :onclick=\"() => handleClick(item as Episode)\" />\n    </swiper-slide>\n  </Carousel>\n</template>\n"],"names":["props","__props","trailerContainer","ref","sidebarState","trailer","onMounted","sidebar","closeSidebar","setDisableScreensaver","_a","config","nmplayer","_b","desktopUIPlugin","DesktopUIPlugin","_c","_d","keyHandlerPlugin","KeyHandlerPlugin","_e","_f","toRaw","_g","isNative","_h","setSidebar","_i","_j","_k","_l","item","_m","App","onUnmounted","useTranslation","handleClick","index","seasonSelectorData","currentSeason","watch","swiper"],"mappings":"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"}