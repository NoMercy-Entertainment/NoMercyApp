import{$ as O,B as ee,k as B,c as V,o as c,p as u,h as g,b as F,j as e,x as a,a0 as p,G as P,z as n,bh as te,A as le,a_ as ae,d as b,aT as se,w as j,f as K,q,F as T,ap as oe,av as ne,as as re}from"./vue-ionic-D4s4ExYp.js";import{u as N}from"./useServerClient-B1iLPo0s.js";import{br as Q,b_ as R,bo as D,bC as ie,a as ue}from"./index-D29s6-I8.js";import{_ as ce,c as de}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-Nn4dwAdV.js";import{u as pe}from"./RipperOverlay.vue_vue_type_script_setup_true_lang-CXq-Wp6k.js";import{_ as I}from"./DropdownMenu.vue_vue_type_script_setup_true_lang-BhiJIgJB.js";import{_ as z}from"./OptimizedIcon.vue_vue_type_script_setup_true_lang-BMWMPBMW.js";import{_ as fe}from"./Modal.vue_vue_type_script_setup_true_lang-FfW6BNHE.js";import{_ as me}from"./ScrollContainer.vue_vue_type_script_setup_true_lang-B9z-yNTL.js";import"./vendor-Dgtccx1h.js";import"./icons-BW5E66pf.js";import"./rxjs-BCp2L9Rn.js";import"./media-C2AqgyMX.js";import"./api-BBofn2cc.js";import"./swiper-D00Cnjmx.js";import"./useInfiniteServerClient-B4MMmB_5.js";import"./music-player-BiOHSPVn.js";import"./primevue-C7GgiIOs.js";import"./useMounted-DYwXa4R_.js";import"./FloatingBackButton.vue_vue_type_script_setup_true_lang-ds0OrJIA.js";import"./Button.vue_vue_type_script_setup_true_lang-CzLYMh2i.js";import"./ripperSocket-wzC5X917.js";import"./Shadow-CECthDCI.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const ve={key:0,class:"my-6 w-full text-sm text-white"},xe={class:"flex h-min w-full flex-1 flex-col justify-center overflow-auto"},he={class:"relative flex flex-grow items-center justify-start gap-2 whitespace-nowrap px-3 text-xs line-clamp-1 w-available"},ye={class:"relative flex flex-grow items-center justify-start gap-2 whitespace-nowrap px-3 text-xs line-clamp-1 w-available"},ge={class:"relative flex flex-grow items-center justify-start gap-2 whitespace-nowrap px-3 text-xs line-clamp-1 w-available"},we={class:"relative flex flex-grow flex-col items-start justify-start gap-4 overflow-clip px-3 text-xs line-clamp-1 w-available max-h-[60vh] whitespace-break-spaces"},_e=O({__name:"LogModal",props:{open:{type:Boolean,required:!0},close:{type:Function,required:!0},id:{type:String,required:!0},name:{type:String,required:!0},data:{type:Object,required:!0}},setup(f){const r=f,w=ee(()=>{if(r.data)try{return JSON.parse(Q(r.data.message))}catch{return r.data.message}});return(t,$)=>{const m=B("Button");return c(),V(fe,{close:f.close,open:!0,"max-width":"max-w-7xl max-h-[80vh]",title:""},{actions:u(()=>[n(m,{id:"no",onclick:f.close,type:"button",color:"auto-alpha",variant:"text"},{default:u(()=>[le(a(t.$t("Close")),1)]),_:1},8,["onclick"])]),default:u(()=>[f.data?(c(),g("div",ve,[e("div",xe,[e("div",he,[e("span",null,a(t.$t("Time"))+":",1),e("span",null,a(p(R)(f.data.time)),1)]),e("div",ye,[e("span",null,a(t.$t("Type"))+":",1),e("span",{class:"h-5 w-20 rounded-full px-2 text-center leading-5",style:P(`background: ${f.data.color}`)},a(f.data.type),5)]),e("div",ge,[e("span",null,a(t.$t("Level"))+":",1),e("span",null,a(f.data.level),1)]),e("div",we,[e("span",null,a(t.$t("Message"))+":",1),n(me,{static:!1},{default:u(()=>[n(p(te),{class:"h-fit",data:w.value},null,8,["data"])]),_:1})])])])):F("",!0)]),_:1},8,["close"])}}}),be={class:"flex flex-col gap-2 overflow-auto py-2 max-h-[60vh]"},$e={class:"-mb-2 flex flex-grow items-center justify-start gap-3 rounded-md px-2.5"},ke={class:"text-center text-xs font-semibold uppercase"},je=["onClick"],Ce={class:"text-center text-xs font-semibold uppercase"},Te=["onclick"],Le=O({__name:"LogTypeSelector",props:ae({refetch:{type:Function,required:!0},logTypes:{type:Array,required:!0}},{selectedTypes:{type:Array,required:!1,default:()=>[]},selectedTypesModifiers:{}}),emits:["update:selectedTypes"],setup(f){const r=f,w=b(!1),t=se(f,"selectedTypes");j(w,v=>{r.logTypes&&console.log("checkboxState",v)}),j(r,()=>{t.value&&(w.value=D(t.value,r.logTypes),r.refetch())}),K(()=>{r.logTypes});function $(v){t.value.some(i=>i.name===v.name)?t.value=t.value.filter(i=>i.name!==v.name):t.value=[...t.value,v]}function m(v){if(!r.logTypes)return;const i=r.logTypes.filter(x=>x.type===v.type);i.every(x=>t.value.some(h=>h.name===x.name))?t.value=t.value.filter(x=>!i.some(h=>h.name===x.name)):t.value=[...t.value,...i]}return(v,i)=>{const x=B("Checkbox");return c(),V(I,{class:"relative flex items-center justify-center gap-2 rounded-lg transition-colors duration-200 hover:bg-auto-5/6"},{button:u(()=>[n(z,{"class-name":"w-6",icon:"chevronDown"})]),default:u(()=>{var h;return[e("div",be,[e("div",$e,[n(x,{modelValue:w.value,"onUpdate:modelValue":i[0]||(i[0]=o=>w.value=o),label:"All"},null,8,["modelValue"]),e("p",ke,a(v.$t("All")),1)]),(c(!0),g(T,null,q(p(ie)(((h=f.logTypes)==null?void 0:h.filter(o=>o.type!=="spacer"))??[],"type"),o=>{var k,S,_;return c(),g(T,{key:o[0].type},[e("div",{class:"relative mt-2 -mb-1 flex items-center justify-start gap-2 self-stretch px-2.5",onClick:()=>m(o[0])},[n(x,{"model-value":p(D)((k=t.value)==null?void 0:k.filter(d=>d.type===o[0].type),o),color:p(D)((S=t.value)==null?void 0:S.filter(d=>d.type===o[0].type),o)===!0?`${(_=o[0])==null?void 0:_.color}44`:""},null,8,["model-value","color"]),e("p",Ce,a(o[0].type),1),i[1]||(i[1]=e("div",{class:"flex-grow h-px bg-[#e2f0fd]/[0.08]"},null,-1))],8,je),(c(!0),g(T,null,q(o,d=>{var M,A;return c(),g("button",{key:d.name,class:"flex flex-grow items-center justify-start gap-3 rounded-md px-2.5",onclick:()=>$(d)},[n(x,{"model-value":(M=t.value)==null?void 0:M.some(L=>L.name===d.name),color:(A=t.value)!=null&&A.some(L=>L.name===d.name)?`${d.color}44`:""},null,8,["model-value","color"]),e("span",{style:P(`background: ${d.color}44`),class:"flex-grow text-sm font-medium text-[#eeecec] rounded-full px-2 w-32 h-5 leading-5 text-center"},a(d.display_name),5)],8,Te)}),128))],64)}),128))])]}),_:1})}}}),Be={class:"mx-2 flex flex-col overflow-auto rounded-lg outline outline-1 min-w-available min-h-available divide-y divide-auto-12/8 h-inherit outline-auto-alpha-5 max-h-[78vh] min-h-[78vh]"},Ve={class:"flex flex-grow-0 items-start justify-start self-stretch rounded-tl-lg rounded-tr-lg w-available"},qe={class:"flex w-full flex-1 gap-4 text-xs font-medium bg-auto-2/10"},Se={class:"relative flex h-11 items-center justify-between gap-3 self-stretch p-3 group/tableButton w-[150px] min-w-[150px]"},Me={class:"flex w-full flex-col items-start justify-between py-2 bg-auto-1"},Ae=["onClick"],Ne={class:"relative flex h-11 items-center justify-between gap-3 self-stretch p-3 group/tableButton w-[120px] min-w-[120px]"},De={class:"relative flex h-11 items-center justify-between gap-3 self-stretch p-3 group/tableButton w-[120px] min-w-[120px]"},Fe={class:"flex w-full flex-col items-start justify-between py-2 bg-auto-1"},Ie=["onClick"],ze={class:"relative flex h-11 items-center justify-between gap-3 self-stretch p-3 group/tableButton w-available"},Oe={class:"relative flex h-11 w-20 items-center justify-between gap-3 self-stretch p-3 group/tableButton min-w-20"},Pe={class:"overflow-auto divide-y divide-auto-12/5 max-h-available flex-1"},Ue={class:"flex h-12 w-full flex-1 justify-center gap-4 odd:bg-white/[0.04]"},Ge={class:"relative flex flex-grow items-center justify-start whitespace-nowrap px-3 text-xs line-clamp-1 w-[150px] min-w-[150px]"},Ee={class:"relative flex flex-grow items-center justify-center whitespace-nowrap text-xs line-clamp-1 w-[120px] min-w-[120px]"},He={class:"relative flex flex-grow items-center justify-start whitespace-nowrap px-3 text-xs line-clamp-1 w-[120px] min-w-[120px]"},Je=["onClick"],ht=O({__name:"Desktop",setup(f){const r=b([]),w=b([]),t=b([]),$=b(50),m=b([]),v=b(""),i=oe(v,500),{data:x,refetch:h}=N({path:"/dashboard/logs",queryKey:["logs"],refetchInterval:5*60*1e3,data:{limit:$,types:w,levels:t,filter:i}});j(x,l=>{l&&(m.value=l)});const{data:o}=N({path:"/dashboard/logs/types"}),{data:k}=N({path:"/dashboard/logs/levels"});j($,()=>{h()}),j(i,()=>{h()}),j(k,l=>{l&&(t.value=l)}),j(r,l=>{l&&(w.value=l.map(y=>y.name),h())});function S(l){t.value.includes(l.level)&&(m.value=m.value.slice(0,m.value.length-1),m.value=[l,...m.value])}pe(de,"NewLog",S),K(()=>{!x.value||!k.value||!r.value||(m.value=x.value,t.value=k.value,h())});const _=b(null),d=b(!1);function M(l){console.log(l),_.value=l,d.value=!0}function A(l){l.stopPropagation(),_.value=null,d.value=!1}function L(){ue().delete("/dashboard/logs").catch(()=>{alert("you'd think this would actually do something huh ðŸ˜‹")}).then(()=>{m.value=[]})}function W(l){t.value.includes(l)?t.value=t.value.filter(y=>y!==l):t.value.push(l),h()}return(l,y)=>{const U=B("Checkbox"),X=B("InputText"),Y=B("Button");return c(),V(p(re),null,{default:u(()=>[n(p(ne),{fullscreen:!0},{default:u(()=>[n(ce,{"grid-style":4,description:"",title:"Logs"},{cta:u(()=>y[2]||(y[2]=[])),default:u(()=>{var G,E,H;return[e("table",Be,[e("thead",Ve,[e("tr",qe,[e("th",Se,[e("span",null,a(l.$t("Limit"))+" ("+a($.value)+")",1),n(I,{class:"relative flex items-center justify-center gap-2 rounded-lg transition-colors duration-200 hover:bg-auto-5/6",translate:"translate-x-1/4"},{button:u(()=>[n(z,{"class-name":"w-6",icon:"chevronDown"})]),default:u(()=>[e("div",Me,[(c(),g(T,null,q([5,10,20,50,100,500,1e3,2e3],s=>e("button",{class:"flex flex-grow items-center justify-start gap-3 rounded-md px-2.5",onClick:C=>$.value=s},[n(U,{"model-value":$.value===s,label:s},null,8,["model-value","label"]),e("span",null,a(s),1)],8,Ae)),64))])]),_:1})]),e("th",Ne,[e("span",null,a(l.$t("Type")),1),p(o)?(c(),V(Le,{key:0,"selected-types":r.value,"onUpdate:selectedTypes":y[0]||(y[0]=s=>r.value=s),"log-types":p(o),refetch:p(h)},null,8,["selected-types","log-types","refetch"])):F("",!0)]),e("th",De,[e("span",null,a(l.$t("Level")),1),n(I,{class:"relative flex items-center justify-center gap-2 rounded-lg transition-colors duration-200 hover:bg-auto-5/6"},{button:u(()=>[n(z,{"class-name":"w-6",icon:"chevronDown"})]),default:u(()=>[e("div",Fe,[(c(!0),g(T,null,q(p(k),s=>{var C;return c(),g("button",{class:"flex flex-grow items-center justify-start gap-3 rounded-md px-2.5",onClick:()=>W(s)},[n(U,{"model-value":(C=t.value)==null?void 0:C.includes(s),label:s},null,8,["model-value","label"]),e("span",null,a(s),1)],8,Ie)}),256))])]),_:1})]),e("th",ze,[e("span",null,a(l.$t("Message")),1),n(X,{id:"filter",modelValue:v.value,"onUpdate:modelValue":y[1]||(y[1]=s=>v.value=s),variant:"filled",size:"small",class:"mr-auto ml-4 min-w-40",name:"",placeholder:"Filter..."},null,8,["modelValue"])]),e("th",Oe,[n(Y,{id:"clear","class-name":"!py-1 !h-8",color:"theme",title:"Clear logs",variant:"text",onClick:L},{default:u(()=>[e("span",null,a(l.$t("clear")),1)]),_:1})])])]),e("tbody",Pe,[(c(!0),g(T,null,q(m.value??[],s=>{var C,J;return c(),g("tr",Ue,[e("td",Ge,a(p(R)(s.time)),1),e("td",Ee,[e("div",{style:P(`background: ${s.color}55`),class:"h-5 w-min rounded-full px-2 text-center leading-5"},a((J=(C=p(o))==null?void 0:C.find(Z=>Z.name===s.type))==null?void 0:J.display_name),5)]),e("td",He,a(s.level),1),e("td",{class:"relative flex flex-grow cursor-pointer items-center justify-start whitespace-nowrap px-3 text-xs line-clamp-1 w-available",onClick:()=>M(s)},a(p(Q)(s.message)),9,Je)])}),256))])]),(G=_.value)!=null&&G.level?(c(),V(_e,{key:0,id:(E=_.value)==null?void 0:E.level,close:A,data:_.value,name:(H=_.value)==null?void 0:H.level,open:!0},null,8,["id","data","name"])):F("",!0)]}),_:1})]),_:1})]),_:1})}}});export{ht as default};
