import{I as K,Z as L,E as f,dk as M,bM as w,w as c,c as v,b as E,K as o,o as l,j as I,dl as S,h as x,d as C,e as V,m as B,F as D,a4 as F}from"./index-BlsCkKvU.js";import{q as y,g as N,a as O,b as j}from"./routerHelper-C0pjLqtA.js";const H={key:0,class:"grid w-available h-available place-items-center"},Q=K({__name:"NMComponent",props:{path:{type:String,required:!1,default:void 0},options:{type:Object,required:!1,default:()=>({keepForever:!0,queryKey:y()})}},setup(g){const s=g,i=s.options.queryKey??y(),h=N({queryKey:i,path:s.path}),{data:t,isLoading:q}=O({queryKey:i,path:s.path}),{data:_,mutate:m}=j({queryKey:i,homeData:t}),a=M(),u=L();function d(){if(!t.value||!a.value)return;const e=t.value.filter(n=>n?.update?.when==="pageLoad")??[];m(e)}function b(){if(!t.value||!a.value)return;const e=t.value.filter(n=>n?.update?.when==="online")??[];m(e)}function p(e){if(!t.value||!a.value)return;const n=t.value.filter(r=>r?.id===e.detail.id)??[];m(n)}return f(()=>{document.addEventListener("mutateId",p),!(!t.value||u.name!=="Home"&&u.name!=="Libraries"&&u.name!=="Music Start")&&a.value&&d()}),w(()=>{document.removeEventListener("mutateId",p)}),c(a,e=>{e&&b()}),c(t,e=>{e&&setTimeout(()=>{document.dispatchEvent(new Event("indexer"))},1e3)}),f(()=>{c(u,(e,n)=>{console.log("onIonViewWillEnter triggered",e.name),!(!t.value||e.name!==F.currentRoute.value.name||e.name!=="Home"&&e.name!=="Libraries"&&e.name!=="Music Start")&&a.value&&d()})}),(e,n)=>o(q)?(l(),v("div",H,[I(o(S),{class:"ion-padding",name:"crescent"})])):!o(h)||!o(a)?(l(!0),v(D,{key:1},x(o(_)??o(t)??[],(r,k)=>(l(),C(V(r?.component),B({key:r.id,index:k},{ref_for:!0},r.props),null,16,["index"]))),128)):E("",!0)}});export{Q as _};
