import{$,c as f,o as l,p as s,j as _,h as B,x as m,d as C,k as R,z as o,a0 as u,av as q,F as L,q as A,v as x,A as v,as as N}from"./vue-ionic-D4s4ExYp.js";import{c as w,a as y,bg as t,B as j}from"./index-D29s6-I8.js";import{u as z}from"./useServerClient-B1iLPo0s.js";import{_ as V}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-Nn4dwAdV.js";import{_ as D}from"./DashboardCard.vue_vue_type_script_setup_true_lang-BBt3Jr4z.js";import{_ as F}from"./TMDBImage.vue_vue_type_script_setup_true_lang-rY4G8dQh.js";import{u as I}from"./primevue-C7GgiIOs.js";import"./vendor-Dgtccx1h.js";import"./icons-BW5E66pf.js";import"./rxjs-BCp2L9Rn.js";import"./media-C2AqgyMX.js";import"./api-BBofn2cc.js";import"./swiper-D00Cnjmx.js";import"./music-player-BiOHSPVn.js";import"./useInfiniteServerClient-B4MMmB_5.js";import"./useMounted-DYwXa4R_.js";import"./FloatingBackButton.vue_vue_type_script_setup_true_lang-ds0OrJIA.js";import"./OptimizedIcon.vue_vue_type_script_setup_true_lang-BMWMPBMW.js";import"./Button.vue_vue_type_script_setup_true_lang-CzLYMh2i.js";import"./ScrollContainer.vue_vue_type_script_setup_true_lang-B9z-yNTL.js";import"./RipperOverlay.vue_vue_type_script_setup_true_lang-CXq-Wp6k.js";import"./ripperSocket-wzC5X917.js";import"./AppLogoSquare-Cg7lwbh7.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const K={class:"relative flex aspect-video flex-shrink-0 flex-grow-0 flex-col items-center justify-center self-stretch overflow-clip rounded-lg bg-theme-11 dark:bg-theme-8 text-slate-light-12/80 dark:text-slate-dark-12/80"},T={key:1,class:"text-xl font-bold"},U=$({__name:"LibraryCard",props:{data:{type:Object,required:!0}},setup(r){return(i,n)=>{var d,c,a;return l(),f(D,{route:`/dashboard/libraries/${r.data.id}`,line1:r.data.title,line2:r.data.folder_library&&((d=r.data.folder_library)==null?void 0:d.length)!==1?`${(c=r.data.folder_library)==null?void 0:c.length} folders`:`${(a=r.data.folder_library)==null?void 0:a.length}  folder`},{image:s(()=>[_("div",K,[n[0]||(n[0]=_("div",{class:"backdropCard-overlay"},null,-1)),r.data.image?(l(),f(F,{key:0,path:r.data.image,class:"z-0"},null,8,["path"])):(l(),B("span",T,m(r.data.title),1))])]),_:1},8,["route","line1","line2"])}}}),fe=$({__name:"Desktop",setup(r){var g;const i=I(),{data:n,error:d}=z({path:"dashboard/libraries",queryKey:["dashboard","libraries",(g=w.value)==null?void 0:g.serverBaseUrl]});function c(){y().post("dashboard/libraries").then(({data:e})=>{var b;i.add({severity:e.status==="ok"?"success":"error",summary:t(e.status==="ok"?"Success":"Error"),detail:t(e.message,...e.args),life:5e3}),j.invalidateQueries({queryKey:["dashboard","libraries",(b=w.value)==null?void 0:b.serverBaseUrl]})})}const a=C(!1);function S(){a.value=!0,y().post("dashboard/libraries/refresh").then(({data:e})=>{a.value=!1,i.add({severity:e.status==="ok"?"success":"error",summary:t(e.status==="ok"?"Success":"Error"),detail:t(e.message,...e.args),life:5e3})}).catch(()=>{a.value=!1,i.add({severity:"error",summary:t("Error"),detail:t("An error occurred while rescanning the libraries"),life:5e3})})}const h=C(!1);function E(){h.value=!0,y().post("dashboard/libraries/rescan").then(({data:e})=>{h.value=!1,i.add({severity:e.status==="ok"?"success":"error",summary:t(e.status==="ok"?"Success":"Error"),detail:t(e.message,...e.args),life:5e3})}).catch(()=>{h.value=!1,i.add({severity:"error",summary:t("Error"),detail:t("An error occurred while rescanning the libraries"),life:5e3})})}return(e,b)=>{const p=R("Button");return l(),f(u(N),null,{default:s(()=>[o(u(q),{fullscreen:!0},{default:s(()=>[o(V,{error:u(d),"grid-style":1,title:"Libraries",description:"Manage your media libraries and their content here."},{cta:s(()=>[o(p,{id:"newLibrary",color:"theme","start-icon":"folderAdd",onClick:c},{default:s(()=>[v(m(e.$t("New library")),1)]),_:1})]),actions:s(()=>[o(p,{id:"refresh",type:"button",variant:"text","start-icon":"folderSwap",disabled:a.value,class:x(a.value?"first:children:animate-spin cursor-not-allowed":""),onClick:S},{default:s(()=>[v(m(e.$t("Refresh all libraries")),1)]),_:1},8,["disabled","class"]),o(p,{id:"rescan",type:"button",variant:"text","start-icon":"folderSwap",disabled:a.value,class:x(a.value?"first:children:animate-spin cursor-not-allowed":""),onClick:E},{default:s(()=>[v(m(e.$t("Rescan all libraries")),1)]),_:1},8,["disabled","class"])]),default:s(()=>[(l(!0),B(L,null,A(u(n)??[],k=>(l(),f(U,{key:k.id,data:k},null,8,["data"]))),128))]),_:1},8,["error"])]),_:1})]),_:1})}}});export{fe as default};
