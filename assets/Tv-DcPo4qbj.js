import"./useBaseQuery-CxayYqx8.js";import{n as W,r as z,t as G}from"./routerHelper-n9EFyUzU.js";import"./useQueryClient-BZNMz1V6.js";import"./useQuery-CqvnrIbp.js";import"./useMutationState-Dbbww25H.js";import{Bs as g,Ci as B,Co as Q,Ec as J,Gc as p,Gs as l,Ho as Z,Js as o,Ks as y,Lo as X,Ns as q,Oc as C,Pc as c,Qs as H,Uo as Y,Vc as h,Wc as ee,Ws as R,Zs as te,_c as S,ec as $,fc as K,hc as r,ho as re,i as V,pc as ae,qs as d,yc as le}from"./index-CzbDenVm.js";import{t as se}from"./_plugin-vue_export-helper-CEc1WwrB.js";import{t as oe}from"./ContentRating-stOFuhaW.js";q();Y();var ne=["src"],ue={class:"flex flex-col justify-end items-start self-stretch flex-grow-0 flex-shrink-0 h-[95px] relative overflow-hidden px-1.5 pt-10 pb-1.5",style:{background:`linear-gradient(
          to bottom,
          rgba(0, 0, 0, 0) 0%,
          rgba(0, 0, 0, 0.24) 25.86%,
          rgba(0, 0, 0, 0.9) 77.75%
        )`}},ie={class:"self-stretch flex-grow-0 flex-shrink-0 w-full text-3xs font-bold text-left text-slate-11 dark:text-slate-11"},ce={class:"self-stretch flex-grow-0 flex-shrink-0 w-full text-[8px] text-left text-[#eff7ff]/[0.62]"},de=$({__name:"TvCard",props:{item:{type:Object,required:!0},index:{type:Number,required:!0},scrollToCenter:{type:Function,required:!0}},setup(e){return(s,f)=>e.item.data?(r(),y(h(Z),{key:0,"data-card":e.item.data,index:e.index,to:e.item.data.link.includes("watch")?e.item.data.link:`${e.item.data.link}/watch`,class:"flex flex-col justify-end relative items-center flex-grow-0 flex-shrink-0 w-full h-auto aspect-poster overflow-hidden rounded bg-cover bg-no-repeat bg-center focus-visible:ring-2 focus-visible:ring-white snap-center pointer-events-auto mr-3 last:mr-0",onFocus:e.scrollToCenter},{default:C(()=>[l("img",{src:`${h(B)?.serverBaseUrl}/images/original${e.item.data.poster}?width=300`,alt:"",class:"w-full h-auto aspect-poster object-cover object-center absolute inset-0",loading:"lazy"},null,8,ne),l("div",ue,[l("p",ie,p(e.item.data.title),1),l("p",ce,p(e.item.data.year),1)])]),_:1},8,["data-card","index","to","onFocus"])):d("",!0)}}),fe=de;q();var ve={key:0,class:"flex flex-col gap-1 w-full"},me={key:0,class:"text-lg font-bold text-slate-1 ml-2"},xe=["data-carousel"],pe=$({__name:"TvCarousel",props:{carousel:{type:Object,required:!0},scrollToCenter:{type:Function,required:!0},scrollIndex:{type:Number,required:!0},setScrollIndex:{type:Function,required:!0},cardsPerScroll:{type:Number,required:!0},unlockKeys:{type:Function,required:!0},index:{type:Number,required:!0},setHasMoreCardsToRight:{type:Function,required:!0}},setup(e){const s=e,f=c();function n(){const u=Array.from(f.value?.querySelectorAll("a")??[]),v=u.filter(x=>x.isVisible()),m=v.at(s.scrollIndex);m?m?.focus():v.length>0?v.at(-1)?.focus():u.at(s.scrollIndex)?.href?(u.at(s.scrollIndex)?.focus(),s.setHasMoreCardsToRight(!0)):(u.at(-1)?.focus(),s.setHasMoreCardsToRight(!0))}function _(){setTimeout(()=>{s.unlockKeys()},200)}const b=c(!1);return K(()=>{setTimeout(()=>{b.value=!0},50*s.index)}),(u,v)=>b.value?(r(),o("div",ve,[e.carousel.title?(r(),o("h3",me,p(e.carousel.title),1)):d("",!0),l("div",{ref_key:"carouselDiv",ref:f,"data-carousel":e.carousel.title,class:"flex flex-nowrap w-full p-1 snap-x snap-mandatory overflow-x-auto pointer-events-none scroll-mr-20",tabindex:"1",onFocus:n},[(r(!0),o(g,null,S(e.carousel.props?.items??[],(m,x)=>(r(),y(fe,{key:m,index:x,item:m,"scroll-to-center":e.scrollToCenter,style:ee(`flex-basis: calc(100% / ${e.cardsPerScroll} - 0.70rem)`),tabindex:"0",onFocus:v[0]||(v[0]=I=>_())},null,8,["index","item","scroll-to-center","style"]))),128))],40,xe)])):d("",!0)}}),he=pe;q();var ye={key:0,class:"w-full h-full absolute right-0 top-0 overflow-hidden bg-black text-surface-12"},ge=["src"],_e={class:"flex flex-col justify-start items-start absolute left-8 gap-5 bottom-4 text-surface-12"},be={class:"flex flex-col justify-start items-start flex-grow-0 flex-shrink-0 relative gap-1"},ke={key:0,class:"flex items-center gap-2 text-xs font-medium text-left"},we={class:"text-3xs"},Te={class:"text-2xl text-left line-clamp-1 w-4/5"},Ce={class:"line-clamp-5 text-xs w-3/6"},qe={class:"flex justify-center items-center flex-grow-0 flex-shrink-0 relative"},$e=$({__name:"TvHomeCard",props:{carousel:{type:Object,required:!0},items:{type:Array,required:!0}},setup(e){return(s,f)=>{const n=le("RouterLink");return r(),o(g,null,[e.carousel?.props?.data?(r(),o("div",ye,[l("img",{src:`${h(B)?.serverBaseUrl}/images/original${e.carousel?.props?.data?.backdrop}`,alt:"",class:"w-available h-auto absolute inset-0 left-40 object-scale-down"},null,8,ge),f[0]||(f[0]=l("div",{class:"absolute bottom-0 w-full h-[200%]",style:{"flex-shrink":"0",background:`radial-gradient(
          87.82% 267.96% at 92.04% -27%,
          rgba(19, 19, 20, 0.1) 34%,
          #131314 70.74%
        )`}},null,-1))])):d("",!0),l("div",_e,[l("div",be,[e.carousel.props.data?.content_ratings?(r(),o("div",ke,[H(oe,{ratings:e.carousel.props.data?.content_ratings},null,8,["ratings"]),l("span",we,"( "+p(e.carousel.props.data?.year)+" )",1)])):d("",!0),l("p",Te,p(e.carousel.props?.data?.title),1),l("p",Ce,p(e.carousel.props?.data?.overview),1)]),l("div",qe,[e.carousel.props?.data?.link?(r(),y(n,{key:0,id:"watch_now",to:e.carousel.props?.data?.link,class:"flex-grow-0 flex-shrink-0 px-4 py-2 rounded-3xl bg-surface-4 focus-visible:ring-[3px] ring-inset focus-visible:ring-focus",tabindex:"0"},{default:C(()=>[te(p(s.$t("Watch Now")),1)]),_:1},8,["to"])):d("",!0)])])],64)}}}),Ie=$e;q();var Ne={key:0,id:"container",class:"flex flex-col gap-8 pt-24 pb-4"},je=$({__name:"Tv",setup(e){const s=V.currentRoute.value.name,f=G(),{data:n}=z({path:"/libraries/tv",queryKey:["libraries","tv"]}),{data:_,mutate:b}=W({homeData:n,queryKey:["libraries","tv"]});V.beforeEach(async t=>{if(!n.value||t.name!==s)return;const i=n.value?.filter?.(a=>a?.update?.when==="pageLoad")??[];b(i)}),J(n,t=>{t&&I("#watch_now")});const u=c(),v=c(),m=c(7),x=c();function I(t){const i=document.querySelector(t);i&&(i.focus(),x.value?.$el?.scrollToTop(0),u.value?.classList.remove("opacity-[0.001]"),j())}function E(){x.value?.$el?.scrollToBottom(0),x.value?.$el?.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"}),u.value?.classList.add("opacity-[0.001]"),v.value?.querySelector("[data-card]")?.focus()}X(()=>{setTimeout(()=>{u.value?.focus()},1e3)});const k=c(0);function F(t){k.value=t}const w=c(!1);function A(t){w.value=t}function O(t){document.activeElement?.scrollIntoView({behavior:"smooth",block:"center",inline:k.value===2||w.value?"center":void 0}),setTimeout(()=>{const i=t.target?.getAttribute("index")?.toInt()??0,a=t.target.closest("[data-carousel]");a.dataset.focussedIndex=i.toString();const T=a.querySelectorAllArray("a").filter(U=>U.isVisible()).indexOf(t.target);k.value!==T&&(w.value=!0),F(T),i>a.childNodes.length-m.value&&(w.value=!1)},400)}const L=c(),N=c(!1);function j(){clearTimeout(L.value),N.value=!1}function D(t){if(t.target.dataset.card){if(N.value)t.preventDefault();else{N.value=!0;return}L.value=setTimeout(()=>{j()},200)}}K(()=>{document.addEventListener("keydown",D)}),ae(()=>{document.removeEventListener("keydown",D)});const P=R(()=>(_.value??n.value)?.filter(t=>t.component==="NMHomeCard")??[]),M=R(()=>(_.value??n.value)?.filter(t=>t.component==="NMCarousel")??[]);return(t,i)=>(r(),y(h(Q),null,{default:C(()=>[H(h(re),{ref_key:"content",ref:x,fullscreen:!0},{default:C(()=>[h(f)?d("",!0):(r(),o("div",Ne,[l("div",{ref_key:"top",ref:u,class:"flex items-center mx-12 w-available min-h-[60vh] relative overflow-hidden rounded-2xl border-2 border-slate-9 transition-opacity duration-200",tabindex:"0",onFocus:i[0]||(i[0]=a=>I("#watch_now"))},[(r(!0),o(g,null,S(P.value,a=>(r(),y(Ie,{key:a.props.title,carousel:a,items:a.props.items},null,8,["carousel","items"]))),128))],544),M.value.length>0?(r(),o("div",{key:0,ref_key:"bottom",ref:v,class:"mx-11 flex flex-col justify-start items-start w-available gap-5 h-[calc(100vh-6rem)] overflow-auto",tabindex:"0",onFocus:E},[h(f)?d("",!0):(r(!0),o(g,{key:0},S(M.value,(a,T)=>(r(),o(g,{key:a.props.title},[a.props.items.length>0?(r(),y(he,{key:0,"cards-per-scroll":m.value,carousel:a,index:T,"scroll-index":k.value,"scroll-to-center":O,"set-has-more-cards-to-right":A,"set-scroll-index":F,"unlock-keys":j},null,8,["cards-per-scroll","carousel","index","scroll-index"])):d("",!0)],64))),128))],544)):d("",!0)]))]),_:1},512)]),_:1}))}}),He=se(je,[["__scopeId","data-v-ce561e90"]]);export{He as default};
