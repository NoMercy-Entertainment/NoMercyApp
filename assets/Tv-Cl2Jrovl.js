import{$ as F,k as z,h as p,o as n,b as q,c as b,j as c,x as D,F as v,q as S,G as P,T as R,z as A,w as V,d as g,f as M,aM as G,p as K,a0 as w,av as H,as as O}from"./vue-ionic-D4s4ExYp.js";import{u as W}from"./useServerClient-B1iLPo0s.js";import{u as J}from"./useInfiniteServerClient-B4MMmB_5.js";import{_ as Q}from"./TMDBImage.vue_vue_type_script_setup_true_lang-rY4G8dQh.js";import"./vendor-Dgtccx1h.js";import"./icons-BW5E66pf.js";import"./rxjs-BCp2L9Rn.js";import"./media-C2AqgyMX.js";import"./api-BBofn2cc.js";import"./swiper-D00Cnjmx.js";import"./index-D29s6-I8.js";import"./music-player-BiOHSPVn.js";import"./primevue-C7GgiIOs.js";import"./AppLogoSquare-Cg7lwbh7.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const X={key:0,"data-row":"",class:"grid grid-rows-[auto_1fr] grid-cols-7 relative justify-start flex-1 w-full gap-3 mb-2"},Y={class:"row-start-1 col-span-7 pointer-events-none font-semibold font-3xl"},Z=["src"],L=F({__name:"TvCarousel2",props:{data:{type:Array,required:!0},title:{type:String,required:!0},handleFocus:{type:Function,required:!0},handleDown:{type:Function,required:!0},handleUp:{type:Function,required:!0},suffix:{type:String,required:!1,default:""}},setup(r){return(y,u)=>{var d;const m=z("RouterLink");return n(),p(v,null,[r.data.length?(n(),p("div",X,[c("h3",Y,D(r.title),1),(n(!0),p(v,null,S(r.data.slice(0,7),(a,h)=>(n(),b(m,{key:a.id,to:`${a.link}${r.suffix}`,"data-card":a.id,"data-index":h,class:"row-start-2 w-full h-auto rounded-xl bg-cover aspect-poster focus:scale-105 focus:outline outline-[2.2px] outline-white transition-transform duration-200 scroll-mb-20 scroll-mt-12 snap-center snap-mandatory",style:P(`background-image: url('https://app.nomercy.tv/tmdb-images${a.poster}?width=300&type=avif&aspect_ratio=null')`),onFocus:i=>r.handleFocus(i,a),onKeydown:u[0]||(u[0]=i=>r.handleDown(i)),onKeyup:u[1]||(u[1]=i=>r.handleUp(i))},null,8,["to","data-card","data-index","style","onFocus"]))),128))])):q("",!0),(n(),b(R,{to:".image-preload-container"},[(n(!0),p(v,null,S((d=r.data)==null?void 0:d.slice(0,7),a=>(n(),p("img",{key:a.id,src:`https://app.nomercy.tv/tmdb-images${a.backdrop}`,width:"0",height:"0",loading:"eager",alt:"",class:"absolute"},null,8,Z))),128))]))],64)}}}),ee={class:"w-available h-auto absolute left-[250px] top-0 overflow-hidden bg-black aspect-video"},te={class:"flex flex-col justify-start items-start w-[484px] relative left-[58px] top-20 gap-7"},ae={class:"flex flex-col justify-start items-start self-stretch relative gap-5"},le={class:"flex flex-col justify-start items-start w-full relative gap-0"},oe={class:"self-stretch w-full text-xl text-left mt-2"},se={class:"line-clamp-4 text-sm -mt-4"},re=F({__name:"TvHeader",props:{selected:{type:Object,required:!1}},setup(r){return(y,u)=>{var m,d,a,h,i;return n(),p("div",{key:(m=r.selected)==null?void 0:m.id,class:"w-full h-full absolute left-0 top-0 bg-[#131314]"},[c("div",ee,[A(Q,{class:"w-available h-available absolute left-[-0.39px] top-[-0.39px] object-cover",path:(d=r.selected)==null?void 0:d.backdrop,size:1080,alt:(a=r.selected)==null?void 0:a.title},null,8,["path","alt"]),u[0]||(u[0]=c("div",{class:"w-available h-available absolute left-[-0.39px] top-[-0.39px]"},null,-1)),u[1]||(u[1]=c("div",{class:"w-[150vw] h-[150vw] absolute left-[-30%] bottom-[-50%]",style:{background:`radial-gradient(
            closest-side,
            rgba(19, 19, 20, 0.1) 0%,
            rgba(19, 19, 20, 1) 70.73974609375%
          )`}},null,-1))]),c("div",te,[c("div",ae,[c("div",le,[c("p",oe,D((h=r.selected)==null?void 0:h.title),1)]),c("div",se,D((i=r.selected)==null?void 0:i.overview),1)])])])}}}),ne={class:"w-screen h-screen relative overflow-hidden bg-[#131314]"},_e=F({__name:"Tv",setup(r){const{data:y,fetchNextPage:u,hasNextPage:m}=J({path:"/",queryKey:["home"]});V(y,()=>{m&&u()});const{data:d}=W({path:"userdata/continue",queryKey:["continue"],refetchInterval:1e3*60*5}),a=g();V(d,e=>{var l;e&&(a.value=(l=e==null?void 0:e.filter(t=>t.id))==null?void 0:l.at(0))}),M(()=>{var e,l;a.value=(l=(e=d.value)==null?void 0:e.filter(t=>t.id))==null?void 0:l.at(0),setTimeout(()=>{var o;const t=document.querySelector(`[data-card="${(o=a.value)==null?void 0:o.id}"]`);t&&t.focus()},1e3)}),G(()=>{var e,l;a.value=(l=(e=d.value)==null?void 0:e.filter(t=>t.id))==null?void 0:l.at(0),setTimeout(()=>{var o;const t=document.querySelector(`[data-card="${(o=a.value)==null?void 0:o.id}"]`);t&&t.focus()},1e3)});const h=g(),i=g(!1),C=g(),B=g();function $(e,l){var o;const t=e.target;if((t==null?void 0:t.nodeName)==="DIV"){(o=B.value??t.querySelector("a"))==null||o.focus();return}l&&(a.value=l,B.value=t)}function T(e){var N,U;if(i.value){e.preventDefault();return}clearTimeout(C.value),i.value=!0;const l=e.target,t=l.getAttribute("data-index"),o=l.closest("[data-row]"),s=o==null?void 0:o.previousElementSibling,k=s==null?void 0:s.querySelector(`a[data-index="${t}"]`),f=o==null?void 0:o.nextElementSibling,_=f==null?void 0:f.querySelector(`a[data-index="${t}"]`),I=l.previousElementSibling,E=l.nextElementSibling;if(k&&e.key==="ArrowUp")e.preventDefault(),k.focus();else if(_&&e.key==="ArrowDown")e.preventDefault(),_.focus();else if(I&&e.key==="ArrowLeft")e.preventDefault(),I.focus();else if(E&&e.key==="ArrowRight")e.preventDefault(),E.focus();else if(s&&e.key==="ArrowUp"){const x=(N=Array.from(s==null?void 0:s.querySelectorAll("a")))==null?void 0:N.at(-1);x&&x.focus()}else if(f&&e.key==="ArrowDown"){const x=(U=Array.from(f==null?void 0:f.querySelectorAll("a")))==null?void 0:U.at(-1);x&&x.focus()}}function j(){C.value=setTimeout(()=>{i.value=!1},150)}return(e,l)=>(n(),b(w(O),null,{default:K(()=>[A(w(H),{fullscreen:!0},{default:K(()=>{var t,o;return[c("div",ne,[a.value?(n(),b(re,{key:0,selected:a.value},null,8,["selected"])):q("",!0),c("div",{ref_key:"scrollContainer",ref:h,tabindex:"0",class:"flex flex-col justify-start items-start w-available -mx-3 px-3 absolute left-14 right-14 top-[264px] h-available overflow-auto scroll-smooth gap-4 flex-1 pb-16",onFocus:l[0]||(l[0]=s=>$(s))},[A(L,{title:"Continue watching",data:((t=w(d))==null?void 0:t.filter(s=>!!s.id))??[],"handle-focus":$,"handle-down":T,"handle-up":j},null,8,["data"]),(o=w(y))!=null&&o.pages?(n(!0),p(v,{key:0},S(w(y).pages,(s,k)=>(n(),p(v,{key:k},[s?(n(!0),p(v,{key:0},S((s==null?void 0:s.data)??[],(f,_)=>(n(),b(L,{key:_,title:f.title,data:f.items,"handle-focus":$,"handle-down":T,"handle-up":j,suffix:"/watch"},null,8,["title","data"]))),128)):q("",!0)],64))),128)):q("",!0)],544)])]}),_:1})]),_:1}))}});export{_e as default};
