import{Gt as l,Ln as w,Lt as B,Mt as M,Rt as f,Tt as T,Vn as p,Vt as V,Wt as v,cn as q,dn as N,kn as a,n as R,qt as L,xn as r,yn as O}from"./index-BVMfOxho.js";import{o as j}from"./ui-FAE7KUbU.js";import{t as z}from"./currentServer-wKQllb71.js";import{s as A}from"./user-CWo_OqEw.js";import{t as D}from"./fileupload-CaQfK8Tn.js";import{t as m}from"./Button-gEqDWnkH.js";import{t as F}from"./Modal-BAtA_bet.js";T();var E={class:"opacity-0 duration-150 transition-all group-hover/cover:opacity-100 group-hover/cover:bg-black/40 inset-0 absolute grid items-center text-lg font-semibold"},G=L({__name:"ClickUploadModal",props:{data:{type:Object,required:!0},url:{type:String,required:!0}},setup(g){const t=g,_=a(null),n=a(!1),s=a(t.data);function u(){n.value=!1}function h(){n.value=!0}const b=R(),i=a(),k=a(),o=a(t.data.cover),c=a(!0),C=B(()=>`${z.value?.serverApiUrl}${t.url}`);function U(){i.value.upload(),c.value=!0}function y(e){b.add({severity:"info",summary:"Success",detail:"File Uploaded",life:3e3});const{data:d}=JSON.parse(e.xhr.response);o.value=d.url,j(d.color_palette?.cover),u()}function S(e){o.value=e.files[0].objectURL,c.value=!1}function $(e){e.xhr.setRequestHeader("Authorization",`Bearer ${A.value.accessToken}`)}function x(){o.value=t.data.cover,i.value.clear(),u()}return O(o,e=>{s.value={...s.value,cover:e}}),(e,d)=>(q(),V(M,null,[f("button",{id:"uploadDialogTrigger",ref_key:"trigger",ref:_,class:"contents",onClick:h},[N(e.$slots,"default",{ref:k.value,data:s.value}),f("div",E,p(e.$t("Change cover")),1)],512),l(F,{close:u,open:n.value,"max-width":"max-w-2xl",title:"Upload image"},{actions:r(()=>[l(m,{id:"upload",color:"white",variant:"text",onClick:x},{default:r(()=>[v(p(e.$t("Cancel")),1)]),_:1}),l(m,{id:"upload",disabled:c.value,color:"theme",onClick:U},{default:r(()=>[v(p(e.$t("Save")),1)]),_:1},8,["disabled"])]),default:r(()=>[l(w(D),{ref_key:"fileUpload",ref:i,"cancel-label":e.$t("Cancel"),"choose-label":e.$t("Choose image"),"max-file-size":2*1024*1024,url:C.value,accept:"image/*",class:"p-button-outlined",mode:"basic",name:"image","with-credentials":"",onSelect:S,onUpload:y,onBeforeSend:$},null,8,["cancel-label","choose-label","url"])]),_:1},8,["open"])],64))}}),X=G;export{X as t};
