import{$ as M,d as _,w as I,f as N,aH as U,c as x,o as D,p as k,z as H,a0 as C,av as T,j as A,as as B,Q as r}from"./vue-ionic-D4s4ExYp.js";import{g as c}from"./imageModal-DHrF4kx7.js";import{S as V}from"./syncPlugin-BiBpkLfF.js";import{A as F}from"./autoSkipPlugin-HJbAPkkG.js";import"./vendor-Dgtccx1h.js";import{q as s,t as K,c as O,r as l}from"./index-D29s6-I8.js";import{D as j}from"./desktopUIPlugin-CJu2Srfl.js";import{n as q,O as z}from"./video-player-B2yH_Yz-.js";import{K as Q}from"./keyHandlerPlugin-BB4c_yFY.js";import{u as R}from"./useServerClient-B1iLPo0s.js";import{V as $}from"./videoNoMercyConnectPlugin-Gr4fpOEm.js";import"./media-C2AqgyMX.js";import"./icons-BW5E66pf.js";import"./api-BBofn2cc.js";import"./swiper-D00Cnjmx.js";import"./buttons-DnucOQvv.js";import"./rxjs-BCp2L9Rn.js";import"./music-player-BiOHSPVn.js";import"./primevue-C7GgiIOs.js";import"./baseUIPlugin-BS3doDHP.js";import"./subtitles-octopus-By2PrHjB.js";import"./useInfiniteServerClient-B4MMmB_5.js";const ge=M({__name:"Desktop",setup(E){var p;const{data:i}=R({enabled:!((p=s.value.features)!=null&&p.nomercyConnect)}),e=_();function u(o){var m,d,f,g,y,v;const a={muted:!1,controls:!1,preload:"auto",debug:!1,autoPlay:!0,playlist:(o==null?void 0:o.filter(n=>!!n.id))??[],controlsTimeout:3e3,doubleClickDelay:300,playbackRates:[.25,.5,.75,1,1.25,1.5,1.75,2],accessToken:(m=s.value)==null?void 0:m.accessToken,basePath:(d=O.value)==null?void 0:d.serverBaseUrl,forceTvMode:(r("android")||r("ios"))&&!r("mobile"),disableTouchControls:!1,disableMediaControls:"mediaSession"in navigator||r("capacitor"),renderAhead:100,disableAutoPlayback:(f=s.value.features)==null?void 0:f.nomercyConnect};if((g=e.value)==null||g.dispose(),e.value=q("player1").setup(a),e.value.once("back",()=>{history.state.back?l.back():l.replace("/")}),(y=s.value.features)!=null&&y.nomercyConnect){const n=new $;e.value.registerPlugin("videoNoMercyConnect",n),e.value.usePlugin("videoNoMercyConnect")}const b=new j;e.value.registerPlugin("desktopUI",b),e.value.usePlugin("desktopUI");const w=new F;e.value.registerPlugin("autoSkip",w),e.value.usePlugin("autoSkip");const S=new Q;if(e.value.registerPlugin("keyHandler",S),e.value.usePlugin("keyHandler"),!((v=s.value.features)!=null&&v.nomercyConnect)){const n=new V;e.value.registerPlugin("sync",n),e.value.usePlugin("sync")}const h=new z;e.value.registerPlugin("octopus",h),e.value.usePlugin("octopus"),e.value.once("play",()=>{e.value.enterFullscreen()}),e.value.on("playlistComplete",()=>{console.log("Playlist complete"),history.state.back?l.back():l.replace("/")}),e.value.on("play",()=>{c(!0)}),e.value.on("pause",()=>{c(!1)}),e.value.on("fullscreen",n=>{var t,P;(P=(t=window.external)==null?void 0:t.sendMessage)==null||P.call(t,n?"enterFullscreen":"exitFullscreen")})}return I(i,o=>{o!=null&&o.length&&u(o)}),N(()=>{var o,a;K.stop(),(o=s.value.features)!=null&&o.nomercyConnect?u():(a=i.value)!=null&&a.length&&u(i.value)}),U(()=>{var o;(o=e.value)==null||o.dispose(),c(!1)}),(o,a)=>(D(),x(C(B),null,{default:k(()=>[H(C(T),{fullscreen:!0},{default:k(()=>a[0]||(a[0]=[A("div",{id:"player1",class:"group nomercyplayer"},null,-1)])),_:1})]),_:1}))}});export{ge as default};
