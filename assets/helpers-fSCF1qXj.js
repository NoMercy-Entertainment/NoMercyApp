var f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function s(e){console.error(e)}s.prototype=new Error;s.prototype.name="InvalidCharacterError";function u(e=""){const r=String(e).replace(/[=]+$/u,"");if(r.length%4===1)throw new s("'atob' failed: The string to be decoded is not correctly encoded.");let t=0,n=0,i=0,o="";for(let a;a=r.charAt(i++);~a&&(n=t%4?n*64+a:a,t++%4)&&(o+=String.fromCharCode(255&n>>(-2*t&6))))a=f.indexOf(a);return o}var l=typeof window<"u"&&window.atob&&window.atob.bind(window)||u;function p(e){return decodeURIComponent(l(e).replace(/(.)/gu,(r,t)=>{let n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n=`0${n}`),`%${n}`}))}function h(e){let r=e.replace(/-/gu,"+").replace(/_/gu,"/");switch(r.length%4){case 0:break;case 2:r+="==";break;case 3:r+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return p(r)}catch{return l(r)}}function c(e){console.error(e)}c.prototype=new Error;c.prototype.name="InvalidTokenError";function g(e,r){if(typeof e!="string")throw new c("Invalid token specified: must be a string");r=r||{};const t=r.header===!0?0:1,n=e.split(".")[t];if(typeof n!="string")throw new c(`Invalid token specified: missing part #${t+1}`);let i;try{i=h(n)}catch(o){throw new c(`Invalid token specified: invalid base64 for part #${t+1} (${o.message})`)}try{return JSON.parse(i)}catch(o){throw new c(`Invalid token specified: invalid json for part #${t+1} (${o.message})`)}}function d(e){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~";let t="";for(let n=0;n<e;n++)t+=r.charAt(Math.floor(Math.random()*66));return t}async function w(e){const r=new TextEncoder().encode(e),t=await window.crypto.subtle?.digest("SHA-256",r);if(!t)return"";const n=Array.from(new Uint8Array(t));return b(n)}function b(e){return btoa(String.fromCharCode.apply(null,e)).replace(/\+/gu,"-").replace(/\//gu,"_").replace(/[=]/gu,"")}async function y(){const e=d(40),r=d(128);sessionStorage.setItem("state",e),sessionStorage.setItem("code_verifier",r);const t=await w(r);return{state:e,codeVerifier:r,codeChallenge:t}}function m(e){return g(e)}export{m as a,y as i,w as n,d as r,b as t};
