import{Bn as te,Bt as o,Gt as u,I as K,Ln as t,Lt as E,M as Q,Mt as Z,Rn as k,Rt as r,Tt as L,Vn as y,Vt as v,Wt as J,an as ae,cn as i,fn as X,kn as z,mt as w,qt as j,un as re,xn as b,yn as B,zt as n}from"./index-C8wrpkyN.js";import{L as ie,S as le,V as se,l as D,m as $,n as ne,p as P,u as oe,x as de}from"./ui-BWVnjNNY.js";import{g as A}from"./client-BmAhQ-69.js";import{D as _,E as S,o as I}from"./currentServer-B_KQACAB.js";import{f as N}from"./global-WVsx5src.js";import{s as ue}from"./user-CXzDmTwG.js";import{l as q,x as ce}from"./router-I2PvuKTp.js";import{N as me,Z as fe,c as pe,g as H,k as V,l as p}from"./SocketClient-CeGi9Yeo.js";import{a as he}from"./contextMenuItems-BAxEuer3.js";import{t as ge}from"./_plugin-vue_export-helper-pDp7unP0.js";import{t as R}from"./MoooomIcon-un4l75-N.js";import{t as ve}from"./DropdownMenu-CZfoN-P5.js";import{n as ye}from"./dist-Dd_BbWhG.js";import{t as M}from"./CoverImage-CcRvdF9S.js";import{t as ke}from"./MusicButton-yLkQD0Gb.js";import{t as xe}from"./BannerButton-B2nPYdxM.js";import{t as Y}from"./MediaLikeButton-DVyfvAKN.js";import{t as O}from"./PlayerIcon-B_LEyqNM.js";import{t as G}from"./Marquee-WbcysVQu.js";import{n as be,t as F}from"./BigPlayButton-l6keFQVr.js";import{n as U,t as we}from"./EqSpinner-DO4w_JXh.js";import{t as W}from"./ShareButton-CcLOsF80.js";import{t as _e}from"./ClickUploadModal-Bofg3J3p.js";L();Q();var Se={class:"flex sm:gap-4 items-center py-4 px-4 sm:px-8 w-full pl-3 pr-4 sm:pr-10 h-20 z-40","data-index":"1"},Ce={class:"relative hidden h-fit cursor-pointer items-center justify-center focus-within:text-surface sm:flex mr-auto"},$e=["value"],Te={class:"absolute top-2 right-2 bottom-2 flex items-center justify-center"},Ee=j({__name:"ControlHeader",props:{data:{type:Object,required:!1},filter:{type:String,required:!0}},emits:["filter-change"],setup(e){const s=e,m=K();function l(){p.setQueue(s.data?.tracks??[])}const g=E(()=>({title:s.data?.name??"",url:`https://app.nomercy.tv${m.fullPath}`}));return(f,x)=>(i(),v(Z,null,[x[1]||(x[1]=r("div",{class:"pointer-events-none absolute z-0 h-96 w-full"},null,-1)),r("div",Se,[e.data?.tracks?(i(),n(F,{key:0,data:e.data,class:"hidden sm:flex"},null,8,["data"])):o("",!0),r("div",Ce,[r("input",{id:"search",value:e.filter,class:"bg-transparent border-surface-12/5 border-2 rounded-md focus-visible:!border-surface-12/9 focus-visible:text-current placeholder-current p-2",name:"search",placeholder:"Filter…",type:"text",onInput:x[0]||(x[0]=C=>f.$emit("filterChange",C.target?.value))},null,40,$e),r("div",Te,[u(R,{class:"!w-7",icon:"searchMagnifyingGlass"})])]),u(W,{"share-data":g.value,class:"!p-0 hidden sm:flex sm:ml-auto"},null,8,["share-data"]),u(Y,{data:e.data,"class-name":"!w-8 !h-8",color:"var(--color-theme-8)"},null,8,["data"]),u(W,{class:"!p-0 sm:hidden"}),t(ce)?(i(),n(ke,{key:1,id:"add",onclick:l,class:"",label:"Add"},{default:b(()=>[u(R,{class:"!w-7",icon:"add"})]),_:1})):o("",!0)]),r("div",{class:k([{"top-11":!t(w)("capacitor"),"top-10":t(w)("capacitor")},"sm:hidden sticky left-full -mt-16 z-1199 flex justify-center items-center gap-2 mr-4 h-auto"]),style:{"box-shadow":"0 1px 2px 0 rgba(16, 24, 40, 0.05)"}},[e.data?.tracks?(i(),n(F,{key:0,data:e.data},null,8,["data"])):o("",!0)],2)],64))}}),$t=Ee;L();var Re={key:0,class:"relative my-4 flex w-full flex-1 flex-shrink-0 flex-col items-start justify-start gap-4 flex-grow-1 sm:hidden"},Le=["innerHTML"],je={class:"relative hidden flex-1 flex-shrink-0 flex-col items-start justify-start gap-1 flex-grow-1 sm:flex"},qe={class:"text-left font-semibold uppercase"},ze=["innerHTML"],Be={class:"relative flex items-center justify-start gap-2"},Pe={key:0,class:"flex items-center gap-4 text-sm font-medium"},Ae={key:0,class:"relative aspect-square h-12 w-12 overflow-clip rounded-full min-w-12"},He={key:1,class:"text-left text-sm font-medium"},Me={class:"text-left text-sm font-medium"},De={key:2,class:"text-left text-sm font-medium"},Ie={class:"text-left text-sm font-medium"},Ne=j({__name:"ArtistHeader",props:{data:{type:Object,required:!1}},setup(e){const s=e,{t:m}=ye(),l=z(""),g=z(),f=z();function x(a){if(a)return de(m,a?.tracks?.map(h=>le(h.duration)).reduce((h,d)=>h+d,0)??0)}B(s,a=>{a&&(l.value=x(a.data))}),ae(()=>{l.value=x(s.data)}),B(g,a=>{if(!a)return;const h=a.getContext("2d",{willReadFrequently:!0,desynchronized:!0}),d=()=>{const c=p._audioElement1?.motion?.canvas;c&&f.value&&(p._audioElement1.isPlaying()?(p._audioElement1?.motion.registerGradient("theme",{bgColor:"transparent",dir:"h",colorStops:[getComputedStyle(f.value).backgroundColor]}),p._audioElement1.motion.gradient="theme",a.width=c.width,a.height=c.height,h.clearRect(0,0,a.width,a.height),h.drawImage(c,0,0,a.width,a.height)):p._audioElement2.isPlaying()&&(p._audioElement2?.motion.registerGradient("theme",{bgColor:"transparent",dir:"h",colorStops:[getComputedStyle(f.value).backgroundColor]}),p._audioElement2.motion.gradient="theme",a.width=c.width,a.height=c.height,h.clearRect(0,0,a.width,a.height),h.drawImage(c,0,0,a.width,a.height))),requestAnimationFrame(d)};d()}),B(f,a=>{!a||!p._audioElement1?.motion||!p._audioElement2?.motion||(p._audioElement1?.motion.registerGradient("theme",{bgColor:"transparent",dir:"h",colorStops:[getComputedStyle(a).backgroundColor]}),p._audioElement1.motion.gradient="theme",p._audioElement2?.motion.registerGradient("theme",{bgColor:"transparent",dir:"h",colorStops:[getComputedStyle(a).backgroundColor]}),p._audioElement2.motion.gradient="theme")});const C=E(()=>se(ie(ne.value),150));return(a,h)=>{const d=X("RouterLink");return i(),v("div",{id:"artist-header",class:k([{"pt-safe-offset-16 px-8 gap-4":t(w)("capacitor"),"pt-24 px-6 gap-2 sm:gap-12":!t(w)("capacitor"),"text-black/12":C.value,"text-white/12":!C.value},"relative z-0 flex flex-col items-end justify-start sm:flex-row sm:gap-9 sm:pt-8 sm:pb-8 sm:px-8"])},[r("div",{id:"audio-color",ref_key:"audioColor",ref:f,class:"absolute top-0 left-0 h-full w-full overflow-clip bg-focus",style:{background:"hsl(from var(--color-theme-8) h s 32%)"}},null,512),h[0]||(h[0]=r("div",{class:"absolute top-0 left-0 h-full w-full overflow-clip"},null,-1)),r("canvas",{id:"audio-visualizer",ref_key:"canvas",ref:g,class:"absolute top-0 left-96 my-12 ml-6 mr-6 mt-full h-available w-available overflow-clip pointer-events-none"},null,512),r("div",{class:k([{"-mt-4":t(w)("capacitor"),"":!t(w)("capacitor")},"frosting relative mx-auto group/cover flex aspect-square w-80 overflow-clip max-w-[90%] flex-col items-center justify-center rounded-xl bg-gradient-to-br min-w-64 bg-theme-6 from-theme-5 via-theme-6 to-theme-9 shadow"])},[e.data?(i(),n(_e,{key:0,data:e.data,url:`${e.data.link}/cover`},{default:b(({data:c,ref:ee})=>[c?.cover?(i(),n(M,{key:0,id:"image",data:c,"img-ref":ee,size:250,"class-name":"aspect-square rounded-xl w-full",loading:"eager"},null,8,["data","img-ref"])):c?.id?(i(),n(be,{key:1,id:c.id,type:c.type,class:"aspect-square rounded-xl w-full"},null,8,["id","type"])):o("",!0)]),_:1},8,["data","url"])):o("",!0)],2),e.data?.name?(i(),v("div",Re,[r("div",{class:"w-full text-2xl font-semibold whitespace-pre-line",innerHTML:t(I)(e.data?.name??"Songs you like","text-sm line-clamp-1")},null,8,Le)])):o("",!0),r("div",je,[r("p",qe,y(e.data?.type?.replace(/s$/u,"")),1),r("div",{class:"w-full text-5xl font-semibold line-clamp-2 leading-[130%] whitespace-pre",innerHTML:t(I)(e.data?.name??"Songs you like","text-2xl line-clamp-1")},null,8,ze),r("div",Be,[e.data?.artists?.length?(i(),v("div",Pe,[e.data?.artists?.[0].cover?(i(),v("div",Ae,[u(M,{id:"image",data:e.data?.artists?.[0],size:250,"class-name":"h-full w-full",loading:"eager"},null,8,["data"])])):o("",!0),u(d,{to:e.data?.artists?.[0].link??"#",class:"text-sm empty:hidden"},{default:b(()=>[J(y(e.data?.artists?.[0]?.name??"Various artists"),1)]),_:1},8,["to"])])):o("",!0),e.data?.tracks?(i(),v("p",He," • ")):o("",!0),r("p",Me,y(e.data?.tracks?.length)+" "+y(e.data?.tracks?.length===1?t(m)("song"):t(m)("songs")),1),l.value?(i(),v("p",De," • ")):o("",!0),r("p",Ie,y(l.value),1)])])],2)}}}),Tt=Ne;L();var Ve=["onclick"],Oe={class:""},Ge=j({__name:"SortButton",props:{name:{type:String,required:!0},sortingType:{type:String,required:!0},iconSpacer:{type:String,default:""}},setup(e){function s(l){console.log("handleSortChange",l),$.value===l?D(P.value===S.asc?S.desc:S.asc):D(S.asc),oe(l)}function m(l){const g=l.target;if(l.key==="ArrowUp"){const f=g.parentElement?.parentElement?.previousElementSibling;f&&f.nodeName==="BUTTON"||f.nodeName==="A"?f.focus():document.querySelector("#playList")?.focus()}else l.key==="ArrowDown"?g.parentElement?.parentElement?.nextElementSibling?.focus():l.key==="ArrowLeft"?g.previousElementSibling?.focus():l.key==="ArrowRight"&&g.nextElementSibling?.focus()}return(l,g)=>(i(),v("button",{onclick:()=>s(e.sortingType),onkeyup:m,class:"relative cursor-pointer items-center focus-visible:underline focus-visible:underline-offset-2","no-ring":""},[r("span",Oe,y(l.$t(e.name)),1),t(P)===t(S).asc&&t($)===e.sortingType&&t($)!==t(_).index?(i(),n(R,{key:0,class:k(`w-6 h-6 ${e.iconSpacer}`),icon:"chevronUp"},null,8,["class"])):t(P)===t(S).desc&&t($)===e.sortingType&&t($)!==t(_).index?(i(),n(R,{key:1,class:k(`w-6 h-6 ${e.iconSpacer}`),icon:"chevronDown"},null,8,["class"])):o("",!0)],8,Ve))}}),T=Ge;L();var Fe=j({__name:"SortHeader",setup(e){return(s,m)=>(i(),v("div",{id:"sortHeaderElement",class:k([{"top-safe-offset-[4rem]":t(w)("capacitor"),"top-safe-offset-16":!t(w)("capacitor")},"sticky -mx-4 px-4 z-30 mt-4 block h-10 content-center items-center justify-start self-stretch bg-transparent text-sm font-medium transition-all duration-200 w-available group/track sm:w-available sm:-top-px"])},[m[0]||(m[0]=r("span",{id:"sorterChild",class:"absolute inset-0 h-10 sm:rounded-t-2xl overflow-clip w-full transition-all duration-200"},null,-1)),r("span",{class:k([{"album-grid":t(q),"artist-grid":!t(q)},"grid justify-start items-center self-stretch pr-3 sm:px-3 rounded-lg group/track text-sm font-medium py-2 z-0 group/track gap-2"])},[u(T,{id:"sortIndex","aria-label":s.$t("Sort by index"),"sorting-type":t(_).index,class:"!flex justify-center","icon-spacer":"absolute left-6",name:"#"},null,8,["aria-label","sorting-type"]),u(T,{"aria-label":s.$t("Sort by name"),"sorting-type":t(_).name,class:"flex sm:flex","icon-spacer":"w-6 h-6",name:"Title"},null,8,["aria-label","sorting-type"]),u(T,{"aria-label":s.$t("Sort by album"),class:k([{"opacity-0":!t(q),"opacity-100":t(q)},"!hidden sm:!flex"]),"sorting-type":t(_).album,"icon-spacer":"w-6 h-6",name:"Album"},null,8,["aria-label","class","sorting-type"]),u(T,{"aria-label":s.$t("Sort by date"),"sorting-type":t(_).date,class:"!hidden sm:!flex","icon-spacer":"w-6 h-6",name:"Release date"},null,8,["aria-label","sorting-type"]),u(T,{"aria-label":s.$t("Sort by duration"),"sorting-type":t(_).duration,class:"!hidden sm:!flex gap-2 flex-row-reverse pr-[4.5rem]","icon-spacer":"w-6 h-6",name:"Duration"},null,8,["aria-label","sorting-type"])],2)],2))}}),Et=ge(Fe,[["__scopeId","data-v-c3e4ca4e"]]);L();Q();var Ue=["data-track-id"],We={class:"flex justify-center text-center"},Ke={key:0,class:"group-focus-visible/track:sm:hidden group-hover/track:sm:hidden"},Qe={class:"flex h-12 items-center gap-2 overflow-hidden w-available sm:gap-4"},Ze={class:"flex h-full flex-col justify-evenly overflow-clip w-inherit"},Je={class:"flex h-6 flex-nowrap overflow-clip text-left line-clamp-1 w-inherit tracking-wide leading-6 px-2 py-1 -ml-2"},Xe=["data-size"],Ye={class:"flex whitespace-nowrap"},et={class:"hidden sm:flex invisible max-h-12 md:visible"},tt={class:"hidden sm:flex mr-4 monospace sm:mr-0"},at=j({__name:"TrackRow",props:{data:{type:Object,required:!0},index:{type:Number,required:!0},displayList:{type:Array,required:!0}},setup(e){const s=e,m=K(),l=E(()=>m.path.startsWith("/music/album")||m.path.startsWith("/music/tracks")),g=E(()=>m.path.startsWith("/music/artist"));function f(){if(!ue.value.features?.nomercyConnect){pe.playTrack(s.data,s.displayList);return}fe.value?.invoke("StartPlaybackCommand",l.value?"album":"artist",l.value?s.data?.album_track.at(0)?.id:s.data?.artist_track.at(0)?.id,s.data.id)}const x=E(()=>!s.data?.date||!A?.language||A.language==="undefined"?null:new Date(s.data.date).toLocaleDateString(A?.language??"en-US",{year:"numeric",month:"long",day:"2-digit"}));return(C,a)=>{const h=X("RouterLink");return i(),v("button",{class:k([{"album-grid":l.value,"artist-grid":!l.value},"grid justify-start children:pointer-events-none items-center self-stretch pr-3 sm:px-3 rounded-lg sm:hover:bg-surface-6/8 group/track text-sm font-medium py-2 z-10"]),"data-track-id":e.data?.id,onclick:f,"data-target":"track",tabindex:"0",onContextmenu:a[1]||(a[1]=d=>t(he)(d,e.data))},[r("span",We,[t(H)?.id!==e.data.id?(i(),v("span",Ke,y(e.index+1),1)):o("",!0),t(H)?.id===e.data.id?(i(),n(we,{key:1,playing:t(V),class:"hidden group-focus-visible/track:sm:!hidden group-hover/track:sm:!hidden",color:"var(--color-theme-8)"},null,8,["playing"])):o("",!0),t(H)?.id===e.data.id&&t(V)?(i(),n(O,{key:2,class:"hidden h-6 w-6 group-focus-visible/track:sm:block group-hover/track:sm:block",icon:"nmPause"})):(i(),n(O,{key:3,class:"hidden h-6 w-6 group-focus-visible/track:sm:block group-hover/track:sm:block",icon:"nmPlay"}))]),r("span",Qe,[l.value?(i(),n(M,{key:0,data:e.data,size:100,style:te({display:l.value?"none":""}),"class-name":"relative hidden h-12 w-12 overflow-hidden min-w-[3rem] sm:block",loading:"eager"},null,8,["data","style"])):o("",!0),r("span",Ze,[r("span",Je,y(e.data.name),1),r("span",{"data-size":t(me),class:"inline-flex h-6 w-available gap-1 overflow-hidden whitespace-nowrap text-slate-3 dark:slate-dark-3 line-clamp-1 text-2xs hover:animate-pause leading-6"},[u(G,null,{default:b(()=>[e.data&&!g.value?(i(),n(U,{key:0,id:e.data.id,data:e.data.artist_track,onclick:d=>d.stopPropagation(),"data-target":"artist",type:"artists"},null,8,["id","data","onclick"])):o("",!0),e.data&&!l.value?(i(),n(U,{key:1,id:e.data.id,data:e.data.album_track,onclick:d=>d.stopPropagation(),"data-target":"album",type:"albums"},null,8,["id","data","onclick"])):o("",!0)]),_:1})],8,Xe)])]),(i(!0),v(Z,null,re(e.data.album_track,d=>(i(),n(G,{key:d.id},{default:b(()=>[r("button",{class:k([{"opacity-0":!l.value,"opacity-100":l.value},"hidden items-center overflow-clip pr-2 line-clamp-2 h-inherit w-inherit sm:flex"]),onClick:a[0]||(a[0]=c=>c.stopPropagation())},[u(h,{to:d?.link,class:"flex items-center gap-1 whitespace-nowrap font-semibold line-clamp-1 hover:underline focus:underline dark:font-medium pointer-events-auto","data-target":"album","no-ring":"",tabindex:"0"},{default:b(()=>[r("span",Ye,y(d.name),1)]),_:2},1032,["to"])],2)]),_:2},1024))),128)),r("span",et,y(x.value),1),r("span",{class:k([{"mr-16":!t(N)},"flex items-center justify-end gap-2 text-end"])},[(i(),n(Y,{key:e.data.id+e.data?.favorite,data:e.data,color:"var(--color-theme-8)","no-background":""},null,8,["data"])),r("span",tt,y(e.data.duration),1),t(N)?(i(),n(ve,{key:0,direction:"down"},{button:b(()=>[u(xe,{class:"",title:""},{default:b(()=>[u(R,{"class-name":"relative h-5 w-5",icon:"menuDotsVertical"})]),_:1})]),default:b(()=>[a[2]||(a[2]=J(" Hellooo ",-1))]),_:1})):o("",!0)],2)],42,Ue)}}}),Rt=at;export{$t as i,Et as n,Tt as r,Rt as t};
