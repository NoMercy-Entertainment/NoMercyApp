import{I as v,ag as o,l as y,w as P,E as k,ah as b,bM as C,d as w,o as S,s as c,j as h,K as p,bu as M,a as _,bh as I,S as s,R as N,a4 as t}from"./index-BlsCkKvU.js";import{g as i}from"./imageModal-zqT0KAAe.js";import{S as U,O as x}from"./octopusPlugin-gyjHnMFk.js";import{A as D}from"./autoSkipPlugin-BrLb25Qa.js";import{n as T}from"./subtitles-octopus-Bdu7PkFC.js";import{D as A}from"./desktopUIPlugin-6g1P5VRl.js";import{K as B}from"./keyHandlerPlugin-sTbkxDPj.js";import{u as H}from"./useServerClient-6Bqhc4IC.js";import{V}from"./videoNoMercyConnectPlugin-DCLsHrt2.js";import"./buttons-IwPh3z7u.js";import"./useQuery-f3S0rg_a.js";import"./useBaseQuery-z80KnmTz.js";import"./useQueryClient-DkDUGw6x.js";import"./useInfiniteServerClient-BSu1htWg.js";const Z=v({__name:"Desktop",setup(F){const{data:r}=H({enabled:!o.value.features?.nomercyConnect}),e=y();function u(l){const n={muted:!1,controls:!1,preload:"auto",debug:!1,autoPlay:!0,playlist:l?.filter(a=>!!a.id)??[],controlsTimeout:3e3,doubleClickDelay:300,playbackRates:[.25,.5,.75,1,1.25,1.5,1.75,2],accessToken:o.value?.accessToken,basePath:N.value?.serverBaseUrl,forceTvMode:(s("android")||s("ios"))&&!s("mobile"),disableTouchControls:!1,disableMediaControls:"mediaSession"in navigator||s("capacitor"),renderAhead:100,disableAutoPlayback:o.value.features?.nomercyConnect};if(e.value?.dispose(),e.value=T("player1").setup(n),e.value.once("back",()=>{history.state.back?t.back():t.replace("/")}),o.value.features?.nomercyConnect){const a=new V;e.value.registerPlugin("videoNoMercyConnect",a),e.value.usePlugin("videoNoMercyConnect")}const d=new A;e.value.registerPlugin("desktopUI",d),e.value.usePlugin("desktopUI");const f=new D;e.value.registerPlugin("autoSkip",f),e.value.usePlugin("autoSkip");const g=new B;if(e.value.registerPlugin("keyHandler",g),e.value.usePlugin("keyHandler"),!o.value.features?.nomercyConnect){const a=new U;e.value.registerPlugin("sync",a),e.value.usePlugin("sync")}const m=new x;e.value.registerPlugin("octopus",m),e.value.usePlugin("octopus"),e.value.once("play",()=>{e.value.enterFullscreen()}),e.value.on("playlistComplete",()=>{console.log("Playlist complete"),history.state.back?t.back():t.replace("/")}),e.value.on("play",()=>{i(!0)}),e.value.on("pause",()=>{i(!1)}),e.value.on("fullscreen",a=>{window.external?.sendMessage?.(a?"enterFullscreen":"exitFullscreen")})}return P(r,l=>{l?.length&&u(l)}),k(()=>{b.stop(),o.value.features?.nomercyConnect?u():r.value?.length&&u(r.value)}),C(()=>{e.value?.dispose(),i(!1)}),(l,n)=>(S(),w(p(I),null,{default:c(()=>[h(p(M),{fullscreen:!0},{default:c(()=>[...n[0]||(n[0]=[_("div",{id:"player1",class:"group nomercyplayer"},null,-1)])]),_:1})]),_:1}))}});export{Z as default};
