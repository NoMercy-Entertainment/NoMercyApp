import"./useBaseQuery-DsK96O9T.js";import"./useInfiniteServerClient-CuW4ZygN.js";import"./useQueryClient-CSGzDuGx.js";import"./useQuery-CCoB99Zd.js";import{Cs as P,Gs as k,Is as _,Ls as c,Ns as b,U as C,Us as w,ac as p,ao as h,fs as l,gc as S,i as o,jc as d,ki as M,nc as U,po as I,rc as N,sa as s,vc as v,wc as x}from"./index-DTGd4uOx.js";import{s as i}from"./imageModal-Bz9ocShb.js";import{t as B}from"./useServerClient-CyNXs_Wr.js";import{i as D,n as T,o as H,r as A,s as F}from"./VideoPlayer-B6XOtJcY.js";import"./buttons-Dz19tni1.js";import{t as V}from"./keyHandlerPlugin-xiIZ_Vdm.js";import{t as j}from"./videoNoMercyConnectPlugin-FB0kP_RN.js";P();var G=k({__name:"Desktop",setup(L){const{data:r}=B({enabled:!s.value.features?.nomercyConnect}),e=x();function u(t){const n={controls:!1,debug:!1,playlist:t?.filter(a=>!!a.id)??[],accessToken:s.value?.accessToken,basePath:M.value?.serverBaseUrl?.replace(/\/$/,""),imageBasePath:"https://app.nomercy.tv/tmdb-images",forceTvMode:(l("android")||l("ios"))&&!l("mobile"),disableTouchControls:!1,disableMediaControls:"mediaSession"in navigator||l("capacitor"),renderAhead:100,disableAutoPlayback:s.value.features?.nomercyConnect};if(e.value=A("player1").setup(n),e.value.once("back",()=>{history.state.back?o.back():o.replace("/")}),s.value.features?.nomercyConnect){const a=new j;e.value.registerPlugin("videoNoMercyConnect",a),e.value.usePlugin("videoNoMercyConnect")}const f=new D;e.value.registerPlugin("desktopUI",f),e.value.usePlugin("desktopUI");const g=new H;e.value.registerPlugin("autoSkip",g),e.value.usePlugin("autoSkip");const m=new V;if(e.value.registerPlugin("keyHandler",m),e.value.usePlugin("keyHandler"),!s.value.features?.nomercyConnect){const a=new F;e.value.registerPlugin("sync",a),e.value.usePlugin("sync")}const y=new T;e.value.registerPlugin("octopus",y),e.value.usePlugin("octopus"),e.value.once("play",()=>{e.value.enterFullscreen()}),e.value.on("playlistComplete",()=>{console.log("Playlist complete"),history.state.back?o.back():o.replace("/")}),e.value.on("play",()=>{i(!0)}),e.value.on("pause",()=>{i(!1)}),e.value.on("fullscreen",a=>{window.external?.sendMessage?.(a?"enterFullscreen":"exitFullscreen")})}return S(r,t=>{t?.length&&u(t)}),U(()=>{C.stop(),s.value.features?.nomercyConnect?u():r.value?.length&&u(r.value)}),N(()=>{e.value?.dispose(),i(!1)}),(t,n)=>(p(),c(d(I),null,{default:v(()=>[w(d(h),{fullscreen:!0},{default:v(()=>[(p(),c(b,{to:"body"},[n[0]||(n[0]=_("div",{id:"player1",class:"group nomercyplayer text-white"},null,-1))]))]),_:1})]),_:1}))}}),Y=G;export{Y as default};
