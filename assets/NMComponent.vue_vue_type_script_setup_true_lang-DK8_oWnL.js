import{$ as _,W as b,aa as k,f as M,w as m,a5 as E,h as d,b as K,a0 as r,o as g,y as L,aX as S,p as x,c as C,s as V,m as B,F as D}from"./vue-ionic-DNlOg-eX.js";import{q as y,g as F,a as I,b as N}from"./routerHelper-DrJCXHiH.js";import{r as W}from"./index-BmWDEClZ.js";const H={key:0,class:"grid w-available h-available place-items-center"},j=_({__name:"NMComponent",props:{path:{type:String,required:!1,default:void 0},options:{type:Object,required:!1,default:()=>({keepForever:!0,queryKey:y()})}},setup(h){const p=h,f=p.options.queryKey??y(),v=F({queryKey:f,path:p.path}),{data:s,isLoading:w}=I({queryKey:f,path:p.path}),{data:q,mutate:l}=N({queryKey:f,homeData:s}),u=b(),c=k();return M(()=>{var e,t;if(s.value&&u.value){const a=((t=(e=s.value)==null?void 0:e.filter)==null?void 0:t.call(e,n=>{var o;return((o=n==null?void 0:n.update)==null?void 0:o.when)==="pageLoad"}))??[];l(a)}}),m(u,e=>{var a,n;if(!e)return;const t=((n=(a=s.value)==null?void 0:a.filter)==null?void 0:n.call(a,o=>{var i;return((i=o==null?void 0:o.update)==null?void 0:i.when)==="online"}))??[];l(t)}),m(s,e=>{e&&setTimeout(()=>{document.dispatchEvent(new Event("indexer"))},1e3)}),W.beforeEach(e=>{var t,a;if(console.log("Router beforeEach:",e.name),!s.value||e.name!=="Home"&&e.name!=="Libraries"&&e.name!=="Music Start"){console.log("Skipping mutation on route change:",e.name);return}if(u.value){const n=((a=(t=s.value)==null?void 0:t.filter)==null?void 0:a.call(t,o=>{var i;return((i=o==null?void 0:o.update)==null?void 0:i.when)==="pageLoad"}))??[];console.log("Mutating on route change:",n),l(n)}}),E(()=>{var e,t;if(console.log("IonViewWillEnter"),!s.value||c.name!=="Home"&&c.name!=="Libraries"&&c.name!=="Music Start"){console.log("Skipping mutation on view enter:",c.name);return}if(u.value){const a=((t=(e=s.value)==null?void 0:e.filter)==null?void 0:t.call(e,n=>{var o;return((o=n==null?void 0:n.update)==null?void 0:o.when)==="pageLoad"}))??[];console.log("Mutating on view enter:",a),l(a)}}),(e,t)=>r(w)?(g(),d("div",H,[L(r(S),{name:"crescent",class:"ion-padding"})])):!r(v)||!r(u)?(g(!0),d(D,{key:1},x(r(q)??r(s)??[],(a,n)=>(g(),C(V(a==null?void 0:a.component),B({key:a.id,index:n,ref_for:!0},a.props),null,16,["index"]))),128)):K("",!0)}});export{j as _};
