import{$,c as f,o as i,p as t,j as _,h as B,x as m,d as C,k as L,z as l,a0 as u,av as S,F as A,q as N,v as x,A as v,as as j}from"./vue-ionic-CemLi1Vc.js";import{c as w,a as y,bg as o,B as z}from"./index-B3QUMSKn.js";import{u as V}from"./useServerClient-DRToBXwu.js";import{_ as D}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-aGbcjvri.js";import{_ as F}from"./DashboardCard.vue_vue_type_script_setup_true_lang-H4lY1dAL.js";import{_ as I}from"./TMDBImage.vue_vue_type_script_setup_true_lang-ZIqhYp7Y.js";import{u as K}from"./primevue-BPlwQLS6.js";import"./vendor-Dgtccx1h.js";import"./icons-BW5E66pf.js";import"./rxjs-BCp2L9Rn.js";import"./media-C2AqgyMX.js";import"./api-BBofn2cc.js";import"./swiper-D00Cnjmx.js";import"./music-player-Ck3tZcPH.js";import"./useInfiniteServerClient-u0SoTP_O.js";import"./useMounted-q87naNmL.js";import"./FloatingBackButton.vue_vue_type_script_setup_true_lang-kgzFoOau.js";import"./OptimizedIcon.vue_vue_type_script_setup_true_lang-BYv8nv5_.js";import"./Button.vue_vue_type_script_setup_true_lang-CGBXDMfG.js";import"./ScrollContainer.vue_vue_type_script_setup_true_lang-SLHwlzBt.js";import"./RipperOverlay.vue_vue_type_script_setup_true_lang-e9qEdd-N.js";import"./Button.vue_vue_type_script_setup_true_lang-DrBdrZAt.js";import"./AppLogoSquare-0rsvao2E.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const T={class:"relative flex aspect-video flex-shrink-0 flex-grow-0 flex-col items-center justify-center self-stretch overflow-clip rounded-lg bg-theme-11 dark:bg-theme-8 text-slate-light-12/80 dark:text-slate-dark-12/80"},U={key:1,class:"text-xl font-bold"},E=$({__name:"LibraryCard",props:{data:{type:Object,required:!0}},setup(r){return(s,n)=>{var d,c,a;return i(),f(F,{route:`/dashboard/libraries/${r.data.id}`,line1:r.data.title,line2:r.data.folder_library&&((d=r.data.folder_library)==null?void 0:d.length)!==1?`${(c=r.data.folder_library)==null?void 0:c.length} folders`:`${(a=r.data.folder_library)==null?void 0:a.length}  folder`},{image:t(()=>[_("div",T,[n[0]||(n[0]=_("div",{class:"backdropCard-overlay"},null,-1)),r.data.image?(i(),f(I,{key:0,path:r.data.image,class:"z-0"},null,8,["path"])):(i(),B("span",U,m(r.data.title),1))])]),_:1},8,["route","line1","line2"])}}}),fe=$({__name:"Desktop",setup(r){var g;const s=K(),{data:n,error:d}=V({path:"dashboard/libraries",queryKey:["dashboard","libraries",(g=w.value)==null?void 0:g.serverBaseUrl]});function c(){y().post("dashboard/libraries").then(({data:e})=>{var b;s.add({severity:e.status==="ok"?"success":"error",summary:o(e.message,...e.args),life:2e3}),z.invalidateQueries({queryKey:["dashboard","libraries",(b=w.value)==null?void 0:b.serverBaseUrl]})})}const a=C(!1);function R(){a.value=!0,y().post("dashboard/libraries/refresh").then(({data:e})=>{a.value=!1,s.add({severity:e.status==="ok"?"success":"error",summary:o(e.message,...e.args),life:2e3})}).catch(()=>{a.value=!1,s.add({severity:"error",summary:o("An error occurred while rescanning the libraries"),life:2e3})})}const h=C(!1);function q(){h.value=!0,y().post("dashboard/libraries/rescan").then(({data:e})=>{h.value=!1,s.add({severity:e.status==="ok"?"success":"error",summary:o(e.message,...e.args),life:2e3})}).catch(()=>{h.value=!1,s.add({severity:"error",summary:o("An error occurred while rescanning the libraries"),life:2e3})})}return(e,b)=>{const p=L("Button");return i(),f(u(j),null,{default:t(()=>[l(u(S),{fullscreen:!0},{default:t(()=>[l(D,{error:u(d),"grid-style":1,title:"Libraries",description:"Manage your media libraries and their content here."},{cta:t(()=>[l(p,{id:"newLibrary",color:"theme","start-icon":"folderAdd",onClick:c},{default:t(()=>[v(m(e.$t("New library")),1)]),_:1})]),actions:t(()=>[l(p,{id:"refresh",type:"button",variant:"text","start-icon":"folderSwap",disabled:a.value,class:x(a.value?"first:children:animate-spin cursor-not-allowed":""),onClick:R},{default:t(()=>[v(m(e.$t("Refresh all libraries")),1)]),_:1},8,["disabled","class"]),l(p,{id:"rescan",type:"button",variant:"text","start-icon":"folderSwap",disabled:a.value,class:x(a.value?"first:children:animate-spin cursor-not-allowed":""),onClick:q},{default:t(()=>[v(m(e.$t("Rescan all libraries")),1)]),_:1},8,["disabled","class"])]),default:t(()=>[(i(!0),B(A,null,N(u(n)??[],k=>(i(),f(E,{key:k.id,data:k},null,8,["data"]))),128))]),_:1},8,["error"])]),_:1})]),_:1})}}});export{fe as default};
