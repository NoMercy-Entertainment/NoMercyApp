import{q as m,g as w,a as q,b as M}from"./routerHelper-DkOAqSxv.js";import{$ as k,W as _,aa as b,f as E,w as g,a5 as K,h as L,b as S,a0 as c,o as y,p as x,c as C,s as B,m as D,F}from"./vue-ionic-Ct1zWn9G.js";import{r as V}from"./index-De9PJTdK.js";const N=k({__name:"NMComponent",props:{path:{type:String,required:!1,default:void 0},options:{type:Object,required:!1,default:()=>({keepForever:!0,queryKey:m()})}},setup(d){const p=d,f=p.options.queryKey??m(),h=w({queryKey:f,path:p.path}),{data:r}=q({queryKey:f,path:p.path}),{data:v,mutate:i}=M({queryKey:f,homeData:r}),u=_(),l=b();return E(()=>{var e,n;if(r.value&&u.value){const a=((n=(e=r.value)==null?void 0:e.filter)==null?void 0:n.call(e,t=>{var o;return((o=t==null?void 0:t.update)==null?void 0:o.when)==="pageLoad"}))??[];i(a)}}),g(u,e=>{var a,t;if(!e)return;const n=((t=(a=r.value)==null?void 0:a.filter)==null?void 0:t.call(a,o=>{var s;return((s=o==null?void 0:o.update)==null?void 0:s.when)==="online"}))??[];i(n)}),g(r,e=>{e&&setTimeout(()=>{document.dispatchEvent(new Event("indexer"))},1e3)}),V.beforeEach(e=>{var n,a;if(console.log("Router beforeEach:",e.name),!r.value||e.name!=="Home"&&e.name!=="Libraries"&&e.name!=="Music Start"){console.log("Skipping mutation on route change:",e.name);return}if(u.value){const t=((a=(n=r.value)==null?void 0:n.filter)==null?void 0:a.call(n,o=>{var s;return((s=o==null?void 0:o.update)==null?void 0:s.when)==="pageLoad"}))??[];console.log("Mutating on route change:",t),i(t)}}),K(()=>{var e,n;if(console.log("IonViewWillEnter"),!r.value||l.name!=="Home"&&l.name!=="Libraries"&&l.name!=="Music Start"){console.log("Skipping mutation on view enter:",l.name);return}if(u.value){const a=((n=(e=r.value)==null?void 0:e.filter)==null?void 0:n.call(e,t=>{var o;return((o=t==null?void 0:t.update)==null?void 0:o.when)==="pageLoad"}))??[];console.log("Mutating on view enter:",a),i(a)}}),(e,n)=>!c(h)||!c(u)?(y(!0),L(F,{key:0},x(c(v)??c(r)??[],(a,t)=>(y(),C(B(a==null?void 0:a.component),D({key:a.id,index:t,ref_for:!0},a.props),null,16,["index"]))),128)):S("",!0)}});export{N as _};
