import{I as J,Y as xe,l as Y,w as he,D as we,af as ke,bM as _e,c as K,o as c,a as l,H as $e,K as u,b2 as Se,R as Ce,ae as ze,f as Pe,d as R,b as G,z as L,n as E,a4 as me,aa as fe,s as j,j as h,t as y,h as Ie,F as qe}from"./index-C_qNKMWs.js";import{A as Ve}from"./autoSkipPlugin-BDxzBwjf.js";import{n as Te}from"./subtitles-octopus-CLlJMLNY.js";import{D as Be}from"./desktopUIPlugin-CrmxI-3q.js";import{K as De}from"./keyHandlerPlugin-CFs1pKI0.js";import{s as be,c as Fe,a as Ue}from"./sidebar-CvqPwIUA.js";import{g as O}from"./imageModal-Bx-CyocX.js";import{u as Ae}from"./useServerClient-abD0VdnA.js";import{S as pe}from"./swiper-vue-BP6tGrPd.js";import{C as Ne}from"./Carousel-CFshk0T7.js";import{_ as He}from"./Select.vue_vue_type_script_setup_true_lang-Dhjalf5P.js";import{u as Re}from"./index-B8V6bTi4.js";import{_ as ge}from"./TMDBImage.vue_vue_type_script_setup_true_lang-DUzr8L2O.js";import{_ as ve}from"./OptimizedIcon.vue_vue_type_script_setup_true_lang-CJu-NfRn.js";const je=["data-music","data-sidebar"],yt=J({__name:"Trailer",props:{videos:{type:Array,required:!0},toggle:{type:Function,required:!0},open:{type:Boolean,required:!0},title:{type:String,required:!0},index:{type:Number,required:!0},incrementTrailerIndex:{type:Function,required:!0}},setup(e){const o=e,M=xe(),{data:v,isError:b}=Ae({queryKey:["base","info",M.params.id,"trailer",o.videos[o.index].src],path:`trailer/${o.videos[o.index].src}`}),p=Y(),n=Y(),t=Y();function g(s){var x,w,k,_,$,S,C,z,P,I,q,V,T,B,D,F,U,A,N;const a={muted:!1,controls:!1,preload:"auto",debug:!1,autoPlay:!0,playlist:[s],controlsTimeout:3e3,doubleClickDelay:300,playbackRates:[.25,.5,.75,1,1.25,1.5,1.75,2],accessToken:(x=ze.value)==null?void 0:x.accessToken,basePath:(w=Ce.value)==null?void 0:w.serverBaseUrl};t.value=Te("trailer").setup(a),(k=t.value)==null||k.once("back",()=>{o.toggle()});const i=new Be;(_=t.value)==null||_.registerPlugin("desktopUI",i),($=t.value)==null||$.usePlugin("desktopUI");const m=new Ve;(S=t.value)==null||S.registerPlugin("autoSkip",m),(C=t.value)==null||C.usePlugin("autoSkip");const f=new De;(z=t.value)==null||z.registerPlugin("keyHandler",f),(P=t.value)==null||P.usePlugin("keyHandler"),(I=t.value)==null||I.on("playlistComplete",()=>{console.log("Playlist complete"),o.toggle()}),(q=t.value)==null||q.on("play",()=>{O(!0)}),(V=t.value)==null||V.on("pause",()=>{O(!1)}),(T=t.value)==null||T.on("fullscreen",r=>{var d,H;(H=(d=window.external)==null?void 0:d.sendMessage)==null||H.call(d,r?"enterFullscreen":"exitFullscreen")}),(B=t.value)==null||B.on("remove",()=>{o.toggle(),o.incrementTrailerIndex()}),(D=t.value)==null||D.on("error",()=>{o.toggle()}),(F=t.value)==null||F.on("close",()=>{o.toggle()}),(U=t.value)==null||U.on("captionsChanged",r=>{r.track===-1?localStorage.setItem("trailerSubtitles","off"):localStorage.setItem("trailerSubtitles",r.track)}),(A=t.value)==null||A.once("ready",()=>{var r;(r=t.value)==null||r.seek(0)}),(N=t.value)==null||N.on("play",()=>{var r,d;localStorage.getItem("trailerSubtitles")==="off"?(r=t.value)==null||r.setCurrentCaption(-1):(d=t.value)==null||d.setCurrentCaption(Number.parseInt(localStorage.getItem("trailerSubtitles")??"-1",10))})}return he(v,s=>{!s||b.value||g(s)}),we(()=>{!v.value||b.value||(ke.stop(),n.value=be.value,O(!0),Fe(),g(v.value))}),_e(()=>{var s;if(Ue(n.value??"open"),O(!1),t.value)try{(s=t.value)==null||s.dispose()}catch{}}),(s,a)=>(c(),K("button",{class:"fixed inset-0 h-available w-available overflow-hidden rounded-lg bg-black/50",onClick:a[1]||(a[1]=i=>e.toggle())},[l("div",{"data-music":u(Se),"data-sidebar":u(be),class:"absolute inset-0 w-full h-auto max-w-full max-h-full sm:w-full sm:h-auto sm:overflow-hidden sm:inset-1/2 sm:aspect-video sm:-translate-y-[50%] sidebar-closed:px-4 sidebar-closed:py-2 sidebar-closed:xl:px-[1.8rem] sidebar-closed:xl:py-4 sm:-translate-x-[50%] sidebar-open:px-4 sidebar-open:py-6 sidebar-open:xl:px-[2.8rem] sidebar-open:xl:py-6"},[l("div",{ref_key:"trailerContainer",ref:p,class:"relative rounded-2xl flex overflow-clip mx-auto children:overflow-clip h-auto top-1/4 sm:top-1/2 -translate-y-1/2 w-fit sm:h-full",onClick:a[0]||(a[0]=$e(()=>{},["stop"]))},a[2]||(a[2]=[l("div",{id:"trailer",class:"group nomercyplayer"},null,-1)]),512)],8,je)]))}}),Ke={class:"relative mb-1 h-auto w-full overflow-clip rounded-t-md group-focus-visible/season:rounded-b-none group-hover/season:rounded-b-none aspect-backdrop bg-auto-1"},Me={class:"transitioning hover:scale-110",style:{"--stroke-width":"1"}},Le={key:0,class:"absolute bottom-0 left-0 z-40 mb-3 w-full px-3"},Ee=["id"],Oe=["id"],Ye={class:"grid w-full items-stretch gap-1 rounded-b-md p-2 transitioning text-left"},Ge=["title"],Je=["title"],Qe={class:"relative mb-1 h-auto w-full overflow-clip rounded-t-md group-focus-visible/season:rounded-b-none group-hover/season:rounded-b-none aspect-backdrop bg-auto-1"},We={class:"transitioning hover:scale-110",style:{"--stroke-width":"1"}},Xe={key:0,class:"absolute bottom-0 left-0 z-40 mb-3 w-full px-3"},Ze=["id"],et=["id"],tt={class:"grid w-full items-stretch gap-1 rounded-b-md p-2 transitioning text-left"},at=["title"],lt=["title"],ye=J({__name:"SeasonCard",props:{data:{type:Object,required:!0},suffix:{type:String,required:!1,default:""}},setup(e){const o=e;return(M,v)=>{var p,n,t,g,s,a,i,m,f,x,w,k,_,$,S,C,z,P,I,q,V,T,B,D,F,U,A,N,r;const b=Pe("RouterLink");return(p=e.data)!=null&&p.id&&((n=e.data)!=null&&n.available)?(c(),R(b,{key:0,id:(t=e.data)==null?void 0:t.id,class:E(`frosting border-0 border-[rgb(var(--color-focus))] flex flex-col h-auto items-center group/season focus-shift focus-outline transition-all duration-200 overflow-clip relative !rounded-lg select-none shadow-[0px_0px_0_1px_rgb(var(--color-focus,var(--color-theme-6))/70%)] w-full z-0 bg-auto-1/12  text-slate-lightA-12/90  dark:text-slate-darkA-12/80 ${(g=e.data)!=null&&g.available?"cursor-pointer":"cursor-not-allowed"}`),onfocus:u(fe)(),style:L(`--color-focus: ${u(me)((a=(s=o.data)==null?void 0:s.color_palette)==null?void 0:a.still).replace(/,/gu," ").replace(")","").replace("rgb(","")};`),"data-card":"true",to:(i=e.data)!=null&&i.available?e.data.link:"#"},{default:j(()=>{var d,H,Q,W,X,Z,ee,te,ae,le,oe,se,ie,re,ne,de,ue,ce;return[l("div",Ke,[h(ge,{path:(d=e.data)==null?void 0:d.still,title:(H=e.data)==null?void 0:H.title,"color-palette":(W=(Q=e.data)==null?void 0:Q.color_palette)==null?void 0:W.still,class:"h-40",size:660,loading:"lazy",aspect:"backdrop","class-name":"pointer-events-none absolute z-20 flex h-full w-full select-none object-cover transitioning trickle-div",type:"image"},null,8,["path","title","color-palette"]),l("div",{class:E(`absolute inset-0 z-30 grid w-full text-white place-items-center group-focus-visible/season:bg-black opacity-0 group-focus-visible/season:opacity-100 transitioning group-hover/season:opacity-100 [background:radial-gradient(75%_50%_at_50%_50%,_rgba(0,_0,_0,_0.40)_0%,_rgba(0,_0,_0,_0.00)_100%),_rgba(0,_0,_0,_0.09)] ${(X=e.data)!=null&&X.available?"":"hidden"}`)},[l("div",Me,[h(ve,{icon:"playCircle","class-name":"w-20",stroke:"1"})])],2),(Z=e.data)!=null&&Z.progress?(c(),K("div",Le,[l("div",{id:`episode-${(ee=e.data)==null?void 0:ee.id}-slider-container`,class:"relative z-40 flex h-1 w-full overflow-clip rounded-full pt-2 pr-8 bg-gray-dark-12"},[l("div",{id:`episode-${(te=e.data)==null?void 0:te.id}-progress-bar`,class:"absolute top-0 left-0 h-full bg-[rgb(var(--color-focus))]",style:L({width:((ae=e.data)==null?void 0:ae.progress)>=99?"100%":`${(le=e.data)==null?void 0:le.progress}%`})},null,12,Oe)],8,Ee)])):G("",!0)]),l("div",Ye,[l("p",{class:"z-10 w-auto text-2xs sm:text-sm font-bold !leading-5 h-10 line-clamp-2 sm:line-clamp-1",title:`${(oe=e.data)!=null&&oe.episode_number?`${(se=e.data)==null?void 0:se.episode_number} - `:""}${(ie=e.data)==null?void 0:ie.title}`},y((re=e.data)!=null&&re.episode_number?`${(ne=e.data)==null?void 0:ne.episode_number} - `:"")+y((de=e.data)==null?void 0:de.title),9,Ge),l("p",{class:"z-10 h-8 w-auto hidden sm:flex text-xs min-h-8 line-clamp-2 leading-[1.2] text-auto-12/80",title:(ue=e.data)==null?void 0:ue.overview},y((ce=e.data)==null?void 0:ce.overview),9,Je)])]}),_:1},8,["id","class","onfocus","style","to"])):(m=e.data)!=null&&m.id?(c(),K("div",{key:1,class:E(`border-0 border-[rgb(var(--color-focus))] flex flex-col h-auto items-center group/season focus-shift focus-outline transition-all duration-200 overflow-clip relative !rounded-lg select-none shadow-[0px_0px_0_1px_rgb(var(--color-focus,var(--color-theme-6))/70%)] w-full z-0 bg-auto-1/12 ${(f=e.data)!=null&&f.available?"cursor-pointer":"cursor-not-allowed"}`),style:L(`--color-focus: ${u(me)((w=(x=o.data)==null?void 0:x.color_palette)==null?void 0:w.still).replace(/,/gu," ").replace(")","").replace("rgb(","")};`),"data-card":"true",onFocus:v[0]||(v[0]=d=>u(fe)())},[l("div",Qe,[h(ge,{path:(k=e.data)==null?void 0:k.still,title:(_=e.data)==null?void 0:_.title,"color-palette":(S=($=e.data)==null?void 0:$.color_palette)==null?void 0:S.still,class:"h-40",size:660,aspect:"backdrop","class-name":"pointer-events-none absolute z-20 flex h-full w-full select-none object-cover transitioning trickle-div",type:"image"},null,8,["path","title","color-palette"]),l("div",{class:E(`absolute inset-0 z-30 grid w-full text-white place-items-center group-focus-visible/season:bg-black opacity-0 group-focus-visible/season:opacity-100 transitioning group-hover/season:opacity-100 [background:radial-gradient(75%_50%_at_50%_50%,_rgba(0,_0,_0,_0.40)_0%,_rgba(0,_0,_0,_0.00)_100%),_rgba(0,_0,_0,_0.09)] ${(C=e.data)!=null&&C.available?"":"hidden"}`)},[l("div",We,[h(ve,{icon:"playCircle","class-name":"w-20",stroke:"1"})])],2),(z=e.data)!=null&&z.progress?(c(),K("div",Xe,[l("div",{id:`episode-${(P=e.data)==null?void 0:P.id}-slider-container`,class:"relative z-40 flex h-1 w-full overflow-clip rounded-full pt-2 pr-8 bg-gray-dark-12"},[l("div",{id:`episode-${(I=e.data)==null?void 0:I.id}-progress-bar`,class:"absolute top-0 left-0 h-full bg-[rgb(var(--color-focus))]",style:L({width:((q=e.data)==null?void 0:q.progress)>=99?"100%":`${(V=e.data)==null?void 0:V.progress}%`})},null,12,et)],8,Ze)])):G("",!0)]),l("div",tt,[l("p",{class:"z-10 w-auto text-sm font-bold !leading-5 h-10 line-clamp-1",title:`${(T=e.data)!=null&&T.episode_number?`${(B=e.data)==null?void 0:B.episode_number} - `:""}${(D=e.data)==null?void 0:D.title}`},y((F=e.data)!=null&&F.episode_number?`${(U=e.data)==null?void 0:U.episode_number} - `:"")+y((A=e.data)==null?void 0:A.title),9,at),l("p",{class:"z-10 h-8 w-auto text-xs min-h-8 line-clamp-2 leading-[1.2] text-auto-12/80",title:(N=e.data)==null?void 0:N.overview},y((r=e.data)==null?void 0:r.overview),9,lt)])],38)):G("",!0)}}}),ht=J({__name:"SeasonCarousel",props:{data:{type:Array,required:!0},type:{type:String,required:!1,default:"poster"},limitCardCountBy:{type:Number,required:!1}},setup(e){var g,s;const o=e,{t:M}=Re();function v(a){}let b=(g=o.data)==null?void 0:g.findIndex(a=>a.season_number===1);b===-1&&(b=0);const p=((s=o.data)==null?void 0:s.map((a,i)=>({index:i,id:a.id,name:`${a.season_number} - ${a.title}`,season_number:a.season_number,episodes:a.episodes})))??[],n=Y(p[b]);function t(){var i;const a=(i=document.querySelector(".swiper-undefined"))==null?void 0:i.swiper;a==null||a.slideTo(0,300)}return he(n,t),(a,i)=>(c(),R(Ne,{index:n.value.season_number,"limit-card-count-by":e.limitCardCountBy,type:e.type},{selector:j(()=>[h(He,{id:"season-selector",modelValue:n.value,"onUpdate:modelValue":i[0]||(i[0]=m=>n.value=m),disabled:u(p).length===1,items:u(p),"option-label":"title",class:"min-w-[21rem] ml-3",label:"",variant:"normal"},null,8,["modelValue","disabled","items"])]),default:j(()=>{var m;return[((m=n.value.episodes)==null?void 0:m.length)===0?(c(),R(u(pe),{key:0,class:"flex sm:p-1 sm:pl-0"},{default:j(()=>[(c(),R(ye,{id:"item-0",key:0,data:{id:1,title:u(M)("To be announced"),season_number:null,episode_number:null,available:!1,overview:"",airDate:"",still:"",link:"",color_palette:{still:{darkVibrant:"",lightVibrant:""}},progress:null},onclick:()=>{}},null,8,["data"]))]),_:1})):(c(!0),K(qe,{key:1},Ie(n.value.episodes,f=>(c(),R(u(pe),{key:f.id,class:"flex sm:p-1 sm:pl-0"},{default:j(()=>[h(ye,{id:`item-${f.id}`,data:f,onclick:()=>void 0},null,8,["id","data","onclick"])]),_:2},1024))),128))]}),_:1},8,["index","limit-card-count-by","type"]))}});export{ht as _,yt as a};
