import{c as $,i as p,it as n,mt as a,x as d}from"./i18n-Rm1NkeNf.js";import{Na as g,ka as _,qi as b,wi as m,xa as w}from"./index-DvNhFfKH.js";$();const o=a(!1),f=a("video"),u=a("");var v=a([]);const R=d(()=>v.value);n(g(u,700),async e=>{if(e===""){v.value=[];return}o.value=!0;const s=`${b.value?.serverBaseUrl}/api/v1/music/search?query=${e}`;try{v.value=(await(await fetch(s,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${w.value?.accessToken}`}})).json()).data}catch(l){console.error("Music search failed:",l)}finally{o.value=!1}});const r=a(""),i=a(!1);var c=a([]);const S=d(()=>c.value);var y=g(r,700),t=a(1);n(y,async e=>{if(e===""){c.value=[];return}i.value=!1,o.value=!0,t.value=1;const s=`https://api.themoviedb.org/3/search/multi?api_key=${m}&language=${p.language}&query=${e}&page=${t.value}&include_adult=false`;try{const l=await(await fetch(s)).json();c.value=l.results,i.value=l.total_pages>1}catch(l){console.error("Video search failed:",l)}finally{o.value=!1}});async function V(){t.value+=1;const e=`https://api.themoviedb.org/3/search/multi?api_key=${m}&language=${p.language}&query=${y.value}&page=${t.value}&include_adult=false`;try{const s=await(await fetch(e)).json();c.value=[...c.value,...s.results],s.results.length===0?i.value=!1:i.value=s.total_pages>t.value}catch(s){console.error("Fetch next page failed:",s)}}var{stop:k}=_(a(null),([{isIntersecting:e}],s)=>{e&&V()});const q=a(),h=a(""),T=d(()=>f.value==="video"?S.value:R.value);n(f,e=>{e==="video"?(u.value="",r.value=h.value):(r.value="",u.value=h.value)});n(h,e=>{f.value==="video"?(r.value=e,u.value=""):(r.value="",u.value=e)});export{o as a,S as c,q as i,i as n,f as o,R as r,h as s,V as t};
