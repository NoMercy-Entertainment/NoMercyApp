{"version":3,"file":"Mobile-Ce4AsvrQ.js","sources":["../../src/views/Base/Person/Mobile.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { computed, ref, watch } from 'vue';\nimport { IonPage, IonContent, IonSkeletonText, onIonViewWillEnter, onIonViewWillLeave } from '@ionic/vue';\nimport { useRoute } from \"vue-router\";\nimport { Swiper as SwiperComponent } from 'swiper/vue';\n\nimport type { PersonResponseItem } from \"@/types/api/base/person\";\n\nimport { tmdbImageBaseUrl } from \"@/config/config\";\nimport i18next from \"@/config/i18next\";\nimport { background, setBackground, setColorPalette } from '@/store/ui';\n\nimport useServerClient from \"@/lib/clients/useServerClient\";\nimport { breakTitle2, setTitle, unique } from \"@/lib/stringArray\";\n\nimport CreditGroup from \"@/components/MusicPlayer/components/CreditGroup.vue\";\nimport MediaCarousel from \"@/components/Carousel/MediaCarousel.vue\";\nimport TMDBImage from \"@/components/Images/TMDBImage.vue\";\nimport { isNative } from \"@/config/global\";\nimport SocialLinkItems from \"@/views/Base/Person/components/SocialLinkItems.vue\";\nimport HeaderItem from \"@/views/Base/Person/components/HeaderItem.vue\";\nimport Collapsible from \"@/views/Base/Person/components/Collapsible.vue\";\n\nconst route = useRoute();\nconst { data, isError } = useServerClient<PersonResponseItem>({\n  queryKey: ['base', 'person', route.params.id],\n});\n\nconst backgroundUrl = computed(() => {\n  return `${tmdbImageBaseUrl}/original${background.value}`;\n  // return `${currentServer.value?.serverBaseUrl}/images/original${background.value}`;\n});\n\nconst age = computed(() => {\n  if (data.value?.deathday) {\n    const birthDate = new Date(data.value?.birthday);\n    const deathDay = new Date(data.value?.deathday);\n    const a = deathDay.getFullYear() - birthDate.getFullYear();\n    const m = deathDay.getMonth() - birthDate.getMonth();\n    if (m < 0 || (m === 0 && deathDay.getDate() < birthDate.getDate())) {\n      return a - 1;\n    }\n    return a;\n  }\n  if (data.value?.birthday) {\n    const birthDate = new Date(data.value?.birthday);\n    const currentDate = new Date();\n    const a = currentDate.getFullYear() - birthDate.getFullYear();\n    const m = currentDate.getMonth() - birthDate.getMonth();\n    if (m < 0 || (m === 0 && currentDate.getDate() < birthDate.getDate())) {\n      return a - 1;\n    }\n    return a;\n  }\n  return null;\n});\n\nconst gender = computed(() => {\n  if (typeof data.value?.gender !== 'number') return data.value?.gender;\n\n  switch (data.value?.gender) {\n    case 0:\n      return 'Not specified';\n    case 1:\n      return 'Female';\n    case 2:\n      return 'Male';\n    case 3:\n      return 'Non-binary';\n    default:\n      return null;\n  }\n});\n\nwatch(data, (value) => {\n  setTitle(data?.value?.name);\n  setBackground(value?.known_for?.at(0)?.backdrop ?? null);\n  setColorPalette(value?.color_palette?.profile);\n});\n\nonIonViewWillEnter(() => {\n  setTitle(data?.value?.name);\n  setBackground(data?.value?.known_for?.at(0)?.backdrop ?? null);\n  setColorPalette(data?.value?.color_palette?.profile);\n});\n\nonIonViewWillLeave(() => {\n  setBackground(null);\n  setColorPalette(null);\n});\n\nconst filter = 'combined';\n\nconst currentImage = ref(data.value?.images?.profiles?.[0]);\n\nwatch(data, (value) => {\n  currentImage.value = value?.images?.profiles?.[0];\n});\n\n</script>\n\n<template>\n  <ion-page>\n    <ion-content ref=\"content\" :fullscreen=\"true\"\n      :style=\"`--background-image: ${backgroundUrl && !backgroundUrl.includes('null') ? `url(${backgroundUrl})` : ''};`\">\n\n      <SwiperComponent ref=\"swiper\" :slides-per-view=\"1\" :loop=\"true\" class=\"w-available swiper h-[420px] !absolute\"\n        :class=\"{\n          'top-safe-offset-12': isNative,\n          'top-12': !isNative,\n        }\">\n        <template v-for=\"(item, index) in data?.images?.profiles ?? []\" :key=\"item.id\">\n          <swiper-slide class=\"h-full\" :data-index=\"index\" :data-id=\"item.src\">\n            <div class=\"frosting w-[280px] h-[420px] z-10 absolute left-1/2 -translate-x-1/2 overflow-clip rounded-2xl\">\n\n              <TMDBImage v-if=\"item\" :key=\"item.src ?? 'poster'\" :autoShadow=\"true\" :path=\"item.src\" :size=\"760\"\n                priority=\"high\" :title=\"data?.name\" aspect=\"poster\" loading=\"eager\"\n                className=\"pointer-events-none absolute -inset-1 z-20 flex h-auto scale-100 select-none items-center overflow-hidden w-available h-available max-h-available\"\n                class=\"m-auto children:w-full scale-100 max-h-available 5xl:w-inherit\" type=\"image\" />\n\n            </div>\n          </swiper-slide>\n        </template>\n      </SwiperComponent>\n\n      <div\n        class=\"flex z-0 flex-col justify-start items-center self-stretch flex-grow overflow-hidden gap-4 will-change-auto text-slate-lightA-12/70 dark:text-slate-darkA-12/80\"\n        style=\"box-shadow: 0 2px 2px 0 rgba(0,0,0,0.16);\">\n        <div class=\"flex justify-start items-end -mx-4 w-available h-[410px] relative gap-2\">\n          <div\n            class=\"absolute flex flex-col justify-start items-end flex-grow w-available -mx-20 h-[410px] bg-cover bg-top\"\n            style=\"background: linear-gradient(0deg, rgba(0, 0, 0, 0.50) 0%, rgba(0, 0, 0, 0.50) 100%), var(--background-image) lightgray 50% / cover no-repeat;\">\n          </div>\n          <div\n            class=\"absolute flex flex-col justify-start items-end flex-grow w-available -mx-20 h-[410px] bg-cover dark:bg-black/50\">\n          </div>\n        </div>\n\n        <div\n          class=\"flex bg-slate-light-3 dark:bg-slate-dark-1 flex-col justify-start items-start self-stretch gap-3 pt-16 pb-5 will-change-auto w-inherit px-6\">\n          <p v-if=\"data?.name\" class=\"self-stretch w-[351px] text-3xl font-bold text-left z-10\"\n            v-html=\"breakTitle2(data?.name ?? ' ', 'text-lg line-clamp-2')\">\n          </p>\n          <ion-skeleton-text v-else :animated=\"true\" class=\"h-7 will-change-auto\"></ion-skeleton-text>\n\n          <Collapsible v-if=\"data?.biography\" :text=\"data?.biography\" :maxLines=\"3\" />\n\n          <div class=\"flex flex-col gap-3 items-start flex-nowrap w-full\">\n\n            <div class=\"flex justify-between items-start flex-nowrap w-full\">\n\n              <HeaderItem v-if=\"data?.known_for_department\" title=\"Known for\" :data=\"data?.known_for_department\" />\n\n              <HeaderItem v-if=\"data?.combined_credits?.cast\" title=\"Credits\"\n                :data=\"data?.combined_credits?.cast.length.toString()\" />\n\n\n              <HeaderItem v-if=\"age\" title=\"Birthday\">\n                <template v-slot:head>\n                  <span v-if=\"data?.deathday\"\n                    class=\"ml-auto flex gap-1 text-xs font-bold uppercase text-auto-alpha-10 whitespace-nowrap\">\n                    <span v-if=\"data.deathday\" class=\"-mr-1 text-base -mt-[3px]\">&#8224;</span>\n                    {{\n                      new Date(data?.deathday!).toLocaleDateString(i18next.language ?? 'en-US', {\n                        year: 'numeric',\n                        month: 'short',\n                        day: '2-digit',\n                      })\n                    }}\n                  </span>\n                </template>\n\n                <p v-if=\"age\" class=\"text-left text-base font-medium text-contrast self-center whitespace-nowrap\">{{\n                  new Date(data?.birthday!).toLocaleDateString(i18next.language ?? 'en-US', {\n                    year: 'numeric',\n                    month: 'short',\n                    day: '2-digit',\n                  })\n                }} ({{ age }} {{ $t('years old') }})\n                </p>\n\n              </HeaderItem>\n            </div>\n\n            <div class=\"flex gap-3 items-start justify-between flex-nowrap w-full\">\n\n              <HeaderItem v-if=\"gender\" title=\"Gender\" :data=\"gender\" />\n\n              <HeaderItem v-if=\"data?.place_of_birth\" title=\"Place of birth\" :data=\"data?.place_of_birth\" />\n\n            </div>\n\n          </div>\n\n          <div class=\"self-stretch h-px bg-slate-dark-7/[0.1] dark:bg-slate-dark-11/[0.1]\"></div>\n\n          <SocialLinkItems v-if=\"data\" :data=\"data\" />\n\n          <div class=\"mb-8 -ml-1 w-[101.5%]\">\n            <div class=\"ml-2 w-[100.6%]\">\n              <MediaCarousel v-if=\"data?.known_for && data?.known_for?.length > 0\" :color-palette=\"data?.color_palette\"\n                :data=\"unique(data.known_for, 'id')\" class=\"-mx-6\" title=\"Known for\" type=\"poster\" />\n            </div>\n          </div>\n\n          <div class=\"self-stretch h-px bg-slate-dark-7/[0.1] dark:bg-slate-dark-11/[0.1]\"></div>\n\n          <CreditGroup :items=\"data?.[`${filter}_credits`]?.cast\" title=\"Acting\" />\n          <CreditGroup :items=\"data?.[`${filter}_credits`]?.crew.filter((c: any) => c.job.includes('Produc'))\"\n            title=\"Production\" />\n          <CreditGroup :items=\"data?.[`${filter}_credits`]?.crew.filter((c: any) => c.job.includes('Writ'))\"\n            title=\"Writing\" />\n          <CreditGroup :items=\"data?.[`${filter}_credits`]?.crew.filter((c: any) => c.job.includes('Direct'))\"\n            title=\"Directing\" />\n          <CreditGroup\n            :items=\"data?.[`${filter}_credits`]?.crew.filter((c: any) => !c.job.includes('Produc') && !c.job.includes('Writ') && !c.job.includes('Direct') && !c.job.includes('Creator'))\"\n            title=\"Crew\" />\n          <CreditGroup :items=\"data?.[`${filter}_credits`]?.crew.filter((c: any) => c.job.includes('Creator'))\"\n            title=\"Creator\" />\n        </div>\n      </div>\n    </ion-content>\n  </ion-page>\n</template>\n\n<style scoped>\n:root {\n  --background-image: none;\n}\n</style>"],"names":["filter","route","useRoute","data","isError","useServerClient","backgroundUrl","computed","tmdbImageBaseUrl","background","age","_a","birthDate","_b","deathDay","_c","a","m","_d","_e","currentDate","gender","watch","value","setTitle","setBackground","setColorPalette","onIonViewWillEnter","_f","onIonViewWillLeave","currentImage","ref"],"mappings":"67JA2FMA,EAAS,qDApEf,MAAMC,EAAQC,GAAS,EACjB,CAAE,KAAAC,EAAM,QAAAC,CAAQ,EAAIC,GAAoC,CAC5D,SAAU,CAAC,OAAQ,SAAUJ,EAAM,OAAO,EAAE,CAAA,CAC7C,EAEKK,EAAgBC,EAAS,IACtB,GAAGC,EAAgB,YAAYC,GAAW,KAAK,EAEvD,EAEKC,EAAMH,EAAS,IAAM,eACrB,IAAAI,EAAAR,EAAK,QAAL,MAAAQ,EAAY,SAAU,CACxB,MAAMC,EAAY,IAAI,MAAKC,EAAAV,EAAK,QAAL,YAAAU,EAAY,QAAQ,EACzCC,EAAW,IAAI,MAAKC,EAAAZ,EAAK,QAAL,YAAAY,EAAY,QAAQ,EACxCC,EAAIF,EAAS,YAAY,EAAIF,EAAU,YAAY,EACnDK,EAAIH,EAAS,SAAS,EAAIF,EAAU,SAAS,EAC/C,OAAAK,EAAI,GAAMA,IAAM,GAAKH,EAAS,QAAQ,EAAIF,EAAU,UAC/CI,EAAI,EAENA,CAAA,CAEL,IAAAE,EAAAf,EAAK,QAAL,MAAAe,EAAY,SAAU,CACxB,MAAMN,EAAY,IAAI,MAAKO,EAAAhB,EAAK,QAAL,YAAAgB,EAAY,QAAQ,EACzCC,MAAkB,KAClBJ,EAAII,EAAY,YAAY,EAAIR,EAAU,YAAY,EACtDK,EAAIG,EAAY,SAAS,EAAIR,EAAU,SAAS,EAClD,OAAAK,EAAI,GAAMA,IAAM,GAAKG,EAAY,QAAQ,EAAIR,EAAU,UAClDI,EAAI,EAENA,CAAA,CAEF,OAAA,IAAA,CACR,EAEKK,EAASd,EAAS,IAAM,WACxB,GAAA,QAAOI,EAAAR,EAAK,QAAL,YAAAQ,EAAY,SAAW,SAAU,OAAOE,EAAAV,EAAK,QAAL,YAAAU,EAAY,OAEvD,QAAAE,EAAAZ,EAAK,QAAL,YAAAY,EAAY,OAAQ,CAC1B,IAAK,GACI,MAAA,gBACT,IAAK,GACI,MAAA,SACT,IAAK,GACI,MAAA,OACT,IAAK,GACI,MAAA,aACT,QACS,OAAA,IAAA,CACX,CACD,EAEKO,GAAAnB,EAAOoB,GAAU,aACZC,IAAAb,EAAAR,GAAA,YAAAA,EAAM,QAAN,YAAAQ,EAAa,IAAI,EAC1Bc,IAAcV,GAAAF,EAAAU,GAAA,YAAAA,EAAO,YAAP,YAAAV,EAAkB,GAAG,KAArB,YAAAE,EAAyB,WAAY,IAAI,EACvCW,GAAAR,EAAAK,GAAA,YAAAA,EAAO,gBAAP,YAAAL,EAAsB,OAAO,CAAA,CAC9C,EAEDS,GAAmB,IAAM,iBACdH,IAAAb,EAAAR,GAAA,YAAAA,EAAM,QAAN,YAAAQ,EAAa,IAAI,EAC1Bc,IAAcP,GAAAH,GAAAF,EAAAV,GAAA,YAAAA,EAAM,QAAN,YAAAU,EAAa,YAAb,YAAAE,EAAwB,GAAG,KAA3B,YAAAG,EAA+B,WAAY,IAAI,EAC7CQ,GAAAE,GAAAT,EAAAhB,GAAA,YAAAA,EAAM,QAAN,YAAAgB,EAAa,gBAAb,YAAAS,EAA4B,OAAO,CAAA,CACpD,EAEDC,GAAmB,IAAM,CACvBJ,EAAc,IAAI,EAClBC,EAAgB,IAAI,CAAA,CACrB,EAID,MAAMI,EAAeC,IAAIhB,GAAAF,GAAAF,EAAAR,EAAK,QAAL,YAAAQ,EAAY,SAAZ,YAAAE,EAAoB,WAApB,YAAAE,EAA+B,EAAE,EAEpD,OAAAO,GAAAnB,EAAOoB,GAAU,SACrBO,EAAa,OAAQjB,GAAAF,EAAAY,GAAA,YAAAA,EAAO,SAAP,YAAAZ,EAAe,WAAf,YAAAE,EAA0B,EAAC,CACjD"}