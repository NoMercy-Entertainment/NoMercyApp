import{C as F,G as M,J as U,O as m,Q as D,S as l,T as I,Tt as n,bt as L,c as P,ct as C,gt as u,j as z,k as t,kt as N,ot as i,w as O,x as J}from"./i18n-Cs-AFcrY.js";import"./ionic-XwZpO7IE.js";import"./vue-core-CKeWI2Kt.js";import{l as v,m as K}from"./primevue-DNc5dNs0.js";import{c as R}from"./query-28IwY2wK.js";import{$i as Z,Qi as G,Sn as H,Zi as W,b as X,xn as Y}from"./index-CpapolHX.js";import"./useInfiniteServerClient-CzMUf_PK.js";import{t as h}from"./useServerClient-1EesMW3F.js";import{t as ee}from"./Toggle-BD8Tin_u.js";import"./ScrollContainer-NuTTzR7r.js";import"./useMounted-18HlRU8K.js";import"./RipperOverlay-d-TYVwF-.js";import"./ripperSocket-DvqsFU_1.js";import"./FloatingBackButton-DfxyIRfC.js";import{t as re}from"./DashboardLayout-n634qIFw.js";P();var le={key:0,class:"col-span-2 col-start-1 2xl:col-start-1"},ae={class:"flex flex-col gap-1"},oe={class:"flex flex-col gap-1"},se={class:"flex flex-col gap-1"},te={key:1,class:"col-span-2 col-start-1 2xl:col-start-3"},ne={class:"flex flex-col gap-1"},ue={class:"flex flex-col gap-1"},ie={class:"flex flex-col gap-1"},de={class:"flex flex-col gap-1"},ve={class:"flex flex-col gap-1"},me={class:"flex flex-col gap-1"},pe={class:"flex flex-col gap-1"},fe={class:"flex flex-col gap-1"},_e={key:2,class:"col-span-2 col-start-1 2xl:col-start-5"},we={class:"flex flex-col gap-1"},ge={class:"flex gap-4"},ke=["aria-label","href"],xe=z({__name:"Desktop",setup(ce){const{data:a,refetch:j,error:A}=h({path:"/dashboard/configuration"}),f=u(!1),s=u(a.value??{}),d=(r,e)=>{if(a.value){if(L(a.value[r])===e){delete s.value[r],s.value={...s.value};return}s.value={...s.value,[r]:e??void 0}}};i(a,r=>{r&&(s.value={},_.value=r?.name,w.value=r?.external_port,g.value=r?.internal_port,k.value=r?.library_workers,x.value=r?.import_workers,c.value=r?.extras_workers,b.value=r?.encoder_workers,V.value=r?.cron_workers,y.value=r?.image_workers,S.value=r?.file_workers,B.value=r?.music_workers,p.value=r?.swagger,f.value=!0)}),M(()=>{a.value&&(s.value={},_.value=a.value?.name,w.value=a.value?.external_port,g.value=a.value?.internal_port,k.value=a.value?.library_workers,x.value=a.value?.import_workers,c.value=a.value?.extras_workers,b.value=a.value?.encoder_workers,V.value=a.value?.cron_workers,y.value=a.value?.image_workers,S.value=a.value?.file_workers,B.value=a.value?.music_workers,p.value=a.value?.swagger,f.value=!0)});const _=u(a.value?.name??"");i(_,r=>{d("name",r)});const w=u(a.value?.external_port??0);i(w,r=>{d("external_port",r)});const g=u(a.value?.internal_port??0);i(g,r=>{d("internal_port",r)});const k=u(a.value?.library_workers??1);i(k,r=>{d("library_workers",r)});const x=u(a.value?.import_workers??2);i(x,r=>{d("import_workers",r)});const c=u(a.value?.extras_workers??15);i(c,r=>{d("extras_workers",r)});const b=u(a.value?.encoder_workers??1);i(b,r=>{d("encoder_workers",r)});const V=u(a.value?.cron_workers??1);i(V,r=>{d("cron_workers",r)});const y=u(a.value?.image_workers??10);i(y,r=>{d("image_workers",r)});const S=u(a.value?.file_workers??4);i(S,r=>{d("file_workers",r)});const B=u(a.value?.music_workers??2);i(B,r=>{d("music_workers",r)});const p=u(a.value?.swagger??!1);i(p,r=>{d("swagger",r)});const Q=J(()=>Object.keys(s.value).length>0);i(s,r=>{console.log(r)});const T=R(),q=()=>{console.raw(s.value),W().patch("/dashboard/configuration",s.value).then(()=>{if(G.value){const r={};if(s.value.name!==void 0&&(r.name=s.value.name.toString()),s.value.external_port!==void 0&&(r.external_port=s.value.external_port.toString()),s.value.internal_port!==void 0&&(r.internal_port=s.value.internal_port.toString()),Object.keys(r).length>0){const e={...G.value,...r};H([...Y.value.filter($=>$.id!==G.value.id),e]),Z(e)}}j(),T.invalidateQueries({queryKey:["serverInfo"]})})};return(r,e)=>{const $=D("Button"),E=D("ion-content");return U(),F(E,{fullscreen:!0},{default:C(()=>[t(re,{error:n(A),gridStyle:2,description:"",title:"General"},{cta:C(()=>[...e[13]||(e[13]=[])]),actions:C(()=>[t($,{id:"save",disabled:!Q.value,class:"ml-auto",color:"theme",form:"myForm",type:"submit",onClick:e[12]||(e[12]=o=>q())},{default:C(()=>[m(N(r.$t("Save")),1)]),_:1},8,["disabled"])]),default:C(()=>[f.value?(U(),I("div",le,[l("div",ae,[e[14]||(e[14]=l("label",{for:"name"},"Server name",-1)),t(n(K),{id:"name",modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=o=>_.value=o),class:"mb-4"},null,8,["modelValue"])]),l("div",oe,[e[15]||(e[15]=l("label",{for:"internal_port"},"Secure internal port",-1)),t(n(v),{id:"internal_port",modelValue:g.value,"onUpdate:modelValue":e[1]||(e[1]=o=>g.value=o),min:2e3,useGrouping:!1,class:"mb-4",showButtons:""},null,8,["modelValue"])]),l("div",se,[e[16]||(e[16]=l("label",{for:"external_port"},"Secure external port",-1)),t(n(v),{id:"external_port",modelValue:w.value,"onUpdate:modelValue":e[2]||(e[2]=o=>w.value=o),min:2e3,useGrouping:!1,class:"mb-4",showButtons:""},null,8,["modelValue"])])])):O("",!0),f.value?(U(),I("div",te,[l("div",ne,[e[17]||(e[17]=l("label",{for:"library_workers"},[m("Library runners "),l("span",{class:"text-xs opacity-60"},"(scanning and rescanning)")],-1)),t(n(v),{id:"library_workers",modelValue:k.value,"onUpdate:modelValue":e[3]||(e[3]=o=>k.value=o),min:0,useGrouping:!1,class:"mb-2",showButtons:""},null,8,["modelValue"])]),l("div",ue,[e[18]||(e[18]=l("label",{for:"import_workers"},[m("Import runners "),l("span",{class:"text-xs opacity-60"},"(movies, shows, collections, audio)")],-1)),t(n(v),{id:"import_workers",modelValue:x.value,"onUpdate:modelValue":e[4]||(e[4]=o=>x.value=o),min:0,useGrouping:!1,class:"mb-2",showButtons:""},null,8,["modelValue"])]),l("div",ie,[e[19]||(e[19]=l("label",{for:"extras_workers"},[m("Extras runners "),l("span",{class:"text-xs opacity-60"},"(metadata fetching)")],-1)),t(n(v),{id:"extras_workers",modelValue:c.value,"onUpdate:modelValue":e[5]||(e[5]=o=>c.value=o),min:0,useGrouping:!1,class:"mb-2",showButtons:""},null,8,["modelValue"])]),l("div",de,[e[20]||(e[20]=l("label",{for:"encoder_workers"},[m("Encoder runners "),l("span",{class:"text-xs opacity-60"},"(video and music encoding)")],-1)),t(n(v),{id:"encoder_workers",modelValue:b.value,"onUpdate:modelValue":e[6]||(e[6]=o=>b.value=o),min:0,useGrouping:!1,class:"mb-2",showButtons:""},null,8,["modelValue"])]),l("div",ve,[e[21]||(e[21]=l("label",{for:"cron_workers"},[m("Cron runners "),l("span",{class:"text-xs opacity-60"},"(scheduled/recurring jobs)")],-1)),t(n(v),{id:"cron_workers",modelValue:V.value,"onUpdate:modelValue":e[7]||(e[7]=o=>V.value=o),min:0,useGrouping:!1,class:"mb-2",showButtons:""},null,8,["modelValue"])]),l("div",me,[e[22]||(e[22]=l("label",{for:"image_workers"},[m("Image runners "),l("span",{class:"text-xs opacity-60"},"(FanArt, CoverArt, palettes)")],-1)),t(n(v),{id:"image_workers",modelValue:y.value,"onUpdate:modelValue":e[8]||(e[8]=o=>y.value=o),min:0,useGrouping:!1,class:"mb-2",showButtons:""},null,8,["modelValue"])]),l("div",pe,[e[23]||(e[23]=l("label",{for:"file_workers"},[m("File runners "),l("span",{class:"text-xs opacity-60"},"(rescanning and discovery)")],-1)),t(n(v),{id:"file_workers",modelValue:S.value,"onUpdate:modelValue":e[9]||(e[9]=o=>S.value=o),min:0,useGrouping:!1,class:"mb-2",showButtons:""},null,8,["modelValue"])]),l("div",fe,[e[24]||(e[24]=l("label",{for:"music_workers"},[m("Music runners "),l("span",{class:"text-xs opacity-60"},"(metadata and lyrics)")],-1)),t(n(v),{id:"music_workers",modelValue:B.value,"onUpdate:modelValue":e[10]||(e[10]=o=>B.value=o),min:0,useGrouping:!1,class:"mb-2",showButtons:""},null,8,["modelValue"])])])):O("",!0),f.value?(U(),I("div",_e,[l("div",we,[l("span",ge,[e[25]||(e[25]=l("label",{for:"swagger"},"Open API / Swagger Ui",-1)),p.value&&n(G)?.serverBaseUrl?(U(),I("a",{key:0,"aria-label":r.$t("Open API / Swagger Ui in a new tab"),href:n(G)?.serverBaseUrl,class:"flex gap-1 items-center underline underline-offset-4 h-4 text-sm",target:"_blank"},[l("span",null,N(r.$t("Open")),1),t(X,{className:"size-4",color:"theme",icon:"shareSquare"})],8,ke)):O("",!0)]),t(ee,{"model-value":p.value,"onUpdate:modelValue":e[11]||(e[11]=o=>p.value=o)},null,8,["model-value"])])])):O("",!0)]),_:1},8,["error"])]),_:1})}}}),Qe=xe;export{Qe as default};
