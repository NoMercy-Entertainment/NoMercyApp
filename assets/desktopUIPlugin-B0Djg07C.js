var M=Object.defineProperty;var k=(y,c,a)=>c in y?M(y,c,{enumerable:!0,configurable:!0,writable:!0,value:a}):y[c]=a;var u=(y,c,a)=>k(y,typeof c!="symbol"?c+"":c,a);import{B as L,h as S,u as $,c as P,l as R,a as F}from"./subtitles-octopus-DU9R5Ums.js";import{s as z,f as b,e as C,d as A}from"./buttons-DDRy-LjE.js";class I extends L{constructor(){super(...arguments);u(this,"topBar",{});u(this,"bottomRow",{});u(this,"frame",{});u(this,"center",{});u(this,"isMouseDown",!1);u(this,"pipEnabled",!1);u(this,"lockActive",!1);u(this,"bottomBar",{});u(this,"topRow",{});u(this,"tooltip",{});u(this,"episodeTip",{});u(this,"scrollContainerStyles",["scroll-container","flex","flex-col","gap-1","language-scroll-container","overflow-x-hidden","overflow-y-auto","p-2","transition-all","duration-200","w-available","scroll-p-4","scroll-snap-align-center","scroll-smooth","scroll-p-4"]);u(this,"subMenuContentStyles",["sub-menu-content","flex","flex-col","max-h-available","w-available","overflow-auto","min-w-52"]);u(this,"subtitleSettingActions",[])}use(){this.subtitleSettingActions=z(this.player),this.topBar=this.createTopBar(this.overlay),this.createBackButton(this.topBar),this.createCloseButton(this.topBar),this.createDivider(this.topBar),this.createTvCurrentItem(this.topBar),this.player.options.disableTouchControls||(this.center=this.createCenter(this.overlay)),this.bottomBar=this.createBottomBar(this.overlay),this.bottomBar.onmouseleave=a=>{var t;const e=(t=this.player.getVideoElement())==null?void 0:t.getBoundingClientRect();!e||a.x>e.left&&a.x<e.right&&a.y>e.top&&a.y<e.bottom||this.player.emit("hide-tooltip")},this.topRow=this.createTopRow(this.bottomBar),this.player.addClasses(this.topRow,["mt-4"]),this.bottomRow=this.createBottomRow(this.bottomBar),this.createProgressBar(this.topRow),this.createPlaybackButton(this.bottomRow,!0),this.createPreviousButton(this.bottomRow,!0),this.player.options.seekButtons&&(this.createSeekBackButton(this.bottomRow,!0),this.createSeekForwardButton(this.bottomRow,!0)),this.createChapterBackButton(this.bottomRow,!0),this.createChapterForwardButton(this.bottomRow,!0),this.createNextButton(this.bottomRow,!0),this.createVolumeButton(this.bottomRow,!0),this.createTime(this.bottomRow,"current",["ml-2"]),this.createDivider(this.bottomRow),this.createTime(this.bottomRow,"remaining",["mr-2"]),this.createTheaterButton(this.bottomRow,!0),this.createPIPButton(this.bottomRow,!0),this.createPlaylistsButton(this.bottomRow,!0),this.createSpeedButton(this.bottomRow,!0),this.createCaptionsButton(this.bottomRow,!0),this.createAudioButton(this.bottomRow,!0),this.createQualityButton(this.bottomRow,!0),this.createSettingsButton(this.bottomRow,!0),this.createFullscreenButton(this.bottomRow,!0),this.frame=this.createMenuFrame(this.bottomRow),this.createMainMenu(this.frame),this.createToolTip(this.overlay),this.episodeTip=this.createEpisodeTip(this.overlay),this.modifySpinner(this.overlay),this.eventHandlers()}dispose(){var a;this.topBar.remove(),this.bottomBar.remove(),this.bottomRow.remove(),this.frame.remove(),(a=this.center)==null||a.remove(),this.tooltip.remove(),this.episodeTip.remove(),this.loader.remove()}createTopRow(a){return this.player.createElement("div","top-row").addClasses(["top-row","flex","gap-1","h-2","items-center","pl-2","pr-2","relative","w-available"]).appendTo(a)}createBottomRow(a){return this.player.createElement("div","bottom-row").addClasses(["bottom-row","flex","h-10","lg:mb-2","p-1","lg:px-4","items-center","relative","w-available"]).appendTo(a)}eventHandlers(){this.player.on("chapters",()=>{this.createChapterMarkers()}),this.player.on("back-button",()=>{switch(this.currentMenu){case"episode":case"language":case"quality":this.player.emit("showPauseScreen");break;case"seek":case"pause":this.seekContainer.style.transform="",this.player.play().then();break}}),window.addEventListener("resize",()=>{this.sizeMenuFrame()})}createCenter(a){const e=this.player.createElement("div","center").addClasses(["center","absolute","grid","grid-cols-3","grid-rows-6","h-full","w-full","z-0","transition-all","duration-200","bg-transparent","group-[&.nomercyplayer:not(.buffering).paused]:bg-gradient-circle-c","from-15%","from-black/50","via-40%","via-black/30","to-100%","to-black/0"]).appendTo(a);return this.createSpinnerContainer(e),this.player.isMobile()?(this.createTouchSeekBack(e,{x:{start:1,end:1},y:{start:2,end:6}}),this.createTouchPlayback(e,{x:{start:2,end:2},y:{start:3,end:5}}),this.createTouchSeekForward(e,{x:{start:3,end:3},y:{start:2,end:6}}),this.createTouchVolUp(e,{x:{start:2,end:2},y:{start:1,end:3}}),this.createTouchVolDown(e,{x:{start:2,end:2},y:{start:5,end:7}})):(this.createTouchSeekBack(e,{x:{start:1,end:2},y:{start:2,end:6}}),this.createTouchPlayback(e,{x:{start:2,end:3},y:{start:2,end:6}}),this.createTouchSeekForward(e,{x:{start:3,end:4},y:{start:2,end:6}})),e}createTouchSeekBack(a,e){const t=this.createTouchBox(a,"touchSeekBack",e);return["click"].forEach(i=>{t.addEventListener(i,this.doubleTap(()=>{this.player.rewindVideo()},()=>{this.controlsVisible&&this.player.emit("hideControls")}))}),this.createSeekRipple(t,"left"),t}doubleTap(a,e){const t=this.player.options.doubleClickDelay??300;let i=0,s,l;return function(o,r){const p=new Date().getTime(),h=p-i;h>0&&h<t?(o.preventDefault(),a(o),clearTimeout(l)):(s=setTimeout(()=>{clearTimeout(s)},t),l=setTimeout(()=>{e==null||e(r)},t)),i=p}}createTouchSeekForward(a,e){const t=this.createTouchBox(a,"touchSeekForward",e);return["mouseup","touchend"].forEach(i=>{t.addEventListener(i,this.doubleTap(()=>{this.player.forwardVideo()},()=>{this.controlsVisible&&this.player.emit("hideControls")}))}),this.createSeekRipple(t,"right"),t}createTouchPlayback(a,e,t=!1){const i=this.createTouchBox(a,"touchPlayback",e);this.player.addClasses(i,["touch-playback","flex","-ml-2","items-center","justify-center"]),["click"].forEach(l=>{i.addEventListener(l,this.doubleTap(()=>{this.player.toggleFullscreen()},()=>{this.controlsVisible&&this.player.togglePlayback()}))});const s=this.createSVGElement(i,"bigPlay",this.buttons.bigPlay,!1,t);return this.player.addClasses(s,["touch-playback-button","pointer-events-none","fill-white"]),this.player.on("ready",()=>{s.style.display="flex"}),this.player.on("pause",()=>{s.style.display="flex"}),this.player.on("play",()=>{s.style.display="none"}),this.player.on("time",()=>{s.style.display="none"}),this.player.on("firstFrame",()=>{s.style.display="none"}),i}createTouchVolUp(a,e){if(!this.player.isMobile())return;const t=this.createTouchBox(a,"touchVolUp",e);return["click"].forEach(i=>{t.addEventListener(i,this.doubleTap(()=>{this.player.volumeUp()},()=>{this.controlsVisible&&this.player.emit("hideControls")}))}),t}createTouchVolDown(a,e){if(!this.player.isMobile())return;const t=this.createTouchBox(a,"touchVolDown",e);return["click"].forEach(i=>{t.addEventListener(i,this.doubleTap(()=>{this.player.volumeDown()},()=>{this.controlsVisible&&this.player.emit("hideControls")}))}),t}createTouchBox(a,e,t){const i=this.player.createElement("div",`touch-box-${e}`).addClasses([`touch-box-${e}`,"z-40"]).appendTo(a);return i.style.gridColumnStart=t.x.start.toString(),i.style.gridColumnEnd=t.x.end.toString(),i.style.gridRowStart=t.y.start.toString(),i.style.gridRowEnd=t.y.end.toString(),a.appendChild(i),i}createSpeedButton(a,e=!1){if(this.player.isMobile())return;const t=this.createUiButton(a,"speed");return this.player.hasSpeeds()?t.style.display="flex":t.style.display="none",this.createSVGElement(t,"speed",this.buttons.speed,!1,e),t.addEventListener("click",i=>{i.stopPropagation(),this.player.emit("hide-tooltip"),this.speedMenuOpen?(this.player.emit("show-menu",!1),this.menuFrame.close()):(this.player.emit("show-speed-menu",!0),this.menuFrame.showModal())}),this.player.on("pip-internal",i=>{i?t.style.display="none":this.player.hasSpeeds()&&(t.style.display="flex")}),a.appendChild(t),t}createPIPButton(a,e=!1){var i;if(this.player.isMobile()||!this.player.hasPipEventHandler)return;const t=this.createUiButton(a,"pip");return this.player.hasPIP()?t.style.display="flex":t.style.display="none",t.ariaLabel=(i=this.buttons.pipEnter)==null?void 0:i.title,this.createSVGElement(t,"pip-enter",this.buttons.pipEnter,!1,e),this.createSVGElement(t,"pip-exit",this.buttons.pipExit,!0,e),document.addEventListener("visibilitychange",()=>{this.pipEnabled&&(document.hidden?document.pictureInPictureEnabled&&this.player.getVideoElement().requestPictureInPicture().then():document.pictureInPictureElement&&document.exitPictureInPicture().then())}),t.addEventListener("click",s=>{var l,n;s.stopPropagation(),this.player.emit("hide-tooltip"),this.player.emit("controls",!1),this.pipEnabled?(this.pipEnabled=!1,t.querySelector(".pip-exit-icon").style.display="none",t.querySelector(".pip-enter-icon").style.display="flex",t.ariaLabel=(l=this.buttons.pipEnter)==null?void 0:l.title,this.player.emit("pip-internal",!1),this.player.emit("pip",!1)):(this.pipEnabled=!0,t.querySelector(".pip-enter-icon").style.display="none",t.querySelector(".pip-exit-icon").style.display="flex",t.ariaLabel=(n=this.buttons.pipExit)==null?void 0:n.title,this.player.emit("pip-internal",!0),this.player.emit("pip",!0),this.player.emit("show-menu",!1))}),this.player.on("fullscreen",()=>{this.player.getFullscreen()?t.style.display="none":t.style.display="flex"}),a.appendChild(t),t}createMenuFrame(a){this.menuFrame=this.player.createElement("dialog","menu-frame-dialog").addClasses(["group-[&.nomercyplayer:has(.open)]:backdrop:bg-black/60","group-[&.nomercyplayer:has(.open)]:backdrop:pointer-events-none"]).appendTo(a),this.menuFrame.setAttribute("popover","manual"),this.menuFrame.setAttribute("role","modal");const e=this.player.createElement("div","menu-wrapper").addClasses(["menu-wrapper","text-white"]).appendTo(this.menuFrame),t=this.player.createElement("div","menu-frame").addClasses(["menu-frame","absolute","flex-col","h-available","hidden","inset-4","justify-self-end","max-h-[calc(100%-2rem)]","max-w-[min(70rem,calc(100%-2rem))]","overflow-clip","rounded-lg","w-fit","z-50"]).appendTo(e);this.sizeMenuFrame();const i=this.player.createElement("div","menu-content").addClasses(["menu-content","flex","flex-row","h-available","justify-end","mt-auto","overflow-clip","w-full"]).appendTo(t);return this.player.on("resize",()=>{this.sizeMenuFrame()}),this.player.on("fullscreen",()=>{this.sizeMenuFrame()}),this.player.on("show-menu",s=>{this.menuOpen=s,this.lockActive=s,s?(this.sizeMenuFrame(),t.style.display="flex",t.classList.add("open"),this.menuFrame.showModal()):(t.style.display="none",t.classList.remove("open"),this.menuFrame.classList.remove("group-[&.nomercyplayer:has(.open)]:backdrop:!hidden"),this.center.classList.remove("!bg-none"),this.menuFrame.close()),i.classList.add("translate-x-0"),i.classList.remove("sub-menu-open"),setTimeout(()=>{var l;(l=Array.from(this.mainMenu.children).find(n=>n.style.display!="none"&&n.id!="menu-header"))==null||l.focus()},200),this.player.emit("show-language-menu",!1),this.player.emit("show-subtitles-menu",!1),this.player.emit("hide-subtitleSettings-menu"),this.player.emit("show-subtitleSettings-menu",!1),this.player.emit("show-subtitleSetting-menu",!1),this.player.emit("show-quality-menu",!1),this.player.emit("show-speed-menu",!1),this.player.emit("show-playlist-menu",!1)}),this.player.on("show-main-menu",s=>{this.mainMenuOpen=s,this.lockActive=s,s&&(t.classList.add("open"),this.player.emit("show-language-menu",!1),this.player.emit("show-subtitles-menu",!1),this.player.emit("hide-subtitleSettings-menu"),this.player.emit("show-subtitleSettings-menu",!1),this.player.emit("show-subtitleSetting-menu",!1),this.player.emit("show-quality-menu",!1),this.player.emit("show-speed-menu",!1),this.player.emit("show-playlist-menu",!1),i.classList.add("translate-x-0"),i.classList.remove("sub-menu-open"),t.style.display="flex",this.menuFrame.classList.remove("group-[&.nomercyplayer:has(.open)]:backdrop:!hidden"),this.center.classList.remove("!bg-none"),setTimeout(()=>{var l;(l=Array.from(this.mainMenu.children).find(n=>n.style.display!="none"&&n.id!="menu-header"))==null||l.focus()},200))}),this.player.on("show-language-menu",s=>{this.languageMenuOpen=s,this.lockActive=s,s&&(t.classList.add("open"),this.player.emit("show-main-menu",!1),this.player.emit("show-subtitles-menu",!1),this.player.emit("hide-subtitleSettings-menu"),this.player.emit("show-subtitleSettings-menu",!1),this.player.emit("show-subtitleSetting-menu",!1),this.player.emit("show-quality-menu",!1),this.player.emit("show-speed-menu",!1),this.player.emit("show-playlist-menu",!1),i.classList.remove("translate-x-0"),i.classList.add("sub-menu-open"),t.style.display="flex")}),this.player.on("show-subtitles-menu",s=>{this.subtitlesMenuOpen=s,this.lockActive=s,s&&(t.classList.add("open"),this.player.emit("show-main-menu",!1),this.player.emit("show-language-menu",!1),this.player.emit("show-quality-menu",!1),this.player.emit("hide-subtitleSettings-menu"),this.player.emit("show-subtitleSettings-menu",!1),this.player.emit("show-subtitleSetting-menu",!1),this.player.emit("show-speed-menu",!1),this.player.emit("show-playlist-menu",!1),i.classList.remove("translate-x-0"),i.classList.add("sub-menu-open"),t.style.display="flex")}),this.player.on("show-subtitleSettings-menu",s=>{this.subtitleSettingsMenuOpen=s,this.lockActive=!!s,s&&(t.classList.add("open"),this.player.emit("show-main-menu",!1),this.player.emit("show-language-menu",!1),this.player.emit("show-subtitles-menu",!1),this.player.emit("show-quality-menu",!1),this.player.emit("show-subtitleSetting-menu",!1),this.player.emit("show-speed-menu",!1),this.player.emit("show-playlist-menu",!1),i.classList.remove("translate-x-0"),i.classList.add("sub-menu-open"),t.style.display="flex")}),this.player.on("show-subtitleSetting-menu",s=>{this.subtitleSettingsMenuOpen=s,this.lockActive=!!s,s&&(t.classList.add("open"),this.player.emit("show-main-menu",!1),this.player.emit("show-language-menu",!1),this.player.emit("show-subtitles-menu",!1),this.player.emit("hide-subtitleSettings-menu"),this.player.emit("show-subtitleSettings-menu",!1),this.player.emit("show-quality-menu",!1),this.player.emit("show-speed-menu",!1),this.player.emit("show-playlist-menu",!1),i.classList.remove("translate-x-0"),i.classList.add("sub-menu-open"),t.style.display="flex")}),this.player.on("show-quality-menu",s=>{this.qualityMenuOpen=s,this.lockActive=s,s&&(t.classList.add("open"),this.player.emit("show-main-menu",!1),this.player.emit("show-language-menu",!1),this.player.emit("show-subtitles-menu",!1),this.player.emit("hide-subtitleSettings-menu"),this.player.emit("show-subtitleSettings-menu",!1),this.player.emit("show-subtitleSetting-menu",!1),this.player.emit("show-speed-menu",!1),this.player.emit("show-playlist-menu",!1),i.classList.remove("translate-x-0"),i.classList.add("sub-menu-open"),t.style.display="flex")}),this.player.on("show-speed-menu",s=>{this.speedMenuOpen=s,this.lockActive=s,s&&(t.classList.add("open"),this.player.emit("show-main-menu",!1),this.player.emit("show-language-menu",!1),this.player.emit("show-subtitles-menu",!1),this.player.emit("hide-subtitleSettings-menu"),this.player.emit("show-subtitleSettings-menu",!1),this.player.emit("show-subtitleSetting-menu",!1),this.player.emit("show-quality-menu",!1),this.player.emit("show-playlist-menu",!1),i.classList.remove("translate-x-0"),i.classList.add("sub-menu-open"),t.style.display="flex")}),this.player.on("show-playlist-menu",s=>{this.playlistMenuOpen=s,this.lockActive=s,s?(t.classList.add("open"),this.player.emit("show-main-menu",!1),this.player.emit("show-language-menu",!1),this.player.emit("show-subtitles-menu",!1),this.player.emit("hide-subtitleSettings-menu"),this.player.emit("show-subtitleSettings-menu",!1),this.player.emit("show-subtitleSetting-menu",!1),this.player.emit("show-quality-menu",!1),this.player.emit("show-speed-menu",!1),i.classList.remove("translate-x-0"),i.classList.add("sub-menu-open"),t.style.display="flex",this.player.emit("switch-season",this.player.playlistItem().season)):t.style.width=""}),this.player.on("controls",s=>{this.lockActive=s,s||(this.player.emit("show-menu",!1),this.player.emit("show-main-menu",!1),this.player.emit("show-language-menu",!1),this.player.emit("show-subtitles-menu",!1),this.player.emit("hide-subtitleSettings-menu"),this.player.emit("show-subtitleSettings-menu",!1),this.player.emit("show-subtitleSetting-menu",!1),this.player.emit("show-quality-menu",!1),this.player.emit("show-speed-menu",!1),this.player.emit("show-playlist-menu",!1))}),i}sizeMenuFrame(){var n,o;const a=(o=(n=this.player)==null?void 0:n.getElement())==null?void 0:o.getBoundingClientRect();if(!a)return;const{width:e,height:t,top:i,bottom:s,left:l}=a;this.menuFrame.firstChild.style.width=`${e}px`,this.menuFrame.firstChild.style.height=`${t}px`,this.menuFrame.firstChild.style.top=`${i}px`,this.menuFrame.firstChild.style.bottom=`${s}px`,this.menuFrame.firstChild.style.left=`${l}px`,this.menuFrame.firstChild.style.padding="2rem",this.menuFrame.firstChild.style.position="fixed"}createMainMenu(a){return this.mainMenu=this.player.createElement("div","main-menu").addClasses(["main-menu","bg-neutral-900/95","flex","flex-col","gap-1","group-[&.nomercyplayer:has(.sub-menu-open)]:!hidden","h-auto","max-h-full","min-w-64","mt-auto","overflow-clip","p-2","pt-0","rounded-lg","pointer-events-auto"]).appendTo(a),this.mainMenu.style.transform="translateX(0)",this.createMainMenuHeader(this.mainMenu).classList.add("!min-h-[2rem]","-mr-1"),this.player.addClasses(this.mainMenu,["main-menu","bg-neutral-900/95","flex","flex-col","gap-1","group-[&.nomercyplayer:has(.sub-menu-open)]:!hidden","h-auto","max-h-full","min-w-64","mt-auto","overflow-clip","p-2","pt-0","rounded-lg"]),this.player.once("translationsLoaded",()=>{this.createMenuButton(this.mainMenu,"language"),this.createMenuButton(this.mainMenu,"subtitles"),this.createMenuButton(this.mainMenu,"subtitle settings"),this.createMenuButton(this.mainMenu,"quality"),this.createMenuButton(this.mainMenu,"speed"),this.createMenuButton(this.mainMenu,"playlist")}),this.createSubMenu(a),this.mainMenu}createSubMenu(a){const e=this.player.createElement("div","sub-menu").addClasses(["sub-menu","bg-neutral-900/95","flex-col","gap-1","group-[&.nomercyplayer:has(.sub-menu-open)]:flex","h-auto","hidden","max-h-full","min-w-64","mt-auto","overflow-clip","rounded-lg","pointer-events-auto","w-full"]).appendTo(a);return e.style.transform="translateX(0)",this.createLanguageMenu(e),this.createSubtitleMenu(e),this.createSubtitleSettingsMenu(e),this.createQualityMenu(e),this.createSpeedMenu(e),this.player.options.playlist&&Array.isArray(this.player.options.playlist)?this.createEpisodeMenu(e):this.player.once("playlist",()=>{this.createEpisodeMenu(e)}),e}createMainMenuHeader(a,e=!1){const t=this.player.createElement("div","menu-header").addClasses(["menu-header","flex","h-9","items-center","min-h-[2.5rem]","py-2","text-white","w-available"]).addClasses(["border-b","border-gray-300/20","!p-0"]).appendTo(a),i=this.createUiButton(t,"close");return this.createSVGElement(i,"menu",this.buttons.close,e),this.player.addClasses(i,["ml-auto","w-8"]),i.classList.remove("w-5"),i.addEventListener("click",s=>{s.stopPropagation(),this.player.emit("show-menu",!1),this.lockActive=!1,this.player.emit("controls",!1),this.menuFrame.close(),this.player.emit("dynamicControls")}),t}createMenuHeader(a,e,t=!1){const i=this.player.createElement("div","menu-header").addClasses(["menu-header","flex","h-9","items-center","min-h-[2.5rem]","py-2","text-white","w-available"]).addClasses(["border-b","border-gray-300/20"]).appendTo(a);if(e!=="Episodes"){const l=this.createUiButton(i,"back");this.createSVGElement(l,"menu",this.buttons.chevronL,t),this.player.addClasses(l,["w-8"]),l.classList.remove("w-5"),l.addEventListener("click",n=>{n.stopPropagation(),this.player.emit("show-main-menu",!0),this.player.emit("show-language-menu",!1),this.player.emit("show-subtitles-menu",!1),this.player.emit("hide-subtitleSettings-menu"),this.player.emit("show-quality-menu",!1),this.player.emit("show-speed-menu",!1),this.player.emit("show-playlist-menu",!1)})}const s=this.player.createElement("span","menu-button-text").addClasses(this.menuButtonTextStyles).appendTo(i);if(s.innerText=this.player.localize(e).toTitleCase(),e!=="Seasons"){const l=this.createUiButton(i,"close");this.createSVGElement(l,"menu",this.buttons.close,t),this.player.addClasses(l,["ml-auto","w-8"]),l.classList.remove("w-5"),l.addEventListener("click",n=>{n.stopPropagation(),this.player.emit("show-menu",!1),this.lockActive=!1,this.player.emit("controls",!1),this.menuFrame.close(),this.player.emit("dynamicControls")})}return i}createSubtitleSettingMenuHeader(a,e){const t=this.player.createElement("div","menu-header").addClasses(["menu-header","flex","h-9","items-center","min-h-[2.5rem]","py-2","text-white","w-available"]).addClasses(["border-b","border-gray-300/20"]).appendTo(a),i=this.createUiButton(t,"back");this.createSVGElement(i,"menu",this.buttons.chevronL,!1),this.player.addClasses(i,["w-8"]),i.classList.remove("w-5"),i.addEventListener("click",n=>{n.stopPropagation(),this.player.emit("show-subtitleSettings-menu",!0),this.player.emit("show-subtitleSetting-menu",!1)});const s=this.player.createElement("span","menu-button-text").addClasses(this.menuButtonTextStyles).appendTo(t);s.innerText=this.player.localize(e).toTitleCase();const l=this.createUiButton(t,"close");return this.createSVGElement(l,"menu",this.buttons.close,!1),this.player.addClasses(l,["ml-auto","w-8"]),l.classList.remove("w-5"),l.addEventListener("click",n=>{n.stopPropagation(),this.player.emit("show-menu",!1),this.lockActive=!1,this.player.emit("controls",!1),this.menuFrame.close(),this.player.emit("dynamicControls")}),t}createMenuButton(a,e,t=!1){const i=this.spaceToCamel(e),s=this.player.createElement("button",`menu-button-${i}`).addClasses(this.languageMenuStyles).appendTo(a);i!=="speed"?s.style.display="none":this.player.hasSpeeds()?s.style.display="flex":s.style.display="none",this.createSVGElement(s,"menu",this.buttons[i],t);const l=this.player.createElement("span",`menu-button-${i}`).addClasses(this.menuButtonTextStyles).appendTo(s);l.innerText=this.player.localize(e.toTitleCase());const n=this.createSVGElement(s,"menu",this.buttons.chevronR,!1,t);this.player.addClasses(n,["ml-auto"]),s.addEventListener("click",o=>{o.stopPropagation(),this.player.emit(`show-${i}-menu`,!0),i==="playlist"&&window.nmplayer().emit("switch-season",window.nmplayer().playlistItem().season)}),i==="language"?(this.player.on("id",()=>{s.style.display="none"}),this.player.hasAudioTracks()&&(s.style.display="flex"),this.player.on("audioTracks",o=>{o.length>1?s.style.display="flex":s.style.display="none"})):i==="subtitles"?(this.player.on("id",()=>{s.style.display="none"}),this.player.hasCaptions()&&(s.style.display="flex"),this.player.on("captionsList",o=>{o.length>1?s.style.display="flex":s.style.display="none"})):i==="subtitleSettings"?s.style.display="flex":i==="quality"?(this.player.on("item",()=>{s.style.display="none"}),this.player.hasQualities()&&(s.style.display="flex"),this.player.on("levels",o=>{o.length>1?s.style.display="flex":s.style.display="none"})):i==="playlist"&&(this.player.options.playlist&&Array.isArray(this.player.options.playlist)&&(s.style.display="flex"),this.player.on("playlist",o=>{o.length>1?s.style.display="flex":s.style.display="none"}))}createLanguageMenu(a){const e=this.player.createElement("div","language-menu").addClasses(this.subMenuContentStyles).appendTo(a);this.createMenuHeader(e,"Language");const t=this.player.createElement("div","language-scroll-container").addClasses(this.scrollContainerStyles).appendTo(e);return t.style.transform="translateX(0)",this.player.on("item",()=>{t.innerHTML=""}),this.player.hasAudioTracks()&&Object.values(this.player.getAudioTracks()).forEach(i=>{this.createLanguageMenuButton(t,{language:i.language,label:i.label,type:"audio",id:i.id,buttonType:"audio"})}),this.player.on("audioTracks",i=>{t.innerHTML="",Object.values(i).forEach(s=>{this.createLanguageMenuButton(t,{language:s.language,label:s.label,type:"audio",id:s.id,buttonType:"audio"})})}),this.player.on("show-language-menu",i=>{i?(e.style.display="flex",setTimeout(()=>{t.firstChild.focus()},200)):e.style.display="none"}),e}createSubtitleMenu(a){const e=this.player.createElement("div","subtitle-menu").addClasses(this.subMenuContentStyles).appendTo(a);this.createMenuHeader(e,"subtitles");const t=this.player.createElement("div","subtitle-scroll-container").addClasses(this.scrollContainerStyles).appendTo(e);return t.style.transform="translateX(0)",this.player.on("item",()=>{t.innerHTML=""}),this.player.hasCaptions()&&Object.values(this.player.getCaptionsList()).forEach(i=>{this.createLanguageMenuButton(t,{language:i.language,label:i.label,type:i.type,id:i.id,buttonType:"subtitle"})}),this.player.on("captionsList",i=>{t.innerHTML="",Object.values(i).forEach(s=>{this.createLanguageMenuButton(t,{language:s.language,label:s.label,type:s.type,id:s.id,buttonType:"subtitle"})})}),this.player.on("show-subtitles-menu",i=>{i?(e.style.display="flex",setTimeout(()=>{t.firstChild.focus()},200)):e.style.display="none"}),e}createSubtitleSettingMenuButton(a,e){const t=this.player.createElement("button",`subtitleSetting-button-${this.spaceToCamel(e.label)}`).addClasses(this.languageMenuStyles).appendTo(a),i=this.player.createElement("span",`menu-button-text-${this.spaceToCamel(e.label)}`).addClasses(this.menuButtonTextStyles).appendTo(t);i.innerText=this.player.localize(e.label);const s=this.player.createElement("span",`menu-button-text-${this.spaceToCamel(e.label)}`).addClasses(this.menuButtonSubTextStyles).appendTo(t);if(this.player.addClasses(s,["ml-auto"]),e.property){const l=this.player.subtitleStyle[e.property].toString(),n=!isNaN(parseInt(l,10));e.property==="fontFamily"?(console.log(b.find(r=>r.value==l)),s.innerText=b.find(r=>r.value==l).name):e.property==="edgeStyle"?s.innerText=C.find(r=>r.value==l).name:s.innerText=(l+(n?"%":"")).toTitleCase();const o=this.createSVGElement(t,"menu",this.buttons.chevronR,!1,!1);this.player.addClasses(o,["ml-2"]),this.createSubtitleSettingMenu(a,e),this.player.on("set-subtitle-style",r=>{if(e.property!=r.property)return;const p=this.player.subtitleStyle[r.property].toString(),h=!isNaN(parseInt(p,10));e.property==="fontFamily"?(console.log(b.find(d=>d.value==p)),s.innerText=b.find(d=>d.value==p).name):e.property==="edgeStyle"?s.innerText=C.find(d=>d.value==p).name:s.innerText=(p+(h?"%":"")).toTitleCase()})}return t.addEventListener("click",l=>{l.stopPropagation(),e.property?(this.player.emit("show-subtitleSetting-menu",e.property),this.player.emit("hide-subtitleSettings-menu")):this.player.setSubtitleStyle(A)}),this.addKeyEventsToLanguageButton(t,a),t}createSubtitleSettingsMenu(a){const e=this.player.createElement("div","subtitleSettings-menu").addClasses(this.subMenuContentStyles).appendTo(a);this.createMenuHeader(e,"subtitle settings");const t=this.player.createElement("div","subtitleSettings-scroll-container").addClasses([...this.scrollContainerStyles,"!w-80"]).appendTo(e);return t.style.transform="translateX(0)",this.createSubtitleSettingMenuButton(t,{label:"Font",property:"fontFamily",buttonType:"subtitleSetting"}),this.createSubtitleSettingMenuButton(t,{label:"Text size",property:"fontSize",buttonType:"subtitleSetting"}),this.createSubtitleSettingMenuButton(t,{label:"Text color",property:"textColor",buttonType:"subtitleSetting"}),this.createSubtitleSettingMenuButton(t,{label:"Text opacity",property:"textOpacity",buttonType:"subtitleSetting"}),this.createSubtitleSettingMenuButton(t,{label:"Edge style",property:"edgeStyle",buttonType:"subtitleSetting"}),this.createSubtitleSettingMenuButton(t,{label:"Area color",property:"backgroundColor",buttonType:"subtitleSetting"}),this.createSubtitleSettingMenuButton(t,{label:"Area opacity",property:"backgroundOpacity",buttonType:"subtitleSetting"}),this.createSubtitleSettingMenuButton(t,{label:"Background color",property:"areaColor",buttonType:"subtitleSetting"}),this.createSubtitleSettingMenuButton(t,{label:"Background opacity",property:"windowOpacity",buttonType:"subtitleSetting"}),this.createSubtitleSettingMenuButton(t,{label:"Reset",property:"",buttonType:"subtitleSetting"}),this.player.on("show-subtitleSettings-menu",i=>{i!=!1?(e.style.display="flex",this.menuFrame.classList.add("group-[&.nomercyplayer:has(.open)]:backdrop:!hidden"),this.center.classList.add("!bg-none"),setTimeout(()=>{t.firstChild.focus()},200)):e.style.display="none"}),e}createSubtitleSettingMenu(a,e){const t=this.player.createElement("div",`subtitleSetting-menu-${e.property}`).addClasses(this.subMenuContentStyles).appendTo(a.parentElement.parentElement);t.style.display="none",this.createSubtitleSettingMenuHeader(t,e.label);const i=this.player.createElement("div",`subtitleSetting-scroll-container-${e.property}`).addClasses([...this.scrollContainerStyles,"!w-80"]).appendTo(t);return i.style.transform="translateX(0)",this.subtitleSettingActions.filter(s=>s.property==e.property).forEach(s=>{this.createSubtitleSettingActionButton(i,s)}),this.player.on("show-subtitleSetting-menu",s=>{e.property==s?(t.style.display="flex",this.menuFrame.classList.add("group-[&.nomercyplayer:has(.open)]:backdrop:!hidden"),this.center.classList.add("!bg-none"),setTimeout(()=>{i.firstChild.focus()},200)):t.style.display="none"}),this.player.on("hide-subtitleSetting-menu",()=>{t.style.display="none"}),i}createSubtitleSettingActionButton(a,e){const t=this.player.createElement("button",`subtitleSetting-action-button-${e.property}`).addClasses(this.languageMenuStyles).appendTo(a),i=this.player.createElement("span","menu-button-text").addClasses(this.menuButtonTextStyles).appendTo(t);i.innerText=this.player.localize(e.label).toTitleCase();const s=this.createSVGElement(t,"checkmark",this.buttons.checkmark,!1,!1);return this.player.addClasses(s,["ml-auto"]),e.value!=this.player.getSubtitleStyle()[e.property]&&s.classList.add("hidden"),this.player.on("set-subtitle-style",l=>{e.property==l.property&&(e.value==l.value?s.classList.remove("hidden"):s.classList.add("hidden"))}),t.addEventListener("click",l=>{l.stopPropagation(),e.action(l),this.player.emit("set-subtitle-style",e)}),this.addKeyEventsToLanguageButton(t,a),t}createSpeedMenu(a,e=!1){const t=this.player.createElement("div","speed-menu").addClasses(this.subMenuContentStyles).appendTo(a);this.createMenuHeader(t,"speed");const i=this.player.createElement("div","speed-scroll-container").addClasses(this.scrollContainerStyles).appendTo(t);i.style.transform="translateX(0)";for(const s of this.player.getSpeeds()??[]){const l=this.player.createElement("button",`speed-button-${s}`).addClasses(this.languageMenuStyles).appendTo(i),n=this.player.createElement("span",`menu-button-text-${s}`).appendTo(l),o=this.player.createElement("span",`menu-button-text-${s}`).addClasses(this.menuButtonTextStyles).appendTo(n);o.innerText=s==1?this.player.localize("Normal"):s.toString();const r=this.createSVGElement(l,"menu",this.buttons.checkmark,!1,e);this.player.addClasses(r,["ml-auto","hidden"]),this.player.on("speed",p=>{p===s?r.classList.remove("hidden"):r.classList.add("hidden")}),l.addEventListener("click",()=>{this.player.emit("show-menu",!1),this.player.setSpeed(s)}),s==this.player.getSpeed()&&r.classList.remove("hidden")}return this.player.on("show-speed-menu",s=>{s?(t.style.display="flex",setTimeout(()=>{i.firstChild.focus()},200)):t.style.display="none"}),t}createQualityMenu(a){const e=this.player.createElement("div","quality-menu").addClasses(this.subMenuContentStyles).appendTo(a);this.createMenuHeader(e,"quality");const t=this.player.createElement("div","quality-scroll-container").addClasses(this.scrollContainerStyles).appendTo(e);return t.style.transform="translateX(0)",this.player.on("item",()=>{t.innerHTML=""}),this.player.hasQualities()&&Object.values(this.player.getQualityLevels()).forEach(i=>{this.createQualityMenuButton(t,{id:i.id,width:i.width??0,height:i.height??0,label:i.label,bitrate:i.bitrate??0})}),this.player.on("levels",i=>{t.innerHTML="",Object.values(i).forEach(s=>{this.createQualityMenuButton(t,{id:s.id,width:s.width??0,height:s.height??0,label:s.label,bitrate:s.bitrate??0})})}),this.player.on("show-quality-menu",i=>{i?(e.style.display="flex",setTimeout(()=>{t.firstChild.focus()},200)):e.style.display="none"}),e}createQualityMenuButton(a,e,t=!1){var n;const i=this.player.createElement("button",`quality-button-${e.height}-${e.bitrate}`).addClasses(this.languageMenuStyles).appendTo(a),s=this.player.createElement("span","menu-button-text").addClasses(this.menuButtonTextStyles).appendTo(i);s.innerText=`${this.player.localize((n=e.label)==null?void 0:n.replace("segment-metadata","Off"))}`;const l=this.createSVGElement(i,"checkmark",this.buttons.checkmark,!1,t);return this.player.addClasses(l,["ml-auto"]),e.id>0&&l.classList.add("hidden"),this.player.on("levelsChanging",o=>{o.id==e.id?l.classList.remove("hidden"):l.classList.add("hidden")}),i.addEventListener("click",o=>{o.stopPropagation(),this.player.setCurrentQuality(e.id),this.player.emit("show-menu",!1)}),i}createSeekRipple(a,e){const t=this.player.createElement("div","seek-ripple").addClasses(["seek-ripple",e]).appendTo(a),i=this.player.createElement("div","seek-ripple-arrow").addClasses(["seek-ripple-arrow"]).appendTo(t),s=this.player.createElement("p","seek-ripple-text").addClasses(["seek-ripple-text"]).appendTo(t);return e=="left"?(t.style.borderRadius="0 50% 50% 0",t.style.left="0px",i.innerHTML=`
				<div class="arrow arrow2 arrow-left"></div>
				<div class="arrow arrow1 arrow-left"></div>
				<div class="arrow arrow3 arrow-left"></div>
			`,this.player.on("rewind",l=>{s.innerText=`${Math.abs(l)} ${this.player.localize("seconds")}`,t.style.display="flex"}),this.player.on("remove-rewind",()=>{t.style.display="none"})):e=="right"&&(t.style.borderRadius="50% 0 0 50%",t.style.right="0px",i.innerHTML=`
				<div class="arrow arrow3 arrow-right"></div>
				<div class="arrow arrow1 arrow-right"></div>
				<div class="arrow arrow2 arrow-right"></div>
			`,this.player.on("forward",l=>{s.innerText=`${Math.abs(l)} ${this.player.localize("seconds")}`,t.style.display="flex"}),this.player.on("remove-forward",()=>{t.style.display="none"})),t}createProgressBar(a){var o;this.sliderBar=this.player.createElement("div","slider-bar").addClasses(["slider-bar","bg-white/20","flex","group/slider","h-2","mx-4","pointer-events-auto","relative","rounded-full","w-available"]).appendTo(a);const e=this.player.createElement("div","slider-buffer").addClasses(["slider-buffer","absolute","bg-white/20","flex","h-full","overflow-clip","overflow-hidden","pointer-events-none","rounded-full","z-0"]).appendTo(this.sliderBar),t=this.player.createElement("div","slider-hover").addClasses(["slider-hover","absolute","bg-white/30","flex","h-full","opacity-1","overflow-clip","overflow-hidden","pointer-events-none","rounded-full","z-0"]).appendTo(this.sliderBar),i=this.player.createElement("div","slider-progress").addClasses(["slider-progress","absolute","bg-white","flex","h-full","overflow-clip","overflow-hidden","pointer-events-none","rounded-full","z-10"]).appendTo(this.sliderBar);this.chapterBar=this.player.createElement("div","chapter-progress").addClasses(["chapter-bar","bg-transparent","flex","h-2","overflow-clip","relative","rounded-full","w-available"]).appendTo(this.sliderBar);const s=document.createElement("div");this.player.addClasses(s,["slider-nipple","!-translate-x-1/2","!-translate-y-1/4","absolute","bg-white","group-hover/slider:flex","h-4","hidden","left-0","rounded-full","top-0","w-4","z-20"]),s.id="slider-nipple",this.player.options.nipple!=!1&&this.sliderBar.append(s);const l=this.player.createElement("div","slider-pop").addClasses(["slider-pop","-translate-x-1/2","absolute","bg-neutral-900/95","bottom-4","flex","flex-col","font-semibold","gap-1","hover:scale-110","overflow-clip","pb-1","pointer-events-none","rounded-md","text-center","z-20"]).appendTo(this.sliderBar);l.style.setProperty("--visibility","0"),l.style.opacity="var(--visibility)",this.sliderPopImage=this.player.createElement("div","slider-pop-image").addClasses(["slider-pop-image"]).appendTo(l);const n=this.player.createElement("div","slider-text").addClasses(["slider-pop-text","font-mono"]).appendTo(l);return this.chapterText=this.player.createElement("div","chapter-text").addClasses(["chapter-text"]).appendTo(l),this.player.options.chapters&&!this.player.isTv()&&((o=this.player.getChapters())==null?void 0:o.length)>0&&(this.sliderBar.style.background=""),["mousedown","touchstart"].forEach(r=>{this.sliderBar.addEventListener(r,()=>{this.isMouseDown||(this.isMouseDown=!0,this.isScrubbing=!0)},{passive:!0})}),this.bottomBar.addEventListener("click",r=>{if(this.player.emit("hide-tooltip"),!this.isMouseDown)return;this.isMouseDown=!1,this.isScrubbing=!1,l.style.setProperty("--visibility","0");const p=this.getScrubTime(r);s.style.left=`${p.scrubTime}%`,this.player.seek(p.scrubTimePlayer)},{passive:!0}),["mousemove","touchmove"].forEach(r=>{this.sliderBar.addEventListener(r,p=>{var f;const h=this.getScrubTime(p);this.getSliderPopImage(h),n.innerText=S(h.scrubTimePlayer);const d=this.getSliderPopOffsetX(l,h);l.style.left=`${d}%`,(!this.player.options.chapters||((f=this.player.getChapters())==null?void 0:f.length)==0)&&(t.style.width=`${h.scrubTime}%`),this.isMouseDown&&(this.chapterText.innerText=this.getChapterText(h.scrubTimePlayer)??"",s.style.left=`${h.scrubTime}%`,this.previewTime.length>0&&l.style.setProperty("--visibility","1"))},{passive:!0})}),this.sliderBar.addEventListener("mouseover",r=>{const p=this.getScrubTime(r);if(this.getSliderPopImage(p),n.innerText=S(p.scrubTimePlayer),this.chapterText.innerText=this.getChapterText(p.scrubTimePlayer)??"",this.previewTime.length>0){l.style.setProperty("--visibility","1");const h=this.getSliderPopOffsetX(l,p);l.style.left=`${h}%`}},{passive:!0}),this.player.on("active",r=>{setTimeout(()=>{this.controlsVisible=r},(this.player.options.doubleClickDelay??300)+10),!r&&l.style.setProperty("--visibility","0")}),this.sliderBar.addEventListener("mouseleave",()=>{l.style.setProperty("--visibility","0"),t.style.width="0"},{passive:!0}),this.player.on("seeked",()=>{l.style.setProperty("--visibility","0")}),this.player.on("item",()=>{this.sliderBar.classList.add("bg-white/20"),this.previewTime=[],this.chapters=[],e.style.width="0",i.style.width="0",this.fetchPreviewTime()}),this.player.on("chapters",()=>{var r;((r=this.player.getChapters())==null?void 0:r.length)>0&&!this.player.isTv()?this.sliderBar.classList.remove("bg-white/20"):this.sliderBar.classList.add("bg-white/20")}),this.player.on("time",r=>{var p;((p=this.player.getChapters())==null?void 0:p.length)==0&&(i.style.width=`${r.percentage}%`),this.isScrubbing||(s.style.left=`${r.percentage}%`)}),this.player.on("controls",r=>{r||(l.style.setProperty("--visibility","0"),this.menuFrame.close())}),this.player.on("pip-internal",r=>{r?this.sliderBar.style.display="none":this.sliderBar.style.display="flex"}),this.sliderBar}getChapterText(a){var t,i,s,l;if(this.player.getChapters().length==0)return null;const e=(t=this.player.getChapters())==null?void 0:t.findIndex(n=>n.startTime>a);return((i=this.player.getChapters()[e-1])==null?void 0:i.title)??((l=this.player.getChapters()[((s=this.player.getChapters())==null?void 0:s.length)-1])==null?void 0:l.title)??null}createChapterMarker(a){const e=this.player.createElement("div",`chapter-marker-${a.id.replace(/\s/gu,"-")}`).addClasses(["chapter-marker","[&:last-child(2):.5px]","absolute","h-available","last:translate-x-[1.5px]","min-w-[2px]","overflow-hidden","rounded-sm"]).appendTo(this.chapterBar);e.style.left=`${a.left}%`,e.style.width=`calc(${a.width}% - 2px)`,this.player.createElement("div",`chapter-marker-bg-${a.id.replace(/\s/gu,"-")}`).addClasses(["chapter-marker-bg","absolute","bg-white/20","h-available","left-0","rounded-sm","w-available","z-0"]).appendTo(e);const t=this.player.createElement("div",`chapter-marker-hover-${a.id.replace(/\s/gu,"-")}`).addClasses(["chapter-marker-hover","absolute","bg-gray-200","h-available","left-0","origin-left","rounded-sm","scale-x-0","w-available","z-10"]).appendTo(e),i=this.player.createElement("div",`chapter-marker-progress-${a.id.replace(/\s/gu,"-")}`).addClasses(["chapter-marker-progress","absolute","bg-white","h-available","left-0","origin-left","rounded-sm","scale-x-0","w-available","z-20"]).appendTo(e),s=a.left,l=a.left+a.width;return this.player.on("time",n=>{n.percentage<s?i.style.transform="scaleX(0)":n.percentage>l?i.style.transform="scaleX(1)":i.style.transform=`scaleX(${(n.percentage-s)/(l-s)})`}),["mousemove","touchmove"].forEach(n=>{this.chapterBar.addEventListener(n,o=>{const{scrubTime:r}=this.getScrubTime(o);r<s?t.style.transform="scaleX(0)":r>l?t.style.transform="scaleX(1)":t.style.transform=`scaleX(${(r-s)/(l-s)})`})}),this.chapterBar.addEventListener("mouseleave",()=>{t.style.transform="scaleX(0)"}),e}createChapterMarkers(){var a;this.player.isTv()||(this.chapterBar.style.background="",this.player.on("item",()=>{this.chapterBar.style.background=""}),this.chapterBar.querySelectorAll(".chapter-marker").forEach(e=>{this.chapterBar.classList.add("bg-white/20"),e.remove()}),(a=this.player.getChapters())==null||a.forEach(e=>{this.createChapterMarker(e)}))}getSliderPopOffsetX(a,e){const t=this.sliderBar.getBoundingClientRect(),s=a.getBoundingClientRect().width*.5/t.width*100;let l=e.scrubTime;return l<=s&&(l=s),l>=100-s&&(l=100-s),l}createEpisodeMenu(a){if(!this.player.getVideoElement())return;const e=this.player.createElement("div","playlist-menu").addClasses([...this.subMenuContentStyles,"!flex-row","!gap-0"]).appendTo(a),t=this.player.createElement("div","sub-menu-content").addClasses([...this.subMenuContentStyles,"!w-1/3","border-r-2","border-gray-500/20"]).appendTo(e);this.createMenuHeader(t,"Seasons");const i=this.player.createElement("div","playlist-scroll-container").addClasses(this.scrollContainerStyles).appendTo(t);i.style.transform="translateX(0)",i.innerHTML="";for(const[,n]of $(this.player.getPlaylist(),"season").entries()??[])this.createSeasonMenuButton(i,n);const s=this.player.createElement("div","episode-menu").addClasses([...this.subMenuContentStyles,"!w-[63rem]"]).appendTo(e);this.createMainMenuHeader(s);const l=this.player.createElement("div","playlist-scroll-container").addClasses(this.scrollContainerStyles).appendTo(s);l.innerHTML="",l.tabIndex=1,l.addEventListener("focus",()=>{var n;(n=l.firstChild)==null||n.focus()});for(const[n,o]of this.player.getPlaylist().entries()??[])this.createEpisodeMenuButton(l,o,n);return this.player.on("show-playlist-menu",n=>{n?(e.style.display="flex",setTimeout(()=>{l.firstChild.focus()},200)):e.style.display="none"}),e}createSeasonMenuButton(a,e,t=!1){if(!(e!=null&&e.season))return;const i=this.player.createElement("button",`season-${e.id}`).addClasses(this.languageMenuStyles).appendTo(a),s=this.player.createElement("span",`season-${e.id}-span`).addClasses(this.menuButtonTextStyles).appendTo(i);s.innerText=e!=null&&e.seasonName?e==null?void 0:e.seasonName:e!=null&&e.season?this.player.localize("Season")+` ${e==null?void 0:e.season}`:"";const l=this.createSVGElement(i,"menu",this.buttons.chevronR,!1,t);return this.player.addClasses(l,["ml-auto"]),i.addEventListener("click",()=>{this.player.emit("switch-season",e==null?void 0:e.season)}),i.addEventListener("focus",()=>{setTimeout(()=>{this.scrollCenter(i,a,{duration:100,margin:1})},50)}),i}createEpisodeMenuButton(a,e,t){var g,w,v,x;const i=this.player.createElement("button",`playlist-${e.id}`).addClasses(["playlist-menu-button","duration-200","flex","focus-visible:outline-2","focus-visible:outline-white","gap-2","hover:bg-neutral-600/20","outline","outline-1","outline-solid","outline-transparent","p-2","relative","rounded-lg","snap-center","text-white","transition-all","w-available"]).appendTo(a);((g=this.player.playlistItem())==null?void 0:g.season)!==1&&(i.style.display="none");const s=this.player.createElement("div",`playlist-${e.id}-left`).addClasses(["episode-menu-button-left","h-available","overflow-clip","pointer-events-none","relative","rounded-md","self-center","w-[30%]"]).appendTo(i);this.player.createElement("div",`episode-${e.id}-shadow`).addClasses(["episode-menu-button-shadow","!h-available","absolute","bg-[linear-gradient(0deg,rgba(0,0,0,0.87)_0%,rgba(0,0,0,0.7)_25%,rgba(0,0,0,0)_50%,rgba(0,0,0,0)_100%)]","bottom-0","left-0","shadow-[inset_0px_1px_0px_rgba(255,255,255,0.24),inset_0px_-1px_0px_rgba(0,0,0,0.24),inset_0px_-2px_0px_rgba(0,0,0,0.24)]","w-available"]).appendTo(s);const l=this.player.createElement("img",`episode-${e.id}-image`).addClasses(["episode-menu-button-image","aspect-video","h-auto","object-cover","w-available"]).appendTo(s);l.setAttribute("loading","lazy"),l.src=e.image&&e.image!=""?`${this.imageBaseUrl.includes("https")?"":this.imageBaseUrl}${e.image}`:"";const n=this.player.createElement("div",`episode-${e.id}-progress-container`).addClasses(["episode-menu-progress-container","absolute","bottom-0","flex","flex-col","px-3","w-available"]).appendTo(s),o=this.player.createElement("div",`episode-${e.id}-progress-box`).addClasses(["episode-menu-progress-box","flex","h-available","justify-between","mb-1","px-1","sm:mx-2"]).appendTo(n),r=this.player.createElement("div",`episode-${e.id}-progress-item`).addClasses(["progress-item-text","text-[0.7rem]"]).appendTo(o);e.episode&&(r.innerText=`${this.player.localize("E")}${e.episode}`);const p=this.player.createElement("div",`episode-${e.id}-progress-duration`).addClasses(["progress-duration","text-[0.7rem]"]).appendTo(o);p.innerText=((w=e.duration)==null?void 0:w.replace(/^00:/u,""))??"";const h=this.player.createElement("div",`episode-${e.id}-slider-container`).addClasses(["slider-container","bg-gray-500/80","h-1","hidden","mb-2","mx-1","overflow-clip","rounded-md","sm:mx-2"]).appendTo(n),d=this.player.createElement("div",`episode-${e.id}-progress-bar`).addClasses(["progress-bar","bg-white"]).appendTo(h);(v=e.progress)!=null&&v.time&&(d.style.width=`${e.progress.time/P(e.duration)*100}%`,h.style.display="flex");const f=this.player.createElement("div",`episode-${e.id}-right-side`).addClasses(["playlist-card-right","flex","flex-col","gap-1","pointer-events-none","text-left","w-3/4"]).appendTo(i),E=this.player.createElement("span",`episode-${e.id}-title`).addClasses(["playlist-menu-button-title","font-bold","line-clamp-2","text-white"]).appendTo(f);e.episode&&(E.innerText=R((x=e.title)==null?void 0:x.replace(e.show??"","").replace("%S",this.player.localize("S")).replace("%E",this.player.localize("E"))));const B=this.player.createElement("span",`episode-${e.id}-overview`).addClasses(["playlist-menu-button-overview","leading-[1rem]","line-clamp-4","overflow-hidden","text-[0.7rem]","text-white"]).appendTo(f);return B.innerText=F(e.description,600),this.player.on("item",m=>{m.season==e.season?i.style.display="flex":i.style.display="none",this.player.playlistItem().season==e.season&&this.player.playlistItem().episode==e.episode?i.style.background="rgba(255,255,255,.1)":i.style.background=""}),this.player.on("switch-season",m=>{m==e.season?i.style.display="flex":i.style.display="none"}),this.player.on("time",m=>{var T;((T=this.player.playlistItem())==null?void 0:T.id)==e.id&&(d.style.width=`${m.percentage}%`,m.percentage>0&&(h.style.display="flex"))}),e.episode&&e.show&&(r.innerText=e.season==null?`${e.episode}`:`${this.player.localize("S")}${e.season}: ${this.player.localize("E")}${e.episode}`),i.addEventListener("click",()=>{this.player.emit("show-menu",!1),e.episode&&e.season?this.setEpisode(e.season,e.episode):this.player.playlistItem(t),this.player.emit("playlist-menu-button-clicked",e)}),i.addEventListener("focus",()=>{setTimeout(()=>{this.scrollCenter(i,a,{duration:100,margin:1})},50)}),i}createToolTip(a){return this.tooltip=this.player.createElement("div","tooltip").addClasses(["tooltip","absolute","bg-neutral-900/95","bottom-0","font-medium","hidden","left-0","pointer-events-none","px-3","py-2","rounded-lg","text-white","text-xs","z-50"]).appendTo(a),this.tooltip.style.transform="translateX(10px)",this.tooltip.innerText="Play (space)",this.player.on("show-tooltip",e=>{this.tooltip.innerText=e.text,this.tooltip.style.display="block",this.tooltip.style.transform=`translate(calc(${e.x} - 50%), calc(${e.y} - 100%))`,e.currentTime=="top"?(this.tooltip.classList.add("top-0"),this.tooltip.classList.remove("bottom-0")):(this.tooltip.classList.remove("top-0"),this.tooltip.classList.add("bottom-0"))}),this.player.on("hide-tooltip",()=>{this.tooltip.style.display="none"}),this.tooltip}createEpisodeTip(a){const e=this.player.createElement("div","episode-tip").addClasses(["episode-tip","!w-96","-bottom-10","absolute","bg-neutral-900/95","font-medium","gap-2","h-24","hidden","left-0","px-2","py-2","rounded-lg","text-white","text-xs","z-50","group-[&.nomercyplayer:not(.active)]:!hidden"]).appendTo(a),t=this.player.createElement("div","next-tip-left").addClasses(["next-tip-left","overflow-clip","relative","rounded-sm","self-center","w-[40%]"]).appendTo(e),i=this.player.createElement("img","next-tip-image").addClasses(["playlist-card-image","aspect-video","h-auto","object-cover","rounded-md","w-available"]).appendTo(t);i.setAttribute("loading","eager");const s=this.player.createElement("div","next-tip-right-side").addClasses(["next-tip-right","flex","flex-col","gap-1","text-left","w-[60%]"]).appendTo(e),l=this.player.createElement("span","next-tip-header").addClasses(["next-tip-header","font-bold"]).appendTo(s),n=this.player.createElement("span","next-tip-title").addClasses(["next-tip-header","font-bold","font-sm","line-clamp-3"]).appendTo(s);return this.player.on("show-episode-tip",o=>{this.getTipData({direction:o.direction,header:l,title:n,image:i}),e.style.display="flex",e.style.transform=`translate(${o.x}, calc(${o.y} - 50%))`}),this.player.on("hide-episode-tip",()=>{e.style.display="none"}),e}getTipDataIndex(a){let e=this.player.getPlaylistIndex();return a=="previous"?e-=1:e+=1,this.player.getPlaylist().at(e)}getTipData({direction:a,header:e,title:t,image:i}){var l;const s=this.getTipDataIndex(a);s&&(i.src=s.image&&s.image!=""?`${this.imageBaseUrl}${s.image}`:"",e.innerText=`${this.player.localize(`${a.toTitleCase()} Episode`)} ${this.getButtonKeyCode(a)}`,t.innerText=(l=s.title)==null?void 0:l.replace(s.show??"","").replace("%S",this.player.localize("S")).replace("%E",this.player.localize("E")),this.player.once("item",()=>{this.getTipData({direction:a,header:e,title:t,image:i})}))}createButton(a,e,t="after",i,s,l){const n=document.querySelector(`${a}`);if(!n)throw new Error("Element not found");const o=this.createUiButton(n,e.replace(/\s/gu,"_"));return o.ariaLabel=e,t==="before"?n==null||n.before(o):n==null||n.after(o),this.createSVGElement(o,`${e.replace(/\s/gu,"_")}-enabled`,i,!0,!1),this.createSVGElement(o,e.replace(/\s/gu,"_"),i,!1),o.addEventListener("click",r=>{r.stopPropagation(),s==null||s(),this.player.emit("hide-tooltip")}),o.addEventListener("contextmenu",r=>{r.stopPropagation(),l==null||l(),this.player.emit("hide-tooltip")}),o}}export{I as D};
