import{I as M,ae as s,l as _,w as I,D,af as N,bM as U,d as x,o as T,s as k,j as A,K as b,bu as B,a as H,bh as V,ap as t,R as F,a2 as r}from"./index-DkQngsHe.js";import{g as c}from"./imageModal-Or-EXmDB.js";import{S as K,O}from"./octopusPlugin-Bie2Fw1-.js";import{A as R}from"./autoSkipPlugin-W08l_S14.js";import{n as j}from"./subtitles-octopus-BvnPWJkB.js";import{D as q}from"./desktopUIPlugin-DtYivsLh.js";import{K as z}from"./keyHandlerPlugin-B_jka6eM.js";import{u as E}from"./useServerClient-CmW8VHrx.js";import{V as G}from"./videoNoMercyConnectPlugin-sHhXdyRm.js";import"./buttons-DnucOQvv.js";import"./useQuery-jTNaBwZN.js";import"./useBaseQuery-BnGe7Aaf.js";import"./useQueryClient-Cy1MABnp.js";import"./useInfiniteServerClient-BHsBwDbE.js";const re=M({__name:"Desktop",setup(J){var p;const{data:u}=E({enabled:!((p=s.value.features)!=null&&p.nomercyConnect)}),e=_();function i(a){var d,f,m,g,y,v;const o={muted:!1,controls:!1,preload:"auto",debug:!1,autoPlay:!0,playlist:(a==null?void 0:a.filter(n=>!!n.id))??[],controlsTimeout:3e3,doubleClickDelay:300,playbackRates:[.25,.5,.75,1,1.25,1.5,1.75,2],accessToken:(d=s.value)==null?void 0:d.accessToken,basePath:(f=F.value)==null?void 0:f.serverBaseUrl,forceTvMode:(t("android")||t("ios"))&&!t("mobile"),disableTouchControls:!1,disableMediaControls:"mediaSession"in navigator||t("capacitor"),renderAhead:100,disableAutoPlayback:(m=s.value.features)==null?void 0:m.nomercyConnect};if((g=e.value)==null||g.dispose(),e.value=j("player1").setup(o),e.value.once("back",()=>{history.state.back?r.back():r.replace("/")}),(y=s.value.features)!=null&&y.nomercyConnect){const n=new G;e.value.registerPlugin("videoNoMercyConnect",n),e.value.usePlugin("videoNoMercyConnect")}const C=new q;e.value.registerPlugin("desktopUI",C),e.value.usePlugin("desktopUI");const w=new R;e.value.registerPlugin("autoSkip",w),e.value.usePlugin("autoSkip");const S=new z;if(e.value.registerPlugin("keyHandler",S),e.value.usePlugin("keyHandler"),!((v=s.value.features)!=null&&v.nomercyConnect)){const n=new K;e.value.registerPlugin("sync",n),e.value.usePlugin("sync")}const h=new O;e.value.registerPlugin("octopus",h),e.value.usePlugin("octopus"),e.value.once("play",()=>{e.value.enterFullscreen()}),e.value.on("playlistComplete",()=>{console.log("Playlist complete"),history.state.back?r.back():r.replace("/")}),e.value.on("play",()=>{c(!0)}),e.value.on("pause",()=>{c(!1)}),e.value.on("fullscreen",n=>{var l,P;(P=(l=window.external)==null?void 0:l.sendMessage)==null||P.call(l,n?"enterFullscreen":"exitFullscreen")})}return I(u,a=>{a!=null&&a.length&&i(a)}),D(()=>{var a,o;N.stop(),(a=s.value.features)!=null&&a.nomercyConnect?i():(o=u.value)!=null&&o.length&&i(u.value)}),U(()=>{var a;(a=e.value)==null||a.dispose(),c(!1)}),(a,o)=>(T(),x(b(V),null,{default:k(()=>[A(b(B),{fullscreen:!0},{default:k(()=>o[0]||(o[0]=[H("div",{id:"player1",class:"group nomercyplayer"},null,-1)])),_:1})]),_:1}))}});export{re as default};
