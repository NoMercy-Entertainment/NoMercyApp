import"./i18n-DXLa9EKW.js";import{fn as a}from"./index-CLM6Y7vI.js";import{setUpdatePending as o}from"./updateState-ChPJAutX.js";import{t as n}from"./pwa-B3c6W3lJ.js";var i=300*1e3,s="/version.json",c=null;function d(){return localStorage.getItem("language")||navigator.language.split("-")[0]||"en"}function f(){const e=n[d()]||n.en;a({id:"version-update-pending",type:"update",title:e.newVersion,body:e.updateNow,from:"system",read:!1,created_at:Date.now(),updated_at:Date.now(),notify:!0,link:"reload"})}async function r(){try{const e=await fetch(s,{cache:"no-store",headers:{"Cache-Control":"no-cache"}});if(!e.ok||!(e.headers.get("content-type")??"").includes("application/json"))return!1;const t=await e.json();return t.version!=="7e0cbf6"?(o(t.version),f(),!0):!1}catch(e){return console.error("Version check failed:",e),!1}}function v(){c=window.setInterval(r,i),document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&r()})}export{r as checkForUpdates,v as startVersionChecks};
