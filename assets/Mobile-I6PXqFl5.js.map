{"version":3,"file":"Mobile-I6PXqFl5.js","sources":["../../src/views/Base/Libraries/Mobile.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport {IonPage, IonContent, onIonViewWillEnter, onIonViewDidEnter} from '@ionic/vue';\n\nimport {type PropType, watch} from 'vue';\nimport type { HomeItem } from '@/types/api/base/home';\nimport { type Component, getMutating, getMutation, getQuery, queryKey } from '@/lib/routerHelper';\n\nimport router from '@/router';\nimport { useRoute } from 'vue-router';\nimport {currentServer} from \"@/store/currentServer\";\n\nconst props = defineProps({\n  options: {\n    type: Object as PropType<Component<HomeItem>[] & { queryKey?: string[], path?: string }>,\n    required: false,\n    default: () => ({\n      keepForever: true,\n      queryKey: queryKey(),\n    }),\n  },\n});\n\nconst route = useRoute();\nconst routeName = router.currentRoute.value.name;\n\nconst isMutating = getMutating({ queryKey: props.options?.queryKey, path: '/libraries/mobile' });\n\nconst { data: homeData, refetch } = getQuery({ queryKey: props.options.queryKey, path: '/libraries/mobile' });\n\nconst { data: mutatedData, mutate, reset } = getMutation({ queryKey: props.options.queryKey, homeData: homeData });\n\nonIonViewWillEnter(() => {\n  if (!homeData.value) return;\n\n  if (route.name !== routeName) return;\n\n  const mutations = homeData.value?.filter?.(item => item?.update?.when == 'pageLoad') ?? [];\n  mutate(mutations);\n});\n\nonIonViewDidEnter(() => {\n  document.dispatchEvent(new Event('indexer'));\n});\n\nwatch(currentServer, (value) => {\n  if (!value) {\n    mutatedData.value = undefined;\n    homeData.value = undefined;\n  }\n  else {\n    refetch();\n    reset();\n  }\n});\n\n</script>\n\n<template>\n  <ion-page>\n    <ion-content :fullscreen=\"true\">\n      <template v-if=\"!isMutating && (mutatedData?.every?.(d => d.component) || homeData?.every?.(d => d.component))\">\n        <component v-for=\"(render, index) in mutatedData ?? homeData\" :index=\"index\" :key=\"render.id\"\n          :is=\"render.component\" v-bind=\"render.props\" />\n      </template>\n    </ion-content>\n  </ion-page>\n</template>\n"],"names":["props","__props","route","useRoute","routeName","router","isMutating","getMutating","_a","homeData","refetch","getQuery","mutatedData","mutate","reset","getMutation","onIonViewWillEnter","mutations","_b","item","onIonViewDidEnter","watch","currentServer","value"],"mappings":"uVAWA,MAAMA,EAAQC,EAWRC,EAAQC,EAAS,EACjBC,EAAYC,EAAO,aAAa,MAAM,KAEtCC,EAAaC,EAAY,CAAE,UAAUC,EAAAR,EAAM,UAAN,YAAAQ,EAAe,SAAU,KAAM,oBAAqB,EAEzF,CAAE,KAAMC,EAAU,QAAAC,CAAA,EAAYC,EAAS,CAAE,SAAUX,EAAM,QAAQ,SAAU,KAAM,oBAAqB,EAEtG,CAAE,KAAMY,EAAa,OAAAC,EAAQ,MAAAC,CAAM,EAAIC,EAAY,CAAE,SAAUf,EAAM,QAAQ,SAAU,SAAAS,EAAoB,EAEjH,OAAAO,EAAmB,IAAM,SAGvB,GAFI,CAACP,EAAS,OAEVP,EAAM,OAASE,EAAW,OAExB,MAAAa,IAAYC,GAAAV,EAAAC,EAAS,QAAT,YAAAD,EAAgB,SAAhB,YAAAU,EAAA,KAAAV,EAAyBW,GAAQ,OAAA,QAAAX,EAAAW,GAAA,YAAAA,EAAM,SAAN,YAAAX,EAAc,OAAQ,eAAe,CAAC,EACzFK,EAAOI,CAAS,CAAA,CACjB,EAEDG,EAAkB,IAAM,CACtB,SAAS,cAAc,IAAI,MAAM,SAAS,CAAC,CAAA,CAC5C,EAEKC,EAAAC,EAAgBC,GAAU,CACzBA,GAKKb,EAAA,EACFI,EAAA,IALNF,EAAY,MAAQ,OACpBH,EAAS,MAAQ,OAKnB,CACD"}