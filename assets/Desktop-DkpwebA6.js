import{aG as w,j as u,o as l,a7 as r,a as _,c as $,aR as I,t as c,bG as R,ba as k,K as C,v as S,x as s,aI as o,bS as L,F as q,w as N,C as x,a6 as m,bQ as j,bI as v,br as K}from"./index-DptfosSX.js";import{_ as V}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-CwEGzoBR.js";import{_ as z}from"./DashboardCard.vue_vue_type_script_setup_true_lang-Dpek2Qt_.js";import"./FloatingBackButton.vue_vue_type_script_setup_true_lang-UVOnhi59.js";import"./Button.vue_vue_type_script_setup_true_lang-Dq3V_YMm.js";const D={class:"relative flex aspect-video flex-shrink-0 flex-grow-0 flex-col items-center justify-center self-stretch overflow-clip rounded-lg bg-theme-11 dark:bg-theme-8 text-slate-light-12/80 dark:text-slate-dark-12/80"},F={key:1,class:"text-xl font-bold"},G=w({__name:"LibraryCard",props:{data:{type:Object,required:!0}},setup(e){return(y,i)=>{var n,a,d;return l(),u(z,{route:`/dashboard/libraries/${e.data.id}`,line1:e.data.title,line2:e.data.folder_library&&((n=e.data.folder_library)==null?void 0:n.length)!=1?`${(a=e.data.folder_library)==null?void 0:a.length} folders`:`${(d=e.data.folder_library)==null?void 0:d.length}  folder`},{image:r(()=>[_("div",D,[i[0]||(i[0]=_("div",{class:"backdropCard-overlay"},null,-1)),e.data.image?(l(),u(I,{key:0,path:e.data.image,class:"z-0"},null,8,["path"])):(l(),$("span",F,c(e.data.title),1))])]),_:1},8,["route","line1","line2"])}}}),O=w({__name:"Desktop",setup(e){var p;const{data:y,error:i}=R({path:"dashboard/libraries",queryKey:["dashboard","libraries",(p=k.value)==null?void 0:p.serverBaseUrl]}),n=()=>{v().post("dashboard/libraries").then(({data:t})=>{var b;K.invalidateQueries({queryKey:["dashboard","libraries",(b=k.value)==null?void 0:b.serverBaseUrl]})})},a=C(!1),d=()=>{a.value=!0,v().post("dashboard/libraries/refresh").then(({data:t})=>{a.value=!1}).catch(()=>{a.value=!1})},f=C(!1),B=()=>{f.value=!0,v().post("dashboard/libraries/rescan").then(({data:t})=>{f.value=!1}).catch(()=>{f.value=!1})};return(t,b)=>{const h=S("Button");return l(),u(o(j),null,{default:r(()=>[s(o(L),{fullscreen:!0},{default:r(()=>[s(V,{error:o(i),gridStyle:1,title:"Libraries",description:"Manage your media libraries and their content here."},{cta:r(()=>[s(h,{id:"newLibrary",color:"theme",startIcon:"folderAdd",onClick:n},{default:r(()=>[m(c(t.$t("New library")),1)]),_:1})]),actions:r(()=>[s(h,{type:"button",id:"refresh",variant:"text",startIcon:"folderSwap",disabled:a.value,class:x(a.value?"first:children:animate-spin cursor-not-allowed":""),onClick:d},{default:r(()=>[m(c(t.$t("Refresh all libraries")),1)]),_:1},8,["disabled","class"]),s(h,{type:"button",id:"rescan",variant:"text",startIcon:"folderSwap",disabled:a.value,class:x(a.value?"first:children:animate-spin cursor-not-allowed":""),onClick:B},{default:r(()=>[m(c(t.$t("Rescan all libraries")),1)]),_:1},8,["disabled","class"])]),default:r(()=>[(l(!0),$(q,null,N(o(y)??[],g=>(l(),u(G,{key:g.id,data:g},null,8,["data"]))),128))]),_:1},8,["error"])]),_:1})]),_:1})}}});export{O as default};
