import{$ as ee,d as l,w as n,f as re,B as oe,aZ as te,k as se,c as ae,o as S,p as v,z as i,a0 as d,av as le,h as y,b as C,j as s,x as H,A as ne,as as ue,R as ie}from"./vue-ionic-D4s4ExYp.js";import{c as a,a as de,c0 as I,bz as N,c1 as h}from"./index-D29s6-I8.js";import{_ as me}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-Nn4dwAdV.js";import{u as pe}from"./useServerClient-B1iLPo0s.js";import{T as fe}from"./Toggle-C-ZMzIxy.js";import{_ as ve}from"./OptimizedIcon.vue_vue_type_script_setup_true_lang-BMWMPBMW.js";import{g as _e,f as q}from"./primevue-C7GgiIOs.js";import"./vendor-Dgtccx1h.js";import"./icons-BW5E66pf.js";import"./rxjs-BCp2L9Rn.js";import"./media-C2AqgyMX.js";import"./api-BBofn2cc.js";import"./swiper-D00Cnjmx.js";import"./music-player-BiOHSPVn.js";import"./useMounted-DYwXa4R_.js";import"./FloatingBackButton.vue_vue_type_script_setup_true_lang-ds0OrJIA.js";import"./Button.vue_vue_type_script_setup_true_lang-CzLYMh2i.js";import"./ScrollContainer.vue_vue_type_script_setup_true_lang-B9z-yNTL.js";import"./RipperOverlay.vue_vue_type_script_setup_true_lang-CXq-Wp6k.js";import"./ripperSocket-wzC5X917.js";import"./useInfiniteServerClient-B4MMmB_5.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const we={key:0,class:"col-span-2 col-start-1 2xl:col-start-1"},ge={class:"flex flex-col gap-2"},ce={class:"flex flex-col gap-2"},ke={class:"flex flex-col gap-2"},xe={key:1,class:"col-span-2 col-start-1 2xl:col-start-3"},be={class:"flex flex-col gap-2"},Ve={class:"flex flex-col gap-2"},Se={class:"flex flex-col gap-2"},qe={key:2,class:"col-span-2 col-start-1 2xl:col-start-5"},Be={class:"flex flex-col gap-2"},ye={class:"flex gap-4"},Ce=["aria-label","href"],We=ee({__name:"Desktop",setup(Ue){var O,z,A,P,Q,T,j,D,E,R;const{data:o,refetch:J,error:L}=pe({path:"/dashboard/configuration"}),_=l(!1),u=l(o.value??{}),m=(e,r)=>{if(o.value){if(ie(o.value[e])===r){delete u.value[e],u.value={...u.value};return}u.value={...u.value,[e]:r??void 0}}};n(o,e=>{e&&(u.value={},w.value=e==null?void 0:e.name,g.value=e==null?void 0:e.external_port,c.value=e==null?void 0:e.internal_port,k.value=e==null?void 0:e.queue_workers,U.value=e==null?void 0:e.cron_workers,$.value=e==null?void 0:e.data_workers,G.value=e==null?void 0:e.request_workers,b.value=e==null?void 0:e.encoder_workers,x.value=e==null?void 0:e.image_workers,p.value=e==null?void 0:e.swagger,_.value=!0)}),re(()=>{var e,r,B,f,V,t,F,K,M,Z;o.value&&(u.value={},w.value=(e=o.value)==null?void 0:e.name,g.value=(r=o.value)==null?void 0:r.external_port,c.value=(B=o.value)==null?void 0:B.internal_port,k.value=(f=o.value)==null?void 0:f.queue_workers,U.value=(V=o.value)==null?void 0:V.cron_workers,$.value=(t=o.value)==null?void 0:t.data_workers,G.value=(F=o.value)==null?void 0:F.request_workers,b.value=(K=o.value)==null?void 0:K.encoder_workers,x.value=(M=o.value)==null?void 0:M.image_workers,p.value=(Z=o.value)==null?void 0:Z.swagger,_.value=!0)});const w=l(((O=o.value)==null?void 0:O.name)??"");n(w,e=>{m("name",e),a.value&&(I([...N.value.filter(r=>r.id!==a.value.id),{...a.value,name:e.toString()}]),h({...a.value,name:e.toString()}))});const g=l(((z=o.value)==null?void 0:z.external_port)??0);n(g,e=>{m("external_port",e),a.value&&(I([...N.value.filter(r=>r.id!==a.value.id),{...a.value,external_port:e.toString()}]),h({...a.value,external_port:e.toString()}))});const c=l(((A=o.value)==null?void 0:A.internal_port)??0);n(c,e=>{m("internal_port",e),a.value&&(I([...N.value.filter(r=>r.id!==a.value.id),{...a.value,internal_port:e.toString()}]),h({...a.value,internal_port:e.toString()}))});const k=l(((P=o.value)==null?void 0:P.queue_workers)??0);n(k,e=>{m("queue_workers",e)});const U=l(((Q=o.value)==null?void 0:Q.cron_workers)??0);n(U,e=>{m("cron_workers",e)});const $=l(((T=o.value)==null?void 0:T.data_workers)??0);n($,e=>{m("data_workers",e)});const G=l(((j=o.value)==null?void 0:j.request_workers)??0);n(G,e=>{m("request_workers",e)});const x=l(((D=o.value)==null?void 0:D.image_workers)??0);n(x,e=>{m("image_workers",e)});const b=l(((E=o.value)==null?void 0:E.encoder_workers)??0);n(b,e=>{m("encoder_workers",e)});const p=l(((R=o.value)==null?void 0:R.swagger)??!1);n(p,e=>{m("swagger",e)});const W=oe(()=>Object.keys(u.value).length>0);n(u,e=>{console.log(e)});const X=te(),Y=()=>{console.raw(u.value),de().patch("/dashboard/configuration",u.value).then(()=>{J(),X.invalidateQueries({queryKey:["serverInfo"]})})};return(e,r)=>{const B=se("Button");return S(),ae(d(ue),null,{default:v(()=>[i(d(le),{fullscreen:!0},{default:v(()=>[i(me,{error:d(L),gridStyle:2,title:"General",description:""},{cta:v(()=>r[8]||(r[8]=[])),actions:v(()=>[i(B,{type:"submit",id:"save",disabled:!W.value,color:"theme",class:"ml-auto",form:"myForm",onClick:r[7]||(r[7]=f=>Y())},{default:v(()=>[ne(H(e.$t("Save")),1)]),_:1},8,["disabled"])]),default:v(()=>{var f,V;return[_.value?(S(),y("div",we,[s("div",ge,[r[9]||(r[9]=s("label",{for:"name"},"Server name",-1)),i(d(_e),{id:"name",modelValue:w.value,"onUpdate:modelValue":r[0]||(r[0]=t=>w.value=t),class:"mb-4"},null,8,["modelValue"])]),s("div",ce,[r[10]||(r[10]=s("label",{for:"internal_port"},"Secure internal port",-1)),i(d(q),{id:"internal_port",modelValue:c.value,"onUpdate:modelValue":r[1]||(r[1]=t=>c.value=t),class:"mb-4",useGrouping:!1,showButtons:"",min:2e3},null,8,["modelValue"])]),s("div",ke,[r[11]||(r[11]=s("label",{for:"external_port"},"Secure external port",-1)),i(d(q),{id:"external_port",modelValue:g.value,"onUpdate:modelValue":r[2]||(r[2]=t=>g.value=t),class:"mb-4",useGrouping:!1,showButtons:"",min:2e3},null,8,["modelValue"])])])):C("",!0),_.value?(S(),y("div",xe,[s("div",be,[r[12]||(r[12]=s("label",{for:"encoder_workers"},"Encoder workers",-1)),i(d(q),{id:"encoder_workers",modelValue:b.value,"onUpdate:modelValue":r[3]||(r[3]=t=>b.value=t),class:"mb-4",useGrouping:!1,showButtons:"",min:0},null,8,["modelValue"])]),s("div",Ve,[r[13]||(r[13]=s("label",{for:"image_workers"},"Image workers",-1)),i(d(q),{id:"image_workers",modelValue:x.value,"onUpdate:modelValue":r[4]||(r[4]=t=>x.value=t),class:"mb-4",useGrouping:!1,showButtons:"",min:0},null,8,["modelValue"])]),s("div",Se,[r[14]||(r[14]=s("label",{for:"queue_workers"},"Queue workers",-1)),i(d(q),{id:"queue_workers",modelValue:k.value,"onUpdate:modelValue":r[5]||(r[5]=t=>k.value=t),class:"mb-4",useGrouping:!1,showButtons:"",min:0},null,8,["modelValue"])])])):C("",!0),_.value?(S(),y("div",qe,[s("div",Be,[s("span",ye,[r[15]||(r[15]=s("label",{for:"swagger"},"Open API / Swagger Ui",-1)),p.value&&((f=d(a))!=null&&f.serverBaseUrl)?(S(),y("a",{key:0,target:"_blank","aria-label":e.$t("Open API / Swagger Ui in a new tab"),href:(V=d(a))==null?void 0:V.serverBaseUrl,class:"flex gap-1 items-center underline underline-offset-4 h-4 text-sm"},[s("span",null,H(e.$t("Open")),1),i(ve,{icon:"shareSquare",className:"size-4",color:"theme"})],8,Ce)):C("",!0)]),i(fe,{"model-value":p.value,"onUpdate:modelValue":r[6]||(r[6]=t=>p.value=t)},null,8,["model-value"])])])):C("",!0)]}),_:1},8,["error"])]),_:1})]),_:1})}}});export{We as default};
