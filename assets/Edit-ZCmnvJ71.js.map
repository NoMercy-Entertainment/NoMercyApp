{"version":3,"file":"Edit-ZCmnvJ71.js","sources":["../../src/views/Dashboard/Content/Specials/components/DeleteSpecialModal.vue","../../src/views/Dashboard/Content/Specials/Edit.vue"],"sourcesContent":["<script lang=\"ts\" setup>\nimport { PropType } from 'vue';\nimport { useTranslation } from 'i18next-vue';\n\nimport { useQueryClient } from '@tanstack/vue-query';\n\nimport serverClient from '@/lib/clients/serverClient';\nimport Modal from \"@/components/Modal.vue\";\n\nconst props = defineProps({\n  open: {\n    type: Boolean,\n    required: true,\n  },\n  close: {\n    type: Function as PropType<() => any>,\n    required: true,\n  },\n  id: {\n    type: String,\n    required: true,\n  },\n  name: {\n    type: String,\n    required: true,\n  },\n  noRedirect: {\n    type: Boolean,\n    default: false,\n  },\n});\n\nconst { t } = useTranslation();\nconst query = useQueryClient();\n\nconst handleDelete = () => {\n  serverClient()\n    .delete(`dashboard/specials/${props.id}`)\n    .then(({ data }) => {\n\n      // showNotification({\n      // \ttitle: translate(data.message, ...data.args ?? []),\n      // \ttype: data.status == 'ok'\n      // \t\t? TYPE.SUCCESS\n      // \t\t: TYPE.ERROR,\n      // \tvisibleOnly: true,\n      // \tduration: 2000,\n      // });\n      query.invalidateQueries({ queryKey: ['dashboard', 'specials'] });\n\n      if (props.noRedirect) return;\n      window.history.back();\n    });\n\n  props.close();\n};\n\n</script>\n<template>\n  <Modal :close=\"close\" :open=\"open\" maxWidth=\"max-w-xl\" :params=\"{ special: props.name }\"\n    :title=\"`Delete special {{special}}`\">\n\n    <div class=\"my-6 text-sm text-auto-10\">\n      {{ t('Are you sure you want to delete this special?') }}\n    </div>\n\n    <template v-slot:actions>\n      <Button id=\"yes\" :onclick=\"handleDelete\" endIcon=\"trash\" color=\"red\" type=\"button\">\n        {{ t('Delete') }}\n      </button>\n      <Button id=\"no\" :onClick=\"close\" type=\"button\" color=\"text-auto-alpha-11\" variant=\"text\">\n        {{ t('Cancel') }}\n      </button>\n    </template>\n  </Modal>\n</template>\n","<script setup lang=\"ts\">\nimport { onBeforeMount, onMounted, ref, watch } from 'vue';\nimport { useRoute } from 'vue-router';\n\nimport type { LibrariesResponse } from \"@/types/api/base/library\";\n\nimport useServerClient from '@/lib/clients/useServerClient';\n\nimport DashboardLayout from '@/Layout/Desktop/DashboardLayout.vue';\nimport DeleteSpecialModal from './components/DeleteSpecialModal.vue';\nimport Button from '@/components/Buttons/Button.vue';\nimport { InputText } from \"primevue\";\nimport { currentServer } from \"@/store/currentServer\";\nimport serverClient from \"@/lib/clients/serverClient\";\n\nconst route = useRoute();\n\nconst { data: specials, error, refetch } = useServerClient<LibrariesResponse[]>({\n  path: 'dashboard/specials',\n  queryKey: ['dashboard', 'specials'],\n});\n\nconst settings = ref<LibrariesResponse>();\n\nonBeforeMount(() => {\n  refetch();\n});\n\nonMounted(() => {\n  if (!specials.value) return;\n  settings.value = specials.value.find(l => l.id == route.params.id)!;\n});\n\nwatch(specials, (value) => {\n  if (!value) return;\n  settings.value = value.find(l => l.id == route.params.id)!;\n});\n\nconst deleteConfirmOpen = ref(false);\nconst openDeleteConfirm = () => {\n  deleteConfirmOpen.value = true;\n};\nconst closeDeleteConfirm = () => {\n  deleteConfirmOpen.value = false;\n};\n\nconst handleCancel = () => {\n  window.history.back();\n};\n\nconst title = ref<string>(settings.value?.title || '');\nconst overview = ref<string>(settings.value?.overview || '');\nconst backdrop = ref<string>(settings.value?.backdrop || '');\nconst poster = ref<string>(settings.value?.poster || '');\nconst logo = ref<string>(settings.value?.logo || '');\n\nwatch(settings, (value) => {\n  if (!value) return;\n  title.value = value?.title;\n  overview.value = value?.overview;\n  backdrop.value = value?.backdrop;\n  poster.value = value?.poster;\n  logo.value = value?.logo;\n});\n\nconst handleSave = () => {\n  serverClient().patch(`/dashboard/specials/${settings.value?.id}`, {\n    title: title.value,\n    overview: overview.value,\n    backdrop: backdrop.value,\n    poster: poster.value,\n    logo: logo.value,\n  }).then(({ data }) => {\n    console.log(data);\n  });\n};\n\n</script>\n\n<template>\n\n  <DashboardLayout :gridStyle=\"1\" :error=\"error\" :title=\"`Special: {{title}}`\" :params=\"{ title: settings?.title }\">\n    <template v-slot:cta>\n    </template>\n    <template v-slot:actions>\n      <Button type=\"button\" id=\"remove\" variant=\"text\" startIcon=\"folderRemove\"\n        class=\"children:text-gray-400 children:transition-colors children:duration-100 children:hover:text-red-dark-8\"\n        color=\"text-auto-alpha-11\" @click=\"openDeleteConfirm\">\n        {{ $t('Remove') }}\n      </button>\n      <Button type=\"button\" id=\"cancel\" variant=\"text\" color=\"white\" @click=\"handleCancel\">\n        {{ $t('Cancel') }}\n      </Button>\n      <Button type=\"button\" id=\"save\" class=\"ml-auto\" color=\"theme\" @click=\"handleSave\">\n        {{ $t('Save') }}\n      </button>\n    </template>\n\n    <div class=\"flex flex-col gap-5 col-span-5 col-start-1 2xl:col-start-1\">\n      <div class=\"flex flex-col gap-2\">\n        <label for=\"name\">Name</label>\n        <InputText variant=\"filled\" id=\"name\" v-model=\"title\" class=\"w-full\" />\n      </div>\n      <div class=\"flex flex-col gap-2\">\n        <label for=\"overview\">Overview</label>\n        <Textarea variant=\"filled\" :rows=\"8\" id=\"overview\" v-model=\"overview\" class=\"w-full\" />\n      </div>\n\n      <div class=\"flex gap-4 w-full\">\n        <div class=\"flex flex-col gap-4 w-full\">\n          <div class=\"flex flex-col gap-2\">\n            <label for=\"backdrop\">Backdrop</label>\n            <InputText variant=\"filled\" id=\"backdrop\" v-model=\"backdrop\" class=\"w-full\" />\n          </div>\n          <Image :src=\"`${currentServer?.serverBaseUrl}/images/original${backdrop}`\" alt=\"Image\" width=\"100%\"\n            class=\"mx-2\" preview />\n        </div>\n        <div class=\"flex flex-col gap-4 w-full\">\n          <div class=\"flex flex-col gap-2\">\n            <label for=\"logo\">Logo</label>\n            <InputText variant=\"filled\" id=\"logo\" v-model=\"logo\" class=\"w-full\" />\n          </div>\n          <Image :src=\"`${currentServer?.serverBaseUrl}/images/original${logo}`\" alt=\"Image\" width=\"100%\" class=\"mx-2\"\n            preview />\n        </div>\n      </div>\n\n    </div>\n\n    <div class=\"flex flex-col gap-4 col-span-2 row-start-1 col-start-1 2xl:col-start-6\">\n      <div class=\"flex flex-col gap-5\">\n        <div class=\"flex flex-col gap-2\">\n          <label for=\"poster\">Poster</label>\n          <InputText variant=\"filled\" id=\"poster\" v-model=\"poster\" class=\"w-full\" />\n        </div>\n        <Image :src=\"`${currentServer?.serverBaseUrl}/images/original${poster}`\" alt=\"Image\" width=\"100%\" class=\"mx-2\"\n          preview />\n      </div>\n    </div>\n\n\n    <DeleteSpecialModal v-if=\"settings?.id\" :id=\"settings?.id\" :name=\"settings?.title\" :close=\"closeDeleteConfirm\"\n      :open=\"deleteConfirmOpen\" />\n  </DashboardLayout>\n</template>\n\n<style scoped></style>\n"],"names":["props","__props","t","useTranslation","query","useQueryClient","handleDelete","serverClient","data","route","useRoute","specials","error","refetch","useServerClient","settings","ref","onBeforeMount","onMounted","l","watch","value","deleteConfirmOpen","openDeleteConfirm","closeDeleteConfirm","handleCancel","title","_a","overview","_b","backdrop","_c","poster","_d","logo","_e","handleSave"],"mappings":"2yBASA,MAAMA,EAAQC,EAuBR,CAAE,EAAAC,CAAE,EAAIC,EAAe,EACvBC,EAAQC,EAAe,EAEvBC,EAAe,IAAM,CACZC,IACV,OAAO,sBAAsBP,EAAM,EAAE,EAAE,EACvC,KAAK,CAAC,CAAE,KAAAQ,CAAA,IAAW,CAUlBJ,EAAM,kBAAkB,CAAE,SAAU,CAAC,YAAa,UAAU,EAAG,EAE3D,CAAAJ,EAAM,YACV,OAAO,QAAQ,KAAK,CAAA,CACrB,EAEHA,EAAM,MAAM,CACd,gjCCxCA,MAAMS,EAAQC,GAAS,EAEjB,CAAE,KAAMC,EAAU,MAAAC,EAAO,QAAAC,CAAA,EAAYC,EAAqC,CAC9E,KAAM,qBACN,SAAU,CAAC,YAAa,UAAU,CAAA,CACnC,EAEKC,EAAWC,EAAuB,EAExCC,EAAc,IAAM,CACVJ,EAAA,CAAA,CACT,EAEDK,EAAU,IAAM,CACTP,EAAS,QACLI,EAAA,MAAQJ,EAAS,MAAM,QAAUQ,EAAE,IAAMV,EAAM,OAAO,EAAE,EAAA,CAClE,EAEKW,EAAAT,EAAWU,GAAU,CACpBA,IACIN,EAAA,MAAQM,EAAM,KAAK,GAAK,EAAE,IAAMZ,EAAM,OAAO,EAAE,EAAA,CACzD,EAEK,MAAAa,EAAoBN,EAAI,EAAK,EAC7BO,EAAoB,IAAM,CAC9BD,EAAkB,MAAQ,EAC5B,EACME,EAAqB,IAAM,CAC/BF,EAAkB,MAAQ,EAC5B,EAEMG,EAAe,IAAM,CACzB,OAAO,QAAQ,KAAK,CACtB,EAEMC,EAAQV,IAAYW,EAAAZ,EAAS,QAAT,YAAAY,EAAgB,QAAS,EAAE,EAC/CC,EAAWZ,IAAYa,EAAAd,EAAS,QAAT,YAAAc,EAAgB,WAAY,EAAE,EACrDC,EAAWd,IAAYe,EAAAhB,EAAS,QAAT,YAAAgB,EAAgB,WAAY,EAAE,EACrDC,EAAShB,IAAYiB,EAAAlB,EAAS,QAAT,YAAAkB,EAAgB,SAAU,EAAE,EACjDC,EAAOlB,IAAYmB,EAAApB,EAAS,QAAT,YAAAoB,EAAgB,OAAQ,EAAE,EAE7Cf,EAAAL,EAAWM,GAAU,CACpBA,IACLK,EAAM,MAAQL,GAAA,YAAAA,EAAO,MACrBO,EAAS,MAAQP,GAAA,YAAAA,EAAO,SACxBS,EAAS,MAAQT,GAAA,YAAAA,EAAO,SACxBW,EAAO,MAAQX,GAAA,YAAAA,EAAO,OACtBa,EAAK,MAAQb,GAAA,YAAAA,EAAO,KAAA,CACrB,EAED,MAAMe,EAAa,IAAM,OACvB7B,EAAA,EAAe,MAAM,wBAAuBoB,EAAAZ,EAAS,QAAT,YAAAY,EAAgB,EAAE,GAAI,CAChE,MAAOD,EAAM,MACb,SAAUE,EAAS,MACnB,SAAUE,EAAS,MACnB,OAAQE,EAAO,MACf,KAAME,EAAK,KACZ,CAAA,EAAE,KAAK,CAAC,CAAE,KAAA1B,KAAW,CACpB,QAAQ,IAAIA,CAAI,CAAA,CACjB,CACH"}