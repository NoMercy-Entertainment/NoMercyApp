import{I as T,l as s,w as n,E as j,C as A,f as D,d as K,o as b,s as p,j as i,K as d,bu as R,c as S,b as q,a as o,R as t,t as G,q as z,bh as F,O as H,eI as U,e8 as I,eJ as $,cH as J}from"./index-H-vD2rqS.js";import{u as M}from"./useQueryClient-B5STIjF7.js";import{_ as L}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-DuAJYD1Y.js";import{u as W}from"./useServerClient-DCS4BGnu.js";import{T as X}from"./Toggle-ZDAP0vAD.js";import{_ as Y}from"./OptimizedIcon.vue_vue_type_script_setup_true_lang-CX14zQZK.js";import{a as Z}from"./index-fCPAnBT7.js";import{s as V}from"./index-BGWKRR9x.js";import"./useMounted-Dveo4ZJ5.js";import"./HubConnection-CMQnVIkW.js";import"./FloatingBackButton.vue_vue_type_script_setup_true_lang-Dccf_qNw.js";import"./Button.vue_vue_type_script_setup_true_lang-Cx9uFmF_.js";import"./ScrollContainer.vue_vue_type_script_setup_true_lang-OA0oELVZ.js";import"./RipperOverlay.vue_vue_type_script_setup_true_lang-BgPrKIqK.js";import"./ripperSocket-VzNd0LM5.js";import"./useQuery-C5_JtCKV.js";import"./useBaseQuery-x8hgGQVw.js";import"./useInfiniteServerClient-B-2LPPx2.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-C5qO4Eqs.js";import"./index-ZhWAdK_X.js";import"./index-CkDSjnyt.js";const ee={key:0,class:"col-span-2 col-start-1 2xl:col-start-1"},re={class:"flex flex-col gap-2"},ae={class:"flex flex-col gap-2"},oe={class:"flex flex-col gap-2"},le={key:1,class:"col-span-2 col-start-1 2xl:col-start-3"},te={class:"flex flex-col gap-2"},se={class:"flex flex-col gap-2"},ne={class:"flex flex-col gap-2"},ue={key:2,class:"col-span-2 col-start-1 2xl:col-start-5"},ie={class:"flex flex-col gap-2"},de={class:"flex gap-4"},ve=["aria-label","href"],Ee=T({__name:"Desktop",setup(me){const{data:a,refetch:N,error:O}=W({path:"/dashboard/configuration"}),f=s(!1),u=s(a.value??{}),v=(e,r)=>{if(a.value){if(J(a.value[e])===r){delete u.value[e],u.value={...u.value};return}u.value={...u.value,[e]:r??void 0}}};n(a,e=>{e&&(u.value={},_.value=e?.name,w.value=e?.external_port,g.value=e?.internal_port,c.value=e?.queue_workers,B.value=e?.cron_workers,C.value=e?.data_workers,y.value=e?.request_workers,x.value=e?.encoder_workers,k.value=e?.image_workers,m.value=e?.swagger,f.value=!0)}),j(()=>{a.value&&(u.value={},_.value=a.value?.name,w.value=a.value?.external_port,g.value=a.value?.internal_port,c.value=a.value?.queue_workers,B.value=a.value?.cron_workers,C.value=a.value?.data_workers,y.value=a.value?.request_workers,x.value=a.value?.encoder_workers,k.value=a.value?.image_workers,m.value=a.value?.swagger,f.value=!0)});const _=s(a.value?.name??"");n(_,e=>{v("name",e),t.value&&(U([...I.value.filter(r=>r.id!==t.value.id),{...t.value,name:e.toString()}]),$({...t.value,name:e.toString()}))});const w=s(a.value?.external_port??0);n(w,e=>{v("external_port",e),t.value&&(U([...I.value.filter(r=>r.id!==t.value.id),{...t.value,external_port:e.toString()}]),$({...t.value,external_port:e.toString()}))});const g=s(a.value?.internal_port??0);n(g,e=>{v("internal_port",e),t.value&&(U([...I.value.filter(r=>r.id!==t.value.id),{...t.value,internal_port:e.toString()}]),$({...t.value,internal_port:e.toString()}))});const c=s(a.value?.queue_workers??0);n(c,e=>{v("queue_workers",e)});const B=s(a.value?.cron_workers??0);n(B,e=>{v("cron_workers",e)});const C=s(a.value?.data_workers??0);n(C,e=>{v("data_workers",e)});const y=s(a.value?.request_workers??0);n(y,e=>{v("request_workers",e)});const k=s(a.value?.image_workers??0);n(k,e=>{v("image_workers",e)});const x=s(a.value?.encoder_workers??0);n(x,e=>{v("encoder_workers",e)});const m=s(a.value?.swagger??!1);n(m,e=>{v("swagger",e)});const h=A(()=>Object.keys(u.value).length>0);n(u,e=>{console.log(e)});const E=M(),P=()=>{console.raw(u.value),H().patch("/dashboard/configuration",u.value).then(()=>{N(),E.invalidateQueries({queryKey:["serverInfo"]})})};return(e,r)=>{const Q=D("Button");return b(),K(d(F),null,{default:p(()=>[i(d(R),{fullscreen:!0},{default:p(()=>[i(L,{error:d(O),gridStyle:2,title:"General",description:""},{cta:p(()=>[...r[8]||(r[8]=[])]),actions:p(()=>[i(Q,{type:"submit",id:"save",disabled:!h.value,color:"theme",class:"ml-auto",form:"myForm",onClick:r[7]||(r[7]=l=>P())},{default:p(()=>[z(G(e.$t("Save")),1)]),_:1},8,["disabled"])]),default:p(()=>[f.value?(b(),S("div",ee,[o("div",re,[r[9]||(r[9]=o("label",{for:"name"},"Server name",-1)),i(d(Z),{id:"name",modelValue:_.value,"onUpdate:modelValue":r[0]||(r[0]=l=>_.value=l),class:"mb-4"},null,8,["modelValue"])]),o("div",ae,[r[10]||(r[10]=o("label",{for:"internal_port"},"Secure internal port",-1)),i(d(V),{id:"internal_port",modelValue:g.value,"onUpdate:modelValue":r[1]||(r[1]=l=>g.value=l),class:"mb-4",useGrouping:!1,showButtons:"",min:2e3},null,8,["modelValue"])]),o("div",oe,[r[11]||(r[11]=o("label",{for:"external_port"},"Secure external port",-1)),i(d(V),{id:"external_port",modelValue:w.value,"onUpdate:modelValue":r[2]||(r[2]=l=>w.value=l),class:"mb-4",useGrouping:!1,showButtons:"",min:2e3},null,8,["modelValue"])])])):q("",!0),f.value?(b(),S("div",le,[o("div",te,[r[12]||(r[12]=o("label",{for:"encoder_workers"},"Encoder workers",-1)),i(d(V),{id:"encoder_workers",modelValue:x.value,"onUpdate:modelValue":r[3]||(r[3]=l=>x.value=l),class:"mb-4",useGrouping:!1,showButtons:"",min:0},null,8,["modelValue"])]),o("div",se,[r[13]||(r[13]=o("label",{for:"image_workers"},"Image workers",-1)),i(d(V),{id:"image_workers",modelValue:k.value,"onUpdate:modelValue":r[4]||(r[4]=l=>k.value=l),class:"mb-4",useGrouping:!1,showButtons:"",min:0},null,8,["modelValue"])]),o("div",ne,[r[14]||(r[14]=o("label",{for:"queue_workers"},"Queue workers",-1)),i(d(V),{id:"queue_workers",modelValue:c.value,"onUpdate:modelValue":r[5]||(r[5]=l=>c.value=l),class:"mb-4",useGrouping:!1,showButtons:"",min:0},null,8,["modelValue"])])])):q("",!0),f.value?(b(),S("div",ue,[o("div",ie,[o("span",de,[r[15]||(r[15]=o("label",{for:"swagger"},"Open API / Swagger Ui",-1)),m.value&&d(t)?.serverBaseUrl?(b(),S("a",{key:0,target:"_blank","aria-label":e.$t("Open API / Swagger Ui in a new tab"),href:d(t)?.serverBaseUrl,class:"flex gap-1 items-center underline underline-offset-4 h-4 text-sm"},[o("span",null,G(e.$t("Open")),1),i(Y,{icon:"shareSquare",className:"size-4",color:"theme"})],8,ve)):q("",!0)]),i(X,{"model-value":m.value,"onUpdate:modelValue":r[6]||(r[6]=l=>m.value=l)},null,8,["model-value"])])])):q("",!0)]),_:1},8,["error"])]),_:1})]),_:1})}}});export{Ee as default};
