import{$ as J,aa as we,d as G,w as xe,f as ke,aG as _e,h as R,o as c,i as l,N as $e,a0 as n,j as Se,c as j,b as Z,H as L,t as M,l as H,y,v as h,a7 as Ce,ai as me,p as ze,F as Pe}from"./vue-ionic-DerxjBh9.js";import{j as qe,Z as Ie,h as Ve,u as Te,p as be,bq as pe}from"./index-H0ECF5wf.js";import{A as Be}from"./autoSkipPlugin-CRsbLUC4.js";import"./vendor-C28OoIfY.js";import{D as De}from"./desktopUIPlugin-C59GWCOU.js";import{n as Fe,K as Ne}from"./video-player-DmVd3h04.js";import"./subtitles-octopus-By2PrHjB.js";import{s as ge,c as Ue,a as Ae}from"./sidebar-BDOxZkOn.js";import{g as E}from"./imageModal-BVwhZ-nM.js";import{u as je}from"./useServerClient-a5smfCyZ.js";import{C as He}from"./Carousel-BtIaiZK7.js";import{_ as Re}from"./Select.vue_vue_type_script_setup_true_lang-BcAEQKoh.js";import{_ as ve}from"./TMDBImage.vue_vue_type_script_setup_true_lang-D01DIKRP.js";import{_ as he}from"./OptimizedIcon.vue_vue_type_script_setup_true_lang--O4NX453.js";const Ke=["data-music","data-sidebar"],yt=J({__name:"Trailer",props:{videos:{type:Array,required:!0},toggle:{type:Function,required:!0},open:{type:Boolean,required:!0},title:{type:String,required:!0},index:{type:Number,required:!0},incrementTrailerIndex:{type:Function,required:!0}},setup(e){const s=e,K=we(),{data:v,isError:b}=je({queryKey:["base","info",K.params.id,"trailer",s.videos[s.index].src],path:`trailer/${s.videos[s.index].src}`}),p=G(),r=G(),t=G();function g(o){var x,w,k,_,$,S,C,z,P,q,I,V,T,B,D,F,N,U;const a={muted:!1,controls:!1,preload:"auto",debug:!1,autoPlay:!0,playlist:[o],controlsTimeout:3e3,doubleClickDelay:300,playbackRates:[.25,.5,.75,1,1.25,1.5,1.75,2],accessToken:(x=Te.value)==null?void 0:x.accessToken,basePath:(w=Ve.value)==null?void 0:w.serverBaseUrl};t.value=Fe("trailer").setup(a),(k=t.value)==null||k.once("back",()=>{s.toggle()});const i=new De;(_=t.value)==null||_.registerPlugin("desktopUI",i),($=t.value)==null||$.usePlugin("desktopUI");const f=new Be;(S=t.value)==null||S.registerPlugin("autoSkip",f),(C=t.value)==null||C.usePlugin("autoSkip");const m=new Ne;(z=t.value)==null||z.registerPlugin("keyHandler",m),(P=t.value)==null||P.usePlugin("keyHandler"),(q=t.value)==null||q.on("playlistComplete",()=>{console.log("Playlist complete"),s.toggle()}),(I=t.value)==null||I.on("play",()=>{E(!0)}),(V=t.value)==null||V.on("pause",()=>{E(!1)}),(T=t.value)==null||T.on("fullscreen",d=>{var u,A;(A=(u=window.external)==null?void 0:u.sendMessage)==null||A.call(u,d?"enterFullscreen":"exitFullscreen")}),(B=t.value)==null||B.on("remove",()=>{s.toggle(),s.incrementTrailerIndex()}),(D=t.value)==null||D.on("error",()=>{s.toggle()}),(F=t.value)==null||F.on("close",()=>{s.toggle()}),(N=t.value)==null||N.on("captionsChanged",d=>{d.track===-1?localStorage.setItem("trailerSubtitles","off"):localStorage.setItem("trailerSubtitles",d.track)}),(U=t.value)==null||U.on("play",()=>{var d,u;localStorage.getItem("trailerSubtitles")==="off"?(d=t.value)==null||d.setCurrentCaption(-1):(u=t.value)==null||u.setCurrentCaption(Number.parseInt(localStorage.getItem("trailerSubtitles")??"-1",10))})}return xe(v,o=>{!o||b.value||g(o)}),ke(()=>{!v.value||b.value||(qe.stop(),r.value=ge.value,E(!0),Ue(),g(v.value))}),_e(()=>{var o;if(Ae(r.value??"open"),E(!1),t.value)try{(o=t.value)==null||o.dispose()}catch{}}),(o,a)=>(c(),R("button",{class:"fixed h-full w-full overflow-hidden rounded-lg bg-black/50",onClick:a[1]||(a[1]=i=>e.toggle())},[l("div",{"data-music":n(Ie),"data-sidebar":n(ge),class:"absolute w-screen h-available sm:w-auto sm:overflow-hidden sm:inset-1/2 sm:aspect-video sm:-translate-y-[50%] sidebar-closed:sm:h-full sidebar-closed:sm:max-w-[90vw] sidebar-closed:sm:max-h-[93%] sidebar-closed:px-4 sidebar-closed:py-2 sidebar-closed:xl:px-[1.8rem] sidebar-closed:xl:py-4 sm:-translate-x-[50%] sidebar-open:h-5/6 sidebar-open:px-10 sidebar-open:py-6 sidebar-open:xl:px-[2.8rem] sidebar-open:xl:py-6"},[l("div",{ref_key:"trailerContainer",ref:p,class:"relative rounded-2xl flex overflow-clip children:overflow-clip h-auto top-1/2 -translate-y-1/2 w-full sm:h-full children:!w-full children:!h-auto children:!aspect-video",onClick:a[0]||(a[0]=$e(()=>{},["stop"]))},a[2]||(a[2]=[l("div",{id:"trailer",class:"group nomercyplayer"},null,-1)]),512)],8,Ke)]))}}),Le={class:"relative mb-1 h-auto w-full overflow-clip rounded-t-md group-focus-visible/season:rounded-b-none group-hover/season:rounded-b-none aspect-backdrop bg-auto-1"},Me={class:"transitioning hover:scale-110",style:{"--stroke-width":"1"}},Ee={key:0,class:"absolute bottom-0 left-0 z-40 mb-3 w-full px-3"},Ge=["id"],Oe=["id"],Ze={class:"grid w-full items-stretch gap-1 rounded-b-md p-2 transitioning text-left"},Je=["title"],Qe=["title"],We={class:"relative mb-1 h-auto w-full overflow-clip rounded-t-md group-focus-visible/season:rounded-b-none group-hover/season:rounded-b-none aspect-backdrop bg-auto-1"},Xe={class:"transitioning hover:scale-110",style:{"--stroke-width":"1"}},Ye={key:0,class:"absolute bottom-0 left-0 z-40 mb-3 w-full px-3"},et=["id"],tt=["id"],at={class:"grid w-full items-stretch gap-1 rounded-b-md p-2 transitioning text-left"},lt=["title"],st=["title"],ye=J({__name:"SeasonCard",props:{data:{type:Object,required:!0},suffix:{type:String,required:!1,default:""}},setup(e){const s=e;return(K,v)=>{var p,r,t,g,o,a,i,f,m,x,w,k,_,$,S,C,z,P,q,I,V,T,B,D,F,N,U,d,u,A;const b=Se("RouterLink");return(p=e.data)!=null&&p.id&&((r=e.data)!=null&&r.available)?(c(),j(b,{key:0,id:(t=e.data)==null?void 0:t.id,class:M(`frosting border-0 border-[rgb(var(--color-focus))] flex flex-col h-auto items-center group/season focus-shift focus-outline transition-all duration-200 overflow-clip relative !rounded-lg select-none shadow-[0px_0px_0_1px_rgb(var(--color-focus,var(--color-theme-6))/70%)] w-full z-0 bg-auto-1/12  text-slate-lightA-12/90  dark:text-slate-darkA-12/80 ${(g=e.data)!=null&&g.available?"cursor-pointer":"cursor-not-allowed"}`),onfocus:n(pe)(),style:L(`--color-focus: ${n(be)((a=(o=s.data)==null?void 0:o.color_palette)==null?void 0:a.still).replace(/,/gu," ").replace(")","").replace("rgb(","")};`),"data-card":"true",to:(i=e.data)!=null&&i.available?(f=e.data)==null?void 0:f.link:"#"},{default:H(()=>{var O,Q,W,X,Y,ee,te,ae,le,se,oe,ie,re,ne,de,ue,ce,fe;return[l("div",Le,[y(ve,{path:(O=e.data)==null?void 0:O.still,title:(Q=e.data)==null?void 0:Q.title,"color-palette":(X=(W=e.data)==null?void 0:W.color_palette)==null?void 0:X.still,class:"h-40",size:660,aspect:"backdrop","class-name":"pointer-events-none absolute z-20 flex h-full w-full select-none object-cover transitioning trickle-div",type:"image"},null,8,["path","title","color-palette"]),l("div",{class:M(`absolute inset-0 z-30 grid w-full text-white place-items-center group-focus-visible/season:bg-black opacity-0 group-focus-visible/season:opacity-100 transitioning group-hover/season:opacity-100 [background:radial-gradient(75%_50%_at_50%_50%,_rgba(0,_0,_0,_0.40)_0%,_rgba(0,_0,_0,_0.00)_100%),_rgba(0,_0,_0,_0.09)] ${(Y=e.data)!=null&&Y.available?"":"hidden"}`)},[l("div",Me,[y(he,{icon:"playCircle","class-name":"w-20",stroke:"1"})])],2),(ee=e.data)!=null&&ee.progress?(c(),R("div",Ee,[l("div",{id:`episode-${(te=e.data)==null?void 0:te.id}-slider-container`,class:"relative z-40 flex h-1 w-full overflow-clip rounded-full pt-2 pr-8 bg-gray-dark-12"},[l("div",{id:`episode-${(ae=e.data)==null?void 0:ae.id}-progress-bar`,class:"absolute top-0 left-0 h-full bg-[rgb(var(--color-focus))]",style:L({width:((le=e.data)==null?void 0:le.progress)>=99?"100%":`${(se=e.data)==null?void 0:se.progress}%`})},null,12,Oe)],8,Ge)])):Z("",!0)]),l("div",Ze,[l("p",{class:"z-10 w-auto flex-shrink-0 flex-grow-0 self-stretch text-2xs sm:text-sm font-bold !leading-5 h-11 line-clamp-2 sm:line-clamp-1",title:`${(oe=e.data)!=null&&oe.episode_number?`${(ie=e.data)==null?void 0:ie.episode_number} - `:""}${(re=e.data)==null?void 0:re.title}`},h((ne=e.data)!=null&&ne.episode_number?`${(de=e.data)==null?void 0:de.episode_number} - `:"")+h((ue=e.data)==null?void 0:ue.title),9,Je),l("p",{class:"z-10 h-8 w-auto flex-shrink-0 flex-grow-0 self-stretch hidden sm:flex text-xs min-h-8 line-clamp-2 leading-[1.2] text-auto-12/80",title:(ce=e.data)==null?void 0:ce.overview},h((fe=e.data)==null?void 0:fe.overview),9,Qe)])]}),_:1},8,["id","class","onfocus","style","to"])):(m=e.data)!=null&&m.id?(c(),R("div",{key:1,class:M(`border-0 border-[rgb(var(--color-focus))] flex flex-col h-auto items-center group/season focus-shift focus-outline transition-all duration-200 overflow-clip relative !rounded-lg select-none shadow-[0px_0px_0_1px_rgb(var(--color-focus,var(--color-theme-6))/70%)] w-full z-0 bg-auto-1/12 ${(x=e.data)!=null&&x.available?"cursor-pointer":"cursor-not-allowed"}`),style:L(`--color-focus: ${n(be)((k=(w=s.data)==null?void 0:w.color_palette)==null?void 0:k.still).replace(/,/gu," ").replace(")","").replace("rgb(","")};`),"data-card":"true",onFocus:v[0]||(v[0]=O=>n(pe)())},[l("div",We,[y(ve,{path:(_=e.data)==null?void 0:_.still,title:($=e.data)==null?void 0:$.title,"color-palette":(C=(S=e.data)==null?void 0:S.color_palette)==null?void 0:C.still,class:"h-40",size:660,aspect:"backdrop","class-name":"pointer-events-none absolute z-20 flex h-full w-full select-none object-cover transitioning trickle-div",type:"image"},null,8,["path","title","color-palette"]),l("div",{class:M(`absolute inset-0 z-30 grid w-full text-white place-items-center group-focus-visible/season:bg-black opacity-0 group-focus-visible/season:opacity-100 transitioning group-hover/season:opacity-100 [background:radial-gradient(75%_50%_at_50%_50%,_rgba(0,_0,_0,_0.40)_0%,_rgba(0,_0,_0,_0.00)_100%),_rgba(0,_0,_0,_0.09)] ${(z=e.data)!=null&&z.available?"":"hidden"}`)},[l("div",Xe,[y(he,{icon:"playCircle","class-name":"w-20",stroke:"1"})])],2),(P=e.data)!=null&&P.progress?(c(),R("div",Ye,[l("div",{id:`episode-${(q=e.data)==null?void 0:q.id}-slider-container`,class:"relative z-40 flex h-1 w-full overflow-clip rounded-full pt-2 pr-8 bg-gray-dark-12"},[l("div",{id:`episode-${(I=e.data)==null?void 0:I.id}-progress-bar`,class:"absolute top-0 left-0 h-full bg-[rgb(var(--color-focus))]",style:L({width:((V=e.data)==null?void 0:V.progress)>=99?"100%":`${(T=e.data)==null?void 0:T.progress}%`})},null,12,tt)],8,et)])):Z("",!0)]),l("div",at,[l("p",{class:"z-10 w-auto flex-shrink-0 flex-grow-0 self-stretch text-sm font-bold !leading-5 line-clamp-1",title:`${(B=e.data)!=null&&B.episode_number?`${(D=e.data)==null?void 0:D.episode_number} - `:""}${(F=e.data)==null?void 0:F.title}`},h((N=e.data)!=null&&N.episode_number?`${(U=e.data)==null?void 0:U.episode_number} - `:"")+h((d=e.data)==null?void 0:d.title),9,lt),l("p",{class:"z-10 h-8 w-auto flex-shrink-0 flex-grow-0 self-stretch text-xs min-h-8 line-clamp-2 leading-[1.2] text-auto-12/80",title:(u=e.data)==null?void 0:u.overview},h((A=e.data)==null?void 0:A.overview),9,st)])],38)):Z("",!0)}}}),xt=J({__name:"SeasonCarousel",props:{data:{type:Array,required:!0},type:{type:String,required:!1,default:"poster"},limitCardCountBy:{type:Number,required:!1}},setup(e){var g,o;const s=e,{t:K}=Ce();function v(a){}let b=(g=s.data)==null?void 0:g.findIndex(a=>a.season_number===1);b===-1&&(b=0);const p=((o=s.data)==null?void 0:o.map((a,i)=>({index:i,id:a.id,name:`${a.season_number} - ${a.title}`,season_number:a.season_number,episodes:a.episodes})))??[],r=G(p[b]);function t(){var i;const a=(i=document.querySelector(".swiper-undefined"))==null?void 0:i.swiper;a==null||a.slideTo(0,300)}return xe(r,t),(a,i)=>(c(),j(He,{index:r.value.season_number,"limit-card-count-by":e.limitCardCountBy,type:e.type},{selector:H(()=>[y(Re,{id:"season-selector",modelValue:r.value,"onUpdate:modelValue":i[0]||(i[0]=f=>r.value=f),disabled:n(p).length===1,items:n(p),"option-label":"title",class:"min-w-[21rem] ml-3",label:"",variant:"normal"},null,8,["modelValue","disabled","items"])]),default:H(()=>{var f;return[((f=r.value.episodes)==null?void 0:f.length)===0?(c(),j(n(me),{key:0,class:"flex sm:p-1 sm:pl-0"},{default:H(()=>[(c(),j(ye,{id:"item-0",key:0,data:{id:1,title:n(K)("To be announced"),season_number:null,episode_number:null,available:!1,overview:"",airDate:"",still:"",link:"",color_palette:{still:{darkVibrant:"",lightVibrant:""}},progress:null},onclick:()=>{}},null,8,["data"]))]),_:1})):(c(!0),R(Pe,{key:1},ze(r.value.episodes,m=>(c(),j(n(me),{key:m.id,class:"flex sm:p-1 sm:pl-0"},{default:H(()=>[y(ye,{id:`item-${m.id}`,data:m,onclick:()=>void 0},null,8,["id","data","onclick"])]),_:2},1024))),128))]}),_:1},8,["index","limit-card-count-by","type"]))}});export{xt as _,yt as a};
