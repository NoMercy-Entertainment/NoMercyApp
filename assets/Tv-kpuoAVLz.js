import{I as D,f as V,c as u,o as a,b as x,d as y,a as n,t as $,F as f,h as b,A as L,c6 as P,j as A,w as N,l as h,E as R,ci as z,s as K,K as v,bu as H,bh as M}from"./index-DhiqRu-L.js";import{u as O}from"./useServerClient-Cknalotx.js";import{u as W}from"./useInfiniteServerClient-COY0PYt-.js";import{_ as G}from"./TMDBImage.vue_vue_type_script_setup_true_lang-Ch2_RmsF.js";import"./useQuery-D0X0p7yJ.js";import"./useBaseQuery-BFsI7r_f.js";import"./useQueryClient-B03e10GK.js";import"./AppLogoSquare-BTlGgqwW.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const J={key:0,class:"grid grid-rows-[auto_1fr] grid-cols-7 relative justify-start flex-1 w-full gap-3 mb-2","data-row":""},Q={class:"row-start-1 col-span-7 pointer-events-none font-semibold font-3xl"},X=["src"],U=D({__name:"TvCarousel2",props:{data:{type:Array,required:!0},title:{type:String,required:!0},handleFocus:{type:Function,required:!0},handleDown:{type:Function,required:!0},handleUp:{type:Function,required:!0},suffix:{type:String,required:!1,default:""}},setup(t){return(p,r)=>{const k=V("RouterLink");return a(),u(f,null,[t.data.length?(a(),u("div",J,[n("h3",Q,$(t.title),1),(a(!0),u(f,null,b(t.data.slice(0,7),(l,i)=>(a(),y(k,{key:l.id,"data-card":l.id,"data-index":i,style:L(`background-image: url('https://app.nomercy.tv/tmdb-images${l.poster}?width=300')`),to:`${l.link}${t.suffix}`,class:"row-start-2 w-full h-auto rounded-xl bg-cover aspect-poster focus:scale-105 focus:outline outline-[2.2px] outline-white transition-transform duration-200 scroll-mb-20 scroll-mt-12 snap-center snap-mandatory",onFocus:c=>t.handleFocus(c,l),onKeydown:r[0]||(r[0]=c=>t.handleDown(c)),onKeyup:r[1]||(r[1]=c=>t.handleUp(c))},null,8,["data-card","data-index","style","to","onFocus"]))),128))])):x("",!0),(a(),y(P,{to:".image-preload-container"},[(a(!0),u(f,null,b(t.data?.slice(0,7),l=>(a(),u("img",{key:l.id,src:`https://app.nomercy.tv/tmdb-images${l.backdrop}?width=2160`,alt:"",class:"absolute",height:"0",loading:"eager",width:"0"},null,8,X))),128))]))],64)}}}),Y={class:"w-available h-auto absolute left-[250px] top-0 overflow-hidden bg-black aspect-video"},Z={class:"flex flex-col justify-start items-start w-[484px] relative left-[58px] top-20 gap-7"},ee={class:"flex flex-col justify-start items-start self-stretch relative gap-5"},te={class:"flex flex-col justify-start items-start w-full relative gap-0"},ae={class:"self-stretch w-full text-xl text-left mt-2"},le={class:"line-clamp-4 text-sm -mt-4"},oe=D({__name:"TvHeader",props:{selected:{type:Object,required:!1}},setup(t){return(p,r)=>(a(),u("div",{key:t.selected?.id,class:"w-full h-full absolute left-0 top-0 bg-[#131314]"},[n("div",Y,[A(G,{class:"w-available h-available absolute left-[-0.39px] top-[-0.39px] object-cover",path:t.selected?.backdrop,size:1080,alt:t.selected?.title},null,8,["path","alt"]),r[0]||(r[0]=n("div",{class:"w-available h-available absolute left-[-0.39px] top-[-0.39px]"},null,-1)),r[1]||(r[1]=n("div",{class:"w-[150vw] h-[150vw] absolute left-[-30%] bottom-[-50%]",style:{background:`radial-gradient(
            closest-side,
            rgba(19, 19, 20, 0.1) 0%,
            rgba(19, 19, 20, 1) 70.73974609375%
          )`}},null,-1))]),n("div",Z,[n("div",ee,[n("div",te,[n("p",ae,$(t.selected?.title),1)]),n("div",le,$(t.selected?.overview),1)])])]))}}),se={class:"w-screen h-screen relative overflow-hidden bg-[#131314]"},he=D({__name:"Tv",setup(t){const{data:p,fetchNextPage:r,hasNextPage:k}=W({path:"/",queryKey:["home"]});N(p,()=>{k&&r()});const{data:l}=O({path:"userdata/continue",queryKey:["continue"],refetchInterval:1e3*60*5}),i=h();N(l,e=>{e&&(i.value=e?.filter(s=>s.id)?.at(0))}),R(()=>{i.value=l.value?.filter(e=>e.id)?.at(0),setTimeout(()=>{const e=document.querySelector(`[data-card="${i.value?.id}"]`);e&&e.focus()},1e3)}),z(()=>{i.value=l.value?.filter(e=>e.id)?.at(0),setTimeout(()=>{const e=document.querySelector(`[data-card="${i.value?.id}"]`);e&&e.focus()},1e3)});const c=h(),S=h(!1),F=h(),C=h();function _(e,s){const o=e.target;if(o?.nodeName==="DIV"){(C.value??o.querySelector("a"))?.focus();return}s&&(i.value=s,C.value=o)}function B(e){if(S.value){e.preventDefault();return}clearTimeout(F.value),S.value=!0;const s=e.target,o=s.getAttribute("data-index"),g=s.closest("[data-row]"),d=g?.previousElementSibling,w=d?.querySelector(`a[data-index="${o}"]`),q=g?.nextElementSibling,I=q?.querySelector(`a[data-index="${o}"]`),T=s.previousElementSibling,E=s.nextElementSibling;if(w&&e.key==="ArrowUp")e.preventDefault(),w.focus();else if(I&&e.key==="ArrowDown")e.preventDefault(),I.focus();else if(T&&e.key==="ArrowLeft")e.preventDefault(),T.focus();else if(E&&e.key==="ArrowRight")e.preventDefault(),E.focus();else if(d&&e.key==="ArrowUp"){const m=Array.from(d?.querySelectorAll("a"))?.at(-1);m&&m.focus()}else if(q&&e.key==="ArrowDown"){const m=Array.from(q?.querySelectorAll("a"))?.at(-1);m&&m.focus()}}function j(){F.value=setTimeout(()=>{S.value=!1},150)}return(e,s)=>(a(),y(v(M),null,{default:K(()=>[A(v(H),{fullscreen:!0},{default:K(()=>[n("div",se,[i.value?(a(),y(oe,{key:0,selected:i.value},null,8,["selected"])):x("",!0),n("div",{ref_key:"scrollContainer",ref:c,class:"flex flex-col justify-start items-start w-available -mx-3 px-3 absolute left-14 right-14 top-[264px] h-available overflow-auto scroll-smooth gap-4 flex-1 pb-16",tabindex:"0",onFocus:s[0]||(s[0]=o=>_(o))},[A(U,{data:v(l)?.filter(o=>!!o.id)??[],"handle-down":B,"handle-focus":_,"handle-up":j,title:"Continue watching"},null,8,["data"]),v(p)?.pages?(a(!0),u(f,{key:0},b(v(p).pages,(o,g)=>(a(),u(f,{key:g},[o?(a(!0),u(f,{key:0},b(o?.data??[],(d,w)=>(a(),y(U,{key:w,data:d.items,"handle-down":B,"handle-focus":_,"handle-up":j,title:d.title,suffix:"/watch"},null,8,["data","title"]))),128)):x("",!0)],64))),128)):x("",!0)],544)])]),_:1})]),_:1}))}});export{he as default};
