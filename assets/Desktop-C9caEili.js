import"./useBaseQuery-CYfJwrsk.js";import"./useInfiniteServerClient-DbRwcWh9.js";import"./useQueryClient-C_P4UbFA.js";import"./useQuery-BZZbL5T1.js";import{As as i,Jo as k,Ms as D,Ps as E,Ta as R,Tr as p,Us as t,Ys as y,_a as $,fs as b,g as T,hs as C,ls as w,nc as d,oc as u,os as _,ps as o,r as q,rc as g,ss as c,ts as A,ur as a,wr as h,za as N}from"./index-DHmO9d-Y.js";import"./_plugin-vue_export-helper-CksOYaUN.js";import"./AppLogoSquare-CDlgz3Ix.js";import"./OptimizedIcon-BsR4mq_7.js";import{t as z}from"./TMDBImage-ByExKXxq.js";import{t as I}from"./useServerClient-4jd4Xj-7.js";import"./ScrollContainer-DN-VaE0D.js";import"./useMounted-D8ozgYI7.js";import"./RipperOverlay-CiaWRqXv.js";import"./HubConnection-A53UwK20.js";import"./ripperSocket-bPyJRefx.js";import"./Button-S2Vqb2RP.js";import"./FloatingBackButton-DvPJRFSU.js";import{t as M}from"./DashboardLayout-CieD9zJ6.js";import{t as U}from"./DashboardCard-B549lQPI.js";N();k();var V={class:"relative flex aspect-video flex-shrink-0 flex-grow-0 flex-col items-center justify-center self-stretch overflow-clip rounded-lg bg-theme-8"},j={key:1,class:"text-xl font-bold"},K=C({__name:"LibraryCard",props:{data:{type:Object,required:!0}},setup(r){return(l,n)=>(i(),c(U,{line1:r.data.title,line2:r.data.folder_library&&r.data.folder_library?.length!==1?`${r.data.folder_library?.length} folders`:`${r.data.folder_library?.length}  folder`,route:`/dashboard/libraries/${r.data.id}`},{image:t(()=>[_("div",V,[n[0]||(n[0]=_("div",{class:"backdropCard-overlay"},null,-1)),r.data.image?(i(),c(z,{key:0,path:r.data.image,class:"z-0"},null,8,["path"])):(i(),w("span",j,u(r.data.title),1))])]),_:1},8,["line1","line2","route"]))}}),P=K;k();var F=C({__name:"Desktop",setup(r){const l=q(),{data:n,error:x}=I({path:"dashboard/libraries",queryKey:["dashboard","libraries",p.value?.serverBaseUrl]});function B(){h().post("dashboard/libraries").then(({data:e})=>{l.add({severity:e.status==="ok"?"success":"error",summary:a(e.status==="ok"?"Success":"Error"),detail:a(e.message,...e.args),life:5e3}),T.invalidateQueries({queryKey:["dashboard","libraries",p.value?.serverBaseUrl]})})}const s=y(!1);function L(){s.value=!0,h().post("dashboard/libraries/refresh").then(({data:e})=>{s.value=!1,l.add({severity:e.status==="ok"?"success":"error",summary:a(e.status==="ok"?"Success":"Error"),detail:a(e.message,...e.args),life:5e3})}).catch(()=>{s.value=!1,l.add({severity:"error",summary:a("Error"),detail:a("An error occurred while rescanning the libraries"),life:5e3})})}const f=y(!1);function S(){f.value=!0,h().post("dashboard/libraries/rescan").then(({data:e})=>{f.value=!1,l.add({severity:e.status==="ok"?"success":"error",summary:a(e.status==="ok"?"Success":"Error"),detail:a(e.message,...e.args),life:5e3})}).catch(()=>{f.value=!1,l.add({severity:"error",summary:a("Error"),detail:a("An error occurred while rescanning the libraries"),life:5e3})})}return(e,J)=>{const m=E("Button");return i(),c(d(R),null,{default:t(()=>[o(d($),{fullscreen:!0},{default:t(()=>[o(M,{error:d(x),"grid-style":1,title:"Libraries",description:"Manage your media libraries and their content here."},{cta:t(()=>[o(m,{id:"newLibrary",color:"theme","start-icon":"folderAdd",onClick:B},{default:t(()=>[b(u(e.$t("New library")),1)]),_:1})]),actions:t(()=>[o(m,{id:"refresh",type:"button",variant:"text","start-icon":"folderSwap",disabled:s.value,class:g(s.value?"first:children:animate-spin cursor-not-allowed":""),onClick:L},{default:t(()=>[b(u(e.$t("Refresh all libraries")),1)]),_:1},8,["disabled","class"]),o(m,{id:"rescan",type:"button",variant:"text","start-icon":"folderSwap",disabled:s.value,class:g(s.value?"first:children:animate-spin cursor-not-allowed":""),onClick:S},{default:t(()=>[b(u(e.$t("Rescan all libraries")),1)]),_:1},8,["disabled","class"])]),default:t(()=>[(i(!0),w(A,null,D(d(n)??[],v=>(i(),c(P,{key:v.id,data:v},null,8,["data"]))),128))]),_:1},8,["error"])]),_:1})]),_:1})}}}),ce=F;export{ce as default};
