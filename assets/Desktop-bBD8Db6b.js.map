{"version":3,"file":"Desktop-bBD8Db6b.js","sources":["../../src/views/Base/Collection/Desktop.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport {onMounted, onUnmounted, ref, watch} from 'vue';\nimport {useRouter} from 'vue-router';\nimport {IonPage, IonContent} from '@ionic/vue';\nimport collect from 'collect.js';\n\nimport type {CollectionResponse} from '@/types/api/base/collection';\n\nimport i18next from '@/config/i18next';\nimport useServerClient from '@/lib/clients/useServerClient';\nimport {setBackground, setColorPalette} from '@/store/ui';\nimport {setTitle, sortByPosterAlphabetized, unique} from '@/lib/stringArray';\nimport {convertToHumanReact} from '@/lib/dateTime';\n\nimport ScrollContainer from '@/Layout/Desktop/components/ScrollContainer.vue';\nimport FloatingBackButton from '@/components/Buttons/FloatingBackButton.vue';\nimport GenrePill from '@/components/Buttons/GenrePill.vue';\nimport MoooomIcon from '@/components/Images/icons/MoooomIcon.vue';\nimport MediaLikeButton from '@/components/Buttons/MediaLikeButton.vue';\nimport DropdownMenu from '@/Layout/Desktop/components/Menus/DropdownMenu.vue';\nimport {showBackdrops} from '@/store/preferences';\nimport MediaCard from '@/components/Cards/MediaCard.vue';\nimport PersonCarousel from '@/components/Carousel/PersonCarousel.vue';\nimport ImageCarousel from '@/components/Carousel/ImageCarousel.vue';\nimport ContentRating from '@/components/Images/ContentRating.vue';\nimport {useTranslation} from 'i18next-vue';\nimport InfoHeaderItem from \"@/views/Base/Info/components/InfoHeaderItem.vue\";\nimport HeaderItem from \"@/views/Base/Person/components/HeaderItem.vue\";\n\nconst {t} = useTranslation();\nconst router = useRouter();\n\nconst { data } = useServerClient<CollectionResponse>({\n  queryKey: ['base', 'collection', router.currentRoute.value.params.id],\n  limit: 1000,\n  keepForever: true,\n});\n\nconst endTime = ref<string | 0 | null | undefined>(null);\nconst interval = ref<NodeJS.Timeout | null>(null);\n\nwatch(data, (value) => {\n  if (!value) return;\n\n  if (value?.backdrop) {\n    setBackground(value?.backdrop);\n  }\n  if (value?.color_palette) {\n    setColorPalette(value.color_palette.backdrop);\n  }\n\n  endTime.value = value.duration && new Date(new Date().getTime() + (value.duration * 60 * 1000)).toLocaleTimeString(i18next.language ?? 'en-US', {\n    hour: '2-digit',\n    minute: '2-digit',\n  });\n  interval.value = setInterval(() => {\n    endTime.value = value.duration && new Date(new Date().getTime() + (value.duration * 60 * 1000)).toLocaleTimeString(i18next.language ?? 'en-US', {\n      hour: '2-digit',\n      minute: '2-digit',\n    });\n  }, 1000);\n\n});\n\nonMounted(() => {\n  document.dispatchEvent(new Event('sidebar'));\n  setTitle(data?.value?.title);\n\n  if (data?.value?.backdrop) {\n    setBackground(data?.value?.backdrop);\n  }\n  if (data?.value?.color_palette) {\n    setColorPalette(data?.value?.color_palette.backdrop);\n  }\n});\n\nonUnmounted(() => {\n  setBackground(null);\n  setColorPalette(null);\n\n  clearInterval(interval.value ?? undefined);\n});\n\n\n</script>\n\n<template>\n  <ion-page>\n    <ion-content :fullscreen=\"true\">\n      <ScrollContainer :static=\"true\" :auto-hide=\"true\">\n\n        <div class=\"w-available\">\n          <FloatingBackButton />\n          <div v-if=\"data\" class=\"w-available overflow-x-clip relative mt-12 flex flex-grow flex-col items-start justify-start gap-4 self-stretch p-4 pr-0 pb-5\">\n            <p class=\"ml-4 w-full flex-shrink-0 flex-grow-0 self-stretch text-5xl font-bold\">\n              {{ data?.title?.replace(/(: | en de )/, '\\n') }}\n            </p>\n            <p class=\"ml-4 w-full flex-shrink-0 flex-grow-0 self-stretch text-lg\">\n              {{ data?.overview }}\n            </p>\n            <div class=\"flex flex-shrink-0 flex-grow-0 flex-col items-start justify-start gap-4 self-stretch\">\n              <div\n                  class=\"relative flex flex-shrink-0 flex-grow-0 flex-col items-start justify-start gap-4 self-stretch\">\n                <div class=\"self-stretch h-px bg-[#e2f0fd]/4\"></div>\n                <div class=\"flex flex-shrink-0 flex-grow-0 items-start justify-start gap-8 self-stretch pl-4\">\n                  <div class=\"relative flex h-14 items-center justify-center gap-2\">\n                      <ContentRating :size=\"6\" v-if=\"data?.content_ratings\"\n                                     class=\"h-full min-!h-[1rem] object-scale-down rounded-lg overflow-clip children:-m-0.5\"\n                                     :ratings=\"data?.content_ratings\"/>\n                  </div>\n                  <div class=\"relative flex flex-shrink-0 flex-grow-0 flex-col items-start justify-center gap-1\">\n                    <p class=\"flex-shrink-0 flex-grow-0 text-xs font-bold uppercase text-auto-alpha-10\">\n                      {{ $t('Availability') }}\n                    </p>\n\n                    <InfoHeaderItem>\n                      <p class=\"flex-shrink-0 flex-grow-0 text-sm font-bold text-auto-12 -ml-0.5\">\n                        {{ data?.have_items }} / {{ data?.number_of_items }}\n                      </p>\n                    </InfoHeaderItem>\n                  </div>\n                  <div class=\"relative flex flex-shrink-0 flex-grow-0 flex-col items-start justify-center gap-1\">\n                    <p class=\"flex-shrink-0 flex-grow-0 text-xs font-bold uppercase text-auto-alpha-10\">\n                      {{ $t('Timespan') }}\n                    </p>\n                    <InfoHeaderItem>\n                      <p class=\"flex-shrink-0 flex-grow-0 text-sm font-bold text-auto-12 -ml-0.5\">\n                        {{ collect(data?.collection).min('year') }}\n                        - {{ collect(data?.collection).max('year') }}\n                      </p>\n                    </InfoHeaderItem>\n                  </div>\n                  <div class=\"relative flex flex-shrink-0 flex-grow-0 flex-col items-start justify-center gap-1\">\n                    <p class=\"flex-shrink-0 flex-grow-0 text-xs font-bold uppercase text-auto-alpha-10\">\n                      {{ $t('Total duration') }}\n                    </p>\n                    <InfoHeaderItem v-if=\"data?.total_duration\">\n                      <p class=\"flex-shrink-0 flex-grow-0 text-sm font-bold text-auto-12 -ml-0.5\">\n                        {{ convertToHumanReact(t, data?.total_duration, true) }}\n                      </p>\n                    </InfoHeaderItem>\n                  </div>\n                  <div class=\"relative flex flex-grow flex-col items-start justify-center text-left gap-1\">\n                    <p class=\"flex-shrink-0 flex-grow-0 text-xs font-bold uppercase text-auto-alpha-10\">\n                      {{ $t('Genre') }}\n                    </p>\n                    <div class=\"flex flex-shrink-0 flex-grow-0 flex-wrap self-stretch overflow-clip font-medium gap-0.5\"\n                         :class=\"data?.genres?.length > 5 ? 'children:grayscale' : ''\"\n                    >\n                      <template v-for=\"genre in data?.genres\" :key=\"genre.id\">\n                        <GenrePill :genre=\"genre\" />\n                      </template>\n                    </div>\n                  </div>\n\n                  <div class=\"relative ml-auto flex h-16 flex-shrink-0 flex-grow-0 items-center justify-center gap-4\" v-if=\"data\">\n\n                    <RouterLink\n                        :to=\"`/${data?.media_type}/${data?.id}/watch`\"\n                        class=\"relative flex items-center justify-center gap-2 rounded-lg p-2 transition-colors duration-300 group/play hover:bg-auto-5/6\">\n                      <MoooomIcon icon=\"play\" className=\"w-6\"/>\n\n                      <div\n                          class=\"absolute top-3 grid h-0 w-max flex-shrink-0 flex-grow-0 origin-bottom group-hover/play:grid-cols-1 items-center justify-start bg-black duration-300 grid-cols-[0fr] group-hover/play:h-[32.77px] transform-all left-[-31px] group-hover/play:top-[-38px] rounded-[5.46px]\">\n                        <div class=\"overflow-hidden\">\n                          <p class=\"flex-shrink-0 flex-grow-0 py-0 text-xs font-bold px-2.5\">\n                            {{ $t('Ends at') }}\n                            {{ endTime }}\n                          </p>\n                        </div>\n                      </div>\n                    </RouterLink>\n\n                    <!--                            <button-->\n                    <!--                                class=\"relative flex items-center justify-center gap-2 overflow-hidden rounded-lg p-2 transition-colors duration-300 hover:bg-auto-5/6\"-->\n                    <!--                            >-->\n                    <!--                                <MoooomIcon icon=\"film\" className=\"w-6\"/>-->\n                    <!--                            </button>-->\n                    <!--                            <button-->\n                    <!--                                class=\"relative flex items-center justify-center gap-2 overflow-hidden rounded-lg p-2 transition-colors duration-300 hover:bg-auto-5/6\"-->\n                    <!--                            >-->\n                    <!--                                <MoooomIcon icon=\"check\" className=\"w-6\"/>-->\n                    <!--                            </button>-->\n\n                    <MediaLikeButton div v-if=\"data\" :data=\"data\"/>\n\n                    <DropdownMenu\n                        class=\"relative flex items-center justify-center gap-2 overflow-hidden rounded-lg p-2 transition-colors duration-300 hover:bg-auto-5/6\">\n                      >\n                      <template v-slot:button>\n                        <MoooomIcon icon=\"menuDotsVertical\" className=\"w-6\"/>\n                      </template>\n\n                      <div class=\"flex w-full flex-col items-start justify-start bg-auto-1\"\n                           style=\"box-shadow: 0 4px 7px 0 rgba(0,0,0,0.08);\">\n                        <div\n                            class=\"relative flex h-auto flex-shrink-0 flex-grow-0 flex-col items-center justify-start gap-2 self-stretch z-1099 group\">\n                          <div class=\"flex flex-col p-2\">\n\n                          </div>\n                        </div>\n                      </div>\n                    </DropdownMenu>\n                  </div>\n                </div>\n                <div class=\"self-stretch h-px bg-[#e2f0fd]/4\"></div>\n              </div>\n            </div>\n\n            <div class=\"flex-shrink-0 flex-grow-0 items-start justify-start gap-4 self-stretch px-4\"\n                 :class=\"showBackdrops ? 'media-backdrop-grid' : 'media-poster-grid'\">\n              <template v-for=\"movie in data?.collection ?? []\" :key=\"movie?.id\">\n                <MediaCard :data=\"movie\"  class=\"\" />\n              </template>\n            </div>\n\n            <PersonCarousel v-if=\"data?.cast && data?.cast?.length > 0\"\n                            :data=\"unique(data?.cast, 'id').slice(0, 50)\"\n                            title=\"Cast\"/>\n\n            <PersonCarousel v-if=\"data?.crew && data?.crew?.length > 0\"\n                            :data=\"sortByPosterAlphabetized(data?.crew).slice(0, 50)\"\n                            title=\"Crew\"/>\n\n            <ImageCarousel v-if=\"data?.posters && data?.posters?.length > 0\"\n                           :data=\"data?.posters\"\n                           title=\"Poster\"\n                           type=\"poster\"/>\n\n            <ImageCarousel v-if=\"data?.backdrops && data?.backdrops?.length > 0\"\n                           :color-palette=\"data?.color_palette?.poster\"\n                           :data=\"data?.backdrops\"\n                           title=\"Backdrop\"\n                           type=\"backdrop\"/>\n\n\n          </div>\n        </div>\n      </ScrollContainer>\n    </ion-content>\n  </ion-page>\n</template>\n"],"names":["t","useTranslation","router","useRouter","data","useServerClient","endTime","ref","interval","watch","value","setBackground","setColorPalette","i18next","onMounted","setTitle","_a","_b","_c","_d","_e","onUnmounted"],"mappings":"iiGA6BM,KAAA,CAAC,EAAAA,EAAC,EAAIC,GAAe,EACrBC,GAASC,GAAU,EAEnB,CAAE,KAAAC,CAAK,EAAIC,GAAoC,CACnD,SAAU,CAAC,OAAQ,aAAcH,GAAO,aAAa,MAAM,OAAO,EAAE,EACpE,MAAO,IACP,YAAa,EAAA,CACd,EAEKI,EAAUC,EAAmC,IAAI,EACjDC,EAAWD,EAA2B,IAAI,EAE1C,OAAAE,GAAAL,EAAOM,GAAU,CAChBA,IAEDA,GAAA,MAAAA,EAAO,UACTC,EAAcD,GAAA,YAAAA,EAAO,QAAQ,EAE3BA,GAAA,MAAAA,EAAO,eACOE,EAAAF,EAAM,cAAc,QAAQ,EAG9CJ,EAAQ,MAAQI,EAAM,UAAY,IAAI,KAAK,IAAI,OAAO,QAAa,EAAAA,EAAM,SAAW,GAAK,GAAK,EAAE,mBAAmBG,EAAQ,UAAY,QAAS,CAC9I,KAAM,UACN,OAAQ,SAAA,CACT,EACQL,EAAA,MAAQ,YAAY,IAAM,CACjCF,EAAQ,MAAQI,EAAM,UAAY,IAAI,KAAK,IAAI,OAAO,QAAa,EAAAA,EAAM,SAAW,GAAK,GAAK,EAAE,mBAAmBG,EAAQ,UAAY,QAAS,CAC9I,KAAM,UACN,OAAQ,SAAA,CACT,GACA,GAAI,EAAA,CAER,EAEDC,GAAU,IAAM,eACd,SAAS,cAAc,IAAI,MAAM,SAAS,CAAC,EAClCC,IAAAC,EAAAZ,GAAA,YAAAA,EAAM,QAAN,YAAAY,EAAa,KAAK,GAEvBC,EAAAb,GAAA,YAAAA,EAAM,QAAN,MAAAa,EAAa,UACDN,GAAAO,EAAAd,GAAA,YAAAA,EAAM,QAAN,YAAAc,EAAa,QAAQ,GAEjCC,EAAAf,GAAA,YAAAA,EAAM,QAAN,MAAAe,EAAa,eACCP,GAAAQ,EAAAhB,GAAA,YAAAA,EAAM,QAAN,YAAAgB,EAAa,cAAc,QAAQ,CACrD,CACD,EAEDC,GAAY,IAAM,CAChBV,EAAc,IAAI,EAClBC,EAAgB,IAAI,EAEN,cAAAJ,EAAS,OAAS,MAAS,CAAA,CAC1C;"}