import"./useBaseQuery-DhMTNjjH.js";import{n as K}from"./useInfiniteServerClient-BOGzXRLT.js";import"./useQueryClient-BDTWlHnP.js";import"./useQuery-UqFzG2sc.js";import{Ba as L,Ea as P,Fs as R,Hs as V,Js as z,Ns as _,Os as M,Va as O,Ws as U,Yo as $,Ys as T,cs as g,ec as m,gs as C,is as W,js as a,ls as x,ms as D,ns as f,sc as h,ss as n,us as i,va as Y}from"./index-zK1-WOQT.js";import"./_plugin-vue_export-helper-CksOYaUN.js";import"./AppLogoSquare-ClEEG0E7.js";import{t as J}from"./TMDBImage-BTvZBjXB.js";import{t as G}from"./useServerClient-BWjN3Na1.js";L();$();var Q={key:0,class:"grid grid-rows-[auto_1fr] grid-cols-7 relative justify-start flex-1 w-full gap-3 mb-2","data-row":""},X={class:"row-start-1 col-span-7 pointer-events-none font-semibold font-3xl"},Z=["src"],ee=C({__name:"TvCarousel2",props:{data:{type:Array,required:!0},title:{type:String,required:!0},handleFocus:{type:Function,required:!0},handleDown:{type:Function,required:!0},handleUp:{type:Function,required:!0},suffix:{type:String,required:!1,default:""}},setup(t){return(v,o)=>{const b=R("RouterLink");return a(),i(f,null,[t.data.length?(a(),i("div",Q,[n("h3",X,T(t.title),1),(a(!0),i(f,null,_(t.data.slice(0,7),(l,u)=>(a(),g(b,{key:l.id,"data-card":l.id,"data-index":u,style:z(`background-image: url('https://app.nomercy.tv/tmdb-images${l.poster}?width=300')`),to:`${l.link}${t.suffix}`,class:"row-start-2 w-full h-auto rounded-xl bg-cover aspect-poster focus:scale-105 focus:outline outline-[2.2px] outline-white transition-transform duration-200 scroll-mb-20 scroll-mt-12 snap-center snap-mandatory",onFocus:d=>t.handleFocus(d,l),onKeydown:o[0]||(o[0]=d=>t.handleDown(d)),onKeyup:o[1]||(o[1]=d=>t.handleUp(d))},null,8,["data-card","data-index","style","to","onFocus"]))),128))])):x("",!0),(a(),g(W,{to:".image-preload-container"},[(a(!0),i(f,null,_(t.data?.slice(0,7),l=>(a(),i("img",{key:l.id,src:`https://app.nomercy.tv/tmdb-images${l.backdrop}?width=1080`,alt:"",class:"absolute",height:"0",loading:"eager",width:"0"},null,8,Z))),128))]))],64)}}}),H=ee;$();var te={class:"w-available h-auto absolute left-[250px] top-0 overflow-hidden bg-black aspect-video"},ae={class:"flex flex-col justify-start items-start w-[484px] relative left-[58px] top-20 gap-7"},le={class:"flex flex-col justify-start items-start self-stretch relative gap-5"},re={class:"flex flex-col justify-start items-start w-full relative gap-0"},se={class:"self-stretch w-full text-xl text-left mt-2"},oe={class:"line-clamp-4 text-sm -mt-4"},ne=C({__name:"TvHeader",props:{selected:{type:Object,required:!1}},setup(t){return(v,o)=>(a(),i("div",{key:t.selected?.id,class:"w-full h-full absolute left-0 top-0 bg-[#131314]"},[n("div",te,[D(J,{alt:t.selected?.title,path:t.selected?.backdrop,size:540,class:"w-available h-available absolute left-[-0.39px] top-[-0.39px] object-cover"},null,8,["alt","path"]),o[0]||(o[0]=n("div",{class:"w-available h-available absolute left-[-0.39px] top-[-0.39px]"},null,-1)),o[1]||(o[1]=n("div",{class:"w-[150vw] h-[150vw] absolute left-[-30%] bottom-[-50%]",style:{background:`radial-gradient(
            closest-side,
            rgba(19, 19, 20, 0.1) 0%,
            rgba(19, 19, 20, 1) 70.73974609375%
          )`}},null,-1))]),n("div",ae,[n("div",le,[n("div",re,[n("p",se,T(t.selected?.title),1)]),n("div",oe,T(t.selected?.overview),1)])])]))}}),ue=ne;$();var ie={class:"w-screen h-screen relative overflow-hidden bg-[#131314]"},de=C({__name:"Tv",setup(t){const{data:v,fetchNextPage:o,hasNextPage:b}=K({path:"/",queryKey:["home"]});V(v,()=>{b&&o()});const{data:l}=G({path:"userdata/continue",queryKey:["continue"],refetchInterval:1e3*60*5}),u=m();V(l,e=>{e&&(u.value=e?.filter(s=>s.id)?.at(0))}),M(()=>{u.value=l.value?.filter(e=>e.id)?.at(0),setTimeout(()=>{const e=document.querySelector(`[data-card="${u.value?.id}"]`);e&&e.focus()},1e3)}),O(()=>{u.value=l.value?.filter(e=>e.id)?.at(0),setTimeout(()=>{const e=document.querySelector(`[data-card="${u.value?.id}"]`);e&&e.focus()},1e3)});const d=m(),k=m(!1),A=m(),B=m();function S(e,s){const r=e.target;if(r?.nodeName==="DIV"){(B.value??r.querySelector("a"))?.focus();return}s&&(u.value=s,B.value=r)}function F(e){if(k.value){e.preventDefault();return}clearTimeout(A.value),k.value=!0;const s=e.target,r=s.getAttribute("data-index"),y=s.closest("[data-row]"),c=y?.previousElementSibling,w=c?.querySelector(`a[data-index="${r}"]`),q=y?.nextElementSibling,I=q?.querySelector(`a[data-index="${r}"]`),E=s.previousElementSibling,N=s.nextElementSibling;if(w&&e.key==="ArrowUp")e.preventDefault(),w.focus();else if(I&&e.key==="ArrowDown")e.preventDefault(),I.focus();else if(E&&e.key==="ArrowLeft")e.preventDefault(),E.focus();else if(N&&e.key==="ArrowRight")e.preventDefault(),N.focus();else if(c&&e.key==="ArrowUp"){const p=Array.from(c?.querySelectorAll("a"))?.at(-1);p&&p.focus()}else if(q&&e.key==="ArrowDown"){const p=Array.from(q?.querySelectorAll("a"))?.at(-1);p&&p.focus()}}function j(){A.value=setTimeout(()=>{k.value=!1},150)}return(e,s)=>(a(),g(h(P),null,{default:U(()=>[D(h(Y),{fullscreen:!0},{default:U(()=>[n("div",ie,[u.value?(a(),g(ue,{key:0,selected:u.value},null,8,["selected"])):x("",!0),n("div",{ref_key:"scrollContainer",ref:d,class:"flex flex-col justify-start items-start w-available -mx-3 px-3 absolute left-14 right-14 top-[264px] h-available overflow-auto scroll-smooth gap-4 flex-1 pb-16",tabindex:"0",onFocus:s[0]||(s[0]=r=>S(r))},[D(H,{data:h(l)?.filter(r=>!!r.id)??[],"handle-down":F,"handle-focus":S,"handle-up":j,title:"Continue watching"},null,8,["data"]),h(v)?.pages?(a(!0),i(f,{key:0},_(h(v).pages,(r,y)=>(a(),i(f,{key:y},[r?(a(!0),i(f,{key:0},_(r?.data??[],(c,w)=>(a(),g(H,{key:w,data:c.items,"handle-down":F,"handle-focus":S,"handle-up":j,title:c.title,suffix:"/watch"},null,8,["data","title"]))),128)):x("",!0)],64))),128)):x("",!0)],544)])]),_:1})]),_:1}))}}),xe=de;export{xe as default};
