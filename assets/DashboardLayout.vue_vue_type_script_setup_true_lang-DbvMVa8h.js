import{K as q,dI as z,ba as C,dJ as E,dK as R,dL as I,dM as T,dN as G,ax as w,L as D,aG as V,cl as K,bb as L,j as $,a7 as A,a6 as P,t as x,o as h,cL as U,cM as Q,bE as J,dO as F,dP as W,dQ as X,az as Y,aM as Z,aP as ee,dR as te,dS as se,c as _,a as o,h as ae,x as j,r as S,aI as le,dT as oe,bH as ne,dU as ce,C as H}from"./index-DQ0F_mrS.js";import{_ as re}from"./FloatingBackButton.vue_vue_type_script_setup_true_lang-DfYnJ3B0.js";import{_ as ie}from"./Button.vue_vue_type_script_setup_true_lang-DwVamkC9.js";const a=q(),Me=w(()=>{var t;return(t=a.value)==null?void 0:t.connection}),b=q(!1),B=()=>{var t,l,s;b.value=!0,console.log("Connected to Dashboard SignalR"),document.dispatchEvent(new Event("dashboardHub-connected")),(t=a.value)!=null&&t.connection&&(T((l=a.value)==null?void 0:l.connection),G((s=a.value)==null?void 0:s.connection))},y=t=>{b.value=!1,console.log("Disconnected from Dashboard SignalR",t),document.dispatchEvent(new Event("dashboardHub-disconnected"))},N=t=>{b.value=!1,console.error("Dashboard SignalR Error:",t),document.dispatchEvent(new Event("dashboardHub-error"))};D(C,async t=>{var s,n,u,g,m,f,v,p;const l=(s=z.value)==null?void 0:s.accessToken;t&&b.value&&((u=(n=a.value)==null?void 0:n.connection)==null||u.stop().then(),(g=a.value)==null||g.dispose(),a.value=new R(C.value.serverBaseUrl,l,"dashboardHub"),(f=(m=a.value)==null?void 0:m.connection)==null||f.on("connected",B),(p=(v=a.value)==null?void 0:v.connection)==null||p.on("disconnected",y),await O().catch(N))});const O=async()=>{var t,l,s,n;if(((l=(t=a.value)==null?void 0:t.connection)==null?void 0:l.state)!==E.Connected)return(n=(s=a.value)==null?void 0:s.connection)==null?void 0:n.start().then(B)},de=async()=>{var t,l,s,n;try{return((l=(t=a.value)==null?void 0:t.connection)==null?void 0:l.state)===E.Disconnected||(n=(s=a.value)==null?void 0:s.connection)==null?void 0:n.stop().then(y).catch(y)}catch(u){console.error("Error stopping Dashboard SignalR:",u),y()}},M=async()=>{var l,s,n,u,g,m,f,v,p,e,r,i,d;const t=(l=z.value)==null?void 0:l.accessToken;C.value&&(!((n=(s=a.value)==null?void 0:s.connection)!=null&&n.state)||((g=(u=a.value)==null?void 0:u.connection)==null?void 0:g.state)===E.Disconnected)&&(a.value=new R(C.value.serverBaseUrl,t,"dashboardHub"),(f=(m=a.value)==null?void 0:m.connection)==null||f.on("connected",B),(p=(v=a.value)==null?void 0:v.connection)==null||p.on("disconnected",y),await O().catch(N),(r=(e=a.value)==null?void 0:e.connection)==null||r.onreconnecting(c=>{var k;console.log("SignalR Disconnected.",c==null?void 0:c.message),I((k=a.value)==null?void 0:k.connection),y()}),(d=(i=a.value)==null?void 0:i.connection)==null||d.onreconnected(()=>{var c;console.log("SignalR Reconnected."),T((c=a.value)==null?void 0:c.connection),B()}))},ue=V({__name:"HelpButton",setup(t){const l=L(),s=w(()=>`https://docs${K}.nomercy.tv${l.path.replace(/\/\w{8}-\w{4}-\w{4}-\w{4}-\w{12}/gu,"")}`);return(n,u)=>(h(),$(ie,{id:"help",href:s.value,variant:"text",component:"link",target:"_blank",color:"auto",startIcon:"messageBubbleQuestion",class:"relative flex h-10 flex-shrink-0 flex-grow-0 items-center justify-center gap-2 overflow-hidden rounded-lg px-4 py-2.5"},{default:A(()=>[P(x(n.$t("Help")),1)]),_:1},8,["href"]))}}),fe={key:0,class:"grid h-full w-full place-items-center"},ve={class:"relative flex items-center justify-start gap-8 overflow-hidden"},he={class:"relative flex w-full flex-col gap-4"},pe={class:"text-7xl font-bold text-center text-slate-light-12/80 dark:text-slate-dark-12/80"},ge={class:"left-0 text-2xl text-center text-slate-light-12/80 dark:text-slate-dark-12/80 whitespace-pre-line"},me=["inert"],xe={class:"z-10 flex h-20 items-center justify-between gap-4 self-stretch border-b px-4 py-4 border-auto-7/6 xl:px-6 bg-slate-light-4 dark:bg-slate-dark-2"},be={class:"relative flex h-full flex-col items-start justify-center gap-1 text-slate-light-12/80 dark:text-slate-dark-12/80"},we={class:"w-auto flex-shrink-0 flex-grow-0 self-stretch whitespace-nowrap text-xl font-semibold"},ye={key:1,class:"hidden h-8 w-auto flex-shrink-0 flex-grow-0 items-center self-stretch text-sm empty:hidden lg:flex"},ke={class:"flex flex-col flex-nowrap items-end justify-center gap-x-3 gap-y-1 sm:flex-row"},_e={key:0,class:"grid h-full w-full place-items-center bg-slate-light-4 dark:bg-slate-dark-2"},Se={class:"relative flex flex-col items-center justify-start gap-8 overflow-hidden"},$e={class:"relative flex w-full flex-col gap-4"},Ce={class:"text-7xl font-bold text-center text-slate-light-12/80 dark:text-slate-dark-12/80"},Be={class:"left-0 text-2xl text-center text-slate-light-12/80 dark:text-slate-dark-12/80 whitespace-pre-line"},De={key:2,class:"sticky bottom-0 z-0 flex w-full flex-wrap items-center gap-4 border-t px-4 py-4 border-auto-7/6 empty:hidden sm:h-16 xl:px-6"},qe=V({__name:"DashboardLayout",props:U({title:{type:String,required:!0},params:{type:Object,required:!1},description:{type:String,required:!1},gridStyle:{type:Number,required:!1,default:0},back:{type:Boolean,required:!1,default:!1},error:{type:Object,required:!1},allowAnyone:{type:Boolean,required:!1,default:!1}},{modelValue:{required:!1,type:Boolean},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const l=Q(t,"modelValue"),s=t,{dataUpdatedAt:n,error:u,isPending:g}=J({path:"dashboard/server",enabled:!s.allowAnyone,refetchInterval:1e4,queryKey:["dashboard","server",b.value]}),m=w(()=>s.gridStyle==1?F.value:s.gridStyle==2?W.value:s.gridStyle==3?X.value:s.gridStyle==4?"flex flex-wrap h-available":"flex flex-wrap h-available overflow-clip"),f=w(()=>{var r,i,d,c,k;if(s.allowAnyone)return null;const e=u.value;if(((r=e==null?void 0:e.response)==null?void 0:r.status)!=200)return{code:((d=(i=e==null?void 0:e.response)==null?void 0:i.data)==null?void 0:d.status)??null,message:((k=(c=e==null?void 0:e.response)==null?void 0:c.data)==null?void 0:k.detail)??""}}),v=w(()=>{var r,i,d,c;const e=s.error;if(console.log(e),!(!(e!=null&&e.response)||((r=e==null?void 0:e.response)==null?void 0:r.status)==200))return{code:(i=e==null?void 0:e.response)==null?void 0:i.status,message:((c=(d=e==null?void 0:e.response)==null?void 0:d.data)==null?void 0:c.detail)??""}});Y(()=>{Z(null),ee(null)}),te(M,de,1);const p=w(()=>{var e;return(((e=f.value)==null?void 0:e.code)||g.value||!b.value)&&!s.allowAnyone});return D(p,e=>{e&&l.value!=null&&(l.value=!1)}),D(n,e=>{e&&!b.value&&M()}),(e,r)=>{var i,d,c;return h(),$(se,null,[p.value?(h(),_("div",fe,[o("div",ve,[o("div",he,[o("p",pe,x((i=f.value)!=null&&i.code?(d=f.value)==null?void 0:d.code:"Offline"),1),o("p",ge,x((c=f.value)==null?void 0:c.message),1)])])])):(h(),_("div",{key:1,class:H([{" min-h-[92vh] sm:min-h-[92.8vh]":!e.$slots.cta," min-h-[92vh] sm:min-h-[90.2vh]":!!e.$slots.cta},"flex flex-col relative z-0 h-available h-px overflow-clip items-start justify-start self-stretch w-available bg-slate-light-4 dark:bg-slate-dark-2"])},[o("div",{class:"sticky top-0 z-10 flex flex-shrink-0 flex-grow-0 flex-col items-start justify-start gap-5 self-stretch",inert:le(oe)},[r[0]||(r[0]=o("div",{class:"absolute inset-0 z-0 h-full w-full"},null,-1)),o("div",xe,[o("div",be,[o("p",we,x(e.$t(t.title,t.params)),1),t.back?(h(),$(re,{key:0,position:"relative",class:"left-4"})):(h(),_("p",ye,x(e.$t(t.description)),1))]),S(e.$slots,"title"),o("div",ke,[j(ue),S(e.$slots,"cta")])])],8,me),v.value?(h(),_("div",_e,[o("div",Se,[o("div",$e,[o("p",Ce,x(v.value.code),1),o("p",Be,x(v.value.message),1)])])])):(h(),$(ne,{key:1,static:!0,frame:"",class:"z-0 w-full flex-1 overflow-y-auto overflow-x-hidden sm:p-4 bg-slate-light-4 dark:bg-slate-dark-2"},{default:A(()=>[o("div",{class:H(["h-auto w-full flex-wrap content-start gap-4",m.value])},[S(e.$slots,"default")],2)]),_:3})),!v.value&&e.$slots.actions?(h(),_("div",De,[r[1]||(r[1]=o("div",{class:"absolute inset-0 -z-10 h-full w-full"},null,-1)),S(e.$slots,"actions")])):ae("",!0),j(ce)],2))],1024)}}});export{qe as _,Me as c,b as d};
