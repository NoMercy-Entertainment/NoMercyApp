import"./useBaseQuery-C0DEEruv.js";import"./useInfiniteServerClient-DmNFqhtp.js";import{t as A}from"./useQueryClient-Ckl8PMYN.js";import"./useQuery-DpAWDUOh.js";import{Ci as t,Co as H,Ec as s,Gc as i,Gs as l,Hc as K,Hn as U,Js as S,Ks as R,Nc as N,Ns as T,Oc as p,Qs as v,Rc as u,Si as j,Vn as G,Ws as z,Zs as F,ec as J,fc as L,hc as b,ho as W,qs as q,wi as I,yc as h}from"./index-CJcxWh6B.js";import"./basecomponent-uIIspM28.js";import"./classnames-ai0DVBar.js";import"./baseicon-U3LAJ6fQ.js";import"./MoooomIcon-dTKqCeuZ.js";import"./baseeditableholder-CAq63NTu.js";import{t as Z}from"./Toggle-D_gSZGjc.js";import{t as X}from"./inputtext-C88CUN4S.js";import{t as V}from"./inputnumber-h0w7IWOa.js";import{t as Y}from"./useServerClient-CHebaSt5.js";import"./ScrollContainer-DOKCGwiN.js";import"./useMounted-CUA850NP.js";import"./RipperOverlay-BTER2IQJ.js";import"./HubConnection-BgYujhqd.js";import"./ripperSocket-BtjuUdEG.js";import"./Button-Cgjwh3Ii.js";import"./FloatingBackButton-Benyi2O8.js";import{t as ee}from"./DashboardLayout-CRrh8Ool.js";T();var re={key:0,class:"col-span-2 col-start-1 2xl:col-start-1"},ae={class:"flex flex-col gap-2"},le={class:"flex flex-col gap-2"},oe={class:"flex flex-col gap-2"},te={key:1,class:"col-span-2 col-start-1 2xl:col-start-3"},se={class:"flex flex-col gap-2"},ue={class:"flex flex-col gap-2"},ne={class:"flex flex-col gap-2"},ie={key:2,class:"col-span-2 col-start-1 2xl:col-start-5"},ve={class:"flex flex-col gap-2"},de={class:"flex gap-4"},me=["aria-label","href"],pe=J({__name:"Desktop",setup(_e){const{data:a,refetch:D,error:O}=Y({path:"/dashboard/configuration"}),_=u(!1),n=u(a.value??{}),d=(e,r)=>{if(a.value){if(K(a.value[e])===r){delete n.value[e],n.value={...n.value};return}n.value={...n.value,[e]:r??void 0}}};s(a,e=>{e&&(n.value={},f.value=e?.name,w.value=e?.external_port,g.value=e?.internal_port,c.value=e?.queue_workers,y.value=e?.cron_workers,C.value=e?.data_workers,B.value=e?.request_workers,x.value=e?.encoder_workers,k.value=e?.image_workers,m.value=e?.swagger,_.value=!0)}),L(()=>{a.value&&(n.value={},f.value=a.value?.name,w.value=a.value?.external_port,g.value=a.value?.internal_port,c.value=a.value?.queue_workers,y.value=a.value?.cron_workers,C.value=a.value?.data_workers,B.value=a.value?.request_workers,x.value=a.value?.encoder_workers,k.value=a.value?.image_workers,m.value=a.value?.swagger,_.value=!0)});const f=u(a.value?.name??"");s(f,e=>{d("name",e),t.value&&(U([...G.value.filter(r=>r.id!==t.value.id),{...t.value,name:e.toString()}]),I({...t.value,name:e.toString()}))});const w=u(a.value?.external_port??0);s(w,e=>{d("external_port",e),t.value&&(U([...G.value.filter(r=>r.id!==t.value.id),{...t.value,external_port:e.toString()}]),I({...t.value,external_port:e.toString()}))});const g=u(a.value?.internal_port??0);s(g,e=>{d("internal_port",e),t.value&&(U([...G.value.filter(r=>r.id!==t.value.id),{...t.value,internal_port:e.toString()}]),I({...t.value,internal_port:e.toString()}))});const c=u(a.value?.queue_workers??0);s(c,e=>{d("queue_workers",e)});const y=u(a.value?.cron_workers??0);s(y,e=>{d("cron_workers",e)});const C=u(a.value?.data_workers??0);s(C,e=>{d("data_workers",e)});const B=u(a.value?.request_workers??0);s(B,e=>{d("request_workers",e)});const k=u(a.value?.image_workers??0);s(k,e=>{d("image_workers",e)});const x=u(a.value?.encoder_workers??0);s(x,e=>{d("encoder_workers",e)});const m=u(a.value?.swagger??!1);s(m,e=>{d("swagger",e)});const $=z(()=>Object.keys(n.value).length>0);s(n,e=>{console.log(e)});const Q=A(),E=()=>{console.raw(n.value),j().patch("/dashboard/configuration",n.value).then(()=>{D(),Q.invalidateQueries({queryKey:["serverInfo"]})})};return(e,r)=>{const M=h("MoooomIcon"),P=h("Button");return b(),R(i(H),null,{default:p(()=>[v(i(W),{fullscreen:!0},{default:p(()=>[v(ee,{error:i(O),gridStyle:2,description:"",title:"General"},{cta:p(()=>[...r[8]||(r[8]=[])]),actions:p(()=>[v(P,{id:"save",disabled:!$.value,class:"ml-auto",color:"theme",form:"myForm",type:"submit",onClick:r[7]||(r[7]=o=>E())},{default:p(()=>[F(N(e.$t("Save")),1)]),_:1},8,["disabled"])]),default:p(()=>[_.value?(b(),S("div",re,[l("div",ae,[r[9]||(r[9]=l("label",{for:"name"},"Server name",-1)),v(i(X),{id:"name",modelValue:f.value,"onUpdate:modelValue":r[0]||(r[0]=o=>f.value=o),class:"mb-4"},null,8,["modelValue"])]),l("div",le,[r[10]||(r[10]=l("label",{for:"internal_port"},"Secure internal port",-1)),v(i(V),{id:"internal_port",modelValue:g.value,"onUpdate:modelValue":r[1]||(r[1]=o=>g.value=o),min:2e3,useGrouping:!1,class:"mb-4",showButtons:""},null,8,["modelValue"])]),l("div",oe,[r[11]||(r[11]=l("label",{for:"external_port"},"Secure external port",-1)),v(i(V),{id:"external_port",modelValue:w.value,"onUpdate:modelValue":r[2]||(r[2]=o=>w.value=o),min:2e3,useGrouping:!1,class:"mb-4",showButtons:""},null,8,["modelValue"])])])):q("",!0),_.value?(b(),S("div",te,[l("div",se,[r[12]||(r[12]=l("label",{for:"encoder_workers"},"Encoder workers",-1)),v(i(V),{id:"encoder_workers",modelValue:x.value,"onUpdate:modelValue":r[3]||(r[3]=o=>x.value=o),min:0,useGrouping:!1,class:"mb-4",showButtons:""},null,8,["modelValue"])]),l("div",ue,[r[13]||(r[13]=l("label",{for:"image_workers"},"Image workers",-1)),v(i(V),{id:"image_workers",modelValue:k.value,"onUpdate:modelValue":r[4]||(r[4]=o=>k.value=o),min:0,useGrouping:!1,class:"mb-4",showButtons:""},null,8,["modelValue"])]),l("div",ne,[r[14]||(r[14]=l("label",{for:"queue_workers"},"Queue workers",-1)),v(i(V),{id:"queue_workers",modelValue:c.value,"onUpdate:modelValue":r[5]||(r[5]=o=>c.value=o),min:0,useGrouping:!1,class:"mb-4",showButtons:""},null,8,["modelValue"])])])):q("",!0),_.value?(b(),S("div",ie,[l("div",ve,[l("span",de,[r[15]||(r[15]=l("label",{for:"swagger"},"Open API / Swagger Ui",-1)),m.value&&i(t)?.serverBaseUrl?(b(),S("a",{key:0,"aria-label":e.$t("Open API / Swagger Ui in a new tab"),href:i(t)?.serverBaseUrl,class:"flex gap-1 items-center underline underline-offset-4 h-4 text-sm",target:"_blank"},[l("span",null,N(e.$t("Open")),1),v(M,{className:"size-4",color:"theme",icon:"shareSquare"})],8,me)):q("",!0)]),v(Z,{"model-value":m.value,"onUpdate:modelValue":r[6]||(r[6]=o=>m.value=o)},null,8,["model-value"])])])):q("",!0)]),_:1},8,["error"])]),_:1})]),_:1})}}}),Ee=pe;export{Ee as default};
