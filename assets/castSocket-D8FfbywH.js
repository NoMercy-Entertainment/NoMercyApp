import{bj as g}from"./vendor-D67oQ9Zt.js";import{u as w,l as p,b6 as E,b7 as T,b8 as H,b9 as B}from"./index-FAKGUJAJ.js";import{C as U,d as R,w as j}from"./vue-ionic-CB3fsSQu.js";const n=R(),z=U(()=>{var e;return(e=n.value)==null?void 0:e.connection}),f=R(!1),b=()=>{var e,o,c;f.value=!0,console.log("Connected to Cast SignalR"),document.dispatchEvent(new Event("castHub-connected")),(e=n.value)!=null&&e.connection&&(H((o=n.value)==null?void 0:o.connection),B((c=n.value)==null?void 0:c.connection))},l=e=>{f.value=!1,console.log("Disconnected from Cast SignalR",e),document.dispatchEvent(new Event("castHub-disconnected"))},y=e=>{f.value=!1,console.error("Cast SignalR Error:",e),document.dispatchEvent(new Event("castHub-error"))};j(p,async e=>{var c,t,a,i,u,r,v,d;const o=(c=w.value)==null?void 0:c.accessToken;e&&f.value&&((a=(t=n.value)==null?void 0:t.connection)==null||a.stop().then(),(i=n.value)==null||i.dispose(),n.value=new E(p.value.serverBaseUrl,o,"castHub"),(r=(u=n.value)==null?void 0:u.connection)==null||r.on("connected",b),(d=(v=n.value)==null?void 0:v.connection)==null||d.on("disconnected",l),await D().catch(y))});const D=async()=>{var e,o,c,t;if(((o=(e=n.value)==null?void 0:e.connection)==null?void 0:o.state)!==g.Connected)return(t=(c=n.value)==null?void 0:c.connection)==null?void 0:t.start().then(b)},A=async()=>{var e,o,c,t;try{return((o=(e=n.value)==null?void 0:e.connection)==null?void 0:o.state)===g.Disconnected||(t=(c=n.value)==null?void 0:c.connection)==null?void 0:t.stop().then(l).catch(l)}catch(a){console.error("Error stopping Cast SignalR:",a),l()}},F=async()=>{var o,c,t,a,i,u,r,v,d,C,S,m,h;const e=(o=w.value)==null?void 0:o.accessToken;p.value&&(!((t=(c=n.value)==null?void 0:c.connection)!=null&&t.state)||((i=(a=n.value)==null?void 0:a.connection)==null?void 0:i.state)===g.Disconnected)&&(n.value=new E(p.value.serverBaseUrl,e,"castHub"),(r=(u=n.value)==null?void 0:u.connection)==null||r.on("connected",b),(d=(v=n.value)==null?void 0:v.connection)==null||d.on("disconnected",l),await D().catch(y),(S=(C=n.value)==null?void 0:C.connection)==null||S.onreconnecting(s=>{var k;console.log("SignalR Disconnected.",s==null?void 0:s.message),T((k=n.value)==null?void 0:k.connection),l()}),(h=(m=n.value)==null?void 0:m.connection)==null||h.onreconnected(()=>{var s;console.log("SignalR Reconnected."),H((s=n.value)==null?void 0:s.connection),b()}))};export{F as a,f as b,z as c,A as s};
