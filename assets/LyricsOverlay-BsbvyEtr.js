import{$ as E,At as h,B as P,C as k,Dt as L,Et as c,K as B,S as n,T as m,Y as o,Z as O,_t as x,c as $,g as j,j as C,k as b,lt as A,p as D,st as g,ut as R,w as _}from"./i18n-DXLa9EKW.js";import{x as V,y as F}from"./vue-core-DBpBuPMK.js";import{$i as U,Ct as Z,Da as Q,Et as G,Nt as H,Q as K,W as f,X as S,Z as y,b as M,bt as q,g as W,ht as X,ln as Y,mt as I,rn as w,s as J,tt as ee,xt as N,yi as te}from"./index-CLM6Y7vI.js";import{t as ae}from"./icons-2vy5mgoB.js";import{t as re}from"./ScrollContainer-aZQSs5X2.js";$();var le={class:"relative aspect-square h-auto w-14 overflow-hidden rounded-md text-focus"},ie={class:"relative flex flex-col items-start justify-start gap-1"},se={class:"w-full flex-shrink-0 font-semibold self-stretch-0 text-left"},ne={class:"mb-1 inline-flex h-6 gap-1 overflow-hidden whitespace-nowrap text-xs w-available line-clamp-1 hover-animate-pause"},oe={class:"-ml-1 w-available","data-marquee":"container"},ue={class:"ml-1 flex w-fit flex-nowrap gap-1 text-xs line-clamp-1 whitespace-break-spaces hover-animate-pause w-available h-available","data-marquee":"scroller"},ce={class:"flex w-fit flex-wrap gap-1 whitespace-wrap line-clamp-2 h-inherit"},de={class:"flex items-center gap-1 leading-none line-clamp-2"},ve=C({__name:"QueueTrackItem",props:{song:{},onClick:{type:Function}},setup(u){return(e,r)=>{const d=E("RouterLink");return o(),m("div",{class:L([e.onClick?"cursor-pointer hover:bg-surface-10/50":"","flex h-auto w-full items-center justify-start gap-2 rounded-lg p-2"]),onClick:r[1]||(r[1]=(...v)=>e.onClick&&e.onClick(...v))},[n("figure",le,[e.song?(o(),k(W,{key:0,data:e.song},null,8,["data"])):_("",!0)]),n("div",ie,[n("p",se,h(e.song?.name),1),n("div",ne,[n("div",oe,[n("div",ue,[n("span",ce,[b(d,{to:e.song?.artist_track?.[0]?.link??"#",class:"flex gap-1 whitespace-nowrap text-xs font-semibold line-clamp-2 h-inherit hover:underline focus:underline dark:font-medium",tabindex:"0",onClick:r[0]||(r[0]=v=>c(Y)(v))},{default:A(()=>[n("span",de,h(e.song?.artist_track?.[0]?.name),1)]),_:1},8,["to"])])])])])])],2)}}}),z=ve;$();F();var fe=["data-open","data-size","inert"],me={key:0,id:"queue_container",class:"flex w-full flex-col p-4 h-available overflow-clip"},pe={class:"flex w-full items-center justify-between p-2 pr-6"},ye={class:"text-lg font-semibold"},he={class:"mt-2 mb-1 flex w-full items-center justify-between px-2"},_e={class:"text-lg font-semibold"},xe={class:"flex w-full flex-col items-start justify-start gap-4 relative overflow-hidden h-available"},be=C({__name:"QueueOverlay",setup(u){const e=V();function r(d){if(!q.value)return;const v=`${d.type?.replace(/s$/u,"")}/${d.id}`;if(!Q.value.features?.nomercyConnect&&(f.addToBackLog(f.currentSong),f._queue?.length>0)){let s=f._queue[0];if(f._shuffle){const p=Math.round(Math.random()*(f._queue.length-1));s=f._queue[p]}f.setCurrentSong(s),f.removeFromQueue(s);return}if(ee(),H.value?.invoke("StartPlaybackCommand",e.meta.type?.replace(/s$/u,""),e.params.id,d.id),S.value===v){f.togglePlayback();return}f.playTrack(d,q.value),Z(v)}return(d,v)=>{const s=E("RouterLink");return o(),m("aside",{"data-open":c(N),"data-size":c(X),inert:!c(N),class:"absolute right-4 top-safe-offset-4 bottom-8 data-[open='true']:full:bottom-28 data-[open='true']:compact:bottom-16 sm:data-[open='true']:full:bottom-4 sm:data-[open='true']:compact:bottom-4 sm:bottom-4 overflow-clip w-available ml-4 sm:w-1/3 bg-surface-3 dark:bg-surface-1 flex items-center justify-center rounded-lg transition-all duration-500 border-2 border-focus data-[open='false']:translate-x-[150%] z-[29999] before:content-[''] before:pointer-events-none before:absolute before:inset-0 before:rounded-lg before:opacity-60 before:bg-surface-10/40"},[c(y)?(o(),m("article",me,[n("header",pe,[n("h2",ye,h(d.$t("Now Playing")),1),c(S)?(o(),k(s,{key:0,to:c(S),class:"text-sm font-semibold flex gap-1 items-center hover:underline underline-offset-2"},{default:A(()=>[n("span",null,h(d.$t("View Playlist")),1),b(M,{icon:c(ae).shareSquare,"class-name":"w-4 h-4"},null,8,["icon"])]),_:1},8,["to"])):_("",!0)]),b(z,{song:c(y)},null,8,["song"]),n("header",he,[n("h2",_e,h(d.$t("Queue")),1)]),n("section",xe,[b(re,{"auto-hide":!0,static:!1},{default:A(()=>[(o(!0),m(j,null,O(c(q),p=>R((o(),k(z,{key:p?.id,"on-click":()=>r(p),song:p},null,8,["on-click","song"])),[[D,p.id!==c(y)?.id]])),128))]),_:1})])])):_("",!0)],8,fe)}}}),Oe=be;$();var ge=["id","data-index"],we={key:1,class:"transition-all duration-200 ease-in-out w-available"},ke=C({__name:"LyricItem",props:{lyric:{type:Object,required:!0},index:{type:Number,required:!0}},setup(u){return(e,r)=>(o(),m("span",{id:typeof u.lyric<"u"?u.lyric?.time?.total.toString():"-1",class:L([{"text-black":u.lyric?.time?.total,"!text-white":!u.lyric?.time?.total},"tv:min-h-24 flex flex-col justify-center items-center gap-2 h-auto w-available transition-all duration-200 ease-in-out"]),"data-index":u.index??-1,"data-lyric":""},[u.lyric?.text!==""?(o(),m("span",{key:0,class:L([{"text-right font-semibold":u.lyric?.rtl,"font-bold":!u.lyric?.rtl},"whitespace-pre-line tv:text-4xl transition-all duration-200 ease-in-out text-3xl tv:leading-[48px] text-pretty text-inherit w-available"])},h(u.lyric?.text),3)):_("",!0),u.lyric?.text===""?(o(),m("span",we,[b(M,{class:"transition-all duration-200 ease-in-out w-[1.5rem] h-[1.5rem]",icon:"noteDouble"})])):_("",!0)],10,ge))}}),$e=ke;$();var Ce=["data-open","inert"],Se=["id"],qe={key:0,class:"contents"},Ie={class:"mt-8 sm:mt-16 font-semibold text-2xs"},Le={key:1,class:"text-lg font-semibold tv:hidden"},je=C({__name:"LyricsOverlay",setup(u){const e=x(),r=x(y.value?.lyrics),d=x(te(8)),v=x(-1),s=x();function p(a){if(!a)return;const l=`${U.value?.serverApiUrl}/music/tracks/${a}/lyrics`;fetch(l,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${Q.value.accessToken}`}}).then(i=>i.json()).then(i=>{G(i.data?.length>0),r.value=i.data})}return B(()=>{e.value&&(v.value=-1,y.value?.lyrics?r.value=y.value.lyrics:y.value?.id&&p(y.value?.id),e.value.scrollTop=0,f.on("seeked",a=>{if(!e.value||!e.value)return;const l=(r.value?.findIndex?.(t=>t.time?.total>=a.position)??0)-1,i=Array.from(e.value?.querySelectorAll("[data-lyric]")??[]);l===-1?(i.forEach(t=>{t.style.opacity="1",t.style.color="black"}),s.value=e.value.querySelector("[data-index='0']"),s.value&&e.value&&w(s.value,e.value,{duration:500})):l===-2&&(i.filter(t=>Number.parseInt(t.dataset.index,10)<l).forEach(t=>{t.style.opacity="0.5",t.style.color="white"}),s.value=e.value.querySelector(`[data-index='${i.length-1}']`),s.value&&e.value&&w(s.value,e.value,{duration:500}))}))}),g(K,a=>{if(!a||!e.value||!r.value)return;a=a+.5;const l=(r.value?.findIndex?.(t=>t.time?.total>=a)??0)-1;if(l===-1&&a>1||v.value===l)return;v.value=l;const i=Array.from(e.value?.querySelectorAll("[data-lyric]")??[]);i.filter(t=>Number.parseInt(t.dataset.index,10)<l).forEach(t=>{t.style.opacity="0.5",t.style.color="white"}),s.value=e.value.querySelector(`[data-index='${l}']`),s.value&&(s.value.style.opacity="1",s.value.style.color="white",w(s.value,e.value,{duration:500})),i.filter(t=>Number.parseInt(t.dataset.index,10)>l).forEach(t=>{t.style.opacity="1",t.style.color="black"})}),g(y,(a,l)=>{a?.id!==l?.id&&(v.value=-1,r.value=null,a?.lyrics?r.value=a.lyrics:a?.id&&p(a?.id))}),g(r,(a,l)=>{if(!a||!e.value||a.at(0)===l?.at(0))return;const i=e.value?.querySelector("[data-index='0']");i&&(i.style.opacity="1",i.style.color="white",w(i,e.value,{duration:500}));const t=Array.from(e.value?.querySelectorAll("[data-lyric]"));P(()=>{t.forEach(T=>{T.style.opacity="1",T.style.color="black"})}),e.value&&(e.value.style.opacity="0",setTimeout(()=>{e.value&&(e.value.style.opacity="1")},1200))}),g(I,a=>{J(a)}),(a,l)=>(o(),m("div",{id:"lyricsContainer","data-open":c(I),inert:!c(I),class:"absolute inset-0 h-inherit w-inherit sm:left-auto sm:right-4 sm:top-4 sm:bottom-4 sm:w-2/3 sm:max-w-3xl tv:max-w-3/4 flex items-center justify-center rounded-xl transition-all duration-500 sm:data-[open='false']:translate-x-[150%] sm:overflow-clip z-[9999] tv:-translate-x-[5%] tv:!w-available tv:data-[open='true']:delay-500 will-change-transform"},[l[0]||(l[0]=n("div",{class:"pointer-events-none absolute inset-0 z-0 flex items-center justify-center rounded-xl sm:bg-white/6 dark:sm:bg-black/30 tv:!bg-transparent"},null,-1)),n("div",{id:`lyrics_container_${d.value}`,ref_key:"lyrics_container",ref:e,class:"relative z-10 flex w-full flex-col overflow-auto scrollbar-none p-4 children:transition-all duration-200 h-available sm:min-h-[calc(100vh-13rem)] gap-4 sm:gap-4 sm:p-16 text-xl sm:text-2xl tv:text-lg tv:p-4 tv:pt-28 tv:gap-3 tv:mt-2"},[r.value?(o(),m(j,{key:0},[Array.isArray(r.value)?(o(),m("div",qe,[(o(!0),m(j,null,O(r.value??[],(i,t)=>(o(),k($e,{key:t,lyric:i,index:t},null,8,["lyric","index"]))),128)),n("p",Ie,h(a.$t("Lyrics provided by Musixmatch")),1)])):_("",!0)],64)):_("",!0),r.value?_("",!0):(o(),m("p",Le,h(a.$t("No lyrics available")),1))],8,Se)],8,Ce))}}),Qe=je;export{Oe as n,Qe as t};
