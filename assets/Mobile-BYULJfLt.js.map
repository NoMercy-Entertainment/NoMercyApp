{"version":3,"file":"Mobile-BYULJfLt.js","sources":["../../src/views/Preferences/Profile/Mobile.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport {computed, onMounted, ref} from 'vue';\nimport {useToast} from \"primevue/usetoast\";\nimport FileUpload, {FileUploadBeforeSendEvent, FileUploadSelectEvent} from 'primevue/fileupload';\nimport {IonContent, IonPage} from \"@ionic/vue\";\n\nimport {user} from \"@/store/user\";\nimport {suffix} from \"@/config/config\";\n\nimport Avatar from \"@/components/Images/Avatar.vue\";\nimport Button from \"@/components/Buttons/Button.vue\";\nimport DashboardLayout from \"@/Layout/Desktop/DashboardLayout.vue\";\nimport apiClient from \"@/lib/clients/apiClient\";\nimport type {User} from \"@/types/auth\";\nimport {twMerge} from \"tailwind-merge\";\nimport {useTranslation} from \"i18next-vue\";\n\nconst { t } = useTranslation();\n\nconst toast = useToast();\nconst fileUpload = ref();\nconst image = ref<HTMLImageElement>();\nconst url = ref(user.value.avatarUrl);\nconst disabled = ref(true);\n\nconst uploadUrl = `https://api${suffix}.nomercy.tv/avatar`;\n\nconst upload = () => {\n  fileUpload.value.upload();\n  disabled.value = true;\n};\n\nconst onUpload = () => {\n  toast.add({severity: 'info', summary: 'Success', detail: 'File Uploaded', life: 3000});\n\n  apiClient()\n      .get<{ data: User }>('/app_config')\n      .then(async ({data}) => {\n        user.value.avatarUrl = data.data.avatarUrl;\n      });\n};\n\nconst handleSelected = (e: FileUploadSelectEvent) => {\n  url.value = e.files[0].objectURL;\n  disabled.value = false;\n};\n\nconst beforeSend = (e: FileUploadBeforeSendEvent) => {\n  e.xhr.setRequestHeader('Authorization', `Bearer ${user.value.accessToken}`);\n};\n\nconst handleReset = () => {\n  url.value = user.value.avatarUrl;\n  fileUpload.value.clear();\n};\n\nonMounted(() => {\n  setTimeout(() => {\n    if (!fileUpload.value?.$el) return;\n    fileUpload.value.$el.querySelector('span[files]').innerText = t('No file chosen');\n  }, 100);\n});\n\nconst style = computed(() => {\n  return {\n    '--color-1': `rgb(var(--color-theme-1))`,\n    '--color-2': `rgb(var(--color-theme-2))`,\n    '--color-3': `rgb(var(--color-theme-3))`,\n    '--color-4': `rgb(var(--color-theme-4))`,\n    '--color-5': `rgb(var(--color-theme-5))`,\n    '--color-6': `rgb(var(--color-theme-6))`,\n    '--color-7': `rgb(var(--color-theme-7))`,\n    '--color-8': `rgb(var(--color-theme-8))`,\n    '--color-9': `rgb(var(--color-theme-9))`,\n    '--color-10': `rgb(var(--color-theme-10))`,\n    '--color-11': `rgb(var(--color-theme-11))`,\n    '--color-12': `rgb(var(--color-theme-12))`,\n  };\n});\n\nconst classes = computed(() => {\n  return twMerge(\n      '!flex !justify-center !items-center !px-4 !py-2 !gap-2 !rounded-lg !text-sm',\n      'select-none !w-auto !font-semibold !leading-[100%] !transition-transform !duration-150 !border-none !text-white',\n      '!bg-gradient-to-b from-[var(--color-11)] to-[var(--color-10)] hover:from-[var(--color-12)] hover:to-[var(--color-11)] active:from-[var(--color-10)] active:to-[var(--color-9)] dark:from-[var(--color-7)] dark:to-[var(--color-5)] dark:hover:from-[var(--color-8)] dark:hover:to-[var(--color-6)] dark:active:from-[var(--color-7)] dark:active:to-[var(--color-4)] button-filled ',\n      `\n\t\t\t\t shadow-[0_1px_0_0_rgba(255,255,255,0.20)_inset,0_-1px_0_0_rgba(var(--background-auto-11)/60%)_inset,0_22px_30px_-4px_rgba(var(--background-auto-11)/70%)]\n\t\t\t\t dark:shadow-[0_1px_0_0_rgba(255,255,255,0.20)_inset,0_-1px_0_0_rgba(var(--background-auto-1)/30%)_inset,0_22px_30px_-4px_rgba(var(--background-auto-1)/70%)]\n\t\t\t\t active:!shadow-none\n\t\t\t\t active:!dark:shadow-none\n\t\t\t `,\n  );\n});\n\nconst description = \"Upload an image of max {{dimension}} pixels and {{size}} in size.\\n We recommend a square image for best results.\";\n\n</script>\n\n<template>\n\n  <ion-page>\n    <ion-content :fullscreen=\"true\">\n      <DashboardLayout :gridStyle=\"3\" title=\"Profile\">\n        <template v-slot:cta>\n          <!--          <Button id=\"invite\" color=\"theme\" startIcon=\"userAdd\" @click=\"{}\">-->\n          <!--            {{ $t('Invite user') }}-->\n          <!--          </Button>-->\n        </template>\n        <div class=\"flex flex-col gap-4 col-span-2 p-4\">\n          <div class=\"flex flex-col gap-4 justify-center items-center\">\n\n            <div class=\"w-60 min-w-60 h-auto aspect-square object-cover bg-slate-dark-1 border border-slate-dark-5 rounded-full overflow-clip\">\n              <img ref=\"image\" v-if=\"url\" :src=\"url\"\n                   class=\"w-full min-w-full h-auto aspect-square object-cover\"\n                   alt=\"Your profile image\"\n                   style=\" box-shadow: 0 1px 3px 0 rgba(16,24,40,0.1), 0 1px 2px 0 rgba(16,24,40,0.06); \"\n              />\n              <Avatar v-else :email=\"user.email\" :size=\"250\" class=\"w-60 min-w-60 h-auto aspect-square rounded-lg\"/>\n            </div>\n\n            <div class=\"flex flex-col justify-center items-center flex-grow relative gap-2\">\n\n              <FileUpload\n                  @select=\"handleSelected\"\n                  @before-send=\"beforeSend\"\n                  @upload=\"onUpload\"\n                  :url=\"uploadUrl\"\n                  :choose-label=\"$t('Choose image')\"\n                  :cancel-label=\"$t('Cancel')\"\n                  ref=\"fileUpload\"\n                  name=\"image\"\n                  withCredentials\n                  mode=\"basic\"\n                  accept=\"image/*\"\n                  :maxFileSize=\"2 * 1024 * 1024\"\n                  :style=\"style\"\n                  :class=\"classes\"\n              />\n\n              <Button id=\"upload\" color=\"theme\" startIcon=\"cloudUpload\" @click=\"upload\" :disabled=\"disabled\">\n                {{ $t('Upload image') }}\n              </Button>\n\n              <p class=\"self-stretch flex-grow-0 flex-shrink-0 w-full text-sm text-left text-[#9ba1a6] text-pretty\">\n                {{ $t(description, {\n                dimension: '2000x2000',\n                size: '2MB',\n              })}}\n              </p>\n\n              <Button id=\"upload\" color=\"white\" variant=\"text\" startIcon=\"arrowCounterClockwise\" @click=\"handleReset\">\n                {{ $t('Reset image') }}\n              </Button>\n            </div>\n          </div>\n        </div>\n      </DashboardLayout>\n    </ion-content>\n  </ion-page>\n</template>\n\n<style scoped>\n\n</style>"],"names":["description","t","useTranslation","toast","useToast","fileUpload","ref","image","url","user","disabled","uploadUrl","suffix","upload","onUpload","apiClient","data","handleSelected","beforeSend","handleReset","onMounted","_a","style","computed","classes","twMerge"],"mappings":"ogCA8FMA,EAAc;AAAA,+EA7Ed,KAAA,CAAE,EAAAC,CAAE,EAAIC,EAAe,EAEvBC,EAAQC,EAAS,EACjBC,EAAaC,EAAI,EACjBC,EAAQD,EAAsB,EAC9BE,EAAMF,EAAIG,EAAK,MAAM,SAAS,EAC9BC,EAAWJ,EAAI,EAAI,EAEnBK,EAAY,cAAcC,CAAM,qBAEhCC,EAAS,IAAM,CACnBR,EAAW,MAAM,OAAO,EACxBK,EAAS,MAAQ,EACnB,EAEMI,EAAW,IAAM,CACfX,EAAA,IAAI,CAAC,SAAU,OAAQ,QAAS,UAAW,OAAQ,gBAAiB,KAAM,GAAA,CAAK,EAE3EY,EAAA,EACL,IAAoB,aAAa,EACjC,KAAK,MAAO,CAAC,KAAAC,KAAU,CACjBP,EAAA,MAAM,UAAYO,EAAK,KAAK,SAAA,CAClC,CACP,EAEMC,EAAkB,GAA6B,CACnDT,EAAI,MAAQ,EAAE,MAAM,CAAC,EAAE,UACvBE,EAAS,MAAQ,EACnB,EAEMQ,EAAc,GAAiC,CACnD,EAAE,IAAI,iBAAiB,gBAAiB,UAAUT,EAAK,MAAM,WAAW,EAAE,CAC5E,EAEMU,EAAc,IAAM,CACpBX,EAAA,MAAQC,EAAK,MAAM,UACvBJ,EAAW,MAAM,MAAM,CACzB,EAEAe,EAAU,IAAM,CACd,WAAW,IAAM,QACVC,EAAAhB,EAAW,QAAX,MAAAgB,EAAkB,MACvBhB,EAAW,MAAM,IAAI,cAAc,aAAa,EAAE,UAAYJ,EAAE,gBAAgB,IAC/E,GAAG,CAAA,CACP,EAEK,MAAAqB,EAAQC,EAAS,KACd,CACL,YAAa,4BACb,YAAa,4BACb,YAAa,4BACb,YAAa,4BACb,YAAa,4BACb,YAAa,4BACb,YAAa,4BACb,YAAa,4BACb,YAAa,4BACb,aAAc,6BACd,aAAc,6BACd,aAAc,4BAChB,EACD,EAEKC,EAAUD,EAAS,IAChBE,EACH,8EACA,kHACA,sXACA;AAAA;AAAA;AAAA;AAAA;AAAA,KAMJ,CACD"}