import{I as j,aC as b,J as R,dB as T,dC as A,b1 as E,dD as J,dE as V,dF as K,az as H,by as z,c8 as P,aw as I,b3 as F,cg as L,o as h,e as S,a7 as N,a6 as M,t as x,cu as Q,cv as U,bt as W,aE as X,c as D,a as c,r as C,v as Y,bw as Z,h as ee,dG as te,dH as se,dI as ae,dJ as ne,z as le}from"./index-1WLsC2v6.js";import{_ as oe}from"./FloatingBackButton.vue_vue_type_script_setup_true_lang-BZWYt5_d.js";import{_ as ce}from"./Button.vue_vue_type_script_setup_true_lang-CqZlgRDM.js";var B=(e=>(e.Disconnected="Disconnected",e.Connecting="Connecting",e.Connected="Connected",e.Disconnecting="Disconnecting",e.Reconnecting="Reconnecting",e))(B||{});const l=j(),ze=b(()=>{var e;return(e=l.value)==null?void 0:e.connection}),w=j(!1),$=()=>{var e,n,a;w.value=!0,console.log("Connected to Dashboard SignalR"),document.dispatchEvent(new Event("dashboardHub-connected")),(e=l.value)!=null&&e.connection&&(V((n=l.value)==null?void 0:n.connection),K((a=l.value)==null?void 0:a.connection))},y=e=>{w.value=!1,console.log("Disconnected from Dashboard SignalR",e),document.dispatchEvent(new Event("dashboardHub-disconnected"))},G=e=>{w.value=!1,console.error("Dashboard SignalR Error:",e),document.dispatchEvent(new Event("dashboardHub-error"))};R(E,async e=>{var a,s,o,p,m,f,v;const n=(a=T.value)==null?void 0:a.accessToken;e&&w.value&&((o=(s=l.value)==null?void 0:s.connection)==null||o.stop().then(),l.value=new A(E.value.serverBaseUrl,n,"dashboardHub"),(m=(p=l.value)==null?void 0:p.connection)==null||m.on("connected",$),(v=(f=l.value)==null?void 0:f.connection)==null||v.on("disconnected",y),await O().catch(G))});const O=async()=>{var e,n,a,s;if(((n=(e=l.value)==null?void 0:e.connection)==null?void 0:n.state)!==B.Connected)return(s=(a=l.value)==null?void 0:a.connection)==null?void 0:s.start().then($)},re=async()=>{var e,n,a,s;try{return((n=(e=l.value)==null?void 0:e.connection)==null?void 0:n.state)===B.Disconnected||(s=(a=l.value)==null?void 0:a.connection)==null?void 0:s.stop().then(y).catch(y)}catch(o){console.error("Error stopping Dashboard SignalR:",o),y()}},q=async()=>{var n,a,s,o,p,m,f,v,k,t,i,d,u;const e=(n=T.value)==null?void 0:n.accessToken;E.value&&(!((s=(a=l.value)==null?void 0:a.connection)!=null&&s.state)||((p=(o=l.value)==null?void 0:o.connection)==null?void 0:p.state)===B.Disconnected)&&(l.value=new A(E.value.serverBaseUrl,e,"dashboardHub"),(f=(m=l.value)==null?void 0:m.connection)==null||f.on("connected",$),(k=(v=l.value)==null?void 0:v.connection)==null||k.on("disconnected",y),await O().catch(G),(i=(t=l.value)==null?void 0:t.connection)==null||i.onreconnecting(r=>{var _;console.log("SignalR Disconnected.",r==null?void 0:r.message),J((_=l.value)==null?void 0:_.connection),y()}),(u=(d=l.value)==null?void 0:d.connection)==null||u.onreconnected(()=>{var r;console.log("SignalR Reconnected."),V((r=l.value)==null?void 0:r.connection),$()}))},g=j([]),ie=(e,n,a=0)=>{H(()=>{const s=g.value.find(o=>o.mount==e);s!=null&&s.timeout&&(clearTimeout(s.timeout),s.timeout=null),(s==null?void 0:s.mount)!=e&&(e(),g.value=[...z(g.value),{mount:e,unmount:n,timeout:null}])}),P(()=>{if(g.value.length===0){n();return}const s=g.value.find(o=>o.mount==e);if(!s){n();return}s.timeout=setTimeout(()=>{n(),g.value=g.value.filter(o=>o.mount!=e).map(o=>z(o))},a*1e3)})},de=I({__name:"HelpButton",setup(e){const n=F(),a=b(()=>`https://docs${L}.nomercy.tv${n.path.replace(/\/\w{8}-\w{4}-\w{4}-\w{4}-\w{12}/gu,"")}`);return(s,o)=>(h(),S(ce,{id:"help",href:a.value,variant:"text",component:"link",target:"_blank",color:"auto",startIcon:"messageBubbleQuestion",class:"relative flex h-10 flex-shrink-0 flex-grow-0 items-center justify-center gap-2 overflow-hidden rounded-lg px-4 py-2.5"},{default:N(()=>[M(x(s.$t("Help")),1)]),_:1},8,["href"]))}}),ue={key:0,class:"grid h-full w-full place-items-center"},fe={class:"relative flex items-center justify-start gap-8 overflow-hidden"},ve={class:"relative flex w-full flex-col gap-4"},he={class:"text-7xl font-bold text-center text-slate-light-12/80 dark:text-slate-dark-12/80"},pe={class:"left-0 text-2xl text-center text-slate-light-12/80 dark:text-slate-dark-12/80 whitespace-pre-line"},me={key:1,class:"relative z-0 h-available flex flex-shrink-0 flex-grow flex-col overflow-clip items-start justify-start self-stretch w-available min-h-available bg-slate-light-3 dark:bg-slate-dark-2"},ge={class:"sticky top-0 z-10 flex flex-shrink-0 flex-grow-0 flex-col items-start justify-start gap-5 self-stretch"},xe={class:"z-10 flex h-20 items-center justify-between gap-4 self-stretch border-b px-4 py-4 border-auto-7/6 xl:px-6 bg-slate-light-3 dark:bg-slate-dark-2"},we={class:"relative flex h-full flex-col items-start justify-center gap-1 text-slate-light-12/80 dark:text-slate-dark-12/80"},be={class:"w-auto flex-shrink-0 flex-grow-0 self-stretch whitespace-nowrap text-xl font-semibold"},ye={key:1,class:"hidden h-8 w-auto flex-shrink-0 flex-grow-0 items-center self-stretch text-sm empty:hidden lg:flex"},ke={class:"flex flex-col flex-nowrap items-end justify-center gap-x-3 gap-y-1 sm:flex-row"},_e={key:0,class:"grid h-full w-full place-items-center"},De={class:"relative flex flex-col items-center justify-start gap-8 overflow-hidden"},Ce={class:"relative flex w-full flex-col gap-4"},Se={class:"text-7xl font-bold text-center text-slate-light-12/80 dark:text-slate-dark-12/80"},Ee={class:"left-0 text-2xl text-center text-slate-light-12/80 dark:text-slate-dark-12/80 whitespace-pre-line"},$e={key:2,class:"sticky bottom-0 z-0 flex w-full flex-wrap items-center gap-4 border-t px-4 py-4 border-auto-7/6 empty:hidden sm:h-16 xl:px-6"},qe=I({__name:"DashboardLayout",props:Q({title:{type:String,required:!0},params:{type:Object,required:!1},description:{type:String,required:!1},gridStyle:{type:Number,required:!1,default:0},back:{type:Boolean,required:!1,default:!1},error:{type:Object,required:!1},allowAnyone:{type:Boolean,required:!1,default:!1}},{modelValue:{required:!1,type:Boolean},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const n=U(e,"modelValue"),a=e,{dataUpdatedAt:s,error:o,isPending:p}=W({path:"dashboard/server",enabled:!a.allowAnyone,refetchInterval:1e4,queryKey:["dashboard","server",w.value]}),m=b(()=>a.gridStyle==1?se.value:a.gridStyle==2?ae.value:a.gridStyle==3?ne.value:"flex flex-wrap"),f=b(()=>{var i,d,u,r,_;if(a.allowAnyone)return null;const t=o.value;if(((i=t==null?void 0:t.response)==null?void 0:i.status)!=200)return{code:((u=(d=t==null?void 0:t.response)==null?void 0:d.data)==null?void 0:u.status)??null,message:((_=(r=t==null?void 0:t.response)==null?void 0:r.data)==null?void 0:_.detail)??""}}),v=b(()=>{var i,d,u,r;const t=a.error;if(console.log(t),!(!(t!=null&&t.response)||((i=t==null?void 0:t.response)==null?void 0:i.status)==200))return{code:(d=t==null?void 0:t.response)==null?void 0:d.status,message:((r=(u=t==null?void 0:t.response)==null?void 0:u.data)==null?void 0:r.detail)??""}});H(()=>{X(null)}),ie(q,re,1);const k=b(()=>{var t;return(((t=f.value)==null?void 0:t.code)||p.value||!w.value)&&!a.allowAnyone});return R(k,t=>{t&&n.value!=null&&(n.value=!1)}),R(s,t=>{t&&!w.value&&q()}),(t,i)=>{var d,u,r;return h(),S(te,null,[k.value?(h(),D("div",ue,[c("div",fe,[c("div",ve,[c("p",he,x((d=f.value)!=null&&d.code?(u=f.value)==null?void 0:u.code:"Offline"),1),c("p",pe,x((r=f.value)==null?void 0:r.message),1)])])])):(h(),D("div",me,[c("div",ge,[i[0]||(i[0]=c("div",{class:"absolute inset-0 z-0 h-full w-full"},null,-1)),c("div",xe,[c("div",we,[c("p",be,x(t.$t(e.title,e.params)),1),e.back?(h(),S(oe,{key:0,position:"relative",class:"left-4"})):(h(),D("p",ye,x(t.$t(e.description)),1))]),C(t.$slots,"title"),c("div",ke,[Y(de),C(t.$slots,"cta")])])]),v.value?(h(),D("div",_e,[c("div",De,[c("div",Ce,[c("p",Se,x(v.value.code),1),c("p",Ee,x(v.value.message),1)])])])):(h(),S(Z,{key:1,static:!0,class:"z-0 flex !h-sidebar+ !min-h-[calc(100vh-16rem)] w-full flex-1 overflow-y-auto overflow-x-hidden p-4"},{default:N(()=>[c("div",{class:le(["h-auto w-full flex-wrap content-start gap-4",m.value])},[C(t.$slots,"default")],2)]),_:3})),!v.value&&t.$slots.actions?(h(),D("div",$e,[i[1]||(i[1]=c("div",{class:"absolute inset-0 -z-10 h-full w-full"},null,-1)),C(t.$slots,"actions")])):ee("",!0)]))],1024)}}});export{qe as _,ze as c,w as d,ie as u};
//# sourceMappingURL=DashboardLayout.vue_vue_type_script_setup_true_lang-g3My6HM7.js.map
