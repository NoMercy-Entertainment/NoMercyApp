import"./useBaseQuery-DhMTNjjH.js";import"./useInfiniteServerClient-BOGzXRLT.js";import"./useQueryClient-BDTWlHnP.js";import"./useQuery-UqFzG2sc.js";import{Ba as P,Ea as k,Er as _,Hs as C,Io as l,Os as b,U as w,Ws as c,Yo as h,cs as p,ec as S,gs as M,i as o,ii as s,is as I,js as d,ks as U,ms as x,sc as v,ss as N,va as B}from"./index-zK1-WOQT.js";import{s as i}from"./imageModal-CsFJnOhE.js";import{t as D}from"./useServerClient-BWjN3Na1.js";import{i as H,n as T,o as A,r as F,s as V}from"./VideoPlayer-CyXJOi7Z.js";import"./buttons-DRw175vE.js";import{t as E}from"./keyHandlerPlugin-BezXiLV9.js";import{t as j}from"./videoNoMercyConnectPlugin-BmqFBfLP.js";h();P();var O=M({__name:"Desktop",setup(W){const{data:u}=D({enabled:!s.value.features?.nomercyConnect}),e=S();function r(t){const n={controls:!1,playlist:t?.filter(a=>!!a.id)??[],accessToken:s.value?.accessToken,basePath:_.value?.serverBaseUrl,forceTvMode:(l("android")||l("ios"))&&!l("mobile"),disableTouchControls:!1,disableMediaControls:"mediaSession"in navigator||l("capacitor"),renderAhead:100,disableAutoPlayback:s.value.features?.nomercyConnect};if(e.value?.dispose(),e.value=F("player1").setup(n),e.value.once("back",()=>{history.state.back?o.back():o.replace("/")}),s.value.features?.nomercyConnect){const a=new j;e.value.registerPlugin("videoNoMercyConnect",a),e.value.usePlugin("videoNoMercyConnect")}const f=new H;e.value.registerPlugin("desktopUI",f),e.value.usePlugin("desktopUI");const g=new A;e.value.registerPlugin("autoSkip",g),e.value.usePlugin("autoSkip");const m=new E;if(e.value.registerPlugin("keyHandler",m),e.value.usePlugin("keyHandler"),!s.value.features?.nomercyConnect){const a=new V;e.value.registerPlugin("sync",a),e.value.usePlugin("sync")}const y=new T;e.value.registerPlugin("octopus",y),e.value.usePlugin("octopus"),e.value.once("play",()=>{e.value.enterFullscreen()}),e.value.on("playlistComplete",()=>{console.log("Playlist complete"),history.state.back?o.back():o.replace("/")}),e.value.on("play",()=>{i(!0)}),e.value.on("pause",()=>{i(!1)}),e.value.on("fullscreen",a=>{window.external?.sendMessage?.(a?"enterFullscreen":"exitFullscreen")})}return C(u,t=>{t?.length&&r(t)}),b(()=>{w.stop(),s.value.features?.nomercyConnect?r():u.value?.length&&r(u.value)}),U(()=>{e.value?.dispose(),i(!1)}),(t,n)=>(d(),p(v(k),null,{default:c(()=>[x(v(B),{fullscreen:!0},{default:c(()=>[(d(),p(I,{to:"body"},[n[0]||(n[0]=N("div",{id:"player1",class:"group nomercyplayer text-white"},null,-1))]))]),_:1})]),_:1}))}}),$=O;export{$ as default};
