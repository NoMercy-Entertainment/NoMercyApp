import{C as E,G as F,J as U,O as m,Q as M,S as l,T as I,Tt as t,bt as P,c as Q,ct as f,gt as u,j as J,k as n,kt as N,ot as i,w as O,x as K}from"./i18n-Bgv5p1Yb.js";import"./ionic-B1wlflFe.js";import{C as L,_ as z}from"./vue-core-Dey0Eikg.js";import{l as v,m as R}from"./primevue-CuC2W_MW.js";import{c as H}from"./query-xyWPY_A0.js";import{Ji as W,Ki as X,_n as Y,b as Z,qi as G,vn as h}from"./index-DLX3dE7o.js";import{t as ee}from"./Toggle-C4H-z61z.js";import"./useInfiniteServerClient-DG5_vM7O.js";import{t as re}from"./useServerClient-BXRsp2bm.js";import"./ScrollContainer-CeB9S2n1.js";import"./useMounted-Cjvkyxzm.js";import"./RipperOverlay-DxVqjbwq.js";import"./ripperSocket-o6W57gTr.js";import"./FloatingBackButton-1LbxvOkI.js";import{t as le}from"./DashboardLayout-BuvOLFFC.js";Q();var ae={key:0,class:"col-span-2 col-start-1 2xl:col-start-1"},oe={class:"flex flex-col gap-1"},se={class:"flex flex-col gap-1"},te={class:"flex flex-col gap-1"},ne={key:1,class:"col-span-2 col-start-1 2xl:col-start-3"},ue={class:"flex flex-col gap-1"},ie={class:"flex flex-col gap-1"},de={class:"flex flex-col gap-1"},ve={class:"flex flex-col gap-1"},me={class:"flex flex-col gap-1"},pe={class:"flex flex-col gap-1"},fe={class:"flex flex-col gap-1"},_e={class:"flex flex-col gap-1"},we={key:2,class:"col-span-2 col-start-1 2xl:col-start-5"},ge={class:"flex flex-col gap-1"},ke={class:"flex gap-4"},xe=["aria-label","href"],ce=J({__name:"Desktop",setup(be){const{data:a,refetch:$,error:j}=re({path:"/dashboard/configuration"}),_=u(!1),s=u(a.value??{}),d=(r,e)=>{if(a.value){if(P(a.value[r])===e){delete s.value[r],s.value={...s.value};return}s.value={...s.value,[r]:e??void 0}}};i(a,r=>{r&&(s.value={},w.value=r?.name,g.value=r?.external_port,k.value=r?.internal_port,x.value=r?.library_workers,c.value=r?.import_workers,b.value=r?.extras_workers,V.value=r?.encoder_workers,y.value=r?.cron_workers,B.value=r?.image_workers,S.value=r?.file_workers,C.value=r?.music_workers,p.value=r?.swagger,_.value=!0)}),F(()=>{a.value&&(s.value={},w.value=a.value?.name,g.value=a.value?.external_port,k.value=a.value?.internal_port,x.value=a.value?.library_workers,c.value=a.value?.import_workers,b.value=a.value?.extras_workers,V.value=a.value?.encoder_workers,y.value=a.value?.cron_workers,B.value=a.value?.image_workers,S.value=a.value?.file_workers,C.value=a.value?.music_workers,p.value=a.value?.swagger,_.value=!0)});const w=u(a.value?.name??"");i(w,r=>{d("name",r)});const g=u(a.value?.external_port??0);i(g,r=>{d("external_port",r)});const k=u(a.value?.internal_port??0);i(k,r=>{d("internal_port",r)});const x=u(a.value?.library_workers??1);i(x,r=>{d("library_workers",r)});const c=u(a.value?.import_workers??2);i(c,r=>{d("import_workers",r)});const b=u(a.value?.extras_workers??15);i(b,r=>{d("extras_workers",r)});const V=u(a.value?.encoder_workers??1);i(V,r=>{d("encoder_workers",r)});const y=u(a.value?.cron_workers??1);i(y,r=>{d("cron_workers",r)});const B=u(a.value?.image_workers??10);i(B,r=>{d("image_workers",r)});const S=u(a.value?.file_workers??4);i(S,r=>{d("file_workers",r)});const C=u(a.value?.music_workers??2);i(C,r=>{d("music_workers",r)});const p=u(a.value?.swagger??!1);i(p,r=>{d("swagger",r)});const q=K(()=>Object.keys(s.value).length>0);i(s,r=>{console.log(r)});const A=H(),T=()=>{console.raw(s.value),X().patch("/dashboard/configuration",s.value).then(()=>{if(G.value){const r={};if(s.value.name!==void 0&&(r.name=s.value.name.toString()),s.value.external_port!==void 0&&(r.external_port=s.value.external_port.toString()),s.value.internal_port!==void 0&&(r.internal_port=s.value.internal_port.toString()),Object.keys(r).length>0){const e={...G.value,...r};h([...Y.value.filter(D=>D.id!==G.value.id),e]),W(e)}}$(),A.invalidateQueries({queryKey:["serverInfo"]})})};return(r,e)=>{const D=M("Button");return U(),E(t(L),null,{default:f(()=>[n(t(z),{fullscreen:!0},{default:f(()=>[n(le,{error:t(j),gridStyle:2,description:"",title:"General"},{cta:f(()=>[...e[13]||(e[13]=[])]),actions:f(()=>[n(D,{id:"save",disabled:!q.value,class:"ml-auto",color:"theme",form:"myForm",type:"submit",onClick:e[12]||(e[12]=o=>T())},{default:f(()=>[m(N(r.$t("Save")),1)]),_:1},8,["disabled"])]),default:f(()=>[_.value?(U(),I("div",ae,[l("div",oe,[e[14]||(e[14]=l("label",{for:"name"},"Server name",-1)),n(t(R),{id:"name",modelValue:w.value,"onUpdate:modelValue":e[0]||(e[0]=o=>w.value=o),class:"mb-4"},null,8,["modelValue"])]),l("div",se,[e[15]||(e[15]=l("label",{for:"internal_port"},"Secure internal port",-1)),n(t(v),{id:"internal_port",modelValue:k.value,"onUpdate:modelValue":e[1]||(e[1]=o=>k.value=o),min:2e3,useGrouping:!1,class:"mb-4",showButtons:""},null,8,["modelValue"])]),l("div",te,[e[16]||(e[16]=l("label",{for:"external_port"},"Secure external port",-1)),n(t(v),{id:"external_port",modelValue:g.value,"onUpdate:modelValue":e[2]||(e[2]=o=>g.value=o),min:2e3,useGrouping:!1,class:"mb-4",showButtons:""},null,8,["modelValue"])])])):O("",!0),_.value?(U(),I("div",ne,[l("div",ue,[e[17]||(e[17]=l("label",{for:"library_workers"},[m("Library runners "),l("span",{class:"text-xs opacity-60"},"(scanning and rescanning)")],-1)),n(t(v),{id:"library_workers",modelValue:x.value,"onUpdate:modelValue":e[3]||(e[3]=o=>x.value=o),min:0,useGrouping:!1,class:"mb-2",showButtons:""},null,8,["modelValue"])]),l("div",ie,[e[18]||(e[18]=l("label",{for:"import_workers"},[m("Import runners "),l("span",{class:"text-xs opacity-60"},"(movies, shows, collections, audio)")],-1)),n(t(v),{id:"import_workers",modelValue:c.value,"onUpdate:modelValue":e[4]||(e[4]=o=>c.value=o),min:0,useGrouping:!1,class:"mb-2",showButtons:""},null,8,["modelValue"])]),l("div",de,[e[19]||(e[19]=l("label",{for:"extras_workers"},[m("Extras runners "),l("span",{class:"text-xs opacity-60"},"(metadata fetching)")],-1)),n(t(v),{id:"extras_workers",modelValue:b.value,"onUpdate:modelValue":e[5]||(e[5]=o=>b.value=o),min:0,useGrouping:!1,class:"mb-2",showButtons:""},null,8,["modelValue"])]),l("div",ve,[e[20]||(e[20]=l("label",{for:"encoder_workers"},[m("Encoder runners "),l("span",{class:"text-xs opacity-60"},"(video and music encoding)")],-1)),n(t(v),{id:"encoder_workers",modelValue:V.value,"onUpdate:modelValue":e[6]||(e[6]=o=>V.value=o),min:0,useGrouping:!1,class:"mb-2",showButtons:""},null,8,["modelValue"])]),l("div",me,[e[21]||(e[21]=l("label",{for:"cron_workers"},[m("Cron runners "),l("span",{class:"text-xs opacity-60"},"(scheduled/recurring jobs)")],-1)),n(t(v),{id:"cron_workers",modelValue:y.value,"onUpdate:modelValue":e[7]||(e[7]=o=>y.value=o),min:0,useGrouping:!1,class:"mb-2",showButtons:""},null,8,["modelValue"])]),l("div",pe,[e[22]||(e[22]=l("label",{for:"image_workers"},[m("Image runners "),l("span",{class:"text-xs opacity-60"},"(FanArt, CoverArt, palettes)")],-1)),n(t(v),{id:"image_workers",modelValue:B.value,"onUpdate:modelValue":e[8]||(e[8]=o=>B.value=o),min:0,useGrouping:!1,class:"mb-2",showButtons:""},null,8,["modelValue"])]),l("div",fe,[e[23]||(e[23]=l("label",{for:"file_workers"},[m("File runners "),l("span",{class:"text-xs opacity-60"},"(rescanning and discovery)")],-1)),n(t(v),{id:"file_workers",modelValue:S.value,"onUpdate:modelValue":e[9]||(e[9]=o=>S.value=o),min:0,useGrouping:!1,class:"mb-2",showButtons:""},null,8,["modelValue"])]),l("div",_e,[e[24]||(e[24]=l("label",{for:"music_workers"},[m("Music runners "),l("span",{class:"text-xs opacity-60"},"(metadata and lyrics)")],-1)),n(t(v),{id:"music_workers",modelValue:C.value,"onUpdate:modelValue":e[10]||(e[10]=o=>C.value=o),min:0,useGrouping:!1,class:"mb-2",showButtons:""},null,8,["modelValue"])])])):O("",!0),_.value?(U(),I("div",we,[l("div",ge,[l("span",ke,[e[25]||(e[25]=l("label",{for:"swagger"},"Open API / Swagger Ui",-1)),p.value&&t(G)?.serverBaseUrl?(U(),I("a",{key:0,"aria-label":r.$t("Open API / Swagger Ui in a new tab"),href:t(G)?.serverBaseUrl,class:"flex gap-1 items-center underline underline-offset-4 h-4 text-sm",target:"_blank"},[l("span",null,N(r.$t("Open")),1),n(Z,{className:"size-4",color:"theme",icon:"shareSquare"})],8,xe)):O("",!0)]),n(ee,{"model-value":p.value,"onUpdate:modelValue":e[11]||(e[11]=o=>p.value=o)},null,8,["model-value"])])])):O("",!0)]),_:1},8,["error"])]),_:1})]),_:1})}}}),Te=ce;export{Te as default};
