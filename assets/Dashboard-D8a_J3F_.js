import{l as u,E as j,bM as K,I as Q,C as ee,c as R,o as M,a as e,b as te,t as n,n as H,F as W,h as q,d as se,s as D,j as E,K as B,c1 as oe,bI as ie,dq as ae,q as ne,bu as re,bh as le,dr as G,ds as ce}from"./index-BlsCkKvU.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";function de(){const i=u({}),h=u(!0),C=()=>{const o=performance.getEntriesByType("navigation")[0];o&&(i.value.loadTime=o.loadEventEnd-o.navigationStart,i.value.domContentLoaded=o.domContentLoadedEventEnd-o.navigationStart)},y=()=>{const l=performance.getEntriesByType("paint").find(c=>c.name==="first-contentful-paint");l&&(i.value.firstContentfulPaint=l.startTime)},b=()=>{if("PerformanceObserver"in window){const o=new PerformanceObserver(l=>{const c=l.getEntries(),_=c[c.length-1];i.value.largestContentfulPaint=_.startTime});try{o.observe({entryTypes:["largest-contentful-paint"]})}catch{}}},f=()=>{if("PerformanceObserver"in window){let o=0;const l=new PerformanceObserver(c=>{for(const _ of c.getEntries())_.hadRecentInput||(o+=_.value);i.value.cumulativeLayoutShift=o});try{l.observe({entryTypes:["layout-shift"]})}catch{}}},a=()=>{if("PerformanceObserver"in window){const o=new PerformanceObserver(l=>{for(const c of l.getEntries())i.value.firstInputDelay=c.processingStart-c.startTime});try{o.observe({entryTypes:["first-input"]})}catch{}}},k=()=>{if("memory"in performance){const o=performance.memory;i.value.memoryUsage=o.usedJSHeapSize/1024/1024}},m=async()=>{try{const o=performance.getEntriesByType("resource");let l=0;for(const c of o)(c.name.includes(".js")||c.name.includes(".css"))&&(l+=c.transferSize||0);i.value.bundleSize=l/1024/1024}catch(o){console.warn("Could not measure bundle size:",o)}},S=()=>{},v=()=>{C(),y(),b(),f(),a(),k(),m(),setTimeout(()=>{h.value=!1},3e3)},w=()=>{const o={performance:100,recommendations:[]};return i.value.largestContentfulPaint&&(i.value.largestContentfulPaint>4e3?(o.performance-=30,o.recommendations.push("Improve Largest Contentful Paint (>4s)")):i.value.largestContentfulPaint>2500&&(o.performance-=15,o.recommendations.push("Optimize Largest Contentful Paint (2.5-4s)"))),i.value.firstContentfulPaint&&(i.value.firstContentfulPaint>3e3?(o.performance-=20,o.recommendations.push("Improve First Contentful Paint (>3s)")):i.value.firstContentfulPaint>1800&&(o.performance-=10,o.recommendations.push("Optimize First Contentful Paint (1.8-3s)"))),i.value.cumulativeLayoutShift&&(i.value.cumulativeLayoutShift>.25?(o.performance-=25,o.recommendations.push("Fix Cumulative Layout Shift (>0.25)")):i.value.cumulativeLayoutShift>.1&&(o.performance-=10,o.recommendations.push("Improve Cumulative Layout Shift (0.1-0.25)"))),i.value.firstInputDelay&&(i.value.firstInputDelay>300?(o.performance-=20,o.recommendations.push("Improve First Input Delay (>300ms)")):i.value.firstInputDelay>100&&(o.performance-=10,o.recommendations.push("Optimize First Input Delay (100-300ms)"))),i.value.bundleSize&&i.value.bundleSize>2&&(o.performance-=15,o.recommendations.push("Reduce bundle size (>2MB)")),o};j(()=>{typeof window<"u"&&(document.readyState==="complete"?v():window.addEventListener("load",v))}),K(()=>{typeof window<"u"&&window.removeEventListener("load",v)});const L=async()=>({lcp:i.value.largestContentfulPaint??null,fid:i.value.firstInputDelay??null,cls:i.value.cumulativeLayoutShift??null}),I=async()=>({ttfb:performance.timing?performance.timing.responseStart-performance.timing.navigationStart:null,fcp:i.value.firstContentfulPaint??null,tti:i.value.loadTime??null}),p=async()=>{const o=performance.getEntriesByType("resource");let l=0;const c=o.length;let _=0;const x={};return o.forEach(z=>{l+=z.transferSize||0,z.transferSize===0&&z.decodedBodySize>0&&_++;const O=z.name.split(".").pop()?.toLowerCase()||"other",g=T(O);x[g]||(x[g]={count:0,size:0,loadTime:0}),x[g].count++,x[g].size+=z.transferSize||0,x[g].loadTime+=z.duration}),{totalResources:c,totalSize:l,cacheHitRate:c>0?Math.round(_/c*100):0,byType:x}},T=o=>({js:"JavaScript",css:"CSS",png:"Images",jpg:"Images",jpeg:"Images",gif:"Images",svg:"Images",webp:"Images",woff:"Fonts",woff2:"Fonts",ttf:"Fonts",eot:"Fonts",json:"Data",xml:"Data"})[o]||"Other";return{metrics:i,isLoading:h,getScores:w,logMetrics:S,getWebVitals:L,getLoadingMetrics:I,getResourceMetrics:p,clearMetrics:()=>{i.value={},"PerformanceObserver"in window&&v()}}}const ue={class:"performance-dashboard"},me={class:"dashboard-header"},ve={class:"header-controls"},fe=["disabled"],pe={class:"metric-section"},ge={class:"metric-grid"},he={class:"metric-value"},ye={class:"metric-value"},be={class:"metric-value"},Se={class:"metric-section"},we={class:"metric-grid"},_e={class:"metric-card"},Ce={class:"metric-value"},xe={class:"metric-card"},ze={class:"metric-value"},Te={class:"metric-card"},Pe={class:"metric-value"},Me={class:"metric-section"},Ie={class:"resource-metrics"},Re={class:"resource-summary"},ke={class:"summary-item"},Le={class:"value"},Fe={class:"summary-item"},He={class:"value"},De={class:"summary-item"},Ee={class:"value"},Be={class:"resource-breakdown"},Ne={class:"breakdown-grid"},Oe={class:"resource-type"},Je={class:"resource-count"},Ve={class:"resource-size"},je={class:"resource-time"},Ue={class:"metric-section"},Ae={class:"memory-metrics"},$e={class:"memory-chart"},We={class:"memory-stats"},qe={class:"stat-item"},Ge={class:"value"},Ke={class:"stat-item"},Qe={class:"value"},Xe={class:"stat-item"},Ye={class:"value"},Ze={class:"stat-item"},et={class:"value"},tt={class:"metric-section"},st={class:"timeline-container"},ot={key:0,class:"metric-section"},it={class:"recommendations"},at={class:"recommendation-title"},nt={class:"recommendation-description"},rt={class:"recommendation-impact"},lt={class:"metric-section"},ct={class:"realtime-metrics"},dt={class:"realtime-item"},ut={class:"realtime-item"},mt={class:"value"},vt={class:"realtime-item"},ft={class:"value"},pt=Q({__name:"PerformanceDashboard",setup(i){const h=de(),C=u(!1),y=u(),b=u(),f=u(60),a=u(16.67),k=u(0),m=u({lcp:null,fid:null,cls:null}),S=u({ttfb:null,fcp:null,tti:null}),v=u({totalResources:0,totalSize:0,cacheHitRate:0,byType:{}}),w=u({usedJSHeapSize:0,totalJSHeapSize:0,jsHeapSizeLimit:0}),L=u([]),I=ee(()=>w.value.jsHeapSizeLimit===0?0:Math.round(w.value.usedJSHeapSize/w.value.jsHeapSizeLimit*100));function p(s){return s==null?"N/A":s<1e3?`${Math.round(s)}ms`:`${(s/1e3).toFixed(2)}s`}function T(s){if(s===0)return"0 B";const t=1024,r=["B","KB","MB","GB"],d=Math.floor(Math.log(s)/Math.log(t));return`${(s/t**d).toFixed(1)} ${r[d]}`}function N(s,t,r){return s===null?"unknown":s<=t?"good":s<=r?"needs-improvement":"poor"}function o(s){return s>=55?"good":s>=30?"needs-improvement":"poor"}async function l(){C.value=!0;try{if(m.value=await h.getWebVitals(),S.value=await h.getLoadingMetrics(),v.value=await h.getResourceMetrics(),"memory"in performance){const s=performance.memory;w.value={usedJSHeapSize:s.usedJSHeapSize,totalJSHeapSize:s.totalJSHeapSize,jsHeapSizeLimit:s.jsHeapSizeLimit}}_(),x(),z()}catch(s){console.error("Failed to refresh metrics:",s)}finally{C.value=!1}}function c(){h.clearMetrics(),l()}function _(){const s=[];m.value.lcp&&m.value.lcp>2500&&s.push({title:"Improve Largest Contentful Paint",description:"Optimize images, reduce server response times, and eliminate render-blocking resources",impact:"High",priority:"high"}),I.value>80&&s.push({title:"Reduce Memory Usage",description:"Consider implementing virtual scrolling and cleaning up unused resources",impact:"Medium",priority:"medium"}),v.value.totalSize>5*1024*1024&&s.push({title:"Reduce Bundle Size",description:"Implement code splitting and remove unused dependencies",impact:"High",priority:"high"}),v.value.cacheHitRate<70&&s.push({title:"Improve Cache Strategy",description:"Optimize service worker caching and implement better cache headers",impact:"Medium",priority:"medium"}),L.value=s}function x(){if(!y.value)return;const s=y.value.getContext("2d");if(!s)return;const t=y.value.width,r=y.value.height;s.clearRect(0,0,t,r);const d=I.value/100,J=t*d;s.fillStyle="#e5e7eb",s.fillRect(0,0,t,r),s.fillStyle=d>.8?"#ef4444":d>.6?"#f59e0b":"#10b981",s.fillRect(0,0,J,r),s.strokeStyle="#374151",s.lineWidth=2,s.strokeRect(0,0,t,r),s.fillStyle="#374151",s.font="14px Arial",s.textAlign="center",s.fillText(`${I.value}%`,t/2,r/2+5)}function z(){if(!b.value)return;const s=b.value.getContext("2d");if(!s)return;const t=b.value.width,r=b.value.height;s.clearRect(0,0,t,r);const d=[{name:"TTFB",value:S.value.ttfb,color:"#3b82f6"},{name:"FCP",value:S.value.fcp,color:"#10b981"},{name:"LCP",value:m.value.lcp,color:"#f59e0b"},{name:"TTI",value:S.value.tti,color:"#8b5cf6"}],J=Math.max(...d.map(P=>P.value||0)),F=t/d.length;d.forEach((P,Y)=>{if(P.value){const A=P.value/J*(r-40),V=Y*F+F*.1,$=r-A-20;s.fillStyle=P.color,s.fillRect(V,$,F*.8,A);const Z=document.documentElement.classList.contains("scheme-dark");s.fillStyle=Z?"#a1a1aa":"#374151",s.font="12px Arial",s.textAlign="center",s.fillText(P.name,V+F*.4,r-5),s.fillText(p(P.value),V+F*.4,$-5)}})}let O=performance.now(),g=0;function U(){g++;const s=performance.now(),t=s-O;t>=1e3&&(f.value=Math.round(g*1e3/t),a.value=Math.round(t/g*100)/100,g=0,O=s),requestAnimationFrame(U)}return j(()=>{l(),U();const s=setInterval(l,1e4);K(()=>{clearInterval(s)})}),(s,t)=>(M(),R("div",ue,[e("div",me,[t[0]||(t[0]=e("h2",null,"Performance Dashboard",-1)),e("div",ve,[e("button",{disabled:C.value,class:"refresh-btn",onClick:l},n(C.value?"Refreshing...":"Refresh"),9,fe),e("button",{class:"clear-btn",onClick:c}," Clear Data ")])]),e("div",pe,[t[7]||(t[7]=e("h3",null,"Core Web Vitals",-1)),e("div",ge,[e("div",{class:H(["metric-card",N(m.value.lcp,2500,4e3)])},[t[1]||(t[1]=e("div",{class:"metric-title"}," Largest Contentful Paint ",-1)),e("div",he,n(p(m.value.lcp)),1),t[2]||(t[2]=e("div",{class:"metric-description"}," Good: <2.5s, Needs Improvement: 2.5s-4s ",-1))],2),e("div",{class:H(["metric-card",N(m.value.fid,100,300)])},[t[3]||(t[3]=e("div",{class:"metric-title"}," First Input Delay ",-1)),e("div",ye,n(p(m.value.fid)),1),t[4]||(t[4]=e("div",{class:"metric-description"}," Good: <100ms, Needs Improvement: 100ms-300ms ",-1))],2),e("div",{class:H(["metric-card",N(m.value.cls,.1,.25)])},[t[5]||(t[5]=e("div",{class:"metric-title"}," Cumulative Layout Shift ",-1)),e("div",be,n(m.value.cls?.toFixed(3)||"N/A"),1),t[6]||(t[6]=e("div",{class:"metric-description"}," Good: <0.1, Needs Improvement: 0.1-0.25 ",-1))],2)])]),e("div",Se,[t[14]||(t[14]=e("h3",null,"Loading Performance",-1)),e("div",we,[e("div",_e,[t[8]||(t[8]=e("div",{class:"metric-title"}," Time to First Byte ",-1)),e("div",Ce,n(p(S.value.ttfb)),1),t[9]||(t[9]=e("div",{class:"metric-description"}," Server response time ",-1))]),e("div",xe,[t[10]||(t[10]=e("div",{class:"metric-title"}," First Contentful Paint ",-1)),e("div",ze,n(p(S.value.fcp)),1),t[11]||(t[11]=e("div",{class:"metric-description"}," First content rendered ",-1))]),e("div",Te,[t[12]||(t[12]=e("div",{class:"metric-title"}," Time to Interactive ",-1)),e("div",Pe,n(p(S.value.tti)),1),t[13]||(t[13]=e("div",{class:"metric-description"}," Page becomes interactive ",-1))])])]),e("div",Me,[t[19]||(t[19]=e("h3",null,"Resource Performance",-1)),e("div",Ie,[e("div",Re,[e("div",ke,[t[15]||(t[15]=e("span",{class:"label"},"Total Resources:",-1)),e("span",Le,n(v.value.totalResources),1)]),e("div",Fe,[t[16]||(t[16]=e("span",{class:"label"},"Total Size:",-1)),e("span",He,n(T(v.value.totalSize)),1)]),e("div",De,[t[17]||(t[17]=e("span",{class:"label"},"Cache Hit Rate:",-1)),e("span",Ee,n(v.value.cacheHitRate)+"%",1)])]),e("div",Be,[t[18]||(t[18]=e("h4",null,"Resource Breakdown",-1)),e("div",Ne,[(M(!0),R(W,null,q(v.value.byType,(r,d)=>(M(),R("div",{key:d,class:"breakdown-item"},[e("div",Oe,n(d),1),e("div",Je,n(r.count)+" files ",1),e("div",Ve,n(T(r.size)),1),e("div",je,n(p(r.loadTime)),1)]))),128))])])])]),e("div",Ue,[t[24]||(t[24]=e("h3",null,"Memory Usage",-1)),e("div",Ae,[e("div",$e,[e("canvas",{ref_key:"memoryChart",ref:y,width:"400",height:"200"},null,512)]),e("div",We,[e("div",qe,[t[20]||(t[20]=e("span",{class:"label"},"Used JS Heap:",-1)),e("span",Ge,n(T(w.value.usedJSHeapSize)),1)]),e("div",Ke,[t[21]||(t[21]=e("span",{class:"label"},"Total JS Heap:",-1)),e("span",Qe,n(T(w.value.totalJSHeapSize)),1)]),e("div",Xe,[t[22]||(t[22]=e("span",{class:"label"},"Heap Limit:",-1)),e("span",Ye,n(T(w.value.jsHeapSizeLimit)),1)]),e("div",Ze,[t[23]||(t[23]=e("span",{class:"label"},"Memory Usage:",-1)),e("span",et,n(I.value)+"%",1)])])])]),e("div",tt,[t[25]||(t[25]=e("h3",null,"Performance Timeline",-1)),e("div",st,[e("canvas",{ref_key:"timelineChart",ref:b,width:"800",height:"300"},null,512)])]),L.value.length>0?(M(),R("div",ot,[t[26]||(t[26]=e("h3",null,"Performance Recommendations",-1)),e("div",it,[(M(!0),R(W,null,q(L.value,(r,d)=>(M(),R("div",{key:d,class:H(["recommendation-item",r.priority])},[e("div",at,n(r.title),1),e("div",nt,n(r.description),1),e("div",rt," Impact: "+n(r.impact),1)],2))),128))])])):te("",!0),e("div",lt,[t[30]||(t[30]=e("h3",null,"Real-time Performance",-1)),e("div",ct,[e("div",dt,[t[27]||(t[27]=e("span",{class:"label"},"FPS:",-1)),e("span",{class:H(["value",o(f.value)])},n(f.value),3)]),e("div",ut,[t[28]||(t[28]=e("span",{class:"label"},"Frame Time:",-1)),e("span",mt,n(p(a.value)),1)]),e("div",vt,[t[29]||(t[29]=e("span",{class:"label"},"Active Requests:",-1)),e("span",ft,n(k.value),1)])])])]))}}),gt=X(pt,[["__scopeId","data-v-eb4e61bc"]]),ht={class:"max-w-7xl mx-auto"},yt=Q({__name:"Dashboard",setup(i){j(()=>{window.location.href="/"});function h(){window.location.reload()}function C(){window.caches&&window.caches.keys().then(f=>{f.forEach(a=>{window.caches.delete(a)})}),localStorage.clear(),sessionStorage.clear(),location.reload(),window.location.reload()}function y(){window.open(`${window.location.origin}?no-cache=1`,"_blank")}function b(){const f=localStorage.getItem("language")||navigator.language.split("-")[0]||"en",a=G[f]||G.en,k={id:`sw-update-test-${Date.now()}`,type:"update",title:a.newVersion,body:a.updateNow,from:"system",read:!1,created_at:Date.now(),updated_at:Date.now(),notify:!0,link:"reload"};ce(k),console.log("Test update notification added")}return(f,a)=>(M(),se(B(le),null,{default:D(()=>[E(B(oe),null,{default:D(()=>[E(B(ie),null,{default:D(()=>[E(B(ae),null,{default:D(()=>[...a[0]||(a[0]=[ne("Performance Dashboard",-1)])]),_:1})]),_:1})]),_:1}),E(B(re),{class:"ion-padding"},{default:D(()=>[e("div",ht,[a[6]||(a[6]=e("div",{class:"mb-6"},[e("h1",{class:"text-2xl font-bold text-auto-12 mb-2"}," Development Performance Dashboard "),e("p",{class:"text-auto-10"}," Monitor app performance, bundle metrics, and optimization status in real-time. ")],-1)),E(gt),e("div",{class:"mt-8 p-4 bg-auto-3 rounded-lg border border-auto-6"},[a[5]||(a[5]=e("h2",{class:"text-lg font-semibold text-auto-12 mb-3"}," Quick Actions ",-1)),e("div",{class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},[e("button",{class:"p-3 bg-auto-4 hover:bg-auto-5 rounded-md border border-auto-6 text-left transition-colors",onClick:h},[...a[1]||(a[1]=[e("div",{class:"font-medium text-auto-12"}," Reload Page ",-1),e("div",{class:"text-sm text-auto-10"}," Test cold start performance ",-1)])]),e("button",{class:"p-3 bg-auto-4 hover:bg-auto-5 rounded-md border border-auto-6 text-left transition-colors",onClick:C},[...a[2]||(a[2]=[e("div",{class:"font-medium text-auto-12"}," Clear Cache ",-1),e("div",{class:"text-sm text-auto-10"}," Reset all cached data ",-1)])]),e("button",{class:"p-3 bg-auto-4 hover:bg-auto-5 rounded-md border border-auto-6 text-left transition-colors",onClick:y},[...a[3]||(a[3]=[e("div",{class:"font-medium text-auto-12"}," Test No Cache ",-1),e("div",{class:"text-sm text-auto-10"}," Simulate first visit ",-1)])]),e("button",{class:"p-3 bg-theme-5 hover:bg-theme-6 rounded-md border border-blue-400 text-left transition-colors text-white",onClick:b},[...a[4]||(a[4]=[e("div",{class:"font-medium"}," Test Update Notification ",-1),e("div",{class:"text-sm opacity-90"}," Manually trigger update UI ",-1)])])])]),a[7]||(a[7]=e("div",{class:"mt-6 p-4 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg border border-yellow-200 dark:border-yellow-800"},[e("div",{class:"flex items-start"},[e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})])]),e("div",{class:"ml-3"},[e("h3",{class:"text-sm font-medium text-yellow-800 dark:text-yellow-200"}," Development Only "),e("div",{class:"mt-2 text-sm text-yellow-700 dark:text-yellow-300"},[e("p",null," This dashboard is only available in development mode. It will not be accessible in production builds. ")])])])],-1))])]),_:1})]),_:1}))}}),wt=X(yt,[["__scopeId","data-v-a64268bf"]]);export{wt as default};
