var q=Object.defineProperty;var O=(T,m,t)=>m in T?q(T,m,{enumerable:!0,configurable:!0,writable:!0,value:t}):T[m]=t;var S=(T,m,t)=>O(T,typeof m!="symbol"?m+"":m,t);import{aG as X,bG as F,K,L as G,az as W,eq as Q,ci as J,cI as P,er as Y,j as Z,o as ee,a7 as N,x as te,aI as B,bS as se,a as V,C as ae,cv as j,bQ as le,bx as L,ba as ie,bc as re,bo as R,es as ne,bd as oe,bA as pe}from"./index-BzOnJQlu.js";import{A as ce,S as de,O as ue}from"./octopusPlugin-Tk4Pcjhw.js";import{B as he,c as ye,l as fe,a as ge,b as me,n as be}from"./subtitles-octopus-Ds4oG3HS.js";import{K as ve}from"./keyHandlerPlugin-3H0i3_Zb.js";import"./buttons-DDRy-LjE.js";class we extends he{constructor(){super(...arguments);S(this,"preScreen",{});S(this,"episodeScreen",{});S(this,"languageScreen",{});S(this,"selectedSeason");S(this,"hasPlayed",!1);S(this,"tvDialogStyles",["w-available","h-available","max-w-available","max-h-available",""])}use(){this.player.container.style.display="contents",this.createTvOverlay(this.player.overlay),this.createPreScreen(this.player.overlay),this.createEpisodeScreen(this.player.overlay),this.createLanguageScreen(this.player.overlay),this.player.options.autoPlay||this.showPreScreen(),this.player.once("firstFrame",()=>{this.hasPlayed=!0}),this.player.on("play",()=>{this.player.emit("show-seek-container",!1),this.player.getVideoElement().scrollIntoView(),this.closePreScreen(),this.closeEpisodeScreen(),this.closeLanguageScreen()}),this.player.on("back-button",this.backMenu.bind(this)),this.player.on("pause",()=>{this.player.overlay.scrollIntoView()}),this.player.once("ready",()=>{this.showPreScreen(),this.player.pause()})}backMenu(){this.player.isTv()&&this.currentMenu!=="seek"&&(this.player.container.classList.contains("episode-screen")?this.closeEpisodeScreen():this.player.container.classList.contains("language-screen")?this.closeLanguageScreen():this.player.container.classList.contains("pre-screen")?this.player.emit("back"):(this.player.pause(),this.showPreScreen()))}createTvOverlay(t){const e=this.player.createElement("div","tv-overlay").addClasses(["absolute","flex","flex-col","justify-end","gap-4","w-available","h-available","z-0"]).addClasses(["group-[&.nomercyplayer.paused.pre-screen]:hidden"]).appendTo(t),l=this.createTopBar(e);this.player.addClasses(l,["px-10","pt-10","z-0"]);const s=this.createRestartButton(l,!0);this.player.addClasses(s,["children:stroke-2"]);const p=this.createNextButton(l,!0);this.player.addClasses(p,["children:stroke-2"]),this.createDivider(l),this.createTvCurrentItem(l),this.createOverlayCenterMessage(e),this.createSpinnerContainer(e),this.seekContainer=this.createSeekContainer(e);const n=this.createBottomBar(e),d=this.player.createElement("div","bottom-row").addClasses(["tv-bottom-row","relative","flex","flex-row","items-center","gap-4","mt-auto","w-available","px-20","pb-10","z-0"]).appendTo(n);this.createPlaybackButton(d,!0),this.createTime(d,"current",[]),this.createTvProgressBar(d),this.createTime(d,"remaining",["mr-14"]),this.player.on("playing",()=>{this.currentMenu!=="seek"&&!this.controlsVisible&&this.playbackButton.focus(),this.currentScrubTime=this.getClosestSeekableInterval()});let o=s??p;[s,p].forEach(i=>{i==null||i.addEventListener("keydown",a=>{var r,u;a.key=="ArrowDown"?!this.nextUp.style||this.nextUp.style.display=="none"?(r=this.playbackButton)==null||r.focus():(u=this.nextUp.lastChild)==null||u.focus():a.key=="ArrowLeft"?(o=a.target.previousElementSibling,o==null||o.focus()):a.key=="ArrowRight"&&(a.preventDefault(),o=a.target.nextElementSibling,o==null||o.focus())})}),[this.nextUp.firstChild,this.nextUp.lastChild].forEach(i=>{i==null||i.addEventListener("keydown",a=>{var r,u,h;a.key=="ArrowUp"?(r=o||s)==null||r.focus():a.key=="ArrowDown"?this.playbackButton.focus():a.key=="ArrowLeft"?(u=this.nextUp.firstChild)==null||u.focus():a.key=="ArrowRight"&&((h=this.nextUp.lastChild)==null||h.focus())})}),[this.playbackButton].forEach(i=>{i==null||i.addEventListener("keydown",a=>{var r;a.key=="ArrowUp"&&(a.preventDefault(),!this.nextUp.style||this.nextUp.style.display=="none"?o==null||o.focus():(r=this.nextUp.lastChild)==null||r.focus())})});let c=!1;return[document.body].forEach(i=>{const a=r=>{if(r.key=="ArrowLeft"){if([s,p,this.nextUp.firstChild,this.nextUp.lastChild].includes(r.target))return;if(r.preventDefault(),this.player.emit("show-seek-container",!0),this.shouldSlide)this.currentScrubTime=this.getClosestSeekableInterval(),this.player.emit("currentScrubTime",{...this.player.getTimeData(),currentTime:this.getClosestSeekableInterval()}),this.shouldSlide=!1;else{const u=this.currentScrubTime-10;c=!0,this.player.emit("currentScrubTime",{...this.player.getTimeData(),currentTime:u})}}else if(r.key=="ArrowRight"){if([s,p,this.nextUp.firstChild,this.nextUp.lastChild].includes(r.target))return;if(r.preventDefault(),this.player.emit("show-seek-container",!0),this.shouldSlide)this.currentScrubTime=this.getClosestSeekableInterval(),this.player.emit("currentScrubTime",{...this.player.getTimeData(),currentTime:this.getClosestSeekableInterval()}),this.shouldSlide=!1;else{const u=this.currentScrubTime+10;c=!0,this.player.emit("currentScrubTime",{...this.player.getTimeData(),currentTime:u})}}else r.key=="Enter"&&(Math.abs(this.currentScrubTime-this.player.getCurrentTime())>5&&c?(this.player.seek(this.currentScrubTime),c=!1):r.target==document.body&&this.player.togglePlayback())};i==null||i.addEventListener("keydown",a),this.player.on("dispose",()=>{i==null||i.removeEventListener("keydown",a)})}),this.player.on("active",i=>{!this.controlsVisible&&i&&this.playbackButton.focus(),this.player.overlay.scrollIntoView(),setTimeout(()=>{this.controlsVisible=i},0)}),n}showPreScreen(){var t;this.preScreen.showModal(),(t=this.preScreen.querySelector(".button-container>button"))==null||t.focus(),setTimeout(()=>{this.player.container.classList.add("pre-screen")},5)}closePreScreen(){this.preScreen.close(),this.player.emit("hideControls"),this.player.container.classList.remove("pre-screen")}createPreScreen(t){this.preScreen=this.player.createElement("dialog","pre-screen-dialog").addClasses(this.tvDialogStyles).addClasses(["group-[&.nomercyplayer.paused:not(.open)]:backdrop:bg-black/80","group-[&.nomercyplayer.paused:not(.open)]:backdrop:pointer-events-none"]).appendTo(t),this.preScreen.setAttribute("popover","manual"),this.preScreen.setAttribute("role","modal");const e=this.player.createElement("div","pre-screen").addClasses(["pre-screen","absolute","inset-0","flex","p-6","text-white","w-available","h-available","z-0"]).addClasses(["group-[&.nomercyplayer.paused.episode-screen]:hidden","group-[&.nomercyplayer.paused.language-screen]:hidden"]).appendTo(this.preScreen),l=this.player.createElement("div","left-side").addClasses(["flex","flex-col","justify-between","items-center","w-1/2","h-available"]).appendTo(e),s=this.createImageContainer(l),p=this.player.createElement("div","title-container").addClasses(["flex","flex-col","w-available","h-available"]).appendTo(s),n=this.player.createElement("div","title").addClasses(["flex","text-white","text-lg","font-bold","mx-2"]).appendTo(p),d=this.player.createElement("div","description").addClasses(["text-left","text-white","text-sm","line-clamp-4","font-bold","leading-5","overflow-hidden","mx-2"]).appendTo(p);this.player.on("item",()=>{n.innerHTML=this.player.playlistItem().title.replace(this.player.playlistItem().show??"","").replace("%S",this.player.localize("S")).replace("%E",this.player.localize("E")),d.innerHTML=this.player.playlistItem().description});const o=this.player.createElement("div","button-container").addClasses(["button-container","flex","flex-col","gap-3","w-available","h-1/2","mt-7","mb-3","overflow-auto","px-2","py-0.5","[*::-webkit-scrollbar]:hidden"]).appendTo(l);this.createTvButton(o,"play",null,this.player.play,this.buttons.play),this.createTvButton(o,"restart","Play from beginning",this.player.restart,this.buttons.restart);const c=this.createTvButton(o,"showEpisodeMenu","Episodes",()=>this.player.emit("showEpisodeScreen"),this.buttons.playlist);c.style.display="none",c.addEventListener("click",()=>{this.player.emit("switch-season",this.player.playlistItem().season),this.showEpisodeScreen()});const i=this.createTvButton(o,"showLanguageMenu","Audio and subtitles",()=>this.player.emit("showLanguageScreen"),this.buttons.language);i.style.display="none",i.addEventListener("click",()=>{this.showLanguageScreen()}),this.player.createElement("div","pre-screen-right-side").addClasses(["flex","flex-col","justify-center","w-1/3","h-available"]).appendTo(e),this.player.on("audioTracks",()=>{this.player.hasAudioTracks()||this.player.hasCaptions()?i.style.display="flex":i.style.display="none"}),this.player.on("item",()=>{this.player.getPlaylist().length>1?c.style.display="flex":c.style.display="none"})}showEpisodeScreen(){var t;this.episodeScreen.showModal(),this.player.container.classList.add("episode-screen"),this.player.container.classList.add("open"),(t=this.episodeScrollContainer.querySelector(".button-container>button"))==null||t.focus()}closeEpisodeScreen(){var t;this.episodeScreen.close(),this.player.container.classList.remove("episode-screen"),this.player.container.classList.remove("open"),(t=this.preScreen.querySelector(".button-container>button"))==null||t.focus()}createEpisodeScreen(t){this.episodeScreen=this.player.createElement("dialog","episode-screen-dialog").addClasses(this.tvDialogStyles).addClasses(["group-[&.nomercyplayer.paused.episode-screen]:backdrop:bg-black/80","group-[&.nomercyplayer.paused.episode-screen]:backdrop:pointer-events-none"]).appendTo(t),this.episodeScreen.setAttribute("popover","manual"),this.episodeScreen.setAttribute("role","modal");const e=this.player.createElement("div","episode-screen").addClasses(["episode-screen","absolute","inset-0","flex","gap-4","p-6","text-white","w-available","h-available","z-0"]).appendTo(this.episodeScreen),l=this.player.createElement("div","episode-screen-left-side").addClasses(["flex","flex-col","justify-between","items-center","w-2/5","h-available"]).appendTo(e);this.createImageContainer(l);const s=this.player.createElement("div","season-button-container").addClasses(["flex","flex-col","gap-3","w-available","h-available","mt-7","mb-3","overflow-auto","px-2","py-0.5","[*::-webkit-scrollbar]:hidden"]).appendTo(l);this.player.once("playlist",()=>{var d;const p=this.player.createElement("div","episode-screen-right-side").addClasses(["flex","flex-col","justify-center","w-3/5","h-available"]).appendTo(e);this.episodeScrollContainer=this.player.createElement("div","episode-button-container").addClasses(["button-container","flex","flex-col","overflow-auto","h-available","pt-6","gap-2","p-1","min-h-[50%]","scroll-p-4","scroll-smooth"]).appendTo(p);let n={};for(const o of this.player.getSeasons())n=this.createTvSeasonButton(s,`season-${o.season}`,o,()=>this.player.emit("switch-season",o.season));(d=n.addEventListener)==null||d.call(n,"keydown",o=>{var c,i;if(o.key!="ArrowLeft"){if(o.key!="ArrowRight"){if(!(o.key=="ArrowUp"&&!this.player.options.disableTouchControls)){if(o.key=="ArrowDown"&&!this.player.options.disableTouchControls){(c=n.nextElementSibling)==null||c.focus();const a=n.nextElementSibling;(a==null?void 0:a.nodeName)=="BUTTON"?a==null||a.focus():(i=n.parentElement.nextElementSibling)==null||i.focus()}}}}});for(const[o,c]of this.player.getPlaylist().entries()??[])this.createTvEpisodeMenuButton(this.episodeScrollContainer,c,o)})}showLanguageScreen(){var t;this.languageScreen.showModal(),this.player.container.classList.add("language-screen"),this.player.container.classList.add("open"),(t=this.languageScreen.querySelector(".button-container>button"))==null||t.focus()}closeLanguageScreen(){var t;this.languageScreen.close(),this.player.container.classList.remove("language-screen"),this.player.container.classList.remove("open"),(t=this.preScreen.querySelector(".button-container>button"))==null||t.focus()}createLanguageScreen(t){var a;this.languageScreen=this.player.createElement("dialog","language-screen-dialog").addClasses(this.tvDialogStyles).addClasses(["group-[&.nomercyplayer.paused.language-screen]:backdrop:bg-black/80","group-[&.nomercyplayer.paused.language-screen]:backdrop:pointer-events-none"]).appendTo(t),this.languageScreen.setAttribute("popover","manual"),this.languageScreen.setAttribute("role","modal");const e=this.player.createElement("div","language-screen").addClasses(["language-screen","absolute","inset-0","flex","p-6","text-white","w-available","h-available","z-0"]).appendTo(this.languageScreen),l=this.player.createElement("div","language-screen-left-side").addClasses(["flex","flex-col","items-center","overflow-clip","w-2/5","h-available"]).appendTo(e);this.createImageContainer(l);const s=this.player.createElement("div","language-scroll-container").addClasses(["flex","flex-col","overflow-auto","w-available","h-available","gap-3","scroll-p-4","scroll-smooth","border-transparent","outline-transparent","p-1"]).appendTo(l);s.addEventListener("focus",()=>{var r;(r=s.querySelector("button"))==null||r.focus()});const p=this.player.createElement("div","language-button-container").addClasses(["flex-shrink-0","h-auto","px-2","py-0.5","w-available","text-left","mt-3"]).appendTo(s);p.innerText=this.player.localize("Audio");const n=this.player.createElement("div","language-button-container").addClasses(["[*::-webkit-scrollbar]:hidden","flex","flex-col","flex-shrink-0","gap-3","px-2","py-0.5","w-available"]).appendTo(s);n.style.paddingRight="5rem";let d={};const o=r=>{var u,h;if(r.key!="ArrowLeft"){if(r.key!="ArrowRight"){if(r.key=="ArrowUp"&&!this.player.options.disableTouchControls)(u=r.target.previousElementSibling)==null||u.focus();else if(r.key=="ArrowDown"&&!this.player.options.disableTouchControls){const f=r.target.nextElementSibling;(f==null?void 0:f.nodeName)=="BUTTON"?f==null||f.focus():(h=d.parentElement.nextElementSibling)==null||h.focus()}}}};(a=d.removeEventListener)==null||a.call(d,"keydown",o),this.player.on("audioTracks",r=>{n.innerHTML="";for(const[u,h]of(r==null?void 0:r.entries())??[])d=this.createLanguageMenuButton(n,{language:h.language??"",label:h.label??"",type:h.type??"",id:h.id??u-1,buttonType:"audio"})});const c=this.player.createElement("div","language-button-container").addClasses(["flex-shrink-0","h-auto","px-2","py-0.5","w-available","text-left","mt-3"]).appendTo(s);c.innerText=this.player.localize("Subtitles");const i=this.player.createElement("div","subtitle-button-container").addClasses(["[*::-webkit-scrollbar]:hidden","flex","flex-col","flex-shrink-0","gap-3","flex-shrink-0","px-2","py-0.5","w-available"]).appendTo(s);i.style.paddingRight="5rem",i.style.marginTop="0",this.player.on("captionsList",r=>{i.innerHTML="";for(const[u,h]of r.entries()??[])this.createLanguageMenuButton(i,{language:h.language??"",label:h.label??"",type:h.type??"",id:h.id??u-1,buttonType:"subtitle"})})}createTvProgressBar(t){this.sliderBar=this.player.createElement("div","slider-bar").addClasses(["slider-bar","group/slider","overflow-clip","flex","rounded-full","bg-white/20","h-2","mx-4","relative","w-available"]).appendTo(t);const e=this.player.createElement("div","slider-progress").addClasses(["slider-progress","absolute","flex","h-full","pointer-events-none","rounded-full","bg-white","z-10","-left-full","w-full"]).appendTo(this.sliderBar);return this.chapterBar=this.player.createElement("div","chapter-progress").addClasses(["chapter-bar","bg-transparent","flex","h-2","relative","rounded-full","overflow-clip","w-available"]).appendTo(this.sliderBar),this.player.on("item",()=>{this.sliderBar.classList.add("bg-white/20"),this.previewTime=[],this.chapters=[],e.style.transform="translateX(0%)",this.fetchPreviewTime()}),this.player.on("chapters",()=>{var l;((l=this.player.getChapters())==null?void 0:l.length)>0&&!this.player.isTv()?this.sliderBar.classList.remove("bg-white/20"):this.sliderBar.classList.add("bg-white/20")}),this.player.on("time",l=>{e.style.transform=`translateX(${l.percentage}%)`}),this.player.on("currentScrubTime",l=>{e.style.transform=`translateX(${l.currentTime/l.duration*100}%)`}),this.sliderBar}createTvEpisodeMenuButton(t,e,l){var b,v,w;const s=this.player.createElement("button",`playlist-${e.id}`).addClasses(["playlist-menu-button","relative","flex","w-available","p-2","gap-2","rounded-lg","snap-center","outline-transparent","outline","outline-1","outline-solid","text-white","focus-visible:outline-2","focus-visible:outline-white","transition-all","duration-200"]).appendTo(t);this.player.playlistItem().season!==1&&(s.style.display="none");const p=this.player.createElement("div",`playlist-${e.id}-left`).addClasses(["episode-menu-button-left","relative","rounded-md","w-[50%]","overflow-clip","self-center"]).appendTo(s);this.player.createElement("div",`episode-${e.id}-shadow`).addClasses(["episode-menu-button-shadow","bg-[linear-gradient(0deg,rgba(0,0,0,0.87)_0%,rgba(0,0,0,0.7)_25%,rgba(0,0,0,0)_50%,rgba(0,0,0,0)_100%)]","shadow-[inset_0px_1px_0px_rgba(255,255,255,0.24),inset_0px_-1px_0px_rgba(0,0,0,0.24),inset_0px_-2px_0px_rgba(0,0,0,0.24)]","bottom-0","left-0","absolute","!h-available","w-available"]).appendTo(p);const n=this.player.createElement("img",`episode-${e.id}-image`).addClasses(["episode-menu-button-image","w-available","h-auto","aspect-video","object-cover",""]).appendTo(p);n.setAttribute("loading","lazy"),(b=e.image)!=null&&b.startsWith("http")?n.src=e.image??"":n.src=e.image&&e.image!=""?`${this.imageBaseUrl}${e.image}`:"";const d=this.player.createElement("div",`episode-${e.id}-progress-container`).addClasses(["episode-menu-progress-container","absolute","bottom-1","w-available","flex","flex-col","px-3"]).appendTo(p),o=this.player.createElement("div",`episode-${e.id}-progress-box`).addClasses(["episode-menu-progress-box","flex","justify-between","h-available","sm:mx-2","mb-1","px-1"]).appendTo(d),c=this.player.createElement("div",`episode-${e.id}-progress-item`).addClasses(["progress-item-text","text-[0.7rem]",""]).appendTo(o);e.episode&&e.show&&(c.innerText=`${this.player.localize("E")}${e.episode}`);const i=this.player.createElement("div",`episode-${e.id}-progress-duration`).addClasses(["progress-duration","text-[0.7rem]"]).appendTo(o);i.innerText=(v=e.duration)==null?void 0:v.replace(/^00:/u,"");const a=this.player.createElement("div",`episode-${e.id}-slider-container`).addClasses(["slider-container","group/slider","overflow-clip","hidden","rounded-full","bg-white/20","h-1","mx-4","relative","w-available"]).appendTo(d);a.style.display=e.progress?"flex":"none";const r=this.player.createElement("div",`episode-${e.id}-progress-bar`).addClasses(["progress-bar","absolute","flex","h-full","pointer-events-none","rounded-full","bg-white","z-10","-left-full","w-full"]).appendTo(a);(w=e.progress)!=null&&w.time&&(r.style.transform=`translateX(${e.progress.time/ye(e.duration)*100}%`);const u=this.player.createElement("div",`episode-${e.id}-right-side`).addClasses(["playlist-card-right","w-3/4","flex","flex-col","text-left","gap-1","px-1","outline-transparent","outline","outline-1","outline-solid","focus-visible:outline-2","focus-visible:outline-white","active:outline-white"]).appendTo(s),h=this.player.createElement("span",`episode-${e.id}-title`).addClasses(["playlist-menu-button-title","font-bold","text-lg","line-clamp-1","text-white",""]).appendTo(u);h.innerText=fe((e.title??"").replace(e.show??"","").replace("%S",this.player.localize("S")).replace("%E",this.player.localize("E")));const f=this.player.createElement("span",`episode-${e.id}-overview`).addClasses(["playlist-menu-button-overview","font-bold","text-[0.7rem]","leading-4","line-clamp-4","overflow-hidden","text-white"]).appendTo(u);return f.innerText=ge(e.description,600),this.player.on("item",()=>{this.player.playlistItem().season==e.season?s.style.display="flex":s.style.display="none",this.player.playlistItem().season==e.season&&this.player.playlistItem().episode==e.episode?s.style.background="rgba(255,255,255,.1)":s.style.background="transparent"}),this.player.on("switch-season",g=>{this.selectedSeason=g,this.player.playlistItem().id==e.id?setTimeout(()=>{this.scrollCenter(s,t,{margin:1,duration:100})},50):this.player.playlistItem().season!==g&&this.episodeScrollContainer.scrollTo(0,0),g==e.season?s.style.display="flex":s.style.display="none"}),this.player.on("active",()=>{r.style.transform=`translateX(${this.player.getTimeData().percentage}%)`}),this.player.on("time",g=>{var x;((x=this.player.playlistItem())==null?void 0:x.uuid)==e.uuid&&this.player.container.classList.contains("active")&&(a.style.display="flex",r.style.transform=`translateX(${g.percentage}%)`)}),e.episode&&e.show&&(c.innerText=e.season==null?`${e.episode}`:`${this.player.localize("S")}${e.season}: ${this.player.localize("E")}${e.episode}`),s.addEventListener("keydown",g=>{var x,C,k;g.key=="ArrowLeft"?(x=document.querySelector(`#season-${this.player.playlistItem().season}`))==null||x.focus():g.key=="ArrowRight"||(g.key=="ArrowUp"&&!this.player.options.disableTouchControls?(C=s.previousElementSibling)==null||C.focus():g.key=="ArrowDown"&&!this.player.options.disableTouchControls&&((k=s.nextElementSibling)==null||k.focus()))}),s.addEventListener("focus",()=>{this.scrollCenter(s,t,{margin:2,duration:50})}),s.addEventListener("click",()=>{e.episode&&e.season?this.setEpisode(e.season,e.episode):this.player.playlistItem(l),this.closeEpisodeScreen(),this.closePreScreen(),this.player.play()}),s}createTvSeasonButton(t,e,l,s,p){const n=this.player.createElement("button",e).addClasses(["w-available","mr-auto","h-8","px-1","py-2","flex","flex-nowrap","items-center","snap-center","rounded","outline-transparent","outline","outline-1","outline-solid","focus-visible:outline-2","focus-visible:outline-white","active:outline-white",`${e}-button`]).appendTo(t);if(n.type="button",n.addEventListener("focus",()=>{this.scrollIntoView(n)}),n.addEventListener("keyup",i=>{var a,r,u,h;i.key=="ArrowLeft"||i.key=="ArrowRight"&&(l.season==((a=this.player.playlistItem())==null?void 0:a.season)?(u=Array.from(document.querySelectorAll("[id^=playlist-]")).filter(f=>getComputedStyle(f).display=="flex").at((((r=this.player.playlistItem())==null?void 0:r.episode)??0)-1))==null||u.focus():(h=Array.from(document.querySelectorAll("[id^=playlist-]")).filter(f=>getComputedStyle(f).display=="flex").at(0))==null||h.focus())}),n.addEventListener("keydown",i=>{var a,r;i.key=="ArrowUp"&&!this.player.options.disableTouchControls?(a=n.previousElementSibling)==null||a.focus():i.key=="ArrowDown"&&!this.player.options.disableTouchControls&&((r=n.nextElementSibling)==null||r.focus())}),n.addEventListener("click",()=>{s==null||s.bind(this)()}),p){const i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.setAttribute("viewBox","0 0 24 24"),i.id=e,this.player.addClasses(i,[`${e}-icon`,...p.classes,"svg-size","h-5","w-5","fill-current","pointer-events-none","group-hover/button:scale-110","duration-700"]);const a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttribute("d",p.hover),i.appendChild(a),n.appendChild(i)}const d=this.player.createElement("div",`${e}-button-text`).addClasses(this.menuButtonTextStyles).addClasses(["flex","justify-between","items-center","w-available","gap-1","flex-nowrap"]).appendTo(n),o=this.player.createElement("span",`${e}-button-text-span-1`).addClasses(["line-clamp-1","text-nowrap","text-sm","w-auto"]).appendTo(d),c=this.player.createElement("span",`${e}-button-text-span-2`).addClasses(["line-clamp-1","text-nowrap","text-xs","w-min"]).appendTo(d);return l.seasonName?(o.innerText=l.seasonName,c.innerText=`${l.episodes} ${this.player.localize("ep")}`):l.season?(o.innerText=`${this.player.localize("Season")} ${l.season}`,c.innerText=`${l.episodes} ${this.player.localize("ep")}`):c.innerText=`${l.episodes} ${this.player.localize("ep")}`,n}getVisibleButtons(t){const e=t.parentElement,l=e==null?void 0:e.querySelectorAll("button");if(!l||(l==null?void 0:l.length)==0)return;const s=Array.from(l).filter(n=>n.style.display!="none"),p=s.findIndex(n=>n==t);return{visibleButtons:s,currentButtonIndex:p}}findPreviousVisibleButton(t){const e=this.getVisibleButtons(t);if(!e)return;const{visibleButtons:l,currentButtonIndex:s}=e;for(let p=s;p>=0;p--)return l[p-1]}findNextVisibleButton(t){const e=this.getVisibleButtons(t);if(!e)return;const{visibleButtons:l,currentButtonIndex:s}=e;for(let p=s;p<l.length;p++)return l[p+1]}createImageContainer(t){const e=this.player.createElement("div","left-side-top").addClasses(["flex","flex-col","justify-center","items-center","w-available","gap-2","h-auto"]).appendTo(t),l=this.player.createElement("div","logo-container").addClasses(["flex","flex-col","justify-center","items-center","w-available","h-[85px]","min-h-[85px]"]).appendTo(e),s=this.player.createElement("span","fallbackText").addClasses(["w-auto","h-available","items-center","py-0","max-w-[38vw]","mr-auto","leading-[1.2]","font-bold","object-fit"]).appendTo(l),p=this.player.createElement("img","logo").addClasses(["w-auto","px-2","py-2","mr-auto","object-fit","h-auto","max-w-[23rem]","max-h-available",""]).appendTo(l),n=this.player.createElement("div","left-side-top-overview").addClasses(["flex","flex-col","w-available","h-[40px]"]).appendTo(e),d=this.player.createElement("div","rating-container").addClasses(["flex","gap-2","items-center","w-available","text-white"]).appendTo(n),o=this.player.createElement("span","year-text").addClasses(["flex","text-white","text-sm","font-bold","mx-2"]).appendTo(d),c=this.player.createElement("img","rating-image").addClasses(["w-8","h-available","object-fit","invert"]).appendTo(d),i=this.player.createElement("span","episodes-count-text").addClasses(["flex","text-white","text-sm","font-bold","mx-2"]).appendTo(d);return this.player.on("item",()=>{var u,h,f,b,v,w;const a=(u=this.player.playlistItem())==null?void 0:u.logo;!a||a==""||a.includes("null")||a.includes("undefined")?(s.innerText=me(((h=this.player.playlistItem())==null?void 0:h.show)??""),s.style.fontSize=`calc(110px / ${s.innerText.length} + 3ch)`,s.style.display="flex",p.style.display="none"):(p.style.display="block",s.style.display="none",a!=null&&a.startsWith("http")?p.src=a:p.src=a&&a!=""?`${this.imageBaseUrl}${a}`:""),o.innerHTML=((b=(f=this.player.playlistItem())==null?void 0:f.year)==null?void 0:b.toString())??"",(v=this.player.playlistItem())!=null&&v.year?o.style.display="flex":o.style.display="none",c.removeAttribute("src"),c.removeAttribute("alt"),c.style.opacity="0",this.player.getPlaylist().length>1&&(i.innerHTML=`${this.player.getPlaylist().length} ${this.player.localize("episodes")}`);const r=(w=this.player.playlistItem())==null?void 0:w.rating;r&&(c.src=`https://storage.nomercy.tv/laravel/kijkwijzer/${r.image}`,c.alt=r.rating.toString(),c.style.opacity="1")}),e}createTvButton(t,e,l,s,p){const n=this.player.createElement("button",e).addClasses(["w-9/12","mr-auto","h-8","px-1","py-2","flex","items-center","rounded","snap-center","outline-transparent","outline","outline-1","outline-solid","focus-visible:outline-2","focus-visible:outline-white","active:outline-white",`${e}-button`]).appendTo(t);if(n.type="button",n.addEventListener("focus",()=>{setTimeout(()=>{this.scrollCenter(n,t,{margin:1,duration:100})},50)}),n.addEventListener("keydown",o=>{var c,i,a;if(o.key=="ArrowUp"&&!this.player.options.disableTouchControls)(c=this.findPreviousVisibleButton(n))==null||c.focus();else if(o.key=="ArrowDown"&&!this.player.options.disableTouchControls){const r=this.findNextVisibleButton(n);r?r==null||r.focus():(a=(i=n.parentElement)==null?void 0:i.nextElementSibling)==null||a.focus()}}),n.addEventListener("click",s==null?void 0:s.bind(this.player)),p){const o=document.createElementNS("http://www.w3.org/2000/svg","svg");o.setAttribute("viewBox","0 0 24 24"),o.id=e,this.player.addClasses(o,[`${e}-icon`,...p.classes,"svg-size","h-5","w-5","fill-current","pointer-events-none","group-hover/button:scale-110","duration-700"]);const c=document.createElementNS("http://www.w3.org/2000/svg","path");c.setAttribute("d",p.hover),o.appendChild(c),n.appendChild(o)}const d=this.player.createElement("span",`${e}-buttonText`).addClasses(this.menuButtonTextStyles).appendTo(n);return l||(l="Play",setTimeout(()=>{this.player.once("firstFrame",()=>{l="Resume",d.innerHTML=this.player.localize("Resume")})},500)),d.innerHTML=this.player.localize(l),n}}const Be=X({__name:"Tv",setup(T){const{data:m}=F(),t=K(),e=()=>{var s,p;(s=t.value)==null||s.emit("back-button"),(p=t.value)==null||p.emit("back-button-hyjack")},l=s=>{var a,r,u,h,f,b,v,w,g,x,C,k,A,I,$,z,M,U,_,D;const p={muted:!1,controls:!1,preload:"auto",debug:!1,autoPlay:!0,playlist:(s==null?void 0:s.filter(y=>!!y.id))??[],controlsTimeout:3e3,doubleClickDelay:300,playbackRates:[.25,.5,.75,1,1.25,1.5,1.75,2],accessToken:((a=re.value)==null?void 0:a.accessToken)||localStorage.getItem("access_token")||"",basePath:(r=ie.value)==null?void 0:r.serverBaseUrl,forceTvMode:(L("android")||L("ios"))&&!L("mobile"),disableTouchControls:!1,disableMediaControls:"mediaSession"in navigator||L("capacitor"),renderAhead:10,customStorage:{set:(y,E)=>new Promise(H=>{localStorage.setItem(y,E),H()}),get:y=>new Promise(E=>{E(localStorage.getItem(y))}),remove:y=>new Promise(E=>{localStorage.removeItem(y),E()})}};t.value=be("player1").setup(p);const n=new we;(u=t.value)==null||u.registerPlugin("tvUI",n),(h=t.value)==null||h.usePlugin("tvUI");const d=new ce;(f=t.value)==null||f.registerPlugin("autoSkip",d),(b=t.value)==null||b.usePlugin("autoSkip");const o=new ve;(v=t.value)==null||v.registerPlugin("keyHandler",o),(w=t.value)==null||w.usePlugin("keyHandler");const c=new de;(g=t.value)==null||g.registerPlugin("sync",c),(x=t.value)==null||x.usePlugin("sync");const i=new ue;(C=t.value)==null||C.registerPlugin("octopus",i),(k=t.value)==null||k.usePlugin("octopus"),(A=t.value)==null||A.once("play",()=>{var y;(y=t.value)==null||y.enterFullscreen()}),(I=t.value)==null||I.once("back",()=>{var y;(y=t.value)==null||y.dispose(),R.back()}),($=t.value)==null||$.on("playlistComplete",()=>{var y;(y=t.value)==null||y.dispose(),R.back()}),(z=t.value)==null||z.on("play",()=>{P(!0)}),(M=t.value)==null||M.on("pause",()=>{P(!1)}),(U=t.value)==null||U.on("ready",()=>{ne(),oe.stop()}),(_=t.value)==null||_.on("item",()=>{var y;(y=t.value)==null||y.play()}),(D=t.value)==null||D.on("active",y=>{}),pe.addListener("backButton",e)};return G(m,s=>{s&&l(s)}),W(()=>{Q(!1),m.value&&l(m.value)}),J(()=>{var s;P(!1),Y(),(s=t.value)==null||s.dispose()}),(s,p)=>(ee(),Z(B(le),null,{default:N(()=>[te(B(se),{fullscreen:!0},{default:N(()=>[V("div",{class:ae(["absolute inset-0 flex h-full w-full overflow-clip bg-black z-1199",{"mb-28":B(j),"mb-0":!B(j)}])},p[0]||(p[0]=[V("div",{id:"player1",class:"group nomercyplayer"},null,-1)]),2)]),_:1})]),_:1}))}});export{Be as default};
