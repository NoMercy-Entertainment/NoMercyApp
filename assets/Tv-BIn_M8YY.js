import{I as _,d as b,b as d,o as s,K as p,aN as z,s as C,a,R as B,t as h,l as u,E as K,c as l,F as g,h as j,A as Q,f as W,j as A,q as G,a5 as R,w as J,ci as X,bM as Y,C as V,bu as Z,bh as ee}from"./index-DhiqRu-L.js";import{g as te,a as se,b as re}from"./routerHelper-D3fX-PiD.js";import{_ as ae}from"./ContentRating.vue_vue_type_script_setup_true_lang-BSclluH5.js";import{_ as oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useQuery-D0X0p7yJ.js";import"./useBaseQuery-BFsI7r_f.js";import"./useQueryClient-B03e10GK.js";import"./useMutationState-C9zDo5AK.js";const le=["src"],ne={class:"flex flex-col justify-end items-start self-stretch flex-grow-0 flex-shrink-0 h-[95px] relative overflow-hidden px-1.5 pt-10 pb-1.5",style:{background:`linear-gradient(
          to bottom,
          rgba(0, 0, 0, 0) 0%,
          rgba(0, 0, 0, 0.24) 25.86%,
          rgba(0, 0, 0, 0.9) 77.75%
        )`}},ie={class:"self-stretch flex-grow-0 flex-shrink-0 w-full text-3xs font-bold text-left text-slate-light-11 dark:text-slate-dark-11"},ce={class:"self-stretch flex-grow-0 flex-shrink-0 w-full text-[8px] text-left text-[#eff7ff]/[0.62]"},ue=_({__name:"TvCard",props:{item:{type:Object,required:!0},index:{type:Number,required:!0},scrollToCenter:{type:Function,required:!0}},setup(e){return(o,f)=>e.item.props.data?(s(),b(p(z),{key:0,to:e.item.props.data.link.includes("watch")?e.item.props.data.link:`${e.item.props.data.link}/watch`,"data-card":e.item.props.data,index:e.index,class:"flex flex-col justify-end relative items-center flex-grow-0 flex-shrink-0 w-full h-auto aspect-poster overflow-hidden rounded bg-cover bg-no-repeat bg-center focus-visible:ring-2 focus-visible:ring-white snap-center pointer-events-auto mr-3 last:mr-0",onFocus:e.scrollToCenter},{default:C(()=>[a("img",{src:`${p(B)?.serverBaseUrl}/images/original${e.item.props.data.poster}?width=300`,alt:"",loading:"lazy",class:"w-full h-auto aspect-poster object-cover object-center absolute inset-0"},null,8,le),a("div",ne,[a("p",ie,h(e.item.props.data.title),1),a("p",ce,h(e.item.props.data.year),1)])]),_:1},8,["to","data-card","index","onFocus"])):d("",!0)}}),de={key:0,class:"flex flex-col gap-1 w-full"},fe={key:0,class:"text-lg font-bold text-auto-12 text-slate-light-1 ml-2"},me=["data-carousel"],xe=_({__name:"TvCarousel",props:{carousel:{type:Object,required:!0},scrollToCenter:{type:Function,required:!0},scrollIndex:{type:Number,required:!0},setScrollIndex:{type:Function,required:!0},cardsPerScroll:{type:Number,required:!0},unlockKeys:{type:Function,required:!0},index:{type:Number,required:!0},setHasMoreCardsToRight:{type:Function,required:!0}},setup(e){const o=e,f=u();function n(){const i=Array.from(f.value?.querySelectorAll("a")??[]),m=i.filter(v=>v.isVisible()),x=m.at(o.scrollIndex);x?x?.focus():m.length>0?m.at(-1)?.focus():i.at(o.scrollIndex)?.href?(i.at(o.scrollIndex)?.focus(),o.setHasMoreCardsToRight(!0)):(i.at(-1)?.focus(),o.setHasMoreCardsToRight(!0))}function y(){setTimeout(()=>{o.unlockKeys()},200)}const k=u(!1);return K(()=>{setTimeout(()=>{k.value=!0},50*o.index)}),(i,m)=>k.value?(s(),l("div",de,[e.carousel.props.title??e.carousel.title?(s(),l("h3",fe,h(e.carousel.props.title??e.carousel.title),1)):d("",!0),a("div",{ref_key:"carouselDiv",ref:f,tabindex:"1",class:"flex flex-nowrap w-full p-1 snap-x snap-mandatory overflow-x-auto pointer-events-none scroll-mr-20","data-carousel":e.carousel.props.title??e.carousel.title,onFocus:n},[(s(!0),l(g,null,j(e.carousel.props?.items??[],(x,v)=>(s(),b(ue,{key:x,tabindex:"0",item:x,index:v,"scroll-to-center":e.scrollToCenter,style:Q(`flex-basis: calc(100% / ${e.cardsPerScroll} - 0.70rem)`),onFocus:m[0]||(m[0]=$=>y())},null,8,["item","index","scroll-to-center","style"]))),128))],40,me)])):d("",!0)}}),ve={key:0,class:"w-full h-full absolute right-0 top-0 overflow-hidden bg-black"},pe=["src"],he={class:"flex flex-col justify-start items-start absolute left-8 gap-5 bottom-4"},be={class:"flex flex-col justify-start items-start flex-grow-0 flex-shrink-0 relative gap-1"},ge={key:0,class:"flex items-center gap-2 text-xs font-medium text-left text-slate-dark-11"},ye={class:"text-3xs"},ke={class:"text-2xl text-left text-slate-dark-12 line-clamp-1 w-4/5"},we={class:"line-clamp-5 text-xs w-3/6"},Te={class:"flex justify-center items-center flex-grow-0 flex-shrink-0 relative"},Ce=_({__name:"TvHomeCard",props:{carousel:{type:Object,required:!0},items:{type:Array,required:!0}},setup(e){return(o,f)=>{const n=W("RouterLink");return s(),l(g,null,[e.carousel?.props?.data?(s(),l("div",ve,[a("img",{src:`${p(B)?.serverBaseUrl}/images/original${e.carousel?.props?.data?.backdrop}`,alt:"",class:"w-available h-auto absolute inset-0 left-40 object-scale-down"},null,8,pe),f[0]||(f[0]=a("div",{class:"absolute bottom-0 w-full h-[200%]",style:{"flex-shrink":"0",background:`radial-gradient(
          87.82% 267.96% at 92.04% -27%,
          rgba(19, 19, 20, 0.1) 34%,
          #131314 70.74%
        )`}},null,-1))])):d("",!0),a("div",he,[a("div",be,[e.carousel.props.data?.content_ratings?(s(),l("div",ge,[A(ae,{ratings:e.carousel.props.data?.content_ratings},null,8,["ratings"]),a("span",ye,"( "+h(e.carousel.props.data?.year)+" )",1)])):d("",!0),a("p",ke,h(e.carousel.props?.data?.title),1),a("p",we,h(e.carousel.props?.data?.overview),1)]),a("div",Te,[e.carousel.props?.data?.link?(s(),b(n,{key:0,id:"watch_now",to:e.carousel.props?.data?.link,tabindex:"0",class:"text-black flex-grow-0 flex-shrink-0 px-4 py-2 rounded-3xl bg-slate-light-4 focus-visible:ring-[3px] ring-inset focus-visible:ring-focus"},{default:C(()=>[G(h(o.$t("Watch Now")),1)]),_:1},8,["to"])):d("",!0)])])],64)}}}),_e={key:0,id:"container",class:"flex flex-col gap-8 pt-24 pb-4"},$e=_({__name:"Tv",setup(e){const o=R.currentRoute.value.name,f=te(),{data:n}=se({path:"/libraries/tv",queryKey:["libraries","tv"]}),{data:y,mutate:k}=re({homeData:n,queryKey:["libraries","tv"]});R.beforeEach(async t=>{if(!n.value||t.name!==o)return;const c=n.value?.filter?.(r=>r?.update?.when==="pageLoad")??[];k(c)}),J(n,t=>{t&&$("#watch_now")});const i=u(),m=u(),x=u(7),v=u();function $(t){const c=document.querySelector(t);c&&(c.focus(),v.value?.$el?.scrollToTop(0),i.value?.classList.remove("opacity-[0.001]"),I())}function E(){v.value?.$el?.scrollToBottom(0),v.value?.$el?.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"}),i.value?.classList.add("opacity-[0.001]"),m.value?.querySelector("[data-card]")?.focus()}X(()=>{setTimeout(()=>{i.value?.focus()},1e3)});const w=u(0);function N(t){w.value=t}const T=u(!1);function H(t){T.value=t}function O(t){document.activeElement?.scrollIntoView({behavior:"smooth",block:"center",inline:w.value===2||T.value?"center":void 0}),setTimeout(()=>{const c=t.target?.getAttribute("index")?.toInt()??0,r=t.target.closest("[data-carousel]");r.dataset.focussedIndex=c.toString();const L=r.querySelectorAllArray("a").filter(U=>U.isVisible()).indexOf(t.target);w.value!==L&&(T.value=!0),N(L),c>r.childNodes.length-x.value&&(T.value=!1)},400)}const F=u(),q=u(!1);function I(){clearTimeout(F.value),q.value=!1}function S(t){if(t.target.dataset.card){if(q.value)t.preventDefault();else{q.value=!0;return}F.value=setTimeout(()=>{I()},200)}}K(()=>{document.addEventListener("keydown",S)}),Y(()=>{document.removeEventListener("keydown",S)});const P=V(()=>(y.value??n.value)?.filter(t=>t.component==="NMHomeCard")??[]),M=V(()=>(y.value??n.value)?.filter(t=>t.component==="NMCarousel")??[]);return(t,c)=>(s(),b(p(ee),null,{default:C(()=>[A(p(Z),{ref_key:"content",ref:v,fullscreen:!0},{default:C(()=>[p(f)?d("",!0):(s(),l("div",_e,[a("div",{ref_key:"top",ref:i,tabindex:"0",class:"flex items-center mx-12 w-available min-h-[60vh] relative overflow-hidden rounded-2xl border-2 border-slate-light-9 transition-opacity duration-200",onFocus:c[0]||(c[0]=r=>$("#watch_now"))},[(s(!0),l(g,null,j(P.value,r=>(s(),b(Ce,{key:r.props.title,carousel:r,items:r.props.items},null,8,["carousel","items"]))),128))],544),M.value.length>0?(s(),l("div",{key:0,ref_key:"bottom",ref:m,tabindex:"0",class:"mx-11 flex flex-col justify-start items-start w-available gap-5 h-[calc(100vh-6rem)] overflow-auto",onFocus:E},[p(f)?d("",!0):(s(!0),l(g,{key:0},j(M.value,(r,D)=>(s(),l(g,{key:r.props.title},[r.props.items.length>0?(s(),b(xe,{key:0,carousel:r,index:D,"scroll-to-center":O,"scroll-index":w.value,"set-scroll-index":N,"cards-per-scroll":x.value,"unlock-keys":I,"set-has-more-cards-to-right":H},null,8,["carousel","index","scroll-index","cards-per-scroll"])):d("",!0)],64))),128))],544)):d("",!0)]))]),_:1},512)]),_:1}))}}),Re=oe($e,[["__scopeId","data-v-9b35d891"]]);export{Re as default};
