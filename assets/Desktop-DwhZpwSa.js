import{An as s,Bt as S,Gt as i,Lt as A,Pn as Q,Rt as a,Sn as d,Tt as T,Un as D,Vt as q,Wt as E,an as L,bn as u,cn as b,fn as M,i as R,qt as j,u as F,zn as m,zt as K}from"./index-CymNhKD_.js";import"./dist-BzCNKCKQ.js";import"./esm-ACLeELb5.js";import"./esm-D_D4nCnV.js";import"./dist-DXrN7I-1.js";import"./client-B3lu4kSB.js";import"./ionic-global-CJHxMOPd.js";import"./hardware-back-button-D60wdz2_.js";import"./index3-D8TaXO-z.js";import"./index8-DyEBw6N5.js";import"./keyboard-CzXNBarC.js";import"./index2-YLkJp4Cu.js";import"./ios.transition-De37_SF6.js";import"./keyboard2-F9Kv6wST.js";import"./md.transition-DlofogM3.js";import"./basecomponent-Bn5la5w8.js";import"./ui-CVk4xI0v.js";import"./client-CxRn8_4O.js";import{n as U,t as l}from"./currentServer-DzE7mepP.js";import"./config-BZ-AEJ_J.js";import"./esm-B369UUD9.js";import"./global-lh4aio7e.js";import"./esm-L6OojSyq.js";import"./bundle-mjs-CKr78mlm.js";import"./user-DlzWNC9W.js";import{t as W}from"./serverClient-BuGPA0-U.js";import{o as G,s as I}from"./router-Ch9jBD0u.js";import"./utils-DO5s4OOL.js";import"./useInfiniteServerClient-vxekqC7x.js";import"./SocketClient-DIjrmZvk.js";import{t as H}from"./useQueryClient-q2-SvbEv.js";import"./apiClient-DbAYXZY3.js";import"./notifications-C159qvRm.js";import"./utils-D5LXfnop.js";import"./deviceInfo-AeSN8xPw.js";import"./auth-Csw53SQZ.js";import{t as J}from"./MoooomIcon-D8Onw6Et.js";import"./baseeditableholder-Df29qiV1.js";import{t as X}from"./Toggle-DpJAggzu.js";import{t as Y}from"./inputtext-Zi1Fameo.js";import{t as V}from"./inputnumber-BFwmAfQj.js";import{t as Z}from"./useServerClient-BC86_TUk.js";import"./ScrollContainer-C0xGPQP4.js";import"./useMounted-CY2UtWfe.js";import"./RipperOverlay-kXCed_FU.js";import"./ripperSocket-DkPvfRvp.js";import"./FloatingBackButton-BMrJa07u.js";import{t as ee}from"./DashboardLayout-DAU11JwG.js";T();var re={key:0,class:"col-span-2 col-start-1 2xl:col-start-1"},oe={class:"flex flex-col gap-2"},ae={class:"flex flex-col gap-2"},te={class:"flex flex-col gap-2"},le={key:1,class:"col-span-2 col-start-1 2xl:col-start-3"},se={class:"flex flex-col gap-2"},ue={class:"flex flex-col gap-2"},ne={class:"flex flex-col gap-2"},ie={key:2,class:"col-span-2 col-start-1 2xl:col-start-5"},me={class:"flex flex-col gap-2"},pe={class:"flex gap-4"},ve=["aria-label","href"],de=j({__name:"Desktop",setup(fe){const{data:o,refetch:N,error:$}=Z({path:"/dashboard/configuration"}),f=s(!1),n=s(o.value??{}),p=(e,r)=>{if(o.value){if(Q(o.value[e])===r){delete n.value[e],n.value={...n.value};return}n.value={...n.value,[e]:r??void 0}}};u(o,e=>{e&&(n.value={},_.value=e?.name,g.value=e?.external_port,w.value=e?.internal_port,k.value=e?.queue_workers,y.value=e?.cron_workers,B.value=e?.data_workers,C.value=e?.request_workers,x.value=e?.encoder_workers,c.value=e?.image_workers,v.value=e?.swagger,f.value=!0)}),L(()=>{o.value&&(n.value={},_.value=o.value?.name,g.value=o.value?.external_port,w.value=o.value?.internal_port,k.value=o.value?.queue_workers,y.value=o.value?.cron_workers,B.value=o.value?.data_workers,C.value=o.value?.request_workers,x.value=o.value?.encoder_workers,c.value=o.value?.image_workers,v.value=o.value?.swagger,f.value=!0)});const _=s(o.value?.name??"");u(_,e=>{p("name",e),l.value&&(I([...G.value.filter(r=>r.id!==l.value.id),{...l.value,name:e.toString()}]),U({...l.value,name:e.toString()}))});const g=s(o.value?.external_port??0);u(g,e=>{p("external_port",e),l.value&&(I([...G.value.filter(r=>r.id!==l.value.id),{...l.value,external_port:e.toString()}]),U({...l.value,external_port:e.toString()}))});const w=s(o.value?.internal_port??0);u(w,e=>{p("internal_port",e),l.value&&(I([...G.value.filter(r=>r.id!==l.value.id),{...l.value,internal_port:e.toString()}]),U({...l.value,internal_port:e.toString()}))});const k=s(o.value?.queue_workers??0);u(k,e=>{p("queue_workers",e)});const y=s(o.value?.cron_workers??0);u(y,e=>{p("cron_workers",e)});const B=s(o.value?.data_workers??0);u(B,e=>{p("data_workers",e)});const C=s(o.value?.request_workers??0);u(C,e=>{p("request_workers",e)});const c=s(o.value?.image_workers??0);u(c,e=>{p("image_workers",e)});const x=s(o.value?.encoder_workers??0);u(x,e=>{p("encoder_workers",e)});const v=s(o.value?.swagger??!1);u(v,e=>{p("swagger",e)});const h=A(()=>Object.keys(n.value).length>0);u(n,e=>{console.log(e)});const O=H(),P=()=>{console.raw(n.value),W().patch("/dashboard/configuration",n.value).then(()=>{N(),O.invalidateQueries({queryKey:["serverInfo"]})})};return(e,r)=>{const z=M("Button");return b(),K(m(F),null,{default:d(()=>[i(m(R),{fullscreen:!0},{default:d(()=>[i(ee,{error:m($),gridStyle:2,description:"",title:"General"},{cta:d(()=>[...r[8]||(r[8]=[])]),actions:d(()=>[i(z,{id:"save",disabled:!h.value,class:"ml-auto",color:"theme",form:"myForm",type:"submit",onClick:r[7]||(r[7]=t=>P())},{default:d(()=>[E(D(e.$t("Save")),1)]),_:1},8,["disabled"])]),default:d(()=>[f.value?(b(),q("div",re,[a("div",oe,[r[9]||(r[9]=a("label",{for:"name"},"Server name",-1)),i(m(Y),{id:"name",modelValue:_.value,"onUpdate:modelValue":r[0]||(r[0]=t=>_.value=t),class:"mb-4"},null,8,["modelValue"])]),a("div",ae,[r[10]||(r[10]=a("label",{for:"internal_port"},"Secure internal port",-1)),i(m(V),{id:"internal_port",modelValue:w.value,"onUpdate:modelValue":r[1]||(r[1]=t=>w.value=t),min:2e3,useGrouping:!1,class:"mb-4",showButtons:""},null,8,["modelValue"])]),a("div",te,[r[11]||(r[11]=a("label",{for:"external_port"},"Secure external port",-1)),i(m(V),{id:"external_port",modelValue:g.value,"onUpdate:modelValue":r[2]||(r[2]=t=>g.value=t),min:2e3,useGrouping:!1,class:"mb-4",showButtons:""},null,8,["modelValue"])])])):S("",!0),f.value?(b(),q("div",le,[a("div",se,[r[12]||(r[12]=a("label",{for:"encoder_workers"},"Encoder workers",-1)),i(m(V),{id:"encoder_workers",modelValue:x.value,"onUpdate:modelValue":r[3]||(r[3]=t=>x.value=t),min:0,useGrouping:!1,class:"mb-4",showButtons:""},null,8,["modelValue"])]),a("div",ue,[r[13]||(r[13]=a("label",{for:"image_workers"},"Image workers",-1)),i(m(V),{id:"image_workers",modelValue:c.value,"onUpdate:modelValue":r[4]||(r[4]=t=>c.value=t),min:0,useGrouping:!1,class:"mb-4",showButtons:""},null,8,["modelValue"])]),a("div",ne,[r[14]||(r[14]=a("label",{for:"queue_workers"},"Queue workers",-1)),i(m(V),{id:"queue_workers",modelValue:k.value,"onUpdate:modelValue":r[5]||(r[5]=t=>k.value=t),min:0,useGrouping:!1,class:"mb-4",showButtons:""},null,8,["modelValue"])])])):S("",!0),f.value?(b(),q("div",ie,[a("div",me,[a("span",pe,[r[15]||(r[15]=a("label",{for:"swagger"},"Open API / Swagger Ui",-1)),v.value&&m(l)?.serverBaseUrl?(b(),q("a",{key:0,"aria-label":e.$t("Open API / Swagger Ui in a new tab"),href:m(l)?.serverBaseUrl,class:"flex gap-1 items-center underline underline-offset-4 h-4 text-sm",target:"_blank"},[a("span",null,D(e.$t("Open")),1),i(J,{className:"size-4",color:"theme",icon:"shareSquare"})],8,ve)):S("",!0)]),i(X,{"model-value":v.value,"onUpdate:modelValue":r[6]||(r[6]=t=>v.value=t)},null,8,["model-value"])])])):S("",!0)]),_:1},8,["error"])]),_:1})]),_:1})}}}),ir=de;export{ir as default};
