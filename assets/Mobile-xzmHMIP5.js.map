{"version":3,"file":"Mobile-xzmHMIP5.js","sources":["../../src/views/Base/Collection/Mobile.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport {computed, ref, watch} from 'vue';\nimport {useRoute} from 'vue-router';\nimport {IonContent, IonPage, IonSkeletonText, onIonViewWillEnter, onIonViewWillLeave} from '@ionic/vue';\n\nimport type {CollectionResponse} from \"@/types/api/base/collection\";\n\nimport useServerClient from '@/lib/clients/useServerClient';\nimport {breakTitle2, setTitle, sortByPosterAlphabetized} from '@/lib/stringArray';\nimport {background, setBackground, setColorPalette, setLogo, setPoster} from '@/store/ui';\nimport {currentServer} from \"@/store/currentServer\";\nimport router from '@/router';\n\nimport InfoItem from '@/views/Base/Info/components/InfoItem.vue';\nimport ImageCarousel from '@/components/Carousel/ImageCarousel.vue';\nimport PersonCarousel from '@/components/Carousel/PersonCarousel.vue';\nimport MediaCarousel from '@/components/Carousel/MediaCarousel.vue';\nimport ContentRating from '@/components/Images/ContentRating.vue';\nimport HeaderItem from \"@/views/Base/Person/components/HeaderItem.vue\";\nimport Collapsible from \"@/views/Base/Person/components/Collapsible.vue\";\nimport MobileInfoCard from \"@/views/Base/Info/components/MobileInfoCard.vue\";\nimport MediaCard from \"@/components/Cards/MediaCard.vue\";\nimport collect from \"collect.js\";\nimport {convertToHumanReact} from \"@/lib/dateTime\";\nimport {t} from \"i18next\";\n\nconst route = useRoute();\n\nconst { data } = useServerClient<CollectionResponse>({\n  queryKey: ['base', 'collection', route.params.id],\n  limit: 1000,\n  keepForever: true,\n});\n\nconst enabled = ref(false);\nconst showMore = ref(false);\nconst trailerIndex = ref(-1);\n\nconst content = ref<VueDivElement>();\n\nconst backgroundUrl = computed(() => {\n  // return `${tmdbImageBaseUrl}/original${background.value}`;\n  return `${currentServer.value?.serverBaseUrl}/images/original${background.value || data.value?.backdrop}`;\n});\n\nwatch(data, (value) => {\n  content.value?.$el?.scrollToTop(window.innerHeight);\n  enabled.value = true;\n  trailerIndex.value = 0;\n\n  setTitle(value?.title);\n\n  if (value?.backdrop) {\n    setBackground(value?.backdrop);\n  }\n  if (value?.poster) {\n    setPoster(value?.poster);\n  }\n  if (value?.logo) {\n    setLogo(value?.logo);\n  }\n  if (value?.color_palette?.poster) {\n    setColorPalette(value?.color_palette?.poster);\n  }\n});\n\nonIonViewWillEnter(() => {\n  content.value?.$el?.scrollToTop(window.innerHeight);\n  // trailerIndex.value = 0;\n  setTitle(data?.value?.title);\n\n  if (data?.value?.backdrop) {\n    setBackground(data?.value?.backdrop);\n  }\n  if (data?.value?.poster) {\n    setPoster(data?.value?.poster);\n  }\n  if (data?.value?.logo) {\n    setLogo(data?.value?.logo);\n  }\n  if (data?.value?.color_palette?.poster) {\n    setColorPalette(data?.value?.color_palette?.poster);\n  }\n});\n\nonIonViewWillLeave(() => {\n  content.value?.$el?.scrollToTop(window.innerHeight);\n});\n\nrouter.afterEach(() => {\n  setTimeout(() => {\n    content.value?.$el?.scrollToTop(window.innerHeight);\n  }, 100);\n});\n\nconst overview = ref<VueDivElement>();\n\nwatch(showMore, (value) => {\n  if (value) {\n    overview.value?.$el?.classList.remove('line-clamp-3');\n  } else {\n    setTimeout(() => {\n      overview.value?.$el?.classList.add('line-clamp-3');\n    }, 300);\n  }\n});\n\nconst posterStyle = 'grid-cols-2 md:grid-cols-5 lg:grid-cols-6 xl:grid-cols-7 2xl:grid-cols-7 3xl:grid-cols-9 4xl:grid-cols-10 5xl:grid-cols-[repeat(14,minmax(0,1fr))] tv:grid-cols-6';\n\n</script>\n\n<template>\n  <ion-page>\n    <ion-content\n        ref=\"content\"\n        :fullscreen=\"true\"\n        :style=\"`--background-image: ${backgroundUrl && !backgroundUrl.includes('null') ? `url(${backgroundUrl})` : ''};`\"\n    >\n\n      <MobileInfoCard :data=\"data\" />\n\n      <div\n          class=\"flex z-0 flex-col justify-start items-center self-stretch flex-grow overflow-hidden gap-4 will-change-auto text-slate-lightA-12/70 dark:text-slate-darkA-12/80\"\n          style=\"box-shadow: 0 2px 2px 0 rgba(0,0,0,0.16);\"\n      >\n        <div\n            class=\"flex justify-start items-end flex-grow-0 flex-shrink-0 -mx-4 w-available h-[410px] relative gap-2\">\n          <div\n              class=\"absolute flex flex-col justify-start items-end flex-grow w-available -mx-20 h-[410px] bg-cover bg-top\"\n              style=\"background: linear-gradient(0deg, rgba(0, 0, 0, 0.30) 0%, rgba(0, 0, 0, 0.30) 100%), var(--background-image) lightgray 50% / cover no-repeat;\"></div>\n        </div>\n\n        <div\n            class=\"flex bg-slate-light-3 dark:bg-slate-dark-1 flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-3 pt-16 pb-5 will-change-auto w-inherit px-6\"\n        >\n          <p v-if=\"data?.title\"\n             class=\"self-stretch flex-grow-0 flex-shrink-0 w-[351px] text-3xl font-bold text-left z-10\"\n             v-html=\"breakTitle2(data?.title ?? ' ', 'text-lg line-clamp-2')\">\n          </p>\n          <ion-skeleton-text v-else :animated=\"true\" class=\"h-7 will-change-auto\"></ion-skeleton-text>\n\n          <Collapsible v-if=\"data?.overview\" :text=\"data?.overview\" :maxLines=\"3\"/>\n\n          <div v-if=\"data\"\n               class=\"flex flex-wrap justify-start items-center self-stretch flex-grow-0 flex-shrink-0 relative gap-2\">\n\n            <HeaderItem v-if=\"data?.content_ratings\" title=\"Age rating\" >\n              <ContentRating :size=\"6\" v-if=\"data?.content_ratings\"\n                             class=\"h-full min-!h-[1rem] object-scale-down rounded-lg overflow-clip children:-m-0.5\"\n                             :ratings=\"data?.content_ratings\"/>\n            </HeaderItem>\n\n            <HeaderItem v-if=\"data?.have_items\" title=\"Availability\"\n                        :data=\"`${ data?.have_items }/${ data?.number_of_items }`\"/>\n\n            <HeaderItem v-if=\"data?.year\" title=\"Release date\" :data=\"data?.year.toString()\"/>\n\n            <HeaderItem v-if=\"data?.collection\" title=\"Timespan\" >\n              <span class=\"whitespace-nowrap\">\n                {{ collect(data?.collection).min('year') }}\n                - {{ collect(data?.collection).max('year') }}\n              </span>\n            </HeaderItem>\n\n            <HeaderItem v-if=\"data?.total_duration\" title=\"Duration\" :data=\"convertToHumanReact(t, data?.total_duration)\"/>\n\n          </div>\n\n          <ion-skeleton-text v-else :animated=\"true\" class=\"h-6 will-change-auto\"></ion-skeleton-text>\n          <div\n              class=\"self-stretch flex-grow-0 flex-shrink-0 h-px bg-slate-dark-7/[0.1] dark:bg-slate-dark-11/[0.1]\"></div>\n\n          <InfoItem v-if=\"data?.genres\" :data=\"data\" title=\"Genres\" keyName=\"genres\" prefix=\"genres\"/>\n          <ion-skeleton-text v-else :animated=\"true\" class=\"h-12 will-change-auto\"></ion-skeleton-text>\n\n          <div\n              class=\"self-stretch flex-grow-0 flex-shrink-0 h-px bg-slate-dark-7/[0.1] dark:bg-slate-dark-11/[0.1]\"></div>\n\n          <div class=\"flex w-available flex-1 flex-col gap-2\">\n            <h3 class=\"text-2xl font-bold text-auto-12 mr-2 text-slate-dark-1 dark:text-slate-light-1\">\n              {{ $t('Collection') }}\n            </h3>\n            <div\n                class=\"grid w-full gap-4 scroll-smooth music-showing:pb-0\"\n                :class=\"posterStyle\"\n            >\n              <template v-for=\"movie in data?.collection ?? []\" :key=\"movie?.id\">\n                <MediaCard :data=\"movie\"  class=\"\" />\n              </template>\n            </div>\n          </div>\n\n          <div\n              class=\"self-stretch flex-grow-0 flex-shrink-0 h-px bg-slate-dark-7/[0.1] dark:bg-slate-dark-11/[0.1]\"></div>\n\n          <PersonCarousel v-if=\"data?.cast && data?.cast?.length > 0\"\n                          class=\"-mx-6\"\n                          :data=\"data?.cast\"\n                          title=\"Cast\"/>\n\n          <PersonCarousel v-if=\"data?.crew && data?.crew?.length > 0\"\n                          class=\"-mx-6\"\n                          :data=\"sortByPosterAlphabetized(data?.crew, 'profile', 'id')\"\n                          title=\"Crew\"/>\n\n          <ImageCarousel v-if=\"data?.posters && data?.posters?.length > 0\"\n                         class=\"-mx-6\"\n                         :data=\"data?.posters\"\n                         title=\"Poster\"\n                         type=\"poster\"/>\n\n          <ImageCarousel v-if=\"data?.backdrops && data?.backdrops?.length > 0\"\n                         class=\"-mx-6\"\n                         :colorPalette=\"data?.color_palette?.poster\"\n                         :data=\"data?.backdrops\"\n                         title=\"Backdrop\"\n                         type=\"backdrop\"/>\n\n          <MediaCarousel v-if=\"data?.recommendations && data?.recommendations?.length > 0\"\n                         class=\"-mx-6\"\n                         :colorPalette=\"data?.color_palette\"\n                         :data=\"data?.recommendations\"\n                         title=\"Recommendations\"\n                         type=\"poster\"/>\n\n          <MediaCarousel v-if=\"data?.similar && data?.similar?.length > 0\"\n                         class=\"-mx-6\"\n                         :colorPalette=\"data?.color_palette\"\n                         :data=\"data?.similar\"\n                         title=\"Similar\"\n                         type=\"poster\"/>\n\n        </div>\n      </div>\n    </ion-content>\n  </ion-page>\n</template>\n\n<style scoped>\n:root {\n  --background-image: none;\n}\n\n</style>\n"],"names":["posterStyle","route","useRoute","data","useServerClient","enabled","ref","showMore","trailerIndex","content","backgroundUrl","computed","_a","currentServer","background","_b","watch","value","setTitle","setBackground","setPoster","setLogo","_c","setColorPalette","_d","onIonViewWillEnter","_e","_f","_g","_h","_i","_k","_j","_m","_l","onIonViewWillLeave","router","overview"],"mappings":"80DA2GMA,GAAc,qMAjFpB,MAAMC,GAAQC,GAAS,EAEjB,CAAE,KAAAC,CAAK,EAAIC,GAAoC,CACnD,SAAU,CAAC,OAAQ,aAAcH,GAAM,OAAO,EAAE,EAChD,MAAO,IACP,YAAa,EAAA,CACd,EAEKI,GAAUC,EAAI,EAAK,EACnBC,GAAWD,EAAI,EAAK,EACpBE,GAAeF,EAAI,EAAE,EAErBG,EAAUH,EAAmB,EAE7BI,EAAgBC,GAAS,IAAM,SAE5B,MAAA,IAAGC,EAAAC,GAAc,QAAd,YAAAD,EAAqB,aAAa,mBAAmBE,GAAW,SAASC,EAAAZ,EAAK,QAAL,YAAAY,EAAY,SAAQ,EAAA,CACxG,EAEKC,GAAAb,EAAOc,GAAU,cACrBF,GAAAH,EAAAH,EAAQ,QAAR,YAAAG,EAAe,MAAf,MAAAG,EAAoB,YAAY,OAAO,aACvCV,GAAQ,MAAQ,GAChBG,GAAa,MAAQ,EAErBU,GAASD,GAAA,YAAAA,EAAO,KAAK,EAEjBA,GAAA,MAAAA,EAAO,UACTE,GAAcF,GAAA,YAAAA,EAAO,QAAQ,EAE3BA,GAAA,MAAAA,EAAO,QACTG,GAAUH,GAAA,YAAAA,EAAO,MAAM,EAErBA,GAAA,MAAAA,EAAO,MACTI,GAAQJ,GAAA,YAAAA,EAAO,IAAI,GAEjBK,EAAAL,GAAA,YAAAA,EAAO,gBAAP,MAAAK,EAAsB,QACRC,IAAAC,EAAAP,GAAA,YAAAA,EAAO,gBAAP,YAAAO,EAAsB,MAAM,CAC9C,CACD,EAEDC,GAAmB,IAAM,gCACvBV,GAAAH,EAAAH,EAAQ,QAAR,YAAAG,EAAe,MAAf,MAAAG,EAAoB,YAAY,OAAO,aAE9BG,IAAAI,EAAAnB,GAAA,YAAAA,EAAM,QAAN,YAAAmB,EAAa,KAAK,GAEvBE,EAAArB,GAAA,YAAAA,EAAM,QAAN,MAAAqB,EAAa,UACDL,IAAAO,EAAAvB,GAAA,YAAAA,EAAM,QAAN,YAAAuB,EAAa,QAAQ,GAEjCC,EAAAxB,GAAA,YAAAA,EAAM,QAAN,MAAAwB,EAAa,QACLP,IAAAQ,EAAAzB,GAAA,YAAAA,EAAM,QAAN,YAAAyB,EAAa,MAAM,GAE3BC,EAAA1B,GAAA,YAAAA,EAAM,QAAN,MAAA0B,EAAa,MACPR,IAAAS,EAAA3B,GAAA,YAAAA,EAAM,QAAN,YAAA2B,EAAa,IAAI,GAEvBC,GAAAC,EAAA7B,GAAA,YAAAA,EAAM,QAAN,YAAA6B,EAAa,gBAAb,MAAAD,EAA4B,QACdR,IAAAU,GAAAC,EAAA/B,GAAA,YAAAA,EAAM,QAAN,YAAA+B,EAAa,gBAAb,YAAAD,EAA4B,MAAM,CACpD,CACD,EAEDE,GAAmB,IAAM,UACvBpB,GAAAH,EAAAH,EAAQ,QAAR,YAAAG,EAAe,MAAf,MAAAG,EAAoB,YAAY,OAAO,YAAW,CACnD,EAEDqB,GAAO,UAAU,IAAM,CACrB,WAAW,IAAM,UACfrB,GAAAH,EAAAH,EAAQ,QAAR,YAAAG,EAAe,MAAf,MAAAG,EAAoB,YAAY,OAAO,cACtC,GAAG,CAAA,CACP,EAED,MAAMsB,EAAW/B,EAAmB,EAE9B,OAAAU,GAAAT,GAAWU,GAAU,SACrBA,GACFF,GAAAH,EAAAyB,EAAS,QAAT,YAAAzB,EAAgB,MAAhB,MAAAG,EAAqB,UAAU,OAAO,gBAEtC,WAAW,IAAM,UACfA,GAAAH,EAAAyB,EAAS,QAAT,YAAAzB,EAAgB,MAAhB,MAAAG,EAAqB,UAAU,IAAI,iBAClC,GAAG,CACR,CACD"}