import"./useBaseQuery-BD2bvG9f.js";import{n as M}from"./useInfiniteServerClient-DsIFlj9d.js";import"./useQueryClient-D6q0hgG8.js";import"./useQuery-CBoq9typ.js";import{Bs as f,Fc as U,Ic as K,Ks as D,Ls as s,Mc as c,Oo as V,Rs as g,Tc as m,Ws as S,_c as E,cc as q,js as x,mo as R,oc as u,oo as z,rc as P,ti as O,uc as W,ws as C,yc as N,zs as w}from"./index-DO6J_9Tp.js";import"./_plugin-vue_export-helper-CEc1WwrB.js";import"./AppLogoSquare-DsJ0G2n6.js";import{t as G}from"./TMDBImage-J_HJdqlI.js";import{t as J}from"./useServerClient-BHDPuUSe.js";C();var Q={key:0,class:"grid grid-rows-[auto_1fr] grid-cols-7 relative justify-start flex-1 w-full gap-3 mb-2","data-row":""},X={class:"row-start-1 col-span-7 pointer-events-none font-semibold font-3xl"},Y=D({__name:"TvCarousel2",props:{data:{type:Array,required:!0},title:{type:String,required:!0},handleFocus:{type:Function,required:!0},handleDown:{type:Function,required:!0},handleUp:{type:Function,required:!0},suffix:{type:String,required:!1,default:""}},setup(t){return(v,r)=>{const _=W("RouterLink");return t.data.length?(u(),f("div",Q,[s("h3",X,K(t.title),1),(u(!0),f(x,null,q(t.data.slice(0,7),(o,n)=>(u(),g(_,{key:o.id,"data-card":o.id,"data-index":n,style:U(`background-image: url('https://app.nomercy.tv/tmdb-images${o.poster}?width=300')`),to:`${o.link}${t.suffix}`,class:"row-start-2 w-full h-auto rounded-xl bg-cover aspect-poster focus:scale-105 focus:outline outline-[2.2px] outline-white transition-transform duration-200 scroll-mb-20 scroll-mt-12 snap-center snap-mandatory",onFocus:i=>t.handleFocus(i,o),onKeydown:r[0]||(r[0]=i=>t.handleDown(i)),onKeyup:r[1]||(r[1]=i=>t.handleUp(i))},null,8,["data-card","data-index","style","to","onFocus"]))),128))])):w("",!0)}}}),H=Y;C();var Z={class:"w-available h-auto absolute left-[250px] top-0 overflow-hidden bg-black aspect-video"},ee={class:"flex flex-col justify-start items-start w-[484px] relative left-[58px] top-20 gap-7"},te={class:"flex flex-col justify-start items-start self-stretch relative gap-5"},ae={class:"flex flex-col justify-start items-start w-full relative gap-0"},le=["innerHTML"],re={class:"line-clamp-4 text-sm -mt-4"},se=D({__name:"TvHeader",props:{selected:{type:Object,required:!1}},setup(t){return(v,r)=>(u(),f("div",{key:t.selected?.id,class:"w-full h-full absolute left-0 top-0 bg-[#131314]"},[s("div",Z,[S(G,{alt:t.selected?.title,path:t.selected?.backdrop,size:540,class:"w-available h-available absolute left-[-0.39px] top-[-0.39px] object-cover"},null,8,["alt","path"]),r[0]||(r[0]=s("div",{class:"w-available h-available absolute left-[-0.39px] top-[-0.39px]"},null,-1)),r[1]||(r[1]=s("div",{class:"w-[150vw] h-[150vw] absolute left-[-30%] bottom-[-50%]",style:{background:`radial-gradient(
            closest-side,
            rgba(19, 19, 20, 0.1) 0%,
            rgba(19, 19, 20, 1) 70.73974609375%
          )`}},null,-1))]),s("div",ee,[s("div",te,[s("div",ae,[s("div",{class:"self-stretch w-full text-xl text-left mt-2 flex flex-col",innerHTML:c(O)(t.selected?.title||"","text-lg")},null,8,le)]),s("div",re,K(t.selected?.overview),1)])])]))}}),oe=se;C();var ne={class:"w-screen h-screen relative overflow-hidden bg-[#131314]"},ue=D({__name:"Tv",setup(t){const{data:v,fetchNextPage:r,hasNextPage:_}=M({path:"/",queryKey:["home"]});E(v,()=>{_&&r()});const{data:o}=J({path:"userdata/continue",queryKey:["continue"],refetchInterval:1e3*60*5}),n=m();E(o,e=>{e&&(n.value=e?.filter(l=>l.id)?.at(0))}),P(()=>{n.value=o.value?.filter(e=>e.id)?.at(0),setTimeout(()=>{const e=document.querySelector(`[data-card="${n.value?.id}"]`);e&&e.focus()},1e3)}),V(()=>{n.value=o.value?.filter(e=>e.id)?.at(0),setTimeout(()=>{const e=document.querySelector(`[data-card="${n.value?.id}"]`);e&&e.focus()},1e3)});const i=m(),b=m(!1),A=m(),B=m();function k(e,l){const a=e.target;if(a?.nodeName==="DIV"){(B.value??a.querySelector("a"))?.focus();return}l&&(n.value=l,B.value=a)}function F(e){if(b.value){e.preventDefault();return}clearTimeout(A.value),b.value=!0;const l=e.target,a=l.getAttribute("data-index"),y=l.closest("[data-row]"),d=y?.previousElementSibling,h=d?.querySelector(`a[data-index="${a}"]`),T=y?.nextElementSibling,I=T?.querySelector(`a[data-index="${a}"]`),j=l.previousElementSibling,L=l.nextElementSibling;if(h&&e.key==="ArrowUp")e.preventDefault(),h.focus();else if(I&&e.key==="ArrowDown")e.preventDefault(),I.focus();else if(j&&e.key==="ArrowLeft")e.preventDefault(),j.focus();else if(L&&e.key==="ArrowRight")e.preventDefault(),L.focus();else if(d&&e.key==="ArrowUp"){const p=Array.from(d?.querySelectorAll("a"))?.at(-1);p&&p.focus()}else if(T&&e.key==="ArrowDown"){const p=Array.from(T?.querySelectorAll("a"))?.at(-1);p&&p.focus()}}function $(){A.value=setTimeout(()=>{b.value=!1},150)}return(e,l)=>(u(),g(c(R),null,{default:N(()=>[S(c(z),{fullscreen:!0},{default:N(()=>[s("div",ne,[n.value?(u(),g(oe,{key:0,selected:n.value},null,8,["selected"])):w("",!0),s("div",{ref_key:"scrollContainer",ref:i,class:"flex flex-col justify-start items-start w-available -mx-3 px-3 absolute left-14 right-14 top-[264px] h-available overflow-auto scroll-smooth gap-4 flex-1 pb-16",tabindex:"0",onFocus:l[0]||(l[0]=a=>k(a))},[S(H,{data:c(o)?.filter(a=>!!a.id)??[],"handle-down":F,"handle-focus":k,"handle-up":$,title:"Continue watching"},null,8,["data"]),c(v)?.pages?(u(!0),f(x,{key:0},q(c(v).pages,(a,y)=>(u(),f(x,{key:y},[a?(u(!0),f(x,{key:0},q(a?.data??[],(d,h)=>(u(),g(H,{key:h,data:d.items,"handle-down":F,"handle-focus":k,"handle-up":$,title:d.title,suffix:"/watch"},null,8,["data","title"]))),128)):w("",!0)],64))),128)):w("",!0)],544)])]),_:1})]),_:1}))}}),ge=ue;export{ge as default};
