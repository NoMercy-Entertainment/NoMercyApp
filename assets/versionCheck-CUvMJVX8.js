import"./i18n-fABvX7Av.js";import"./dist-CJipjyJM.js";import{sn as o}from"./index-BLaXrj-1.js";import{setUpdatePending as a}from"./updateState-C6ml8Pdq.js";import{t as n}from"./pwa-CEi5uPC0.js";var i=300*1e3,s="/version.json",c=null;function d(){return localStorage.getItem("language")||navigator.language.split("-")[0]||"en"}function l(){const e=n[d()]||n.en;o({id:"version-update-pending",type:"update",title:e.newVersion,body:e.updateNow,from:"system",read:!1,created_at:Date.now(),updated_at:Date.now(),notify:!0,link:"reload"})}async function r(){try{const e=await fetch(s,{cache:"no-store",headers:{"Cache-Control":"no-cache"}});if(!e.ok||!(e.headers.get("content-type")??"").includes("application/json"))return!1;const t=await e.json();return t.version!=="231bf4e"?(a(t.version),l(),!0):!1}catch(e){return console.error("Version check failed:",e),!1}}function m(){c=window.setInterval(r,i),document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&r()})}export{r as checkForUpdates,m as startVersionChecks};
