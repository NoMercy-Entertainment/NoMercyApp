{"version":3,"file":"Mobile-h65cyKkD.js","sources":["../../src/views/Search/Mobile.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport {onMounted, ref, watch} from 'vue';\nimport { IonPage, IonContent, onIonViewWillEnter, useKeyboard } from '@ionic/vue';\nimport {useRoute} from \"vue-router\";\n\nimport { parseYear } from '@/lib/dateTime';\nimport {setBackground, setColorPalette} from '@/store/ui';\nimport {\n  search,\n  searchValue,\n  searchType,\n  hasMoreResults,\n  fetchNextPage,\n  musicSearchResult,\n  videoSearchResult,\n  displayResults, videoSearchValue,\n} from '@/store/search';\n\nimport MoooomIcon from '@/components/Images/icons/MoooomIcon.vue';\nimport AppLogoSquare from '@/components/Images/icons/AppLogoSquare.vue';\nimport CosmosBg2 from '@/components/Images/CosmosBg2.vue';\nimport { greetingValue } from '@/config/global';\nimport { showScreensaver } from \"@/store/imageModal\";\nimport {refDebounced} from \"@vueuse/core\";\n\nconst route = useRoute();\nconst content = ref<VueDivElement>();\n\nonIonViewWillEnter(() => {\n  searchType.value = route.query.from == 'music' ? 'music' : 'video';\n  setColorPalette(null);\n  setBackground(null);\n  setTimeout(() => {\n    search.value.focus();\n    // @ts-ignore\n    content.value?.$el?.scrollToBottom();\n  }, 100);\n});\n\nonMounted(() => {\n  searchType.value = route.query.from == 'music' ? 'music' : 'video';\n  setColorPalette(null);\n  setBackground(null);\n  setTimeout(() => {\n    search.value.focus();\n    // @ts-ignore\n    content.value?.$el?.scrollToBottom();\n  }, 100);\n});\n\nconst { isOpen, keyboardHeight } = useKeyboard();\nconst debouncedIsOpen = refDebounced(isOpen, 300);\nconst debouncedKeyboardHeight = refDebounced(keyboardHeight, 300);\n\nonIonViewWillEnter(() => {\n  setColorPalette(null);\n  setBackground(null);\n});\n\nonMounted(() => {\n  setTimeout(() => {\n    search.value.focus();\n    // @ts-ignore\n    content.value?.$el?.scrollToBottom();\n  }, 100);\n});\n\nwatch(showScreensaver, (value) => {\n  if (value) {\n    document.body.focus();\n  }\n});\n\nwatch(searchType, () => {\n  setTimeout(() => {\n    if(searchValue.value?.length == 0) {\n      search.value.focus();\n    }\n    // @ts-ignore\n    content.value?.$el?.scrollToBottom();\n  }, 100);\n});\n\nwatch(debouncedKeyboardHeight, () => {\n  setTimeout(() => {\n    // @ts-ignore\n    content.value?.$el?.scrollToBottom(0);\n  }, 100);\n});\n\n</script>\n\n<template>\n  <ion-page >\n    <ion-content :fullscreen=\"true\" ref=\"content\">\n      <div :class=\"{\n        'flex flex-grow flex-col items-center justify-start gap-12 self-stretch overflow-clip px-4 pt-8 will-change-auto': true,\n        'mb-24': debouncedIsOpen && searchValue?.length == 0,\n      }\">\n        <CosmosBg2 v-if=\"greetingValue && searchValue?.length == 0\" class=\"!h-[90vh]\" />\n        <div v-if=\"greetingValue && searchValue?.length == 0\"\n          class=\"relative z-10 mt-16 flex flex-shrink-0 flex-grow-0 flex-col items-center justify-end gap-3\">\n          <p\n            class=\"flex-grow-0 flex-shrink-0 text-5xl font-black text-left  text-slate-light-11 dark:text-slate-dark-11\">\n            {{ $t(`Good ${greetingValue}`) }}\n          </p>\n          <p class=\"flex-grow-0 flex-shrink-0 w-[333px] text-2xl text-center text-[#eff7ff]/[0.62]\">\n            {{\n              searchType == 'video'\n                  ? $t('What would you like to see?')\n                  : $t('What would you like to listen to?')\n            }}\n          </p>\n        </div>\n\n        <div class=\"absolute top-0 flex w-full flex-col gap-4 px-2 pt-2 h-full overflow-clip\" :style=\"{\n          height: debouncedIsOpen && searchValue?.length == 0\n            ? `calc(100vh - ${debouncedKeyboardHeight + 100}px)`\n            : debouncedIsOpen && searchValue?.length > 0\n              ? `calc(100vh - ${debouncedKeyboardHeight + 70}px)`\n              : '92%',\n        }\" :class=\"searchValue?.length > 0 ? '' : ''\">\n\n          <div v-if=\"searchType == 'video'\" class=\"flex flex-wrap gap-2 sm:gap-4 overflow-auto\">\n            <template v-for=\"item in videoSearchResult ?? []\" :key=\"item.id\">\n\n              <RouterLink :to=\"`/${item.media_type}/${item.id}`\"\n                class=\"relative flex w-full gap-4 overflow-hidden rounded-lg bg-zinc-900 p-2 sm:w-[32.67%]\">\n                <img v-if=\"item?.backdrop_path\" :src=\"'https://image.tmdb.org/t/p/original' + item?.backdrop_path\"\n                  :alt=\"item?.title\" class=\"absolute inset-0 h-full w-full object-cover\" />\n\n                <div\n                  class=\"absolute inset-0 z-10 h-full w-full bg-gradient-to-r from-black via-black/75 to-black/40 from-25%\">\n                </div>\n\n                <div class=\"relative z-20 h-auto w-1/4 overflow-clip rounded-sm aspect-poster bg-auto-1 sm:w-1/4\">\n                  <img v-if=\"item?.poster_path || item?.profile_path\"\n                    :src=\"'https://image.tmdb.org/t/p/original' + (item?.poster_path ?? item?.profile_path)\"\n                    :alt=\"item?.title\" class=\"absolute inset-0 h-auto w-full object-cover\" />\n                  <AppLogoSquare v-else class=\"absolute inset-0 top-2 z-20 m-auto h-16 w-16\" />\n                </div>\n\n                <div class=\"relative z-20 flex h-full w-px flex-1 flex-col items-start justify-start gap-1\">\n                  <p class=\"flex-shrink-0 flex-grow-0 self-stretch text-left text-xl font-semibold line-clamp-1\">\n                    {{ item?.name || item?.title }}\n                  </p>\n                  <div class=\"relative flex flex-shrink-0 flex-grow-0 items-center justify-start gap-2 self-stretch\">\n                    <p class=\"flex flex-shrink-0 flex-grow-0 items-center gap-2 text-right text-base\">\n                      <MoooomIcon v-if=\"item?.media_type === 'tv'\" icon=\"monitor\" className=\"h-5 w-5 sm:h-4 sm:w-4\" />\n                      <MoooomIcon v-else-if=\"item?.media_type === 'movie'\" icon=\"film\"\n                        className=\"h-5 w-5 sm:h-4 sm:w-4\" />\n                      <MoooomIcon v-else-if=\"item?.media_type === 'person'\" icon=\"user\"\n                        className=\"h-5 w-5 sm:h-4 sm:w-4\" />\n                      <span v-if=\"item?.release_date || item?.first_air_date\" class=\"sm:text-2xs\">\n                        ({{ parseYear(item?.release_date ?? item?.first_air_date) }})\n                      </span>\n                    </p>\n                  </div>\n                  <p class=\"text-sm line-clamp-[4] sm:text-2xs sm:line-clamp-4\">\n                    {{ item?.overview }}\n                  </p>\n                </div>\n              </RouterLink>\n\n            </template>\n            <div class=\"z-50 mt-4 flex justify-center\" ref=\"loadMore\" v-if=\"hasMoreResults && videoSearchResult.length > 0\">\n              <button @click=\"fetchNextPage()\" class=\"h-12 rounded bg-blue-500 px-4 py-2 text-white\">\n                {{ $t('Load more') }}\n              </button>\n            </div>\n          </div>\n\n          <div v-else-if=\"musicSearchResult\"\n               class=\"flex w-full flex-col p-1 h-available sm:p-4 sm:pt-0 overflow-auto\">\n            <component v-for=\"(render, index) in musicSearchResult ?? []\" :index=\"index\" :key=\"render.id\"\n                       :is=\"render.component\" v-bind=\"render.props\" />\n          </div>\n        </div>\n\n        <div\n          class=\"absolute flex justify-center items-center self-center flex-grow-0 flex-shrink-0 w-available h-14 sm:w-1/2 overflow-hidden gap-2 p-1.5 rounded-[20px] border-2 bg-[#d7dbdf] border-[#eceef0] dark:bg-black dark:border-[#202425] transition-all duration-300\"\n          :style=\"{\n            bottom: debouncedIsOpen && searchValue.length == 0\n              ? `${debouncedKeyboardHeight - 80}px`\n              : debouncedIsOpen && searchValue.length > 0\n                ? `${debouncedKeyboardHeight - 80}px`\n                : !debouncedIsOpen && searchValue.length > 0\n                  ? '0vh'\n                  : '50vh',\n          }\" :class=\"{\n              'mx-2': !debouncedIsOpen && searchValue.length == 0,\n              'rounded-none': debouncedIsOpen || searchValue.length > 0,\n            }\">\n\n          <div\n              class=\"flex flex-col justify-start items-start flex-grow-0 flex-shrink-0 gap-2 p-1 rounded-xl bg-[#012139]/[0.13] dark:bg-[#dfeffe]/[0.14] backdrop-blur\"\n          >\n            <div class=\"relative flex justify-center items-start flex-grow-0 flex-shrink-0 gap-2\">\n              <div class=\"absolute w-9 h-available inset-0 bg-focus z-0 rounded-lg transition-all duration-150\"\n                   :class=\"{\n                      'translate-x-0': searchType == 'video',\n                      'translate-x-[120%]': searchType == 'music',\n                    }\"\n              ></div>\n              <button @click=\"searchType = 'video'\"\n                      class=\"flex justify-center items-center flex-grow-0 flex-shrink-0 relative gap-2 p-1 rounded-lg w-9\"\n                      :class=\"{\n                         'text-slate-dark-12': searchType == 'video',\n                      }\"\n              >\n                <MoooomIcon icon=\"film\" class=\"h-6 w-6 flex-grow-0 flex-shrink-0 transition-all duration-150\"/>\n              </button>\n              <button @click=\"searchType = 'music'\"\n                      class=\"flex justify-center items-center flex-grow-0 flex-shrink-0 relative gap-2 p-1 rounded-lg w-9\"\n                      :class=\"{\n                         'text-slate-dark-12': searchType == 'music',\n                      }\"\n              >\n                <MoooomIcon icon=\"noteDouble\" class=\"h-6 w-6 flex-grow-0 flex-shrink-0 transition-all duration-150\"/>\n              </button>\n            </div>\n          </div>\n\n          <label class=\"flex w-available\">\n            <input enterkeyhint=\"search\" id=\"search\"\n                       :placeholder=\"searchType == 'video'\n                              ? 'Movie, TV Show or Person...'\n                              : 'Artist, Album or Track...'\"\n\n              class=\"w-available flex-shrink-0 border-transparent bg-transparent mr-1 text-lg shadow-transparent flex-grow-1\n                   focus: outline-none\"\n              :class=\"{\n                '!py-1': !debouncedIsOpen,\n              }\" v-model=\"searchValue\" name=\"search\" type=\"search\" ref=\"search\" autocomplete=\"off\" />\n          </label>\n        </div>\n      </div>\n    </ion-content>\n  </ion-page>\n</template>\n"],"names":["route","useRoute","content","ref","onIonViewWillEnter","searchType","setColorPalette","setBackground","search","_b","_a","onMounted","isOpen","keyboardHeight","useKeyboard","debouncedIsOpen","refDebounced","debouncedKeyboardHeight","watch","showScreensaver","value","searchValue","_c"],"mappings":"82DAyBA,MAAMA,EAAQC,EAAS,EACjBC,EAAUC,EAAmB,EAEnCC,EAAmB,IAAM,CACvBC,EAAW,MAAQL,EAAM,MAAM,MAAQ,QAAU,QAAU,QAC3DM,EAAgB,IAAI,EACpBC,EAAc,IAAI,EAClB,WAAW,IAAM,SACfC,EAAO,MAAM,MAAM,GAEXC,GAAAC,EAAAR,EAAA,QAAA,YAAAQ,EAAO,MAAP,MAAAD,EAAY,kBACnB,GAAG,CAAA,CACP,EAEDE,EAAU,IAAM,CACdN,EAAW,MAAQL,EAAM,MAAM,MAAQ,QAAU,QAAU,QAC3DM,EAAgB,IAAI,EACpBC,EAAc,IAAI,EAClB,WAAW,IAAM,SACfC,EAAO,MAAM,MAAM,GAEXC,GAAAC,EAAAR,EAAA,QAAA,YAAAQ,EAAO,MAAP,MAAAD,EAAY,kBACnB,GAAG,CAAA,CACP,EAED,KAAM,CAAE,OAAAG,EAAQ,eAAAC,CAAe,EAAIC,EAAY,EACzCC,EAAkBC,EAAaJ,EAAQ,GAAG,EAC1CK,EAA0BD,EAAaH,EAAgB,GAAG,EAEhE,OAAAT,EAAmB,IAAM,CACvBE,EAAgB,IAAI,EACpBC,EAAc,IAAI,CAAA,CACnB,EAEDI,EAAU,IAAM,CACd,WAAW,IAAM,SACfH,EAAO,MAAM,MAAM,GAEXC,GAAAC,EAAAR,EAAA,QAAA,YAAAQ,EAAO,MAAP,MAAAD,EAAY,kBACnB,GAAG,CAAA,CACP,EAEKS,EAAAC,EAAkBC,GAAU,CAC5BA,GACF,SAAS,KAAK,MAAM,CACtB,CACD,EAEDF,EAAMb,EAAY,IAAM,CACtB,WAAW,IAAM,aACZK,EAAAW,EAAY,QAAZ,YAAAX,EAAmB,SAAU,GAC9BF,EAAO,MAAM,MAAM,GAGbc,GAAAb,EAAAP,EAAA,QAAA,YAAAO,EAAO,MAAP,MAAAa,EAAY,kBACnB,GAAG,CAAA,CACP,EAEDJ,EAAMD,EAAyB,IAAM,CACnC,WAAW,IAAM,UAEPR,GAAAC,EAAAR,EAAA,QAAA,YAAAQ,EAAO,MAAP,MAAAD,EAAY,eAAe,IAClC,GAAG,CAAA,CACP"}