import{$ as j,a8 as P,B,h as $,o as d,j as t,x as _,a0 as V,G as X,F as M,q as z,v as ee,c as g,z as h,a as le,b as T,p as S,A as D,a$ as A,aU as G,R as I,d as y,w as N,k as Y,a_ as K,bl as se,ao as re,au as ae,ar as oe}from"./vue-ionic-Db_NiJFp.js";import{u as O}from"./useServerClient-CUQzpYwE.js";import{_ as U}from"./Button.vue_vue_type_script_setup_true_lang-ZOdlfYgK.js";import{A as ne}from"./AppLogo-D792PRyH.js";import{cn as ie,a as H,r as te,bf as ue}from"./index-dhF1HRpl.js";import{_ as de}from"./Modal.vue_vue_type_script_setup_true_lang-DgmZ3_6v.js";import{_ as L}from"./MoooomIcon.vue_vue_type_script_setup_true_lang-CLyVk1yD.js";import{_ as Z}from"./Button.vue_vue_type_script_setup_true_lang-BO0XnUC6.js";import{_ as ce}from"./DeleteEncoderProfileModal.vue_vue_type_script_setup_true_lang-Bmy-5E0P.js";import{a as fe,b as pe}from"./DeleteLibraryModal.vue_vue_type_script_setup_true_lang-DxYndUNR.js";import{u as me}from"./primevue-Bn7Q4nqF.js";import"./vendor-Dgtccx1h.js";import"./icons-BW5E66pf.js";import"./rxjs-BCp2L9Rn.js";import"./media-C2AqgyMX.js";import"./api-BBofn2cc.js";import"./swiper-D00Cnjmx.js";import"./useInfiniteServerClient-BLSEFIWT.js";import"./OptimizedIcon.vue_vue_type_script_setup_true_lang-DHzcpnxP.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./music-player-bBxcOCLu.js";import"./ScrollContainer.vue_vue_type_script_setup_true_lang-BY75sSIQ.js";const ve={class:"-mt-12 px-4"},xe={class:"text-xl font-bold text-contrast"},he={"aria-hidden":"true",class:"mt-4"},_e={class:"overflow-hidden rounded-full bg-gray-200"},be=j({__name:"Stepper",props:{steps:{type:Array,required:!0},currentStep:{type:String,required:!0}},setup(s){const l=s,{t:a}=P(),i=B(()=>{var u;return l.steps?(u=l.steps)==null?void 0:u.indexOf(l.currentStep):0}),e=B(()=>l.steps?(i.value+1)/l.steps.length*100:0);return(u,n)=>(d(),$("div",ve,[t("h4",xe,_(V(a)(s.currentStep)),1),t("div",he,[t("div",_e,[t("div",{style:X(`width: ${e.value}%`),class:"h-1 rounded-full bg-theme-600"},null,4)]),t("div",{style:X(`grid-template-columns: repeat(${s.steps.length}, minmax(0, 1fr))`),class:"mt-6 hidden text-sm font-medium text-auto-600 sm:grid"},[(d(!0),$(M,null,z(s.steps,o=>(d(),$("div",{key:o,class:"text-center"},_(V(a)(o)),1))),128))],4)])]))}}),ye={class:"mx-auto grid h-screen place-content-center px-4 sm:px-6 lg:px-8"},ge={class:"mx-auto -mt-24 w-screen max-w-6xl"},ke={class:"flex h-full w-full flex-col gap-4 overflow-hidden p-8 pb-0 min-h-[80vh] max-h-[80vh] h-available"},we={class:"mx-auto h-44 w-auto p-2"},$e={class:"overflow-hidden p-4 h-available"},Se={class:"mt-auto flex h-16 w-full justify-end gap-4 rounded-b-lg p-4 bg-slate-light-1/70 dark:bg-slate-dark-1/70"},Ve=j({__name:"Frame",props:{steps:{type:Array,required:!0},nextButtonLocked:{type:Boolean,default:!1},currentStep:{type:String,required:!0},setCurrentStep:{type:Function,required:!0},finish:{type:Function,required:!0}},setup(s){const l=s,{t:a}=P(),i=B(()=>l.steps.findIndex(o=>o===l.currentStep)===0),e=B(()=>l.steps.findIndex(o=>o===l.currentStep)===l.steps.length-1);function u(){l.steps.findIndex(o=>o===l.currentStep)<l.steps.length-1&&l.setCurrentStep(l.steps[l.steps.findIndex(o=>o===l.currentStep)+1])}function n(){l.steps.findIndex(o=>o===l.currentStep)>0&&l.setCurrentStep(l.steps[l.steps.findIndex(o=>o===l.currentStep)-1])}return O({path:"/dashboard/configuration/languages"}),O({path:"/dashboard/libraries"}),O({path:"/dashboard/encoderProfiles"}),(o,k)=>(d(),$("div",ye,[t("div",ge,[t("div",{class:ee(["animate-loading","w-full h-full gap-2.5 flex flex-col ml-auto overflow-hidden rounded-xl bg-slate-light-1 dark:bg-slate-dark-1 bg-cover border-2 border-transparent text-start [background:padding-box_var(--bg-color),border-box_var(--border-color)] transition-all duration-300"]),style:{"--bg-color":"linear-gradient(rgb(var(--color-auto-50)), rgb(var(--color-auto-50)))","--border-color":`linear-gradient(var(--angle),
						rgb(var(--color-logo-light) / 0.7) 0%,
						rgb(var(--color-logo-light) / 0.3) 33.33%,
						rgb(var(--color-logo-light) / 0.14) 66.67%,
						rgb(var(--color-logo-light) / 0.1) 100%
					)`}},[t("div",ke,[t("div",we,[h(ne,{class:"pb-8"})]),(d(),g(be,{key:s.currentStep,"current-step":s.currentStep,steps:s.steps},null,8,["current-step","steps"])),t("div",$e,[le(o.$slots,"default")])]),t("div",Se,[i.value?T("",!0):(d(),g(U,{key:0,id:"yes",class:"ml-auto !w-28",color:"white",type:"button",variant:"text",onClick:n},{default:S(()=>[D(_(V(a)("Back")),1)]),_:1})),e.value?(d(),g(U,{key:1,id:"cancel",disabled:s.nextButtonLocked,class:"!w-28",color:"theme",type:"button",variant:"default",onClick:s.finish},{default:S(()=>[D(_(V(a)("Finish")),1)]),_:1},8,["disabled","onClick"])):(d(),g(U,{key:2,id:"save",disabled:s.nextButtonLocked,class:"!w-28",color:"theme",type:"button",variant:"default",onClick:u},{default:S(()=>[D(_(V(a)("Next")),1)]),_:1},8,["disabled"]))])])])]))}}),je={class:"flex flex-col justify-start items-center flex-grow gap-4"},Ce={class:"flex justify-start items-start flex-grow-0 flex-shrink-0 relative gap-2 p-2 rounded-lg"},qe={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-0.5"},Ne={class:"flex justify-start items-start self-stretch flex-grow-0 flex-shrink-0 relative gap-1.5"},Fe={class:"flex-grow w-[109.25px] text-base font-medium text-center text-[#eeecec]"},Le=j({__name:"TypeButton",props:{type:{type:Object,required:!0},selected:{type:Boolean,default:!1},className:{type:String,required:!1,default:""}},setup(s){const l=s,a=B(()=>{var e;let i="nomercy";switch((e=l.type)==null?void 0:e.value){case"music":i="noteDouble";break;case"tv":i="tv";break;case"image":i="camera";break;case"movie":i="film";break;default:i="nomercy"}return i});return(i,e)=>(d(),$("div",{class:ee(["flex justify-start items-start flex-grow gap-1 px-2 py-4 rounded-xl",{"bg-[#1c172b] outline outline-2 outline-[#7c66dc] hover:bg-[#7452fe]/[0.15]":s.selected,"hover:bg-[#7452fe]/[0.15]":!s.selected}])},[t("div",je,[t("div",Ce,[h(L,{icon:a.value,"class-name":s.className},null,8,["icon","class-name"])]),t("div",qe,[t("div",Ne,[t("p",Fe,_(s.type.name),1)])])])],2))}}),Be={class:"flex justify-start items-center self-stretch flex-grow-0 flex-shrink-0 gap-2"},Ie={class:"flex flex-col justify-center items-center flex-grow gap-2"},Me={class:"flex justify-start items-center self-stretch flex-grow-0 flex-shrink-0 h-10 relative overflow-hidden gap-2 pl-3 pr-2.5 py-2.5 rounded-[10px] bg-[#d5feff]/[0.03]"},De={class:"flex-grow w-available text-base font-semibold text-left text-[#9ba1a6]"},Oe=j({__name:"FolderItem",props:A({handleDeleteFolder:{type:Function,required:!0},folder:{type:Object,required:!0},setEncoderQualities:{type:Function,required:!0}},{modelValue:{type:Object,required:!0},modelModifiers:{}}),emits:A({"update:modelValue":s=>!0},["update:modelValue"]),setup(s,{emit:l}){var b;const a=s,i=G(s,"modelValue"),{data:e}=O({path:"dashboard/encoderProfiles",queryKey:["dashboard","encoderProfiles"]}),u=B(()=>{var p,c,x,C;switch(i.value.type){case"anime":return(p=e.value)==null?void 0:p.filter(m=>m.container==="m3u8").map(m=>I(m));case"movie":return(c=e.value)==null?void 0:c.filter(m=>m.container==="m3u8").map(m=>I(m));case"tv":return(x=e.value)==null?void 0:x.filter(m=>m.container==="m3u8").map(m=>I(m));case"music":return(C=e.value)==null?void 0:C.filter(m=>m.container==="mp3"||m.container==="flac").map(m=>I(m));default:return[]}}),n=y(((b=u.value)==null?void 0:b.filter(p=>{var c;return(c=a.folder.folder.encoder_profiles)==null?void 0:c.some(x=>x.id===p.id)}))??[]);N([u,()=>a.folder.folder.encoder_profiles],([p,c])=>{!p||!c||(n.value=p.filter(x=>c.some(C=>C.id===x.id)))},{deep:!0});function o(p){const c=p.map(x=>I(x));n.value=c,a.setEncoderQualities(I(a.folder),c)}N(i,()=>{u.value&&(n.value=u.value.filter(p=>a.folder.folder.encoder_profiles.some(c=>c.id===p.id)))});const k=y(!1);function r(){k.value=!0}function v(){k.value=!1}return(p,c)=>{var C,m,E;const x=Y("MultiSelect");return d(),$(M,null,[t("div",Be,[h(x,{id:"encoderProfiles","model-value":n.value,placeholder:"Select",class:"w-[160px]",options:u.value,"option-label":"name","onUpdate:modelValue":o},null,8,["model-value","options"]),t("div",Ie,[t("div",Me,[t("p",De,_(s.folder.folder.path),1),t("button",{onClick:r},[h(L,{icon:"trash","class-name":"w-6 h-6 text-[#9ba1a6] flex-grow-0 flex-shrink-0 cursor-pointer"})])])])]),(C=i.value)!=null&&C.id?(d(),g(ce,{key:0,id:((m=i.value)==null?void 0:m.id)??"",name:((E=i.value)==null?void 0:E.title)??"",close:v,open:k.value},null,8,["id","name","open"])):T("",!0)],64)}}}),Te={class:"flex flex-col justify-start items-start flex-grow-0 flex-shrink-0 w-full relative gap-8 p-1 px-6"},Ee={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-3"},Ae={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-6"},Qe={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-4"},Ue={class:"flex justify-start items-start self-stretch flex-grow-0 flex-shrink-0"},ze={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-2"},Pe={class:"flex justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-2"},Ke={class:"flex flex-col justify-start items-start flex-grow gap-1.5"},Re={class:"flex justify-start items-center flex-grow-0 flex-shrink-0 relative gap-px"},Ge={class:"flex-grow-0 flex-shrink-0 text-sm font-medium text-left text-[#eeecec]"},Ye={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-3"},He={class:"flex justify-start items-center self-stretch flex-grow-0 flex-shrink-0 relative gap-2 rounded"},Je={class:"flex-grow w-[501px] text-lg font-medium text-left text-[#eeecec]"},We={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-6"},Xe={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-2"},Ze={class:"flex flex-col justify-start items-start self-stretch flex-grow-0 flex-shrink-0 gap-2"},et={class:"flex justify-start items-center self-stretch flex-grow-0 flex-shrink-0 relative gap-1"},tt={class:"flex-grow-0 flex-shrink-0 text-sm text-left text-[#9ba1a6]"},lt={class:"flex w-full justify-end items-start self-stretch flex-grow-0 flex-shrink-0 gap-2 rounded-lg bg-white/[0.04] p-2"},st=j({__name:"EditLibraryModal",props:A({open:{type:Boolean,required:!0},close:{type:Function,required:!0},id:{type:String,required:!0},noRedirect:{type:Boolean,default:!1}},{modelValue:{type:Object,required:!0},modelModifiers:{}}),emits:A({"update:modelValue":s=>!0},["update:modelValue"]),setup(s,{emit:l}){var E,J;const a=s,i=l,e=G(s,"modelValue"),u=K(),n=y((E=e.value)==null?void 0:E.title),o=y(((J=e.value)==null?void 0:J.type)??"movie");N(n,f=>{!f||!e.value||(e.value={...e.value,title:f})}),N(o,f=>{!f||!e.value||(e.value={...e.value,type:f})}),N(()=>e.value,f=>{f&&(n.value=f.title,o.value=f.type||"movie",e.value.folder_library||(e.value={...e.value,folder_library:[]}))},{deep:!0});const k=y([]),r=y("/");function v(f){r.value=f}const b=y(!1);function p(){b.value=!0}function c(){b.value=!1,e.value&&!e.value.folder_library&&(e.value={...e.value,folder_library:[]})}function x(){e.value&&(H().patch(`dashboard/libraries/${e.value.id}`,{...e.value,subtitles:k.value.map(f=>f.iso_639_1),specialSeasonName:e.value.specialSeasonName}).then(()=>{u.invalidateQueries({queryKey:["dashboard","libraries"]}),!a.noRedirect&&te.replace("/dashboard/system/libraries")}),a.close())}function C(f,w){if(!e.value)return;const R=e.value.folder_library.map(F=>F.folder_id===f.folder_id?{...F,folder:{...F.folder,encoder_profiles:w.map(Q=>Q)}}:F);i("update:modelValue",{...e.value,folder_library:R})}function m(f){e.value&&(e.value={...e.value,folder_library:e.value.folder_library.filter(w=>w.folder_id!==f.folder_id)})}return(f,w)=>{const R=Y("InputText");return d(),$(M,null,[h(de,{id:"editLibraryModal",close:s.close,open:s.open,"max-width":"max-w-[565px]",title:"Edit Library"},{actions:S(()=>[t("div",lt,[h(Z,{id:"save",type:"button",color:"theme",onClick:x},{default:S(()=>[D(_(f.$t("Create library")),1)]),_:1})])]),default:S(()=>{var F,Q;return[t("div",Te,[t("div",Ee,[t("div",Ae,[t("div",Qe,[t("div",Ue,[(d(!0),$(M,null,z(V(ie),q=>(d(),g(Le,{key:q.value,type:q,selected:o.value===q.value,"class-name":"size-10",onClick:W=>o.value=q.value},null,8,["type","selected","onClick"]))),128))]),t("div",ze,[t("div",Pe,[t("div",Ke,[t("div",Re,[t("p",Ge,_(f.$t("Library Title")),1),w[2]||(w[2]=t("p",{class:"flex-grow-0 flex-shrink-0 text-sm font-medium text-left text-[#6e56cf]"}," * ",-1))]),h(R,{id:"title",modelValue:n.value,"onUpdate:modelValue":w[0]||(w[0]=q=>n.value=q),class:"w-full",required:""},null,8,["modelValue"])])])])])])]),w[3]||(w[3]=t("div",{class:"flex-grow-0 flex-shrink-0 w-10 h-0.5 rounded bg-[#e2f0fd]/[0.08]"},null,-1)),t("div",Ye,[t("div",He,[t("p",Je,_(f.$t("Select one or more folders")),1)]),t("div",We,[t("div",Xe,[t("div",Ze,[h(Z,{id:"save",type:"button",color:"slate",class:"w-full flex justify-between","end-icon":"folderAdd",onClick:p},{default:S(()=>[D(_(f.$t("Add folder")),1)]),_:1})]),(F=e.value)!=null&&F.folder_library?(d(!0),$(M,{key:0},z((Q=e.value)==null?void 0:Q.folder_library,q=>(d(),g(Oe,{key:q.folder_id,modelValue:e.value,"onUpdate:modelValue":w[1]||(w[1]=W=>e.value=W),folder:q,"set-encoder-qualities":C,"handle-delete-folder":m},null,8,["modelValue","folder"]))),128)):T("",!0),t("div",et,[h(L,{icon:"infoCircle","class-name":"w-4 h-4 text-[#9ba1a6] flex-grow-0 flex-shrink-0"}),t("p",tt,_(f.$t("You can always add folder and change encoding profiles later")),1)])])])])])]}),_:1},8,["close","open"]),h(fe,{close:c,folder:r.value,open:b.value,"set-folder":v,library:e.value},null,8,["folder","open","library"])],64)}}}),rt={class:"flex h-min children:cursor-default flex-col items-center rounded-lg w-inherit odd:bg-auto-300/20 even:bg-auto-300/0"},at={class:"flex items-center gap-2 overflow-x-hidden py-2 pr-2 w-inherit overflow-y-show"},ot={class:"ml-2 h-auto w-8 p-2 handle"},nt={class:"w-full line-clamp-1"},it=j({__name:"LibraryItem",props:{modelValue:{type:Object,required:!0},modelModifiers:{}},emits:A({"update:modelValue":s=>!0},["update:modelValue"]),setup(s){const l=G(s,"modelValue"),a=y(!1);function i(){a.value=!0}function e(){a.value=!1}const u=y(!1);function n(){u.value=!0}function o(){u.value=!1}const k=B(()=>{let r;switch(l.value.type){case"music":r="noteDouble";break;case"tv":r="tv";break;case"image":r="camera";break;case"movie":r="film";break;default:r="nomercy"}return r});return(r,v)=>{var b,p,c;return d(),$("div",rt,[t("div",at,[t("button",ot,[h(L,{icon:"menuDotsVertical",class:"h-6 w-6"})]),h(L,{icon:k.value,class:"h-6 w-6"},null,8,["icon"]),t("span",nt,_((b=l.value)==null?void 0:b.title),1),t("button",{class:"ml-auto flex justify-center items-center h-10 px-2.5 py-2 gap-2 rounded-lg text-sm select-none w-auto font-semibold leading-[100%] transition-all duration-150 button-text hover:outline-[rgba(var(--color-500),.1)] hover:outline-1 hover:outline text-[var(--color-500)]",type:"button",onClick:n},[h(L,{icon:"folderEdit",class:"h-6 w-6"})]),t("button",{class:"ml-auto flex justify-center items-center h-10 px-2.5 py-2 gap-2 rounded-lg text-sm select-none w-auto font-semibold leading-[100%] transition-all duration-150 button-text hover:outline-[rgba(var(--color-500),.1)] hover:outline-1 hover:outline text-[var(--color-500)]",type:"button",onClick:i},[h(L,{icon:"folderRemove",class:"h-6 w-6"})])]),l.value?(d(),g(st,{key:0,id:(p=l.value)==null?void 0:p.id,modelValue:l.value,"onUpdate:modelValue":[v[0]||(v[0]=x=>l.value=x),v[1]||(v[1]=x=>{console.log("emit",x),r.$emit("update:modelValue",x)})],close:o,open:u.value,"no-redirect":""},null,8,["id","modelValue","open"])):T("",!0),l.value?(d(),g(pe,{key:1,id:(c=l.value)==null?void 0:c.id,name:l.value.title,close:e,open:a.value,"no-redirect":""},null,8,["id","name","open"])):T("",!0)])}}}),ut={class:"flex flex-col overflow-hidden text-start h-available"},dt={class:"mb-2 text-xl font-semibold"},ct={class:"mb-4 text-sm"},ft={class:"mt-4 flex w-full justify-start"},pt=j({__name:"Libraries",props:{setNextButtonLocked:{type:Function,required:!0}},setup(s){const l=s,{t:a}=P(),i=K(),{data:e}=O({path:"dashboard/libraries"}),u=y(null),n=y(e.value??[]);N(e,r=>{console.log("Libraries updated:",r),r&&(n.value=r,l.setNextButtonLocked((r==null?void 0:r.length)===0))});function o(r){const v=n.value.findIndex(b=>b.id===r.id);v!==-1&&(n.value=[...n.value.slice(0,v),r])}function k(){H().post("dashboard/libraries").then(()=>{i.invalidateQueries({queryKey:["dashboard","libraries"]})})}return se(u,n,{animation:150,handle:".handle"}),(r,v)=>(d(),$("div",ut,[t("h2",dt,_(V(a)("Organize your media library")),1),t("p",ct,_(V(a)("Add your media libraries to organize your content.")),1),t("div",{ref_key:"el",ref:u,class:"flex h-auto w-full flex-col overflow-y-auto text-start"},[(d(!0),$(M,null,z(n.value,(b,p)=>(d(),g(it,{key:b.id,modelValue:n.value[p],"onUpdate:modelValue":[c=>n.value[p]=c,v[0]||(v[0]=c=>o(c))]},null,8,["modelValue","onUpdate:modelValue"]))),128))],512),t("div",ft,[h(U,{id:"yes",color:"theme",type:"button",variant:"contained",onClick:k},{default:S(()=>[D(_(V(a)("Add media library")),1)]),_:1})])]))}}),mt=j({__name:"Finish",props:{setNextButtonLocked:{type:Function,required:!0}},setup(s){return P(),K(),(l,a)=>null}}),vt=j({__name:"Name",props:{setNextButtonLocked:{type:Function,required:!0}},setup(s){var k;const l=s,a=K(),i=me(),{data:e}=O({path:"dashboard/server/info",queryKey:["serverinfo"]}),u=y(((k=e.value)==null?void 0:k.server)??""),n=re(u,500);N(e,r=>{r&&(u.value=r.server)});function o(){H().patch("dashboard/server/info",{name:n.value}).then(({data:r})=>{i.add({severity:"success",summary:ue(r.message,...r.args??[]),life:2e3}),a.invalidateQueries({queryKey:["servers"]})})}return N(n,r=>{r&&o()}),N(u,r=>{l.setNextButtonLocked(!r)}),(r,v)=>{const b=Y("Textarea");return d(),g(b,{id:"serverName",modelValue:u.value,"onUpdate:modelValue":v[0]||(v[0]=p=>u.value=p),name:"Give your server a friendly name to help identify it."},null,8,["modelValue"])}}}),Tt=j({__name:"Desktop",setup(s){const l=y(["Name","Media libraries","Finish"]),a=y("Name"),i=y(!1);function e(){console.log("Finish"),te.replace("/")}function u(o){a.value=o}function n(o){i.value=o}return(o,k)=>(d(),g(V(oe),null,{default:S(()=>[h(V(ae),{fullscreen:!0},{default:S(()=>[h(Ve,{"current-step":a.value,finish:e,"next-button-locked":i.value,"set-current-step":u,steps:l.value},{default:S(()=>[a.value==="Name"?(d(),g(vt,{key:0,"set-next-button-locked":n})):a.value==="Media libraries"?(d(),g(pt,{key:1,"set-next-button-locked":n})):a.value==="Finish"?(d(),g(mt,{key:2,"set-next-button-locked":n})):T("",!0)]),_:1},8,["current-step","next-button-locked","steps"])]),_:1})]),_:1}))}});export{Tt as default};
